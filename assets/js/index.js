!function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},{}],2:[function(e,t,n){"use strict";var r=e("./arrayLikeToArray.js");t.exports=function(e){if(Array.isArray(e))return r(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],3:[function(e,t,n){"use strict";t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],4:[function(e,t,n){"use strict";t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],5:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],6:[function(e,t,n){"use strict";t.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],7:[function(e,t,n){"use strict";var r=e("./superPropBase.js");function i(){return"undefined"!=typeof Reflect&&Reflect.get?(t.exports=i=Reflect.get,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=i=function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},t.exports.__esModule=!0,t.exports.default=t.exports),i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},{"./superPropBase.js":15}],8:[function(e,t,n){"use strict";function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},{}],9:[function(e,t,n){"use strict";var r=e("./setPrototypeOf.js");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./setPrototypeOf.js":14}],10:[function(e,t,n){"use strict";t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],11:[function(e,t,n){"use strict";t.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{}],12:[function(e,t,n){"use strict";t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],13:[function(e,t,n){"use strict";var r=e("./typeof.js").default,i=e("./assertThisInitialized.js");t.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},t.exports.__esModule=!0,t.exports.default=t.exports},{"./assertThisInitialized.js":3,"./typeof.js":17}],14:[function(e,t,n){"use strict";function r(e,n){return t.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e,n)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},{}],15:[function(e,t,n){"use strict";var r=e("./getPrototypeOf.js");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./getPrototypeOf.js":8}],16:[function(e,t,n){"use strict";var r=e("./arrayWithoutHoles.js"),i=e("./iterableToArray.js"),a=e("./unsupportedIterableToArray.js"),o=e("./nonIterableSpread.js");t.exports=function(e){return r(e)||i(e)||a(e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayWithoutHoles.js":2,"./iterableToArray.js":11,"./nonIterableSpread.js":12,"./unsupportedIterableToArray.js":18}],17:[function(e,t,n){"use strict";function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},{}],18:[function(e,t,n){"use strict";var r=e("./arrayLikeToArray.js");t.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},{"./arrayLikeToArray.js":1}],19:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.spline=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=(e=a(e,n)).length,o=i-4,s=n?e[2]:e[0],l=n?e[3]:e[1],u="M"+[s,l];r&&r("MOVE",[s,l]);for(var c=n?2:0,h=n?i-4:i-2,d=2,p=c;p<h;p+=d){var f=p?e[p-2]:e[0],m=p?e[p-1]:e[1],v=e[p+0],g=e[p+1],y=e[p+2],x=e[p+3],_=p!==o?e[p+4]:y,b=p!==o?e[p+5]:x,w=v+(y-f)/6*t,M=g+(x-m)/6*t,S=y-(_-v)/6*t,T=x-(b-g)/6*t;u+="C"+[w,M,S,T,y,x],r&&r("CURVE",[w,M,S,T,y,x])}return u};var i=r(e("@babel/runtime/helpers/toConsumableArray"));function a(e,t){if(e=(0,i.default)(e),Array.isArray(e[0])||(e=e.map((function(e){return[e.x,e.y]}))),t){var n=e[e.length-1],r=e[e.length-2],a=e[0],o=e[1];e.unshift(n),e.unshift(r),e.push(a),e.push(o)}return e.flat()}},{"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/toConsumableArray":16}],20:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){if(r=(n=window.getComputedStyle)?n(e):e.currentStyle)return r[t.replace(/-(\w)/gi,(function(e,t){return t.toUpperCase()}))]}},{}],21:[function(e,t,n){"use strict";t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],t[r]||"");return n.push(e[r]),n.join("")}},{}],22:[function(e,t,n){"use strict";var r,i,a=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof"));r=void 0,i=function(e){function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var r,i,o,s,l,u,c,h,d,p,f,m,v,g,y,x,_,b,w,M,S,T,E,A,C,L,R,P,D={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},I={duration:.5,overwrite:!1,delay:0},O=1e8,z=1e-8,k=2*Math.PI,F=k/4,N=0,B=Math.sqrt,U=Math.cos,G=Math.sin,H=function(e){return"string"==typeof e},j=function(e){return"function"==typeof e},V=function(e){return"number"==typeof e},W=function(e){return"undefined"==typeof e},q=function(e){return"object"===(0,a.default)(e)},X=function(e){return!1!==e},Y=function(){return"undefined"!=typeof window},Z=function(e){return j(e)||H(e)},K="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},J=Array.isArray,Q=/(?:-?\.?\d|\.)+/gi,$=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ee=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,te=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ne=/[+-]=-?[.\d]+/,re=/[^,'"\[\]\s]+/gi,ie=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ae={},oe={},se=function(e){return(oe=Ie(e,ae))&&Mn},le=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},ue=function(e,t){return!t&&console.warn(e)},ce=function(e,t){return e&&(ae[e]=t)&&oe&&(oe[e]=t)||ae},he=function(){return 0},de={},pe=[],fe={},me={},ve={},ge=30,ye=[],xe="",_e=function(e){var t,n,r=e[0];if(q(r)||j(r)||(e=[e]),!(t=(r._gsap||{}).harness)){for(n=ye.length;n--&&!ye[n].targetTest(r););t=ye[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new Wt(e[n],t)))||e.splice(n,1);return e},be=function(e){return e._gsap||_e(ct(e))[0]._gsap},we=function(e,t,n){return(n=e[t])&&j(n)?e[t]():W(n)&&e.getAttribute&&e.getAttribute(t)||n},Me=function(e,t){return(e=e.split(",")).forEach(t)||e},Se=function(e){return Math.round(1e5*e)/1e5||0},Te=function(e){return Math.round(1e7*e)/1e7||0},Ee=function(e,t){var n=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),"+"===n?e+r:"-"===n?e-r:"*"===n?e*r:e/r},Ae=function(e,t){for(var n=t.length,r=0;e.indexOf(t[r])<0&&++r<n;);return r<n},Ce=function(){var e,t,n=pe.length,r=pe.slice(0);for(fe={},pe.length=0,e=0;e<n;e++)(t=r[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},Le=function(e,t,n,r){pe.length&&Ce(),e.render(t,n,r),pe.length&&Ce()},Re=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(re).length<2?t:H(e)?e.trim():e},Pe=function(e){return e},De=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Ie=function(e,t){for(var n in t)e[n]=t[n];return e},Oe=function e(t,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(t[r]=q(n[r])?e(t[r]||(t[r]={}),n[r]):n[r]);return t},ze=function(e,t){var n,r={};for(n in e)n in t||(r[n]=e[n]);return r},ke=function(e){var t,n=e.parent||i,r=e.keyframes?(t=J(e.keyframes),function(e,n){for(var r in n)r in e||"duration"===r&&t||"ease"===r||(e[r]=n[r])}):De;if(X(e.inherit))for(;n;)r(e,n.vars.defaults),n=n.parent||n._dp;return e},Fe=function(e,t,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,o=e[r];if(i)for(a=t[i];o&&o[i]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[r]=t,t._prev=o,t.parent=t._dp=e,t},Ne=function(e,t,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=t._prev,a=t._next;i?i._next=a:e[n]===t&&(e[n]=a),a?a._prev=i:e[r]===t&&(e[r]=i),t._next=t._prev=t.parent=null},Be=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},Ue=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},Ge=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},He=function e(t){return!t||t._ts&&e(t.parent)},je=function(e){return e._repeat?Ve(e._tTime,e=e.duration()+e._rDelay)*e:0},Ve=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},We=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},qe=function(e){return e._end=Te(e._start+(e._tDur/Math.abs(e._ts||e._rts||z)||0))},Xe=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=Te(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),qe(e),n._dirty||Ue(n,e)),e},Ye=function(e,t){var n;if((t._time||t._initted&&!t._dur)&&(n=We(e.rawTime(),t),(!t._dur||ot(0,t.totalDuration(),n)-t._tTime>z)&&t.render(n,!0)),Ue(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-1e-8}},Ze=function(e,t,n,r){return t.parent&&Be(t),t._start=Te((V(n)?n:n||e!==i?rt(e,n,t):e._time)+t._delay),t._end=Te(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Fe(e,t,"_first","_last",e._sort?"_start":0),$e(t)||(e._recent=t),r||Ye(e,t),e},Ke=function(e,t){return(ae.ScrollTrigger||le("scrollTrigger",t))&&ae.ScrollTrigger.create(t,e)},Je=function(e,t,n,r){return $t(e,t),e._initted?!n&&e._pt&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&c!==Dt.frame?(pe.push(e),e._lazy=[t,r],1):void 0:1},Qe=function e(t){var n=t.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||e(n))},$e=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},et=function(e,t,n,r){var i=e._repeat,a=Te(t)||0,o=e._tTime/e._tDur;return o&&!r&&(e._time*=a/e._dur),e._dur=a,e._tDur=i?i<0?1e10:Te(a*(i+1)+e._rDelay*i):a,o>0&&!r?Xe(e,e._tTime=e._tDur*o):e.parent&&qe(e),n||Ue(e.parent,e),e},tt=function(e){return e instanceof Xt?Ue(e):et(e,e._dur)},nt={_start:0,endTime:he,totalDuration:he},rt=function e(t,n,r){var i,a,o,s=t.labels,l=t._recent||nt,u=t.duration()>=O?l.endTime(!1):t._dur;return H(n)&&(isNaN(n)||n in s)?(a=n.charAt(0),o="%"===n.substr(-1),i=n.indexOf("="),"<"===a||">"===a?(i>=0&&(n=n.replace(/=/,"")),("<"===a?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(i<0?l:r).totalDuration()/100:1)):i<0?(n in s||(s[n]=u),s[n]):(a=parseFloat(n.charAt(i-1)+n.substr(i+1)),o&&r&&(a=a/100*(J(r)?r[0]:r).totalDuration()),i>1?e(t,n.substr(0,i-1),r)+a:u+a)):null==n?u:+n},it=function(e,t,n){var r,i,a=V(t[1]),o=(a?2:1)+(e<2?0:1),s=t[o];if(a&&(s.duration=t[1]),s.parent=n,e){for(r=s,i=n;i&&!("immediateRender"in r);)r=i.vars.defaults||{},i=X(i.vars.inherit)&&i.parent;s.immediateRender=X(r.immediateRender),e<2?s.runBackwards=1:s.startAt=t[o-1]}return new an(t[0],s,t[o+1])},at=function(e,t){return e||0===e?t(e):t},ot=function(e,t,n){return n<e?e:n>t?t:n},st=function(e,t){return H(e)&&(t=ie.exec(e))?t[1]:""},lt=[].slice,ut=function(e,t){return e&&q(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&q(e[0]))&&!e.nodeType&&e!==o},ct=function(e,t,n){return!H(e)||n||!s&&It()?J(e)?function(e,t,n){return void 0===n&&(n=[]),e.forEach((function(e){var r;return H(e)&&!t||ut(e,1)?(r=n).push.apply(r,ct(e)):n.push(e)}))||n}(e,n):ut(e)?lt.call(e,0):e?[e]:[]:lt.call((t||l).querySelectorAll(e),0)},ht=function(e){return e.sort((function(){return.5-Math.random()}))},dt=function(e){if(j(e))return e;var t=q(e)?e:{each:e},n=Ut(t.ease),r=t.from||0,i=parseFloat(t.base)||0,a={},o=r>0&&r<1,s=isNaN(r)||o,l=t.axis,u=r,c=r;return H(r)?u=c={center:.5,edges:.5,end:1}[r]||0:!o&&s&&(u=r[0],c=r[1]),function(e,o,h){var d,p,f,m,v,g,y,x,_,b=(h||t).length,w=a[b];if(!w){if(!(_="auto"===t.grid?0:(t.grid||[1,O])[1])){for(y=-O;y<(y=h[_++].getBoundingClientRect().left)&&_<b;);_--}for(w=a[b]=[],d=s?Math.min(_,b)*u-.5:r%_,p=_===O?0:s?b*c/_-.5:r/_|0,y=0,x=O,g=0;g<b;g++)f=g%_-d,m=p-(g/_|0),w[g]=v=l?Math.abs("y"===l?m:f):B(f*f+m*m),v>y&&(y=v),v<x&&(x=v);"random"===r&&ht(w),w.max=y-x,w.min=x,w.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(_>b?b-1:l?"y"===l?b/_:_:Math.max(_,b/_))||0)*("edges"===r?-1:1),w.b=b<0?i-b:i,w.u=st(t.amount||t.each)||0,n=n&&b<0?Nt(n):n}return b=(w[e]-w.min)/w.max||0,Te(w.b+(n?n(b):b)*w.v)+w.u}},pt=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var r=Math.round(parseFloat(n)/e)*e*t;return(r-r%1)/t+(V(n)?0:st(n))}},ft=function(e,t){var n,r,i=J(e);return!i&&q(e)&&(n=i=e.radius||O,e.values?(e=ct(e.values),(r=!V(e[0]))&&(n*=n)):e=pt(e.increment)),at(t,i?j(e)?function(t){return r=e(t),Math.abs(r-t)<=n?r:t}:function(t){for(var i,a,o=parseFloat(r?t.x:t),s=parseFloat(r?t.y:0),l=O,u=0,c=e.length;c--;)(i=r?(i=e[c].x-o)*i+(a=e[c].y-s)*a:Math.abs(e[c]-o))<l&&(l=i,u=c);return u=!n||l<=n?e[u]:t,r||u===t||V(t)?u:u+st(t)}:pt(e))},mt=function(e,t,n,r){return at(J(e)?!t:!0===n?!!(n=0):!r,(function(){return J(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+.99*n))/n)*n*r)/r}))},vt=function(e,t,n){return at(n,(function(n){return e[~~t(n)]}))},gt=function(e){for(var t,n,r,i,a=0,o="";~(t=e.indexOf("random(",a));)r=e.indexOf(")",t),i="["===e.charAt(t+7),n=e.substr(t+7,r-t-7).match(i?re:Q),o+=e.substr(a,t-a)+mt(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),a=r+1;return o+e.substr(a,e.length-a)},yt=function(e,t,n,r,i){var a=t-e,o=r-n;return at(i,(function(t){return n+((t-e)/a*o||0)}))},xt=function(e,t,n){var r,i,a,o=e.labels,s=O;for(r in o)(i=o[r]-t)<0==!!n&&i&&s>(i=Math.abs(i))&&(a=r,s=i);return a},_t=function(e,t,n){var r,i,a=e.vars,o=a[t];if(o)return r=a[t+"Params"],i=a.callbackScope||e,n&&pe.length&&Ce(),r?o.apply(i,r):o.call(i)},bt=function(e){return Be(e),e.scrollTrigger&&e.scrollTrigger.kill(!1),e.progress()<1&&_t(e,"onInterrupt"),e},wt=function(e){var t=(e=!e.name&&e.default||e).name,n=j(e),r=t&&!n&&e.init?function(){this._props=[]}:e,i={init:he,render:fn,add:Jt,kill:vn,modifier:mn,rawVars:0},a={targetTest:0,get:0,getSetter:cn,aliases:{},register:0};if(It(),e!==r){if(me[t])return;De(r,De(ze(e,i),a)),Ie(r.prototype,Ie(i,ze(e,a))),me[r.prop=t]=r,e.targetTest&&(ye.push(r),de[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}ce(t,r),e.register&&e.register(Mn,r,xn)},Mt=255,St={aqua:[0,Mt,Mt],lime:[0,Mt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Mt],navy:[0,0,128],white:[Mt,Mt,Mt],olive:[128,128,0],yellow:[Mt,Mt,0],orange:[Mt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Mt,0,0],pink:[Mt,192,203],cyan:[0,Mt,Mt],transparent:[Mt,Mt,Mt,0]},Tt=function(e,t,n){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(n-t)*e*6:e<.5?n:3*e<2?t+(n-t)*(2/3-e)*6:t)*Mt+.5|0},Et=function(e,t,n){var r,i,a,o,s,l,u,c,h,d,p=e?V(e)?[e>>16,e>>8&Mt,e&Mt]:0:St.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),St[e])p=St[e];else if("#"===e.charAt(0)){if(e.length<6&&(r=e.charAt(1),i=e.charAt(2),a=e.charAt(3),e="#"+r+r+i+i+a+a+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&Mt,p&Mt,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&Mt,e&Mt]}else if("hsl"===e.substr(0,3))if(p=d=e.match(Q),t){if(~e.indexOf("="))return p=e.match($),n&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,s=+p[1]/100,r=2*(l=+p[2]/100)-(i=l<=.5?l*(s+1):l+s-l*s),p.length>3&&(p[3]*=1),p[0]=Tt(o+1/3,r,i),p[1]=Tt(o,r,i),p[2]=Tt(o-1/3,r,i);else p=e.match(Q)||St.transparent;p=p.map(Number)}return t&&!d&&(r=p[0]/Mt,i=p[1]/Mt,a=p[2]/Mt,l=((u=Math.max(r,i,a))+(c=Math.min(r,i,a)))/2,u===c?o=s=0:(h=u-c,s=l>.5?h/(2-u-c):h/(u+c),o=u===r?(i-a)/h+(i<a?6:0):u===i?(a-r)/h+2:(r-i)/h+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*s+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},At=function(e){var t=[],n=[],r=-1;return e.split(Lt).forEach((function(e){var i=e.match(ee)||[];t.push.apply(t,i),n.push(r+=i.length+1)})),t.c=n,t},Ct=function(e,t,n){var r,i,a,o,s="",l=(e+s).match(Lt),u=t?"hsla(":"rgba(",c=0;if(!l)return e;if(l=l.map((function(e){return(e=Et(e,t,1))&&u+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"})),n&&(a=At(e),(r=n.c).join(s)!==a.c.join(s)))for(o=(i=e.replace(Lt,"1").split(ee)).length-1;c<o;c++)s+=i[c]+(~r.indexOf(c)?l.shift()||u+"0,0,0,0)":(a.length?a:l.length?l:n).shift());if(!i)for(o=(i=e.split(Lt)).length-1;c<o;c++)s+=i[c]+l[c];return s+i[o]},Lt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in St)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Rt=/hsl[a]?\(/,Pt=function(e){var t,n=e.join(" ");if(Lt.lastIndex=0,Lt.test(n))return t=Rt.test(n),e[1]=Ct(e[1],t),e[0]=Ct(e[0],t,At(e[1])),!0},Dt=(x=Date.now,_=500,b=33,w=x(),M=w,T=S=1e3/240,A=function e(t){var n,r,i,a,o=x()-M,s=!0===t;if(o>_&&(w+=o-b),((n=(i=(M+=o)-w)-T)>0||s)&&(a=++v.frame,g=i-1e3*v.time,v.time=i/=1e3,T+=n+(n>=S?4:S-n),r=1),s||(p=f(e)),r)for(y=0;y<E.length;y++)E[y](i,g,a,t)},v={time:0,frame:0,tick:function(){A(!0)},deltaRatio:function(e){return g/(1e3/(e||60))},wake:function(){u&&(!s&&Y()&&(o=s=window,l=o.document||{},ae.gsap=Mn,(o.gsapVersions||(o.gsapVersions=[])).push(Mn.version),se(oe||o.GreenSockGlobals||!o.gsap&&o||{}),m=o.requestAnimationFrame),p&&v.sleep(),f=m||function(e){return setTimeout(e,T-1e3*v.time+1|0)},d=1,A(2))},sleep:function(){(m?o.cancelAnimationFrame:clearTimeout)(p),d=0,f=he},lagSmoothing:function(e,t){_=e||1e8,b=Math.min(t,_,0)},fps:function(e){S=1e3/(e||240),T=1e3*v.time+S},add:function(e,t,n){var r=t?function(t,n,i,a){e(t,n,i,a),v.remove(r)}:e;return v.remove(e),E[n?"unshift":"push"](r),It(),r},remove:function(e,t){~(t=E.indexOf(e))&&E.splice(t,1)&&y>=t&&y--},_listeners:E=[]}),It=function(){return!d&&Dt.wake()},Ot={},zt=/^[\d.\-M][\d.\-,\s]/,kt=/["']/g,Ft=function(e){for(var t,n,r,i={},a=e.substr(1,e.length-3).split(":"),o=a[0],s=1,l=a.length;s<l;s++)n=a[s],t=s!==l-1?n.lastIndexOf(","):n.length,r=n.substr(0,t),i[o]=isNaN(r)?r.replace(kt,"").trim():+r,o=n.substr(t+1).trim();return i},Nt=function(e){return function(t){return 1-e(1-t)}},Bt=function e(t,n){for(var r,i=t._first;i;)i instanceof Xt?e(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?e(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},Ut=function(e,t){return e&&(j(e)?e:Ot[e]||function(e){var t,n,r,i,a=(e+"").split("("),o=Ot[a[0]];return o&&a.length>1&&o.config?o.config.apply(null,~e.indexOf("{")?[Ft(a[1])]:(t=e,n=t.indexOf("(")+1,r=t.indexOf(")"),i=t.indexOf("(",n),t.substring(n,~i&&i<r?t.indexOf(")",r+1):r)).split(",").map(Re)):Ot._CE&&zt.test(e)?Ot._CE("",e):o}(e))||t},Gt=function(e,t,n,r){void 0===n&&(n=function(e){return 1-t(1-e)}),void 0===r&&(r=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var i,a={easeIn:t,easeOut:n,easeInOut:r};return Me(e,(function(e){for(var t in Ot[e]=ae[e]=a,Ot[i=e.toLowerCase()]=n,a)Ot[i+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=Ot[e+"."+t]=a[t]})),a},Ht=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},jt=function e(t,n,r){var i=n>=1?n:1,a=(r||(t?.3:.45))/(n<1?n:1),o=a/k*(Math.asin(1/i)||0),s=function(e){return 1===e?1:i*Math.pow(2,-10*e)*G((e-o)*a)+1},l="out"===t?s:"in"===t?function(e){return 1-s(1-e)}:Ht(s);return a=k/a,l.config=function(n,r){return e(t,n,r)},l},Vt=function e(t,n){void 0===n&&(n=1.70158);var r=function(e){return e?--e*e*((n+1)*e+n)+1:0},i="out"===t?r:"in"===t?function(e){return 1-r(1-e)}:Ht(r);return i.config=function(n){return e(t,n)},i};Me("Linear,Quad,Cubic,Quart,Quint,Strong",(function(e,t){var n=t<5?t+1:t;Gt(e+",Power"+(n-1),t?function(e){return Math.pow(e,n)}:function(e){return e},(function(e){return 1-Math.pow(1-e,n)}),(function(e){return e<.5?Math.pow(2*e,n)/2:1-Math.pow(2*(1-e),n)/2}))})),Ot.Linear.easeNone=Ot.none=Ot.Linear.easeIn,Gt("Elastic",jt("in"),jt("out"),jt()),C=7.5625,R=1/(L=2.75),Gt("Bounce",(function(e){return 1-P(1-e)}),P=function(e){return e<R?C*e*e:e<.7272727272727273?C*Math.pow(e-1.5/L,2)+.75:e<.9090909090909092?C*(e-=2.25/L)*e+.9375:C*Math.pow(e-2.625/L,2)+.984375}),Gt("Expo",(function(e){return e?Math.pow(2,10*(e-1)):0})),Gt("Circ",(function(e){return-(B(1-e*e)-1)})),Gt("Sine",(function(e){return 1===e?1:1-U(e*F)})),Gt("Back",Vt("in"),Vt("out"),Vt()),Ot.SteppedEase=Ot.steps=ae.SteppedEase={config:function(e,t){void 0===e&&(e=1);var n=1/e,r=e+(t?0:1),i=t?1:0;return function(e){return((r*ot(0,.99999999,e)|0)+i)*n}}},I.ease=Ot["quad.out"],Me("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(e){return xe+=e+","+e+"Params,"}));var Wt=function(e,t){this.id=N++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:we,this.set=t?t.getSetter:cn},qt=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,et(this,+e.duration,1,1),this.data=e.data,d||Dt.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,et(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(It(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Xe(this,e),!n._dp||n.parent||Ye(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&Ze(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===z||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),Le(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+je(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+je(this),t):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(e,t){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,t):this._repeat?Ve(this._tTime,n)+1:1},t.timeScale=function(e){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===e)return this;var t=this.parent&&this._ts?We(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||-1e-8===e?0:this._rts,this.totalTime(ot(-this._delay,this._tDur,t),!0),qe(this),Ge(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(It(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==z&&(this._tTime-=z)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&Ze(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(X(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?We(t.rawTime(e),this):this._tTime:this._tTime},t.globalTime=function(e){for(var t=this,n=arguments.length?e:t.rawTime();t;)n=t._start+n/(t._ts||1),t=t._dp;return n},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,tt(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,tt(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(rt(this,e),X(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,X(t))},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-1e-8:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},t.isActive=function(){var e,t=this.parent||this._dp,n=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=n&&e<this.endTime(!0)-z))},t.eventCallback=function(e,t,n){var r=this.vars;return arguments.length>1?(t?(r[e]=t,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=t)):delete r[e],this):r[e]},t.then=function(e){var t=this;return new Promise((function(n){var r=j(e)?e:Pe,i=function(){var e=t.then;t.then=null,j(r)&&(r=r(t))&&(r.then||r===t)&&(t.then=e),n(r),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?i():t._prom=i}))},t.kill=function(){bt(this)},e}();De(qt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Xt=function(e){function r(t,r){var a;return void 0===t&&(t={}),(a=e.call(this,t)||this).labels={},a.smoothChildTiming=!!t.smoothChildTiming,a.autoRemoveChildren=!!t.autoRemoveChildren,a._sort=X(t.sortChildren),i&&Ze(t.parent||i,n(a),r),t.reversed&&a.reverse(),t.paused&&a.paused(!0),t.scrollTrigger&&Ke(n(a),t.scrollTrigger),a}t(r,e);var a=r.prototype;return a.to=function(e,t,n){return it(0,arguments,this),this},a.from=function(e,t,n){return it(1,arguments,this),this},a.fromTo=function(e,t,n,r){return it(2,arguments,this),this},a.set=function(e,t,n){return t.duration=0,t.parent=this,ke(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new an(e,t,rt(this,n),1),this},a.call=function(e,t,n){return Ze(this,an.delayedCall(0,e,t),n)},a.staggerTo=function(e,t,n,r,i,a,o){return n.duration=t,n.stagger=n.stagger||r,n.onComplete=a,n.onCompleteParams=o,n.parent=this,new an(e,n,rt(this,i)),this},a.staggerFrom=function(e,t,n,r,i,a,o){return n.runBackwards=1,ke(n).immediateRender=X(n.immediateRender),this.staggerTo(e,t,n,r,i,a,o)},a.staggerFromTo=function(e,t,n,r,i,a,o,s){return r.startAt=n,ke(r).immediateRender=X(r.immediateRender),this.staggerTo(e,t,r,i,a,o,s)},a.render=function(e,t,n){var r,a,o,s,l,u,c,h,d,p,f,m,v=this._time,g=this._dirty?this.totalDuration():this._tDur,y=this._dur,x=e<=0?0:Te(e),_=this._zTime<0!=e<0&&(this._initted||!y);if(this!==i&&x>g&&e>=0&&(x=g),x!==this._tTime||n||_){if(v!==this._time&&y&&(x+=this._time-v,e+=this._time-v),r=x,d=this._start,u=!(h=this._ts),_&&(y||(v=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(f=this._yoyo,l=y+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*l+e,t,n);if(r=Te(x%l),x===g?(s=this._repeat,r=y):((s=~~(x/l))&&s===x/l&&(r=y,s--),r>y&&(r=y)),p=Ve(this._tTime,l),!v&&this._tTime&&p!==s&&(p=s),f&&1&s&&(r=y-r,m=1),s!==p&&!this._lock){var b=f&&1&p,w=b===(f&&1&s);if(s<p&&(b=!b),v=b?0:y,this._lock=1,this.render(v||(m?0:Te(s*l)),t,!y)._lock=0,this._tTime=x,!t&&this.parent&&_t(this,"onRepeat"),this.vars.repeatRefresh&&!m&&(this.invalidate()._lock=1),v&&v!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,g=this._tDur,w&&(this._lock=2,v=b?y:-1e-4,this.render(v,!0),this.vars.repeatRefresh&&!m&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;Bt(this,m)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(e,t,n){var r;if(n>t)for(r=e._first;r&&r._start<=n;){if("isPause"===r.data&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if("isPause"===r.data&&r._start<t)return r;r=r._prev}}(this,Te(v),Te(r)),c&&(x-=r-(r=c._start))),this._tTime=x,this._time=r,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,v=0),!v&&r&&!t&&(_t(this,"onStart"),this._tTime!==x))return this;if(r>=v&&e>=0)for(a=this._first;a;){if(o=a._next,(a._act||r>=a._start)&&a._ts&&c!==a){if(a.parent!==this)return this.render(e,t,n);if(a.render(a._ts>0?(r-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+(r-a._start)*a._ts,t,n),r!==this._time||!this._ts&&!u){c=0,o&&(x+=this._zTime=-1e-8);break}}a=o}else{a=this._last;for(var M=e<0?e:r;a;){if(o=a._prev,(a._act||M<=a._end)&&a._ts&&c!==a){if(a.parent!==this)return this.render(e,t,n);if(a.render(a._ts>0?(M-a._start)*a._ts:(a._dirty?a.totalDuration():a._tDur)+(M-a._start)*a._ts,t,n),r!==this._time||!this._ts&&!u){c=0,o&&(x+=this._zTime=M?-1e-8:z);break}}a=o}}if(c&&!t&&(this.pause(),c.render(r>=v?0:-1e-8)._zTime=r>=v?1:-1,this._ts))return this._start=d,qe(this),this.render(e,t,n);this._onUpdate&&!t&&_t(this,"onUpdate",!0),(x===g&&this._tTime>=this.totalDuration()||!x&&v)&&(d!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((e||!y)&&(x===g&&this._ts>0||!x&&this._ts<0)&&Be(this,1),t||e<0&&!v||!x&&!v&&g||(_t(this,x===g&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(x<g&&this.timeScale()>0)&&this._prom())))}return this},a.add=function(e,t){var n=this;if(V(t)||(t=rt(this,t,e)),!(e instanceof qt)){if(J(e))return e.forEach((function(e){return n.add(e,t)})),this;if(H(e))return this.addLabel(e,t);if(!j(e))return this;e=an.delayedCall(0,e)}return this!==e?Ze(this,e,t):this},a.getChildren=function(e,t,n,r){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=-O);for(var i=[],a=this._first;a;)a._start>=r&&(a instanceof an?t&&i.push(a):(n&&i.push(a),e&&i.push.apply(i,a.getChildren(!0,t,n)))),a=a._next;return i},a.getById=function(e){for(var t=this.getChildren(1,1,1),n=t.length;n--;)if(t[n].vars.id===e)return t[n]},a.remove=function(e){return H(e)?this.removeLabel(e):j(e)?this.killTweensOf(e):(Ne(this,e),e===this._recent&&(this._recent=this._last),Ue(this))},a.totalTime=function(t,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Te(Dt.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,n),this._forcing=0,this):this._tTime},a.addLabel=function(e,t){return this.labels[e]=rt(this,t),this},a.removeLabel=function(e){return delete this.labels[e],this},a.addPause=function(e,t,n){var r=an.delayedCall(0,t||he,n);return r.data="isPause",this._hasPause=1,Ze(this,r,rt(this,e))},a.removePause=function(e){var t=this._first;for(e=rt(this,e);t;)t._start===e&&"isPause"===t.data&&Be(t),t=t._next},a.killTweensOf=function(e,t,n){for(var r=this.getTweensOf(e,n),i=r.length;i--;)Yt!==r[i]&&r[i].kill(e,t);return this},a.getTweensOf=function(e,t){for(var n,r=[],i=ct(e),a=this._first,o=V(t);a;)a instanceof an?Ae(a._targets,i)&&(o?(!Yt||a._initted&&a._ts)&&a.globalTime(0)<=t&&a.globalTime(a.totalDuration())>t:!t||a.isActive())&&r.push(a):(n=a.getTweensOf(i,t)).length&&r.push.apply(r,n),a=a._next;return r},a.tweenTo=function(e,t){t=t||{};var n,r=this,i=rt(r,e),a=t,o=a.startAt,s=a.onStart,l=a.onStartParams,u=a.immediateRender,c=an.to(r,De({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:i,overwrite:"auto",duration:t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale())||z,onStart:function(){if(r.pause(),!n){var e=t.duration||Math.abs((i-(o&&"time"in o?o.time:r._time))/r.timeScale());c._dur!==e&&et(c,e,0,1).render(c._time,!0,!0),n=1}s&&s.apply(c,l||[])}},t));return u?c.render(0):c},a.tweenFromTo=function(e,t,n){return this.tweenTo(t,De({startAt:{time:rt(this,e)}},n))},a.recent=function(){return this._recent},a.nextLabel=function(e){return void 0===e&&(e=this._time),xt(this,rt(this,e))},a.previousLabel=function(e){return void 0===e&&(e=this._time),xt(this,rt(this,e),1)},a.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+z)},a.shiftChildren=function(e,t,n){void 0===n&&(n=0);for(var r,i=this._first,a=this.labels;i;)i._start>=n&&(i._start+=e,i._end+=e),i=i._next;if(t)for(r in a)a[r]>=n&&(a[r]+=e);return Ue(this)},a.invalidate=function(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return e.prototype.invalidate.call(this)},a.clear=function(e){void 0===e&&(e=!0);for(var t,n=this._first;n;)t=n._next,this.remove(n),n=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),Ue(this)},a.totalDuration=function(e){var t,n,r,a=0,o=this,s=o._last,l=O;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-e:e));if(o._dirty){for(r=o.parent;s;)t=s._prev,s._dirty&&s.totalDuration(),(n=s._start)>l&&o._sort&&s._ts&&!o._lock?(o._lock=1,Ze(o,s,n-s._delay,1)._lock=0):l=n,n<0&&s._ts&&(a-=n,(!r&&!o._dp||r&&r.smoothChildTiming)&&(o._start+=n/o._ts,o._time-=n,o._tTime-=n),o.shiftChildren(-n,!1,-Infinity),l=0),s._end>a&&s._ts&&(a=s._end),s=t;et(o,o===i&&o._time>a?o._time:a,1,1),o._dirty=0}return o._tDur},r.updateRoot=function(e){if(i._ts&&(Le(i,We(e,i)),c=Dt.frame),Dt.frame>=ge){ge+=D.autoSleep||120;var t=i._first;if((!t||!t._ts)&&D.autoSleep&&Dt._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Dt.sleep()}}},r}(qt);De(Xt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Yt,Zt,Kt=function(e,t,n,r,i,a,o){var s,l,u,c,h,d,p,f,m=new xn(this._pt,e,t,0,1,pn,null,i),v=0,g=0;for(m.b=n,m.e=r,n+="",(p=~(r+="").indexOf("random("))&&(r=gt(r)),a&&(a(f=[n,r],e,t),n=f[0],r=f[1]),l=n.match(te)||[];s=te.exec(r);)c=s[0],h=r.substring(v,s.index),u?u=(u+1)%5:"rgba("===h.substr(-5)&&(u=1),c!==l[g++]&&(d=parseFloat(l[g-1])||0,m._pt={_next:m._pt,p:h||1===g?h:",",s:d,c:"="===c.charAt(1)?Ee(d,c)-d:parseFloat(c)-d,m:u&&u<4?Math.round:0},v=te.lastIndex);return m.c=v<r.length?r.substring(v,r.length):"",m.fp=o,(ne.test(r)||p)&&(m.e=0),this._pt=m,m},Jt=function(e,t,n,r,i,a,o,s,l){j(r)&&(r=r(i||0,e,a));var u,c=e[t],h="get"!==n?n:j(c)?l?e[t.indexOf("set")||!j(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,d=j(c)?l?ln:sn:on;if(H(r)&&(~r.indexOf("random(")&&(r=gt(r)),"="===r.charAt(1)&&((u=Ee(h,r)+(st(h)||0))||0===u)&&(r=u)),h!==r||Zt)return isNaN(h*r)||""===r?(!c&&!(t in e)&&le(t,r),Kt.call(this,e,t,h,r,d,s||D.stringFilter,l)):(u=new xn(this._pt,e,t,+h||0,r-(h||0),"boolean"==typeof c?dn:hn,0,d),l&&(u.fp=l),o&&u.modifier(o,this,e),this._pt=u)},Qt=function(e,t,n,r,i,a){var o,s,l,u;if(me[e]&&!1!==(o=new me[e]).init(i,o.rawVars?t[e]:function(e,t,n,r,i){if(j(e)&&(e=tn(e,i,t,n,r)),!q(e)||e.style&&e.nodeType||J(e)||K(e))return H(e)?tn(e,i,t,n,r):e;var a,o={};for(a in e)o[a]=tn(e[a],i,t,n,r);return o}(t[e],r,i,a,n),n,r,a)&&(n._pt=s=new xn(n._pt,i,e,0,1,o.render,o,0,o.priority),n!==h))for(l=n._ptLookup[n._targets.indexOf(i)],u=o._props.length;u--;)l[o._props[u]]=s;return o},$t=function e(t,n){var a,o,s,l,u,c,h,d,p,f,m,v,g,y=t.vars,x=y.ease,_=y.startAt,b=y.immediateRender,w=y.lazy,M=y.onUpdate,S=y.onUpdateParams,T=y.callbackScope,E=y.runBackwards,A=y.yoyoEase,C=y.keyframes,L=y.autoRevert,R=t._dur,P=t._startAt,D=t._targets,k=t.parent,F=k&&"nested"===k.data?k.parent._targets:D,N="auto"===t._overwrite&&!r,B=t.timeline;if(B&&(!C||!x)&&(x="none"),t._ease=Ut(x,I.ease),t._yEase=A?Nt(Ut(!0===A?x:A,I.ease)):0,A&&t._yoyo&&!t._repeat&&(A=t._yEase,t._yEase=t._ease,t._ease=A),t._from=!B&&!!y.runBackwards,!B||C&&!y.stagger){if(v=(d=D[0]?be(D[0]).harness:0)&&y[d.prop],a=ze(y,de),P&&(Be(P.render(-1,!0)),P._lazy=0),_)if(Be(t._startAt=an.set(D,De({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:X(w),startAt:null,delay:0,onUpdate:M,onUpdateParams:S,callbackScope:T,stagger:0},_))),n<0&&!b&&!L&&t._startAt.render(-1,!0),b){if(n>0&&!L&&(t._startAt=0),R&&n<=0)return void(n&&(t._zTime=n))}else!1===L&&(t._startAt=0);else if(E&&R)if(P)!L&&(t._startAt=0);else if(n&&(b=!1),s=De({overwrite:!1,data:"isFromStart",lazy:b&&X(w),immediateRender:b,stagger:0,parent:k},a),v&&(s[d.prop]=v),Be(t._startAt=an.set(D,s)),n<0&&t._startAt.render(-1,!0),t._zTime=n,b){if(!n)return}else e(t._startAt,z);for(t._pt=t._ptCache=0,w=R&&X(w)||w&&!R,o=0;o<D.length;o++){if(h=(u=D[o])._gsap||_e(D)[o]._gsap,t._ptLookup[o]=f={},fe[h.id]&&pe.length&&Ce(),m=F===D?o:F.indexOf(u),d&&!1!==(p=new d).init(u,v||a,t,m,F)&&(t._pt=l=new xn(t._pt,u,p.name,0,1,p.render,p,0,p.priority),p._props.forEach((function(e){f[e]=l})),p.priority&&(c=1)),!d||v)for(s in a)me[s]&&(p=Qt(s,a,t,m,u,F))?p.priority&&(c=1):f[s]=l=Jt.call(t,u,s,"get",a[s],m,F,0,y.stringFilter);t._op&&t._op[o]&&t.kill(u,t._op[o]),N&&t._pt&&(Yt=t,i.killTweensOf(u,f,t.globalTime(n)),g=!t.parent,Yt=0),t._pt&&w&&(fe[h.id]=1)}c&&yn(t),t._onInit&&t._onInit(t)}t._onUpdate=M,t._initted=(!t._op||t._pt)&&!g,C&&n<=0&&B.render(O,!0,!0)},en=function(e,t,n,r){var i,a,o=t.ease||r||"power1.inOut";if(J(t))a=n[e]||(n[e]=[]),t.forEach((function(e,n){return a.push({t:n/(t.length-1)*100,v:e,e:o})}));else for(i in t)a=n[i]||(n[i]=[]),"ease"===i||a.push({t:parseFloat(e),v:t[i],e:o})},tn=function(e,t,n,r,i){return j(e)?e.call(t,n,r,i):H(e)&&~e.indexOf("random(")?gt(e):e},nn=xe+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",rn={};Me(nn+",id,stagger,delay,duration,paused,scrollTrigger",(function(e){return rn[e]=1}));var an=function(e){function a(t,a,o,s){var l;"number"==typeof a&&(o.duration=a,a=o,o=null);var u,c,h,d,p,f,m,v,g=(l=e.call(this,s?a:ke(a))||this).vars,y=g.duration,x=g.delay,_=g.immediateRender,b=g.stagger,w=g.overwrite,M=g.keyframes,S=g.defaults,T=g.scrollTrigger,E=g.yoyoEase,A=a.parent||i,C=(J(t)||K(t)?V(t[0]):"length"in a)?[t]:ct(t);if(l._targets=C.length?_e(C):ue("GSAP target "+t+" not found. https://greensock.com",!D.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=w,M||b||Z(y)||Z(x)){if(a=l.vars,(u=l.timeline=new Xt({data:"nested",defaults:S||{}})).kill(),u.parent=u._dp=n(l),u._start=0,b||Z(y)||Z(x)){if(d=C.length,m=b&&dt(b),q(b))for(p in b)~nn.indexOf(p)&&(v||(v={}),v[p]=b[p]);for(c=0;c<d;c++)(h=ze(a,rn)).stagger=0,E&&(h.yoyoEase=E),v&&Ie(h,v),f=C[c],h.duration=+tn(y,n(l),c,f,C),h.delay=(+tn(x,n(l),c,f,C)||0)-l._delay,!b&&1===d&&h.delay&&(l._delay=x=h.delay,l._start+=x,h.delay=0),u.to(f,h,m?m(c,f,C):0),u._ease=Ot.none;u.duration()?y=x=0:l.timeline=0}else if(M){ke(De(u.vars.defaults,{ease:"none"})),u._ease=Ut(M.ease||a.ease||"none");var L,R,P,I=0;if(J(M))M.forEach((function(e){return u.to(C,e,">")}));else{for(p in h={},M)"ease"===p||"easeEach"===p||en(p,M[p],h,M.easeEach);for(p in h)for(L=h[p].sort((function(e,t){return e.t-t.t})),I=0,c=0;c<L.length;c++)(P={ease:(R=L[c]).e,duration:(R.t-(c?L[c-1].t:0))/100*y})[p]=R.v,u.to(C,P,I),I+=P.duration;u.duration()<y&&u.to({},{duration:y-u.duration()})}}y||l.duration(y=u.duration())}else l.timeline=0;return!0!==w||r||(Yt=n(l),i.killTweensOf(C),Yt=0),Ze(A,n(l),o),a.reversed&&l.reverse(),a.paused&&l.paused(!0),(_||!y&&!M&&l._start===Te(A._time)&&X(_)&&He(n(l))&&"nested"!==A.data)&&(l._tTime=-1e-8,l.render(Math.max(0,-x))),T&&Ke(n(l),T),l}t(a,e);var o=a.prototype;return o.render=function(e,t,n){var r,i,a,o,s,l,u,c,h,d=this._time,p=this._tDur,f=this._dur,m=e>p-z&&e>=0?p:e<z?0:e;if(f){if(m!==this._tTime||!e||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=e<0){if(r=m,c=this.timeline,this._repeat){if(o=f+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*o+e,t,n);if(r=Te(m%o),m===p?(a=this._repeat,r=f):((a=~~(m/o))&&a===m/o&&(r=f,a--),r>f&&(r=f)),(l=this._yoyo&&1&a)&&(h=this._yEase,r=f-r),s=Ve(this._tTime,o),r===d&&!n&&this._initted)return this._tTime=m,this;a!==s&&(c&&this._yEase&&Bt(c,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(Te(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(Je(this,e<0?e:r,n,t))return this._tTime=0,this;if(d!==this._time)return this;if(f!==this._dur)return this.render(e,t,n)}if(this._tTime=m,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(h||this._ease)(r/f),this._from&&(this.ratio=u=1-u),r&&!d&&!t&&(_t(this,"onStart"),this._tTime!==m))return this;for(i=this._pt;i;)i.r(u,i.d),i=i._next;c&&c.render(e<0?e:!r&&l?-1e-8:c._dur*c._ease(r/this._dur),t,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),_t(this,"onUpdate")),this._repeat&&a!==s&&this.vars.onRepeat&&!t&&this.parent&&_t(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),(e||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&Be(this,1),t||e<0&&!d||!m&&!d||(_t(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}}else!function(e,t,n,r){var i,a,o,s=e.ratio,l=t<0||!t&&(!e._start&&Qe(e)&&(e._initted||!$e(e))||(e._ts<0||e._dp._ts<0)&&!$e(e))?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=ot(0,e._tDur,t),a=Ve(c,u),e._yoyo&&1&a&&(l=1-l),a!==Ve(e._tTime,u)&&(s=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==s||r||e._zTime===z||!t&&e._zTime){if(!e._initted&&Je(e,t,r,n))return;for(o=e._zTime,e._zTime=t||(n?z:0),n||(n=t&&!o),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=c,i=e._pt;i;)i.r(l,i.d),i=i._next;e._startAt&&t<0&&e._startAt.render(t,!0,!0),e._onUpdate&&!n&&_t(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&_t(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&Be(e,1),n||(_t(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)}(this,e,t,n);return this},o.targets=function(){return this._targets},o.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),e.prototype.invalidate.call(this)},o.resetTo=function(e,t,n,r){d||Dt.wake(),this._ts||this.play();var i=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||$t(this,i),function(e,t,n,r,i,a,o){var s,l,u,c=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!c)for(c=e._ptCache[t]=[],l=e._ptLookup,u=e._targets.length;u--;){if((s=l[u][t])&&s.d&&s.d._pt)for(s=s.d._pt;s&&s.p!==t;)s=s._next;if(!s)return Zt=1,e.vars[t]="+=0",$t(e,o),Zt=0,1;c.push(s)}for(u=c.length;u--;)(s=c[u]).s=!r&&0!==r||i?s.s+(r||0)+a*s.c:r,s.c=n-s.s,s.e&&(s.e=Se(n)+st(s.e)),s.b&&(s.b=s.s+st(s.b))}(this,e,t,n,r,this._ease(i/this._dur),i)?this.resetTo(e,t,n,r):(Xe(this,0),this.parent||Fe(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},o.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?bt(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,Yt&&!0!==Yt.vars.overwrite)._first||bt(this),this.parent&&n!==this.timeline.totalDuration()&&et(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,a,o,s,l,u,c=this._targets,h=e?ct(e):c,d=this._ptLookup,p=this._pt;if((!t||"all"===t)&&function(e,t){for(var n=e.length,r=n===t.length;r&&n--&&e[n]===t[n];);return n<0}(c,h))return"all"===t&&(this._pt=0),bt(this);for(r=this._op=this._op||[],"all"!==t&&(H(t)&&(s={},Me(t,(function(e){return s[e]=1})),t=s),t=function(e,t){var n,r,i,a,o=e[0]?be(e[0]).harness:0,s=o&&o.aliases;if(!s)return t;for(r in n=Ie({},t),s)if(r in n)for(i=(a=s[r].split(",")).length;i--;)n[a[i]]=n[r];return n}(c,t)),u=c.length;u--;)if(~h.indexOf(c[u]))for(s in i=d[u],"all"===t?(r[u]=t,o=i,a={}):(a=r[u]=r[u]||{},o=t),o)(l=i&&i[s])&&("kill"in l.d&&!0!==l.d.kill(s)||Ne(this,l,"_pt"),delete i[s]),"all"!==a&&(a[s]=1);return this._initted&&!this._pt&&p&&bt(this),this},a.to=function(e,t){return new a(e,t,arguments[2])},a.from=function(e,t){return it(1,arguments)},a.delayedCall=function(e,t,n,r){return new a(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:r})},a.fromTo=function(e,t,n){return it(2,arguments)},a.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new a(e,t)},a.killTweensOf=function(e,t,n){return i.killTweensOf(e,t,n)},a}(qt);De(an.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Me("staggerTo,staggerFrom,staggerFromTo",(function(e){an[e]=function(){var t=new Xt,n=lt.call(arguments,0);return n.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,n)}}));var on=function(e,t,n){return e[t]=n},sn=function(e,t,n){return e[t](n)},ln=function(e,t,n,r){return e[t](r.fp,n)},un=function(e,t,n){return e.setAttribute(t,n)},cn=function(e,t){return j(e[t])?sn:W(e[t])&&e.setAttribute?un:on},hn=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},dn=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},pn=function(e,t){var n=t._pt,r="";if(!e&&t.b)r=t.b;else if(1===e&&t.e)r=t.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=t.c}t.set(t.t,t.p,r,t)},fn=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},mn=function(e,t,n,r){for(var i,a=this._pt;a;)i=a._next,a.p===r&&a.modifier(e,t,n),a=i},vn=function(e){for(var t,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?Ne(this,r,"_pt"):r.dep||(t=1),r=n;return!t},gn=function(e,t,n,r){r.mSet(e,t,r.m.call(r.tween,n,r.mt),r)},yn=function(e){for(var t,n,r,i,a=e._pt;a;){for(t=a._next,n=r;n&&n.pr>a.pr;)n=n._next;(a._prev=n?n._prev:i)?a._prev._next=a:r=a,(a._next=n)?n._prev=a:i=a,a=t}e._pt=r},xn=function(){function e(e,t,n,r,i,a,o,s,l){this.t=t,this.s=r,this.c=i,this.p=n,this.r=a||hn,this.d=o||this,this.set=s||on,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,n){this.mSet=this.mSet||this.set,this.set=gn,this.m=e,this.mt=n,this.tween=t},e}();Me(xe+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(e){return de[e]=1})),ae.TweenMax=ae.TweenLite=an,ae.TimelineLite=ae.TimelineMax=Xt,i=new Xt({sortChildren:!1,defaults:I,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),D.stringFilter=Pt;var _n={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){return wt(e)}))},timeline:function(e){return new Xt(e)},getTweensOf:function(e,t){return i.getTweensOf(e,t)},getProperty:function(e,t,n,r){H(e)&&(e=ct(e)[0]);var i=be(e||{}).get,a=n?Pe:Re;return"native"===n&&(n=""),e?t?a((me[t]&&me[t].get||i)(e,t,n,r)):function(t,n,r){return a((me[t]&&me[t].get||i)(e,t,n,r))}:e},quickSetter:function(e,t,n){if((e=ct(e)).length>1){var r=e.map((function(e){return Mn.quickSetter(e,t,n)})),i=r.length;return function(e){for(var t=i;t--;)r[t](e)}}e=e[0]||{};var a=me[t],o=be(e),s=o.harness&&(o.harness.aliases||{})[t]||t,l=a?function(t){var r=new a;h._pt=0,r.init(e,n?t+n:t,h,0,[e]),r.render(1,r),h._pt&&fn(1,h)}:o.set(e,s);return a?l:function(t){return l(e,s,n?t+n:t,o,1)}},quickTo:function(e,t,n){var r,i=Mn.to(e,Ie(((r={})[t]="+=0.1",r.paused=!0,r),n||{})),a=function(e,n,r){return i.resetTo(t,e,n,r)};return a.tween=i,a},isTweening:function(e){return i.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Ut(e.ease,I.ease)),Oe(I,e||{})},config:function(e){return Oe(D,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,r=e.plugins,i=e.defaults,a=e.extendTimeline;(r||"").split(",").forEach((function(e){return e&&!me[e]&&!ae[e]&&ue(t+" effect requires "+e+" plugin.")})),ve[t]=function(e,t,r){return n(ct(e),De(t||{},i),r)},a&&(Xt.prototype[t]=function(e,n,r){return this.add(ve[t](e,q(n)?n:(r=n)&&{},this),r)})},registerEase:function(e,t){Ot[e]=Ut(t)},parseEase:function(e,t){return arguments.length?Ut(e,t):Ot},getById:function(e){return i.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var n,r,a=new Xt(e);for(a.smoothChildTiming=X(e.smoothChildTiming),i.remove(a),a._dp=0,a._time=a._tTime=i._time,n=i._first;n;)r=n._next,!t&&!n._dur&&n instanceof an&&n.vars.onComplete===n._targets[0]||Ze(a,n,n._start-n._delay),n=r;return Ze(i,a,0),a},utils:{wrap:function e(t,n,r){var i=n-t;return J(t)?vt(t,e(0,t.length),n):at(r,(function(e){return(i+(e-t)%i)%i+t}))},wrapYoyo:function e(t,n,r){var i=n-t,a=2*i;return J(t)?vt(t,e(0,t.length-1),n):at(r,(function(e){return t+((e=(a+(e-t)%a)%a||0)>i?a-e:e)}))},distribute:dt,random:mt,snap:ft,normalize:function(e,t,n){return yt(e,t,0,1,n)},getUnit:st,clamp:function(e,t,n){return at(n,(function(n){return ot(e,t,n)}))},splitColor:Et,toArray:ct,selector:function(e){return e=ct(e)[0]||ue("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return ct(t,n.querySelectorAll?n:n===e?ue("Invalid scope")||l.createElement("div"):e)}},mapRange:yt,pipe:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(e,t){return t(e)}),e)}},unitize:function(e,t){return function(n){return e(parseFloat(n))+(t||st(n))}},interpolate:function e(t,n,r,i){var a=isNaN(t+n)?0:function(e){return(1-e)*t+e*n};if(!a){var o,s,l,u,c,h=H(t),d={};if(!0===r&&(i=1)&&(r=null),h)t={p:t},n={p:n};else if(J(t)&&!J(n)){for(l=[],u=t.length,c=u-2,s=1;s<u;s++)l.push(e(t[s-1],t[s]));u--,a=function(e){e*=u;var t=Math.min(c,~~e);return l[t](e-t)},r=n}else i||(t=Ie(J(t)?[]:{},t));if(!l){for(o in n)Jt.call(d,t,o,"get",n[o]);a=function(e){return fn(e,d)||(h?t.p:t)}}}return at(r,a)},shuffle:ht},install:se,effects:ve,ticker:Dt,updateRoot:Xt.updateRoot,plugins:me,globalTimeline:i,core:{PropTween:xn,globals:ce,Tween:an,Timeline:Xt,Animation:qt,getCache:be,_removeLinkedListItem:Ne,suppressOverwrites:function(e){return r=e}}};Me("to,from,fromTo,delayedCall,set,killTweensOf",(function(e){return _n[e]=an[e]})),Dt.add(Xt.updateRoot),h=_n.to({},{duration:0});var bn=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},wn=function(e,t){return{name:e,rawVars:1,init:function(e,n,r){r._onInit=function(e){var r,i;if(H(n)&&(r={},Me(n,(function(e){return r[e]=1})),n=r),t){for(i in r={},n)r[i]=t(n[i]);n=r}!function(e,t){var n,r,i,a=e._targets;for(n in t)for(r=a.length;r--;)(i=e._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=bn(i,n)),i&&i.modifier&&i.modifier(t[n],e,a[r],n))}(e,n)}}}},Mn=_n.registerPlugin({name:"attr",init:function(e,t,n,r,i){var a,o;for(a in t)(o=this.add(e,"setAttribute",(e.getAttribute(a)||0)+"",t[a],r,i,0,0,a))&&(o.op=a),this._props.push(a)}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n])}},wn("roundProps",pt),wn("modifiers"),wn("snap",ft))||_n;an.version=Xt.version=Mn.version="3.10.4",u=1,Y()&&It();var Sn,Tn,En,An,Cn,Ln,Rn,Pn=Ot.Power0,Dn=Ot.Power1,In=Ot.Power2,On=Ot.Power3,zn=Ot.Power4,kn=Ot.Linear,Fn=Ot.Quad,Nn=Ot.Cubic,Bn=Ot.Quart,Un=Ot.Quint,Gn=Ot.Strong,Hn=Ot.Elastic,jn=Ot.Back,Vn=Ot.SteppedEase,Wn=Ot.Bounce,qn=Ot.Sine,Xn=Ot.Expo,Yn=Ot.Circ,Zn={},Kn=180/Math.PI,Jn=Math.PI/180,Qn=Math.atan2,$n=/([A-Z])/g,er=/(left|right|width|margin|padding|x)/i,tr=/[\s,\(]\S/,nr={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},rr=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},ir=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},ar=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},or=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},sr=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},lr=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},ur=function(e,t,n){return e.style[t]=n},cr=function(e,t,n){return e.style.setProperty(t,n)},hr=function(e,t,n){return e._gsap[t]=n},dr=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},pr=function(e,t,n,r,i){var a=e._gsap;a.scaleX=a.scaleY=n,a.renderTransform(i,a)},fr=function(e,t,n,r,i){var a=e._gsap;a[t]=n,a.renderTransform(i,a)},mr="transform",vr=mr+"Origin",gr=function(e,t){var n=Tn.createElementNS?Tn.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Tn.createElement(e);return n.style?n:Tn.createElement(e)},yr=function e(t,n,r){var i=getComputedStyle(t);return i[n]||i.getPropertyValue(n.replace($n,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&e(t,_r(n)||n,1)||""},xr="O,Moz,ms,Ms,Webkit".split(","),_r=function(e,t,n){var r=(t||Cn).style,i=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);i--&&!(xr[i]+e in r););return i<0?null:(3===i?"ms":i>=0?xr[i]:"")+e},br=function(){"undefined"!=typeof window&&window.document&&(Sn=window,Tn=Sn.document,En=Tn.documentElement,Cn=gr("div")||{style:{}},gr("div"),mr=_r(mr),vr=mr+"Origin",Cn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Rn=!!_r("perspective"),An=1)},wr=function e(t){var n,r=gr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,a=this.nextSibling,o=this.style.cssText;if(En.appendChild(r),r.appendChild(this),this.style.display="block",t)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=e}catch(e){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(a?i.insertBefore(this,a):i.appendChild(this)),En.removeChild(r),this.style.cssText=o,n},Mr=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},Sr=function(e){var t;try{t=e.getBBox()}catch(n){t=wr.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===wr||(t=wr.call(e,!0)),!t||t.width||t.x||t.y?t:{x:+Mr(e,["x","cx","x1"])||0,y:+Mr(e,["y","cy","y1"])||0,width:0,height:0}},Tr=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!Sr(e))},Er=function(e,t){if(t){var n=e.style;t in Zn&&t!==vr&&(t=mr),n.removeProperty?("ms"!==t.substr(0,2)&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty(t.replace($n,"-$1").toLowerCase())):n.removeAttribute(t)}},Ar=function(e,t,n,r,i,a){var o=new xn(e._pt,t,n,0,1,a?lr:sr);return e._pt=o,o.b=r,o.e=i,e._props.push(n),o},Cr={deg:1,rad:1,turn:1},Lr=function e(t,n,r,i){var a,o,s,l,u=parseFloat(r)||0,c=(r+"").trim().substr((u+"").length)||"px",h=Cn.style,d=er.test(n),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,v="px"===i,g="%"===i;return i===c||!u||Cr[i]||Cr[c]?u:("px"!==c&&!v&&(u=e(t,n,r,"px")),l=t.getCTM&&Tr(t),!g&&"%"!==c||!Zn[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=m+(v?c:i),o=~n.indexOf("adius")||"em"===i&&t.appendChild&&!p?t:t.parentNode,l&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==Tn&&o.appendChild||(o=Tn.body),(s=o._gsap)&&g&&s.width&&d&&s.time===Dt.time?Se(u/s.width*m):((g||"%"===c)&&(h.position=yr(t,"position")),o===t&&(h.position="static"),o.appendChild(Cn),a=Cn[f],o.removeChild(Cn),h.position="absolute",d&&g&&((s=be(o)).time=Dt.time,s.width=o[f]),Se(v?a*u/m:a&&u?m/a*u:0))):(a=l?t.getBBox()[d?"width":"height"]:t[f],Se(g?u/a*m:u/100*a)))},Rr=function(e,t,n,r){var i;return An||br(),t in nr&&"transform"!==t&&~(t=nr[t]).indexOf(",")&&(t=t.split(",")[0]),Zn[t]&&"transform"!==t?(i=Gr(e,r),i="transformOrigin"!==t?i[t]:i.svg?i.origin:Hr(yr(e,vr))+" "+i.zOrigin+"px"):(!(i=e.style[t])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=Or[t]&&Or[t](e,t,n)||yr(e,t)||we(e,t)||("opacity"===t?1:0)),n&&!~(i+"").trim().indexOf(" ")?Lr(e,t,i,n)+n:i},Pr=function(e,t,n,r){if(!n||"none"===n){var i=_r(t,e,1),a=i&&yr(e,i,1);a&&a!==n?(t=i,n=a):"borderColor"===t&&(n=yr(e,"borderTopColor"))}var o,s,l,u,c,h,d,p,f,m,v,g=new xn(this._pt,e.style,t,0,1,pn),y=0,x=0;if(g.b=n,g.e=r,n+="","auto"==(r+="")&&(e.style[t]=r,r=yr(e,t)||r,e.style[t]=n),Pt(o=[n,r]),r=o[1],l=(n=o[0]).match(ee)||[],(r.match(ee)||[]).length){for(;s=ee.exec(r);)d=s[0],f=r.substring(y,s.index),c?c=(c+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(c=1),d!==(h=l[x++]||"")&&(u=parseFloat(h)||0,v=h.substr((u+"").length),"="===d.charAt(1)&&(d=Ee(u,d)+v),p=parseFloat(d),m=d.substr((p+"").length),y=ee.lastIndex-m.length,m||(m=m||D.units[t]||v,y===r.length&&(r+=m,g.e+=m)),v!==m&&(u=Lr(e,t,h,m)||0),g._pt={_next:g._pt,p:f||1===x?f:",",s:u,c:p-u,m:c&&c<4||"zIndex"===t?Math.round:0});g.c=y<r.length?r.substring(y,r.length):""}else g.r="display"===t&&"none"===r?lr:sr;return ne.test(r)&&(g.e=0),this._pt=g,g},Dr={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ir=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n,r,i,a=t.t,o=a.style,s=t.u,l=a._gsap;if("all"===s||!0===s)o.cssText="",r=1;else for(i=(s=s.split(",")).length;--i>-1;)n=s[i],Zn[n]&&(r=1,n="transformOrigin"===n?vr:mr),Er(a,n);r&&(Er(a,mr),l&&(l.svg&&a.removeAttribute("transform"),Gr(a,1),l.uncache=1))}},Or={clearProps:function(e,t,n,r,i){if("isFromStart"!==i.data){var a=e._pt=new xn(e._pt,t,n,0,0,Ir);return a.u=r,a.pr=-10,a.tween=i,e._props.push(n),1}}},zr=[1,0,0,1,0,0],kr={},Fr=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},Nr=function(e){var t=yr(e,mr);return Fr(t)?zr:t.substr(7).match($).map(Se)},Br=function(e,t){var n,r,i,a,o=e._gsap||be(e),s=e.style,l=Nr(e);return o.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(i=e.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?zr:l:(l!==zr||e.offsetParent||e===En||o.svg||(i=s.display,s.display="block",(n=e.parentNode)&&e.offsetParent||(a=1,r=e.nextSibling,En.appendChild(e)),l=Nr(e),i?s.display=i:Er(e,"display"),a&&(r?n.insertBefore(e,r):n?n.appendChild(e):En.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Ur=function(e,t,n,r,i,a){var o,s,l,u=e._gsap,c=i||Br(e,!0),h=u.xOrigin||0,d=u.yOrigin||0,p=u.xOffset||0,f=u.yOffset||0,m=c[0],v=c[1],g=c[2],y=c[3],x=c[4],_=c[5],b=t.split(" "),w=parseFloat(b[0])||0,M=parseFloat(b[1])||0;n?c!==zr&&(s=m*y-v*g)&&(l=w*(-v/s)+M*(m/s)-(m*_-v*x)/s,w=w*(y/s)+M*(-g/s)+(g*_-y*x)/s,M=l):(w=(o=Sr(e)).x+(~b[0].indexOf("%")?w/100*o.width:w),M=o.y+(~(b[1]||b[0]).indexOf("%")?M/100*o.height:M)),r||!1!==r&&u.smooth?(x=w-h,_=M-d,u.xOffset=p+(x*m+_*g)-x,u.yOffset=f+(x*v+_*y)-_):u.xOffset=u.yOffset=0,u.xOrigin=w,u.yOrigin=M,u.smooth=!!r,u.origin=t,u.originIsAbsolute=!!n,e.style[vr]="0px 0px",a&&(Ar(a,u,"xOrigin",h,w),Ar(a,u,"yOrigin",d,M),Ar(a,u,"xOffset",p,u.xOffset),Ar(a,u,"yOffset",f,u.yOffset)),e.setAttribute("data-svg-origin",w+" "+M)},Gr=function(e,t){var n=e._gsap||new Wt(e);if("x"in n&&!t&&!n.uncache)return n;var r,i,a,o,s,l,u,c,h,d,p,f,m,v,g,y,x,_,b,w,M,S,T,E,A,C,L,R,P,I,O,z,k=e.style,F=n.scaleX<0,N="px",B="deg",U=yr(e,vr)||"0";return r=i=a=l=u=c=h=d=p=0,o=s=1,n.svg=!(!e.getCTM||!Tr(e)),v=Br(e,n.svg),n.svg&&(E=(!n.uncache||"0px 0px"===U)&&!t&&e.getAttribute("data-svg-origin"),Ur(e,E||U,!!E||n.originIsAbsolute,!1!==n.smooth,v)),f=n.xOrigin||0,m=n.yOrigin||0,v!==zr&&(_=v[0],b=v[1],w=v[2],M=v[3],r=S=v[4],i=T=v[5],6===v.length?(o=Math.sqrt(_*_+b*b),s=Math.sqrt(M*M+w*w),l=_||b?Qn(b,_)*Kn:0,(h=w||M?Qn(w,M)*Kn+l:0)&&(s*=Math.abs(Math.cos(h*Jn))),n.svg&&(r-=f-(f*_+m*w),i-=m-(f*b+m*M))):(z=v[6],I=v[7],L=v[8],R=v[9],P=v[10],O=v[11],r=v[12],i=v[13],a=v[14],u=(g=Qn(z,P))*Kn,g&&(E=S*(y=Math.cos(-g))+L*(x=Math.sin(-g)),A=T*y+R*x,C=z*y+P*x,L=S*-x+L*y,R=T*-x+R*y,P=z*-x+P*y,O=I*-x+O*y,S=E,T=A,z=C),c=(g=Qn(-w,P))*Kn,g&&(y=Math.cos(-g),O=M*(x=Math.sin(-g))+O*y,_=E=_*y-L*x,b=A=b*y-R*x,w=C=w*y-P*x),l=(g=Qn(b,_))*Kn,g&&(E=_*(y=Math.cos(g))+b*(x=Math.sin(g)),A=S*y+T*x,b=b*y-_*x,T=T*y-S*x,_=E,S=A),u&&Math.abs(u)+Math.abs(l)>359.9&&(u=l=0,c=180-c),o=Se(Math.sqrt(_*_+b*b+w*w)),s=Se(Math.sqrt(T*T+z*z)),g=Qn(S,T),h=Math.abs(g)>2e-4?g*Kn:0,p=O?1/(O<0?-O:O):0),n.svg&&(E=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Fr(yr(e,mr)),E&&e.setAttribute("transform",E))),Math.abs(h)>90&&Math.abs(h)<270&&(F?(o*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(s*=-1,h+=h<=0?180:-180)),t=t||n.uncache,n.x=r-((n.xPercent=r&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+N,n.y=i-((n.yPercent=i&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-i)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+N,n.z=a+N,n.scaleX=Se(o),n.scaleY=Se(s),n.rotation=Se(l)+B,n.rotationX=Se(u)+B,n.rotationY=Se(c)+B,n.skewX=h+B,n.skewY=d+B,n.transformPerspective=p+N,(n.zOrigin=parseFloat(U.split(" ")[2])||0)&&(k[vr]=Hr(U)),n.xOffset=n.yOffset=0,n.force3D=D.force3D,n.renderTransform=n.svg?Zr:Rn?Yr:Vr,n.uncache=0,n},Hr=function(e){return(e=e.split(" "))[0]+" "+e[1]},jr=function(e,t,n){var r=st(t);return Se(parseFloat(t)+parseFloat(Lr(e,"x",n+"px",r)))+r},Vr=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Yr(e,t)},Wr="0deg",qr="0px",Xr=") ",Yr=function(e,t){var n=t||this,r=n.xPercent,i=n.yPercent,a=n.x,o=n.y,s=n.z,l=n.rotation,u=n.rotationY,c=n.rotationX,h=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,v=n.force3D,g=n.target,y=n.zOrigin,x="",_="auto"===v&&e&&1!==e||!0===v;if(y&&(c!==Wr||u!==Wr)){var b,w=parseFloat(u)*Jn,M=Math.sin(w),S=Math.cos(w);w=parseFloat(c)*Jn,b=Math.cos(w),a=jr(g,a,M*b*-y),o=jr(g,o,-Math.sin(w)*-y),s=jr(g,s,S*b*-y+y)}m!==qr&&(x+="perspective("+m+Xr),(r||i)&&(x+="translate("+r+"%, "+i+"%) "),(_||a!==qr||o!==qr||s!==qr)&&(x+=s!==qr||_?"translate3d("+a+", "+o+", "+s+") ":"translate("+a+", "+o+Xr),l!==Wr&&(x+="rotate("+l+Xr),u!==Wr&&(x+="rotateY("+u+Xr),c!==Wr&&(x+="rotateX("+c+Xr),h===Wr&&d===Wr||(x+="skew("+h+", "+d+Xr),1===p&&1===f||(x+="scale("+p+", "+f+Xr),g.style[mr]=x||"translate(0, 0)"},Zr=function(e,t){var n,r,i,a,o,s=t||this,l=s.xPercent,u=s.yPercent,c=s.x,h=s.y,d=s.rotation,p=s.skewX,f=s.skewY,m=s.scaleX,v=s.scaleY,g=s.target,y=s.xOrigin,x=s.yOrigin,_=s.xOffset,b=s.yOffset,w=s.forceCSS,M=parseFloat(c),S=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=Jn,p*=Jn,n=Math.cos(d)*m,r=Math.sin(d)*m,i=Math.sin(d-p)*-v,a=Math.cos(d-p)*v,p&&(f*=Jn,o=Math.tan(p-f),i*=o=Math.sqrt(1+o*o),a*=o,f&&(o=Math.tan(f),n*=o=Math.sqrt(1+o*o),r*=o)),n=Se(n),r=Se(r),i=Se(i),a=Se(a)):(n=m,a=v,r=i=0),(M&&!~(c+"").indexOf("px")||S&&!~(h+"").indexOf("px"))&&(M=Lr(g,"x",c,"px"),S=Lr(g,"y",h,"px")),(y||x||_||b)&&(M=Se(M+y-(y*n+x*i)+_),S=Se(S+x-(y*r+x*a)+b)),(l||u)&&(o=g.getBBox(),M=Se(M+l/100*o.width),S=Se(S+u/100*o.height)),o="matrix("+n+","+r+","+i+","+a+","+M+","+S+")",g.setAttribute("transform",o),w&&(g.style[mr]=o)},Kr=function(e,t,n,r,i){var a,o,s=360,l=H(i),u=parseFloat(i)*(l&&~i.indexOf("rad")?Kn:1)-r,c=r+u+"deg";return l&&("short"===(a=i.split("_")[1])&&(u%=s)!=u%180&&(u+=u<0?s:-360),"cw"===a&&u<0?u=(u+36e9)%s-~~(u/s)*s:"ccw"===a&&u>0&&(u=(u-36e9)%s-~~(u/s)*s)),e._pt=o=new xn(e._pt,t,n,r,u,ir),o.e=c,o.u="deg",e._props.push(n),o},Jr=function(e,t){for(var n in t)e[n]=t[n];return e},Qr=function(e,t,n){var r,i,a,o,s,l,u,c=Jr({},n._gsap),h=n.style;for(i in c.svg?(a=n.getAttribute("transform"),n.setAttribute("transform",""),h[mr]=t,r=Gr(n,1),Er(n,mr),n.setAttribute("transform",a)):(a=getComputedStyle(n)[mr],h[mr]=t,r=Gr(n,1),h[mr]=a),Zn)(a=c[i])!==(o=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(s=st(a)!==(u=st(o))?Lr(n,i,a,u):parseFloat(a),l=parseFloat(o),e._pt=new xn(e._pt,r,i,s,l-s,rr),e._pt.u=u||0,e._props.push(i));Jr(r,c)};Me("padding,margin,Width,Radius",(function(e,t){var n="Top",r="Right",i="Bottom",a="Left",o=(t<3?[n,r,i,a]:[n+a,n+r,i+r,i+a]).map((function(n){return t<2?e+n:"border"+n+e}));Or[t>1?"border"+e:e]=function(e,t,n,r,i){var a,s;if(arguments.length<4)return a=o.map((function(t){return Rr(e,t,n)})),5===(s=a.join(" ")).split(a[0]).length?a[0]:s;a=(r+"").split(" "),s={},o.forEach((function(e,t){return s[e]=a[t]=a[t]||a[(t-1)/2|0]})),e.init(t,s,i)}}));var $r,ei,ti={name:"css",register:br,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,r,i){var o,s,l,u,c,h,d,p,f,m,v,g,y,x,_,b,w,M,S,T=this._props,E=e.style,A=n.vars.startAt;for(d in An||br(),t)if("autoRound"!==d&&(s=t[d],!me[d]||!Qt(d,t,n,r,e,i)))if(c=(0,a.default)(s),h=Or[d],"function"===c&&(s=s.call(n,r,e,i),c=(0,a.default)(s)),"string"===c&&~s.indexOf("random(")&&(s=gt(s)),h)h(this,e,d,s,n)&&(_=1);else if("--"===d.substr(0,2))o=(getComputedStyle(e).getPropertyValue(d)+"").trim(),s+="",Lt.lastIndex=0,Lt.test(o)||(p=st(o),f=st(s)),f?p!==f&&(o=Lr(e,d,o,f)+f):p&&(s+=p),this.add(E,"setProperty",o,s,r,i,0,0,d),T.push(d);else if("undefined"!==c){if(A&&d in A?(o="function"==typeof A[d]?A[d].call(n,r,e,i):A[d],H(o)&&~o.indexOf("random(")&&(o=gt(o)),st(o+"")||(o+=D.units[d]||st(Rr(e,d))||""),"="===(o+"").charAt(1)&&(o=Rr(e,d))):o=Rr(e,d),u=parseFloat(o),(m="string"===c&&"="===s.charAt(1)&&s.substr(0,2))&&(s=s.substr(2)),l=parseFloat(s),d in nr&&("autoAlpha"===d&&(1===u&&"hidden"===Rr(e,"visibility")&&l&&(u=0),Ar(this,E,"visibility",u?"inherit":"hidden",l?"inherit":"hidden",!l)),"scale"!==d&&"transform"!==d&&~(d=nr[d]).indexOf(",")&&(d=d.split(",")[0])),v=d in Zn)if(g||((y=e._gsap).renderTransform&&!t.parseTransform||Gr(e,t.parseTransform),x=!1!==t.smoothOrigin&&y.smooth,(g=this._pt=new xn(this._pt,E,mr,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===d)this._pt=new xn(this._pt,y,"scaleY",y.scaleY,(m?Ee(y.scaleY,m+l):l)-y.scaleY||0),T.push("scaleY",d),d+="X";else{if("transformOrigin"===d){w=void 0,M=void 0,S=void 0,M=(w=(b=s).split(" "))[0],S=w[1]||"50%","top"!==M&&"bottom"!==M&&"left"!==S&&"right"!==S||(b=M,M=S,S=b),w[0]=Dr[M]||M,w[1]=Dr[S]||S,s=w.join(" "),y.svg?Ur(e,s,0,x,0,this):((f=parseFloat(s.split(" ")[2])||0)!==y.zOrigin&&Ar(this,y,"zOrigin",y.zOrigin,f),Ar(this,E,d,Hr(o),Hr(s)));continue}if("svgOrigin"===d){Ur(e,s,1,x,0,this);continue}if(d in kr){Kr(this,y,d,u,m?Ee(u,m+s):s);continue}if("smoothOrigin"===d){Ar(this,y,"smooth",y.smooth,s);continue}if("force3D"===d){y[d]=s;continue}if("transform"===d){Qr(this,s,e);continue}}else d in E||(d=_r(d)||d);if(v||(l||0===l)&&(u||0===u)&&!tr.test(s)&&d in E)l||(l=0),(p=(o+"").substr((u+"").length))!==(f=st(s)||(d in D.units?D.units[d]:p))&&(u=Lr(e,d,o,f)),this._pt=new xn(this._pt,v?y:E,d,u,(m?Ee(u,m+l):l)-u,v||"px"!==f&&"zIndex"!==d||!1===t.autoRound?rr:or),this._pt.u=f||0,p!==f&&"%"!==f&&(this._pt.b=o,this._pt.r=ar);else if(d in E)Pr.call(this,e,d,o,m?m+s:s);else{if(!(d in e)){le(d,s);continue}this.add(e,d,o||e[d],m?m+s:s,r,i)}T.push(d)}_&&yn(this)},get:Rr,aliases:nr,getSetter:function(e,t,n){var r=nr[t];return r&&r.indexOf(",")<0&&(t=r),t in Zn&&t!==vr&&(e._gsap.x||Rr(e,"x"))?n&&Ln===n?"scale"===t?dr:hr:(Ln=n||{})&&("scale"===t?pr:fr):e.style&&!W(e.style[t])?ur:~t.indexOf("-")?cr:cn(e,t)},core:{_removeProperty:Er,_getMatrix:Br}};Mn.utils.checkPrefix=_r,ei=Me("x,y,z,scale,scaleX,scaleY,xPercent,yPercent"+","+($r="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(e){Zn[e]=1})),Me($r,(function(e){D.units[e]="deg",kr[e]=1})),nr[ei[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+$r,Me("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(e){var t=e.split(":");nr[t[1]]=ei[t[0]]})),Me("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(e){D.units[e]="px"})),Mn.registerPlugin(ti);var ni=Mn.registerPlugin(ti)||Mn,ri=ni.core.Tween;e.Back=jn,e.Bounce=Wn,e.CSSPlugin=ti,e.Circ=Yn,e.Cubic=Nn,e.Elastic=Hn,e.Expo=Xn,e.Linear=kn,e.Power0=Pn,e.Power1=Dn,e.Power2=In,e.Power3=On,e.Power4=zn,e.Quad=Fn,e.Quart=Bn,e.Quint=Un,e.Sine=qn,e.SteppedEase=Vn,e.Strong=Gn,e.TimelineLite=Xt,e.TimelineMax=Xt,e.TweenLite=an,e.TweenMax=ri,e.default=ni,e.gsap=ni,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default},"object"===("undefined"==typeof n?"undefined":(0,a.default)(n))&&"undefined"!=typeof t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i((r=r||self).window=r.window||{})},{"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/typeof":17}],23:[function(e,t,n){"use strict";!function(e){function n(){this._listeners=[],this.dispatchCount=0}var r=n.prototype;r.add=s,r.addOnce=function(t,n,r,o){if(!t)throw i;var l=this,u=function(){return l.remove.call(l,t,n),t.apply(n,a.call(arguments,0))};1===(o=a.call(arguments,0)).length&&o.push(e),o.splice(2,0,u),s.apply(l,o)},r.remove=function(e,t){if(!e)return this._listeners.length=0,!0;for(var n,r=this._listeners,i=r.length;i--;)if((n=r[i]).f===e&&(!t||n.c===t))return n.j=0,r.splice(i,1),!0;return!1},r.dispatch=function(e){e=a.call(arguments,0),this.dispatchCount++;for(var t,n,r=this.dispatchCount,i=this._listeners,o=i.length;o--;)if((t=i[o])&&t.j<r&&(t.j=r,!1===t.r.apply(t.c,t.a.concat(e)))){n=t;break}for(o=(i=this._listeners).length;o--;)i[o].j=0;return n};var i="Callback function is missing!",a=Array.prototype.slice;function o(e){e.sort((function(e,t){return e=e.p,(t=t.p)<e?1:e>t?-1:0}))}function s(e,t,n,r){if(!e)throw i;n=n||0;for(var s,l,u,c=this._listeners,h=c.length;h--;)if((s=c[h]).f===e&&s.c===t)return!1;"function"==typeof n&&(l=n,n=r,u=4),c.unshift({f:e,c:t,p:n,r:l||e,a:a.call(arguments,u||3),j:0}),o(c)}"undefined"!=typeof t&&(t.exports=n)}()},{}],24:[function(e,t,n){"use strict";var r=e("./indexOf");t.exports=function(e,t){return-1!==r(e,t)}},{"./indexOf":25}],25:[function(e,t,n){"use strict";t.exports=function(e,t,n){if(n=n||0,null==e)return-1;for(var r=e.length,i=n<0?r+n:n;i<r;){if(e[i]===t)return i;i++}return-1}},{}],26:[function(e,t,n){"use strict";var r=e("./kindOf"),i=e("./isPlainObject"),a=e("../object/mixIn");t.exports=function(e){switch(r(e)){case"Object":return i(o=e)?a({},o):o;case"Array":return e.slice();case"RegExp":return n="",n+=(t=e).multiline?"m":"",n+=t.global?"g":"",n+=t.ignoreCase?"i":"",new RegExp(t.source,n);case"Date":return new Date(+e);default:return e}var t,n,o}},{"../object/mixIn":40,"./isPlainObject":34,"./kindOf":35}],27:[function(e,t,n){"use strict";var r=e("./clone"),i=e("../object/forOwn"),a=e("./kindOf"),o=e("./isPlainObject");t.exports=function e(t,n){switch(a(t)){case"Object":return function(t,n){if(o(t)){var r={};return i(t,(function(t,r){this[r]=e(t,n)}),r),r}return n?n(t):t}(t,n);case"Array":return function(t,n){for(var r=[],i=-1,a=t.length;++i<a;)r[i]=e(t[i],n);return r}(t,n);default:return r(t)}}},{"../object/forOwn":37,"./clone":26,"./isPlainObject":34,"./kindOf":35}],28:[function(e,t,n){"use strict";var r=e("./isKind"),i=Array.isArray||function(e){return r(e,"Array")};t.exports=i},{"./isKind":31}],29:[function(e,t,n){"use strict";var r=e("./isKind");t.exports=function(e){return r(e,"Boolean")}},{"./isKind":31}],30:[function(e,t,n){"use strict";var r=e("./isNumber");t.exports=function(e){return r(e)&&e%1==0}},{"./isNumber":32}],31:[function(e,t,n){"use strict";var r=e("./kindOf");t.exports=function(e,t){return r(e)===t}},{"./kindOf":35}],32:[function(e,t,n){"use strict";var r=e("./isKind");t.exports=function(e){return r(e,"Number")}},{"./isKind":31}],33:[function(e,t,n){"use strict";var r=e("./isKind");t.exports=function(e){return r(e,"Object")}},{"./isKind":31}],34:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof"));t.exports=function(e){return!!e&&"object"===(0,r.default)(e)&&e.constructor===Object}},{"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/typeof":17}],35:[function(e,t,n){"use strict";t.exports=function(e){return Object.prototype.toString.call(e).slice(8,-1)}},{}],36:[function(e,t,n){"use strict";var r,i,a=e("./hasOwn");function o(e,t,n,r){return e.call(r,t[n],n,t)}t.exports=function(e,t,n){var s,l=0;for(s in null==r&&function(){for(var e in i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=!0,{toString:null})r=!1}(),e)if(!1===o(t,e,s,n))break;if(r)for(var u=e.constructor,c=!!u&&e===u.prototype;(s=i[l++])&&("constructor"===s&&(c||!a(e,s))||e[s]===Object.prototype[s]||!1!==o(t,e,s,n)););}},{"./hasOwn":38}],37:[function(e,t,n){"use strict";var r=e("./hasOwn"),i=e("./forIn");t.exports=function(e,t,n){i(e,(function(i,a){if(r(e,a))return t.call(n,e[a],a,e)}))}},{"./forIn":36,"./hasOwn":38}],38:[function(e,t,n){"use strict";t.exports=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},{}],39:[function(e,t,n){"use strict";var r=e("./hasOwn"),i=e("../lang/deepClone"),a=e("../lang/isObject");t.exports=function e(){var t,n,o,s,l=1;for(s=i(arguments[0]);o=arguments[l++];)for(t in o)r(o,t)&&(n=o[t],a(n)&&a(s[t])?s[t]=e(s[t],n):s[t]=i(n));return s}},{"../lang/deepClone":27,"../lang/isObject":33,"./hasOwn":38}],40:[function(e,t,n){"use strict";var r=e("./forOwn");function i(e,t){this[t]=e}t.exports=function(e,t){for(var n,a=0,o=arguments.length;++a<o;)null!=(n=arguments[a])&&r(n,i,e);return e}},{"./forOwn":37}],41:[function(e,t,n){"use strict";var r=e("../string/typecast"),i=e("../lang/isArray"),a=e("../object/hasOwn");t.exports=function(e,t){for(var n,o,s,l,u=(e||"").replace("?","").split("&"),c=-1,h={};o=u[++c];)n=o.indexOf("="),l=o.substring(0,n),s=decodeURIComponent(o.substring(n+1)),!1!==t&&(s=r(s)),a(h,l)?i(h[l])?h[l].push(s):h[l]=[h[l],s]:h[l]=s;return h}},{"../lang/isArray":28,"../object/hasOwn":38,"../string/typecast":44}],42:[function(e,t,n){"use strict";t.exports=function(e){var t=/\?[a-zA-Z0-9\=\&\%\$\-\_\.\+\!\*\'\(\)\,]+/.exec(e);return t?decodeURIComponent(t[0].replace(/\+/g," ")):""}},{}],43:[function(e,t,n){"use strict";var r=e("./decode"),i=e("./getQuery");t.exports=function(e,t){return r(i(e),t)}},{"./decode":41,"./getQuery":42}],44:[function(e,t,n){"use strict";var r;t.exports=function(e){return null===e||"null"===e?null:"true"===e||"false"!==e&&(e===r||"undefined"===e?r:""===e||isNaN(e)?e:parseFloat(e))}},{}],45:[function(e,t,n){"use strict";t.exports=e("./src/quickLoader"),e("./src/types/JSONPItem"),e("./src/types/JSONItem"),e("./src/types/TextItem"),e("./src/types/AudioItem"),e("./src/types/VideoItem"),e("./src/types/AnyItem"),e("./src/types/ImageItem"),e("./src/types/XHRItem")},{"./src/quickLoader":47,"./src/types/AnyItem":49,"./src/types/AudioItem":50,"./src/types/ImageItem":51,"./src/types/JSONItem":52,"./src/types/JSONPItem":53,"./src/types/TextItem":54,"./src/types/VideoItem":55,"./src/types/XHRItem":56}],46:[function(e,t,n){arguments[4][23][0].apply(n,arguments)},{dup:23}],47:[function(e,t,n){"use strict";var r,i=e("min-signal");function a(){this.isLoading=!1,this.totalWeight=0,this.loadedWeight=0,this.itemUrls={},this.itemList=[],this.loadingSignal=new i,this.crossOriginMap={},this.queue=[],this.activeItems=[],this.maxActiveItems=4}var o=a.prototype;o.addChunk=function(e,t){var n,r,i,a,o,s=m(e,t);for(n=0,i=s.length;n<i;n++)for(r=0,a=(o=s[n]).items.length;r<a;r++)this.add(o.items[r],{type:o.type});return s},o.setCrossOrigin=function(e,t){this.crossOriginMap[e]=t},o.add=function(e,t){var n=s[e];return n||(n=this._createItem(e,t&&t.type?t.type:v(e).type,t)),t&&t.onLoad&&n.onLoaded.addOnce(t.onLoad),this.itemUrls[e]||(this.itemUrls[e]=n,this.itemList.push(n),this.totalWeight+=n.weight),n},o.load=function(e,t){var n=s[e];return n||(n=this._createItem(e,t&&t.type?t.type:v(e).type,t)),t&&t.onLoad&&n.onLoaded.addOnce(t.onLoad),l[e]?n.dispatch():n.isStartLoaded||n.load(),n},o.start=function(e){e&&this.loadingSignal.add(e),this.isLoading=!0;var t=this.itemList.length;if(t){var n,i=this.itemList.splice(0,this.itemList.length);for(var a in this.itemUrls)delete this.itemUrls[a];for(var o=0;o<t;o++){n=i[o];var s=!!l[n.url];n.onLoaded.addOnce(p,this,-1024,n,i,s),n.hasLoading&&n.loadingSignal.add(h,this,-1024,n,i,r),s?n.dispatch(p):n.isStartLoaded||this.queue.push(n)}this.queue.length&&this.loadNext()}else p.call(this,r,this.itemList)},o.loadNext=function(){if(this.queue.length&&this.activeItems.length<this.maxActiveItems){var e=this.queue.shift();this.activeItems.push(e),this.loadNext(),e.load()}},o._createItem=function(e,t,n){if(!(n=n||{}).crossOrigin)for(var r in this.crossOriginMap)if(0===e.indexOf(r)){n.crossOrigin=this.crossOriginMap[r];break}return new c[t](e,n)},o._onLoading=h,o.VERSION="0.1.17",o.register=function(e){c[e.type]||(u.push(e),c[e.type]=e)},o.retrieveAll=m,o.retrieve=v,o.testExtensions=g,o.create=y,o.check=function(){var e=[],t=[];for(var n in s)e.push(n),l[n]||t.push(s[n]);console.log({added:e,notLoaded:t})};var s=o.addedItems={},l=o.loadedItems={},u=o.ITEM_CLASS_LIST=[],c=o.ITEM_CLASSES={};function h(e,t,n,i,a){e&&!e.isLoaded&&1===e.getCombinedPercent(i)||(a===r&&(this.loadedWeight=d(t),a=this.loadedWeight/this.totalWeight),(n=n||this.loadingSignal).dispatch(a,e))}function d(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n].loadedWeight;return t}function p(e,t,n){if(this.loadedWeight=d(t),!n)for(var r=this.activeItems,a=r.length;a--;)if(r[a]===e){r.splice(a,1);break}var o=this.loadingSignal;this.loadedWeight===this.totalWeight?(this.isLoading=!1,this.loadedWeight=0,this.totalWeight=0,this.loadingSignal=new i,this._onLoading(e,t,o,1,1),e&&e.noCache&&f(e)):(this._onLoading(e,t,o,1,this.loadedWeight/this.totalWeight),e&&e.noCache&&f(e),n||this.loadNext())}function f(e){var t=e.url;e.content=r,s[t]=r,l[t]=r}function m(e,t){var n,r,i=e.length,a=[];if(i&&"string"!=typeof e)for(n=0;n<i;n++)(r=v(e[n],t))&&(a=a.concat(r));else(r=v(e,t))&&(a=a.concat(r));return a}function v(e,t){var n,i,a,o,s;if(t)a=(o=c[t]).retrieve(e);else for(n=0,i=u.length;n<i;n++){if(s=(o=u[n]).type,"string"==typeof e){if(g(e,o)){a=[e];break}}else if((a=o.retrieve(e))&&a.length&&"string"==typeof a[0]&&g(a[0],o))break;a=r,s=r}if(a)return{type:t||s,items:a}}function g(e,t){if(e){for(var n=function(e){return e.split(".").pop().split(/#|\?/)[0]}(e),r=t.extensions,i=r.length;i--;)if(n===r[i])return!0;return!1}}function y(){return new a}t.exports=y()},{"min-signal":46}],48:[function(e,t,n){"use strict";var r=e("min-signal"),i=e("../quickLoader");function a(e,t){if(e){for(var n in this.url=e,this.loadedWeight=0,this.weight=1,this.postPercent=0,t)this[n]=t[n];this.type||(this.type=this.constructor.type),this.hasLoading&&(this.loadingSignal=new r,this.loadingSignal.add(s,this),this.onLoading&&this.loadingSignal.add(this.onLoading)),this.onPost?(this.onPostLoadingSignal=new r,this.onPostLoadingSignal.add(this._onPostLoading,this),this.postWeightRatio=this.postWeightRatio||.1):this.postWeightRatio=0;var a=this;this.boundOnLoad=function(){a._onLoad()},this.onLoaded=new r,i.addedItems[e]=this}}t.exports=a;var o=a.prototype;function s(e){this.loadedWeight=this.weight*this.getCombinedPercent(e)}o.load=function(){this.isStartLoaded=!0},o._onLoad=function(){this.onPost?this.onPost.call(this,this.content,this.onPostLoadingSignal):this._onLoadComplete()},o._onLoading=s,o._onPostLoading=function(e){this.postPercent=e,this.hasLoading&&this.loadingSignal.dispatch(1),1===e&&this._onLoadComplete()},o._onLoadComplete=function(){this.isLoaded=!0,this.loadedWeight=this.weight,i.loadedItems[this.url]=this,this.onLoaded.dispatch(this.content)},o.getCombinedPercent=function(e){return e*(1-this.postWeightRatio)+this.postWeightRatio*this.postPercent},o.dispatch=function(){this.hasLoading&&this.loadingSignal.remove(),this.onLoaded.dispatch(this.content)},a.extensions=[],a.retrieve=function(){return!1}},{"../quickLoader":47,"min-signal":46}],49:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("../quickLoader");function a(e,t){e&&(o.constructor.call(this,e,t),!this.loadFunc&&console&&console[console.error||console.log]("require loadFunc in the config object."))}t.exports=a,a.type="any",a.extensions=[],i.register(a),a.retrieve=function(){return!1};var o=r.prototype,s=a.prototype=new r;s.constructor=a,s.load=function(){var e=this;this.loadFunc(this.url,(function(t){e.content=t,o._onLoad.call(e)}),this.loadingSignal)}},{"../quickLoader":47,"./AbstractItem":48}],50:[function(e,t,n){"use strict";var r,i=e("./AbstractItem"),a=e("../quickLoader");function o(e,t){if(e){this.loadThrough=!t||t.loadThrough===r||t.loadThrough,s.constructor.apply(this,arguments);try{this.content=this.content||new Audio}catch(e){this.content=this.content||document.createElement("audio")}this.crossOrigin&&(this.content.crossOrigin=this.crossOrigin)}}t.exports=o,o.type="audio",o.extensions=["mp3","ogg"],a.register(o),o.retrieve=function(e){return!1};var s=i.prototype,l=o.prototype=new i;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e=this,t=e.content;t.src=this.url,this.loadThrough?t.addEventListener("canplaythrough",this.boundOnLoad,!1):t.addEventListener("canplay",this.boundOnLoad,!1),t.load()},l._onLoad=function(){this.content.removeEventListener("canplaythrough",this.boundOnLoad,!1),this.content.removeEventListener("canplay",this.boundOnLoad,!1),this.isLoaded||s._onLoad.call(this)}},{"../quickLoader":47,"./AbstractItem":48}],51:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("computed-style"),a=e("../quickLoader");function o(e,t){e&&(s.constructor.apply(this,arguments),this.content=this.content||new Image,this.crossOrigin&&(this.content.crossOrigin=this.crossOrigin))}t.exports=o;var s=r.prototype,l=o.prototype=new r;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e=this.content;e.onload=this.boundOnLoad,e.src=this.url},l._onLoad=function(){delete this.content.onload,this.width=this.content.width,this.height=this.content.height,s._onLoad.call(this)},o.retrieve=function(e){if(e.nodeType&&e.style){var t=[];"img"===e.nodeName.toLowerCase()&&e.src.indexOf(";")<0&&t.push(e.src),i(e,"background-image").replace(/s?url\(\s*?['"]?([^;]*?)['"]?\s*?\)/g,(function(e,n){t.push(n)}));for(var n=t.length;n--;)0===t[n].indexOf("data:")&&t.splice(n,1);return!!t.length&&t}return"string"==typeof e&&[e]},o.type="image",o.extensions=["jpg","gif","png"],a.register(o)},{"../quickLoader":47,"./AbstractItem":48,"computed-style":20}],52:[function(require,module,exports){"use strict";var TextItem=require("./TextItem"),quickLoader=require("../quickLoader");function JSONItem(e){e&&_super.constructor.apply(this,arguments)}module.exports=JSONItem,JSONItem.type="json",JSONItem.extensions=["json"],quickLoader.register(JSONItem),JSONItem.retrieve=function(){return!1};var _super=TextItem.prototype,_p=JSONItem.prototype=new TextItem;function _onLoad(){this.content||(this.content=window.JSON&&window.JSON.parse?JSON.parse(this.xmlhttp.responseText.toString()):eval(this.xmlhttp.responseText.toString())),_super._onLoad.call(this)}_p.constructor=JSONItem,_p._onLoad=_onLoad},{"../quickLoader":47,"./TextItem":54}],53:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("../quickLoader");function a(){return"_jsonp"+(new Date).getTime()+~~(1e8*Math.random())}function o(e){e&&s.constructor.apply(this,arguments)}t.exports=o,o.type="jsonp",o.extensions=[],i.register(o),o.retrieve=function(e){return"string"==typeof e&&e.indexOf("=")>-1&&[e]};var s=r.prototype,l=o.prototype=new r;l.constructor=o,l.load=function(e){s.load.apply(this,arguments);var t=this,n=this.url.lastIndexOf("=")+1,r=this.url.substr(0,n),i=this.url.substr(n);0===i.length?(i=a(),this.jsonpCallback=e):this.jsonpCallback=this.jsonpCallback||window[i],window[i]=function(e){o.parentNode&&o.parentNode.removeChild(o),t.content=e,t._onLoad()};var o=document.createElement("script");o.type="text/javascript",o.src=r+i,document.getElementsByTagName("head")[0].appendChild(o)}},{"../quickLoader":47,"./AbstractItem":48}],54:[function(e,t,n){"use strict";var r=e("./XHRItem"),i=e("../quickLoader");function a(e,t){e&&(t.responseType="text",o.constructor.apply(this,arguments))}t.exports=a,a.type="text",a.extensions=["html","txt","svg"],i.register(a),a.retrieve=function(){return!1};var o=r.prototype,s=a.prototype=new r;s.constructor=a,s._onLoad=function(){this.content||(this.content=this.xmlhttp.responseText),o._onLoad.apply(this,arguments)}},{"../quickLoader":47,"./XHRItem":56}],55:[function(e,t,n){"use strict";var r,i=e("./AbstractItem"),a=e("../quickLoader");function o(e,t){if(e){this.loadThrough=!t||t.loadThrough===r||t.loadThrough,s.constructor.apply(this,arguments);try{this.content=this.content||new Video}catch(e){this.content=this.content||document.createElement("video")}this.crossOrigin&&(this.content.crossOrigin=this.crossOrigin)}}t.exports=o,o.type="video",o.extensions=["mp4","webm","ogv"],a.register(o),o.retrieve=function(e){return!1};var s=i.prototype,l=o.prototype=new i;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e=this.content;e.preload="auto",e.src=this.url,this.loadThrough?e.addEventListener("canplaythrough",this.boundOnLoad,!1):e.addEventListener("canplay",this.boundOnLoad,!1),e.load()},l._onLoad=function(){this.content.removeEventListener("canplaythrough",this.boundOnLoad),this.content.removeEventListener("canplay",this.boundOnLoad),this.isLoaded||s._onLoad.call(this)}},{"../quickLoader":47,"./AbstractItem":48}],56:[function(e,t,n){"use strict";var r=e("./AbstractItem"),i=e("../quickLoader"),a=!!window.XMLHttpRequest;function o(e){e&&(s.constructor.apply(this,arguments),this.responseType=this.responseType||"",this.method=this.method||"GET")}t.exports=o,o.type="xhr",o.extensions=[],i.register(o),o.retrieve=function(){return!1};var s=r.prototype,l=o.prototype=new r;l.constructor=o,l.load=function(){s.load.apply(this,arguments);var e,t=this;e=this.xmlhttp=a?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.hasLoading&&(e.onprogress=function(e){t._onXmlHttpProgress(e)}),e.onreadystatechange=function(){t._onXmlHttpChange()},e.open(this.method,this.url,!0),this.xmlhttp.responseType=this.responseType,a?e.send(null):e.send()},l._onXmlHttpChange=function(){4===this.xmlhttp.readyState&&200===this.xmlhttp.status&&this._onLoad(this.xmlhttp)},l._onXmlHttpProgress=function(e){this.loadingSignal.dispatch(e.loaded/e.total)},l._onLoad=function(){this.content||(this.content=this.xmlhttp.response),this.xmlhttp=void 0,s._onLoad.call(this)}},{"../quickLoader":47,"./AbstractItem":48}],57:[function(e,t,n){"use strict";var r,i=(r=e("./simplex-noise.js"))&&r.__esModule?r:{default:r};i.default.SimplexNoise=i.default,t.exports=i.default},{"./simplex-noise.js":58}],58:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass"));Object.defineProperty(n,"__esModule",{value:!0}),n.buildPermutationTable=n.SimplexNoise=void 0;var o=.5*(Math.sqrt(3)-1),s=(3-Math.sqrt(3))/6,l=1/6,u=(Math.sqrt(5)-1)/4,c=(5-Math.sqrt(5))/20,h=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),d=new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;(0,i.default)(this,e);var n="function"==typeof t?t:m(t);this.p=f(n),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var r=0;r<512;r++)this.perm[r]=this.p[255&r],this.permMod12[r]=this.perm[r]%12}return(0,a.default)(e,[{key:"noise2D",value:function(e,t){var n,r,i=this.permMod12,a=this.perm,l=0,u=0,c=0,d=(e+t)*o,p=Math.floor(e+d),f=Math.floor(t+d),m=(p+f)*s,v=e-(p-m),g=t-(f-m);v>g?(n=1,r=0):(n=0,r=1);var y=v-n+s,x=g-r+s,_=v-1+2*s,b=g-1+2*s,w=255&p,M=255&f,S=.5-v*v-g*g;if(S>=0){var T=3*i[w+a[M]];l=(S*=S)*S*(h[T]*v+h[T+1]*g)}var E=.5-y*y-x*x;if(E>=0){var A=3*i[w+n+a[M+r]];u=(E*=E)*E*(h[A]*y+h[A+1]*x)}var C=.5-_*_-b*b;if(C>=0){var L=3*i[w+1+a[M+1]];c=(C*=C)*C*(h[L]*_+h[L+1]*b)}return 70*(l+u+c)}},{key:"noise3D",value:function(e,t,n){var r,i,a,o,s,u,c,d,p,f,m=this.permMod12,v=this.perm,g=.3333333333333333*(e+t+n),y=Math.floor(e+g),x=Math.floor(t+g),_=Math.floor(n+g),b=(y+x+_)*l,w=e-(y-b),M=t-(x-b),S=n-(_-b);w>=M?M>=S?(s=1,u=0,c=0,d=1,p=1,f=0):w>=S?(s=1,u=0,c=0,d=1,p=0,f=1):(s=0,u=0,c=1,d=1,p=0,f=1):M<S?(s=0,u=0,c=1,d=0,p=1,f=1):w<S?(s=0,u=1,c=0,d=0,p=1,f=1):(s=0,u=1,c=0,d=1,p=1,f=0);var T=w-s+l,E=M-u+l,A=S-c+l,C=w-d+2*l,L=M-p+2*l,R=S-f+2*l,P=w-1+.5,D=M-1+.5,I=S-1+.5,O=255&y,z=255&x,k=255&_,F=.6-w*w-M*M-S*S;if(F<0)r=0;else{var N=3*m[O+v[z+v[k]]];r=(F*=F)*F*(h[N]*w+h[N+1]*M+h[N+2]*S)}var B=.6-T*T-E*E-A*A;if(B<0)i=0;else{var U=3*m[O+s+v[z+u+v[k+c]]];i=(B*=B)*B*(h[U]*T+h[U+1]*E+h[U+2]*A)}var G=.6-C*C-L*L-R*R;if(G<0)a=0;else{var H=3*m[O+d+v[z+p+v[k+f]]];a=(G*=G)*G*(h[H]*C+h[H+1]*L+h[H+2]*R)}var j=.6-P*P-D*D-I*I;if(j<0)o=0;else{var V=3*m[O+1+v[z+1+v[k+1]]];o=(j*=j)*j*(h[V]*P+h[V+1]*D+h[V+2]*I)}return 32*(r+i+a+o)}},{key:"noise4D",value:function(e,t,n,r){var i,a,o,s,l,h=this.perm,p=(e+t+n+r)*u,f=Math.floor(e+p),m=Math.floor(t+p),v=Math.floor(n+p),g=Math.floor(r+p),y=(f+m+v+g)*c,x=e-(f-y),_=t-(m-y),b=n-(v-y),w=r-(g-y),M=0,S=0,T=0,E=0;x>_?M++:S++,x>b?M++:T++,x>w?M++:E++,_>b?S++:T++,_>w?S++:E++,b>w?T++:E++;var A=M>=3?1:0,C=S>=3?1:0,L=T>=3?1:0,R=E>=3?1:0,P=M>=2?1:0,D=S>=2?1:0,I=T>=2?1:0,O=E>=2?1:0,z=M>=1?1:0,k=S>=1?1:0,F=T>=1?1:0,N=E>=1?1:0,B=x-A+c,U=_-C+c,G=b-L+c,H=w-R+c,j=x-P+2*c,V=_-D+2*c,W=b-I+2*c,q=w-O+2*c,X=x-z+3*c,Y=_-k+3*c,Z=b-F+3*c,K=w-N+3*c,J=x-1+4*c,Q=_-1+4*c,$=b-1+4*c,ee=w-1+4*c,te=255&f,ne=255&m,re=255&v,ie=255&g,ae=.6-x*x-_*_-b*b-w*w;if(ae<0)i=0;else{var oe=h[te+h[ne+h[re+h[ie]]]]%32*4;i=(ae*=ae)*ae*(d[oe]*x+d[oe+1]*_+d[oe+2]*b+d[oe+3]*w)}var se=.6-B*B-U*U-G*G-H*H;if(se<0)a=0;else{var le=h[te+A+h[ne+C+h[re+L+h[ie+R]]]]%32*4;a=(se*=se)*se*(d[le]*B+d[le+1]*U+d[le+2]*G+d[le+3]*H)}var ue=.6-j*j-V*V-W*W-q*q;if(ue<0)o=0;else{var ce=h[te+P+h[ne+D+h[re+I+h[ie+O]]]]%32*4;o=(ue*=ue)*ue*(d[ce]*j+d[ce+1]*V+d[ce+2]*W+d[ce+3]*q)}var he=.6-X*X-Y*Y-Z*Z-K*K;if(he<0)s=0;else{var de=h[te+z+h[ne+k+h[re+F+h[ie+N]]]]%32*4;s=(he*=he)*he*(d[de]*X+d[de+1]*Y+d[de+2]*Z+d[de+3]*K)}var pe=.6-J*J-Q*Q-$*$-ee*ee;if(pe<0)l=0;else{var fe=h[te+1+h[ne+1+h[re+1+h[ie+1]]]]%32*4;l=(pe*=pe)*pe*(d[fe]*J+d[fe+1]*Q+d[fe+2]*$+d[fe+3]*ee)}return 27*(i+a+o+s+l)}}]),e}();function f(e){for(var t=new Uint8Array(256),n=0;n<256;n++)t[n]=n;for(var r=0;r<255;r++){var i=r+~~(e()*(256-r)),a=t[r];t[r]=t[i],t[i]=a}return t}function m(e){var t,n=0,r=0,i=0,a=1,o=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});return n=o(" "),r=o(" "),i=o(" "),(n-=o(e))<0&&(n+=1),(r-=o(e))<0&&(r+=1),(i-=o(e))<0&&(i+=1),function(){var e=2091639*n+2.3283064365386963e-10*a;return n=r,r=i,i=e-(a=0|e)}}n.SimplexNoise=p,n.default=p,n.buildPermutationTable=f},{"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10}],59:[function(e,t,n){"use strict";var r,i,a=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof"));r=void 0,i=function(e){void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t});var t=100,n=300,r=301,i=302,o=303,s=304,l=306,u=307,c=1e3,h=1001,d=1002,p=1003,f=1004,m=1005,v=1006,g=1008,y=1009,x=1012,_=1014,b=1015,w=1016,M=1020,S=1022,T=1023,E=1026,A=1027,C=33776,L=33777,R=33778,P=33779,D=35840,I=35841,O=35842,z=35843,k=37492,F=37496,N=2300,B=2301,U=2302,G=2400,H=2401,j=2402,V=2500,W=2501,q=3e3,X=3001,Y=3007,Z=3002,K=7680,J=35044,Q=35048,$="300 es";function ee(){}Object.assign(ee.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});for(var te=[],ne=0;ne<256;ne++)te[ne]=(ne<16?"0":"")+ne.toString(16);var re=1234567,ie={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(te[255&e]+te[e>>8&255]+te[e>>16&255]+te[e>>24&255]+"-"+te[255&t]+te[t>>8&255]+"-"+te[t>>16&15|64]+te[t>>24&255]+"-"+te[63&n|128]+te[n>>8&255]+"-"+te[n>>16&255]+te[n>>24&255]+te[255&r]+te[r>>8&255]+te[r>>16&255]+te[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(re=e%2147483647),((re=16807*re%2147483647)-1)/2147483646},degToRad:function(e){return e*ie.DEG2RAD},radToDeg:function(e){return e*ie.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((t+r)/2),c=o((t+r)/2),h=a((t-r)/2),d=o((t-r)/2),p=a((r-t)/2),f=o((r-t)/2);switch(i){case"XYX":e.set(s*c,l*h,l*d,s*u);break;case"YZY":e.set(l*d,s*c,l*h,s*u);break;case"ZXZ":e.set(l*h,l*d,s*c,s*u);break;case"XZX":e.set(s*c,l*f,l*p,s*u);break;case"YXY":e.set(l*p,s*c,l*f,s*u);break;case"ZYZ":e.set(l*f,l*p,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e,t,n){return t&&ae(e.prototype,t),n&&ae(e,n),e}function se(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ue,ce=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=e,this.y=t}var t=e.prototype;return t.set=function(e,t){return this.x=e,this.y=t,this},t.setScalar=function(e){return this.x=e,this.y=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y)},t.copy=function(e){return this.x=e.x,this.y=e.y,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},t.multiply=function(e){return this.x*=e.x,this.y*=e.y,this},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this},t.divide=function(e){return this.x/=e.x,this.y/=e.y,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.applyMatrix3=function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.dot=function(e){return this.x*e.x+this.y*e.y},t.cross=function(e){return this.x*e.y-this.y*e.x},t.lengthSq=function(){return this.x*this.x+this.y*this.y},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.angle=function(){return Math.atan2(-this.y,-this.x)+Math.PI},t.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},t.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},t.manhattanDistanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this},t.equals=function(e){return e.x===this.x&&e.y===this.y},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},t.rotateAround=function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this},oe(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}}]),e}(),he=function(){function e(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var t=e.prototype;return t.set=function(e,t,n,r,i,a,o,s,l){var u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this},t.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.clone=function(){return(new this.constructor).fromArray(this.elements)},t.copy=function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},t.extractBasis=function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},t.setFromMatrix4=function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},t.multiply=function(e){return this.multiplyMatrices(this,e)},t.premultiply=function(e){return this.multiplyMatrices(e,this)},t.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],h=n[2],d=n[5],p=n[8],f=r[0],m=r[3],v=r[6],g=r[1],y=r[4],x=r[7],_=r[2],b=r[5],w=r[8];return i[0]=a*f+o*g+s*_,i[3]=a*m+o*y+s*b,i[6]=a*v+o*x+s*w,i[1]=l*f+u*g+c*_,i[4]=l*m+u*y+c*b,i[7]=l*v+u*x+c*w,i[2]=h*f+d*g+p*_,i[5]=h*m+d*y+p*b,i[8]=h*v+d*x+p*w,this},t.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},t.determinant=function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*i*u+n*o*s+r*i*l-r*a*s},t.getInverse=function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var n=e.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],h=n[7],d=n[8],p=d*l-u*h,f=u*c-d*s,m=h*s-l*c,v=i*p+a*f+o*m;if(0===v)return this.set(0,0,0,0,0,0,0,0,0);var g=1/v;return r[0]=p*g,r[1]=(o*h-d*a)*g,r[2]=(u*a-o*l)*g,r[3]=f*g,r[4]=(d*i-o*c)*g,r[5]=(o*s-u*i)*g,r[6]=m*g,r[7]=(a*c-h*i)*g,r[8]=(l*i-a*s)*g,this},t.transpose=function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},t.getNormalMatrix=function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},t.transposeIntoArray=function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},t.setUvTransform=function(e,t,n,r,i,a,o){var s=Math.cos(i),l=Math.sin(i);this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1)},t.scale=function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},t.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],l=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*l,r[6]=t*o+n*u,r[1]=-n*i+t*s,r[4]=-n*a+t*l,r[7]=-n*o+t*u,this},t.translate=function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},t.equals=function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e},e}(),de={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ue&&(ue=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ue.width=e.width,ue.height=e.height;var n=ue.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ue}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},pe=0;function fe(e,t,n,r,i,a,o,s,l,u){Object.defineProperty(this,"id",{value:pe++}),this.uuid=ie.generateUUID(),this.name="",this.image=void 0!==e?e:fe.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:fe.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:h,this.wrapT=void 0!==r?r:h,this.magFilter=void 0!==i?i:v,this.minFilter=void 0!==a?a:g,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:T,this.internalFormat=null,this.type=void 0!==s?s:y,this.offset=new ce(0,0),this.repeat=new ce(1,1),this.center=new ce(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new he,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:q,this.version=0,this.onUpdate=null}fe.DEFAULT_IMAGE=void 0,fe.DEFAULT_MAPPING=n,fe.prototype=Object.assign(Object.create(ee.prototype),{constructor:fe,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=ie.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)i.push(de.getDataURL(r[a]))}else i=de.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==n)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case c:e.x=e.x-Math.floor(e.x);break;case h:e.x=e.x<0?0:1;break;case d:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case c:e.y=e.y-Math.floor(e.y);break;case h:e.y=e.y<0?0:1;break;case d:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(fe.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var me=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=e,this.y=t,this.z=n,this.w=r}var t=e.prototype;return t.set=function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},t.setScalar=function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setZ=function(e){return this.z=e,this},t.setW=function(e){return this.w=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},t.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.setAxisAngleFromQuaternion=function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},t.setAxisAngleFromRotationMatrix=function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,l=s[0],u=s[4],c=s[8],h=s[1],d=s[5],p=s[9],f=s[2],m=s[6],v=s[10];if(Math.abs(u-h)<a&&Math.abs(c-f)<a&&Math.abs(p-m)<a){if(Math.abs(u+h)<o&&Math.abs(c+f)<o&&Math.abs(p+m)<o&&Math.abs(l+d+v-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var g=(l+1)/2,y=(d+1)/2,x=(v+1)/2,_=(u+h)/4,b=(c+f)/4,w=(p+m)/4;return g>y&&g>x?g<a?(n=0,r=.707106781,i=.707106781):(r=_/(n=Math.sqrt(g)),i=b/n):y>x?y<a?(n=.707106781,r=0,i=.707106781):(n=_/(r=Math.sqrt(y)),i=w/r):x<a?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(x)),r=w/i),this.set(n,r,i,t),this}var M=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(h-u)*(h-u));return Math.abs(M)<.001&&(M=1),this.x=(m-p)/M,this.y=(c-f)/M,this.z=(h-u)/M,this.w=Math.acos((l+d+v-1)/2),this},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this},t.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},oe(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}}]),e}();function ve(e,t,n){this.width=e,this.height=t,this.scissor=new me(0,0,e,t),this.scissorTest=!1,this.viewport=new me(0,0,e,t),n=n||{},this.texture=new fe(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:v,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function ge(e,t,n){ve.call(this,e,t,n),this.samples=4}ve.prototype=Object.assign(Object.create(ee.prototype),{constructor:ve,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),ge.prototype=Object.assign(Object.create(ve.prototype),{constructor:ge,isWebGLMultisampleRenderTarget:!0,copy:function(e){return ve.prototype.copy.call(this,e),this.samples=e.samples,this}});var ye=function(){function e(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=e,this._y=t,this._z=n,this._w=r}e.slerp=function(e,t,n,r){return n.copy(e).slerp(t,r)},e.slerpFlat=function(e,t,n,r,i,a,o){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],h=i[a+0],d=i[a+1],p=i[a+2],f=i[a+3];if(c!==f||s!==h||l!==d||u!==p){var m=1-o,v=s*h+l*d+u*p+c*f,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var x=Math.sqrt(y),_=Math.atan2(x,v*g);m=Math.sin(m*_)/x,o=Math.sin(o*_)/x}var b=o*g;if(s=s*m+h*b,l=l*m+d*b,u=u*m+p*b,c=c*m+f*b,m===1-o){var w=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=w,l*=w,u*=w,c*=w}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c},e.multiplyQuaternionsFlat=function(e,t,n,r,i,a){var o=n[r],s=n[r+1],l=n[r+2],u=n[r+3],c=i[a],h=i[a+1],d=i[a+2],p=i[a+3];return e[t]=o*p+u*c+s*d-l*h,e[t+1]=s*p+u*h+l*c-o*d,e[t+2]=l*p+u*d+o*h-s*c,e[t+3]=u*p-o*c-s*h-l*d,e};var t=e.prototype;return t.set=function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},t.copy=function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},t.setFromEuler=function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(r/2),c=o(i/2),h=s(n/2),d=s(r/2),p=s(i/2);switch(a){case"XYZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"YXZ":this._x=h*u*c+l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"ZXY":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c-h*d*p;break;case"ZYX":this._x=h*u*c-l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c+h*d*p;break;case"YZX":this._x=h*u*c+l*d*p,this._y=l*d*c+h*u*p,this._z=l*u*p-h*d*c,this._w=l*u*c-h*d*p;break;case"XZY":this._x=h*u*c-l*d*p,this._y=l*d*c-h*u*p,this._z=l*u*p+h*d*c,this._w=l*u*c+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this},t.setFromAxisAngle=function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},t.setFromRotationMatrix=function(e){var t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],u=t[6],c=t[10],h=n+o+c;if(h>0){var d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(u-s)*d,this._y=(i-l)*d,this._z=(a-r)*d}else if(n>o&&n>c){var p=2*Math.sqrt(1+n-o-c);this._w=(u-s)/p,this._x=.25*p,this._y=(r+a)/p,this._z=(i+l)/p}else if(o>c){var f=2*Math.sqrt(1+o-n-c);this._w=(i-l)/f,this._x=(r+a)/f,this._y=.25*f,this._z=(s+u)/f}else{var m=2*Math.sqrt(1+c-n-o);this._w=(a-r)/m,this._x=(i+l)/m,this._y=(s+u)/m,this._z=.25*m}return this._onChangeCallback(),this},t.setFromUnitVectors=function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},t.angleTo=function(e){return 2*Math.acos(Math.abs(ie.clamp(this.dot(e),-1,1)))},t.rotateTowards=function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},t.identity=function(){return this.set(0,0,0,1)},t.inverse=function(){return this.conjugate()},t.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},t.dot=function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},t.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.normalize=function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},t.premultiply=function(e){return this.multiplyQuaternions(e,this)},t.multiplyQuaternions=function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+r*l-i*s,this._y=r*u+a*s+i*o-n*l,this._z=i*u+a*l+n*s-r*o,this._w=a*u-n*o-r*s-i*l,this._onChangeCallback(),this},t.slerp=function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*n+t*this._x,this._y=l*r+t*this._y,this._z=l*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),c=Math.atan2(u,o),h=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=i*h+this._z*d,this._onChangeCallback(),this},t.equals=function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},t.fromArray=function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},t.fromBufferAttribute=function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},t._onChange=function(e){return this._onChangeCallback=e,this},t._onChangeCallback=function(){},oe(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}]),e}(),xe=function(){function e(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=t,this.z=n}var t=e.prototype;return t.set=function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this},t.setScalar=function(e){return this.x=e,this.y=e,this.z=e,this},t.setX=function(e){return this.x=e,this},t.setY=function(e){return this.y=e,this},t.setZ=function(e){return this.z=e,this},t.setComponent=function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},t.getComponent=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},t.clone=function(){return new this.constructor(this.x,this.y,this.z)},t.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},t.add=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},t.addScalar=function(e){return this.x+=e,this.y+=e,this.z+=e,this},t.addVectors=function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},t.addScaledVector=function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},t.sub=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},t.subScalar=function(e){return this.x-=e,this.y-=e,this.z-=e,this},t.subVectors=function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},t.multiplyScalar=function(e){return this.x*=e,this.y*=e,this.z*=e,this},t.multiplyVectors=function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},t.applyEuler=function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(be.setFromEuler(e))},t.applyAxisAngle=function(e,t){return this.applyQuaternion(be.setFromAxisAngle(e,t))},t.applyMatrix3=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},t.applyNormalMatrix=function(e){return this.applyMatrix3(e).normalize()},t.applyMatrix4=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this},t.applyQuaternion=function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*r-o*n,u=s*n+o*t-i*r,c=s*r+i*n-a*t,h=-i*t-a*n-o*r;return this.x=l*s+h*-i+u*-o-c*-a,this.y=u*s+h*-a+c*-i-l*-o,this.z=c*s+h*-o+l*-a-u*-i,this},t.project=function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},t.unproject=function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},t.transformDirection=function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},t.divide=function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},t.divideScalar=function(e){return this.multiplyScalar(1/e)},t.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},t.max=function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},t.clamp=function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},t.clampScalar=function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},t.clampLength=function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},t.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},t.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},t.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},t.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},t.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},t.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},t.normalize=function(){return this.divideScalar(this.length()||1)},t.setLength=function(e){return this.normalize().multiplyScalar(e)},t.lerp=function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},t.lerpVectors=function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this},t.cross=function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},t.crossVectors=function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},t.projectOnVector=function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},t.projectOnPlane=function(e){return _e.copy(this).projectOnVector(e),this.sub(_e)},t.reflect=function(e){return this.sub(_e.copy(e).multiplyScalar(2*this.dot(e)))},t.angleTo=function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(ie.clamp(n,-1,1))},t.distanceTo=function(e){return Math.sqrt(this.distanceToSquared(e))},t.distanceToSquared=function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},t.manhattanDistanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},t.setFromSpherical=function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},t.setFromSphericalCoords=function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},t.setFromCylindrical=function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},t.setFromCylindricalCoords=function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},t.setFromMatrixPosition=function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},t.setFromMatrixScale=function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},t.setFromMatrixColumn=function(e,t){return this.fromArray(e.elements,4*t)},t.setFromMatrix3Column=function(e,t){return this.fromArray(e.elements,3*t)},t.equals=function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},t.fromArray=function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},t.fromBufferAttribute=function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},t.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}(),_e=new xe,be=new ye,we=function(){function e(e,t){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==e?e:new xe(1/0,1/0,1/0),this.max=void 0!==t?t:new xe(-1/0,-1/0,-1/0)}var t=e.prototype;return t.set=function(e,t){return this.min.copy(e),this.max.copy(t),this},t.setFromArray=function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],h=e[s+2];u<t&&(t=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this},t.setFromBufferAttribute=function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),h=e.getZ(s);u<t&&(t=u),c<n&&(n=c),h<r&&(r=h),u>i&&(i=u),c>a&&(a=c),h>o&&(o=h)}return this.min.set(t,n,r),this.max.set(i,a,o),this},t.setFromPoints=function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},t.setFromCenterAndSize=function(e,t){var n=Te.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},t.setFromObject=function(e){return this.makeEmpty(),this.expandByObject(e)},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.min.copy(e.min),this.max.copy(e.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new xe),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new xe),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},t.expandByPoint=function(e){return this.min.min(e),this.max.max(e),this},t.expandByVector=function(e){return this.min.sub(e),this.max.add(e),this},t.expandByScalar=function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},t.expandByObject=function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),Ee.copy(t.boundingBox),Ee.applyMatrix4(e.matrixWorld),this.union(Ee));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},t.containsPoint=function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},t.containsBox=function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},t.getParameter=function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new xe),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},t.intersectsBox=function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},t.intersectsSphere=function(e){return this.clampPoint(e.center,Te),Te.distanceToSquared(e.center)<=e.radius*e.radius},t.intersectsPlane=function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},t.intersectsTriangle=function(e){if(this.isEmpty())return!1;this.getCenter(Ie),Oe.subVectors(this.max,Ie),Ae.subVectors(e.a,Ie),Ce.subVectors(e.b,Ie),Le.subVectors(e.c,Ie),Re.subVectors(Ce,Ae),Pe.subVectors(Le,Ce),De.subVectors(Ae,Le);var t=[0,-Re.z,Re.y,0,-Pe.z,Pe.y,0,-De.z,De.y,Re.z,0,-Re.x,Pe.z,0,-Pe.x,De.z,0,-De.x,-Re.y,Re.x,0,-Pe.y,Pe.x,0,-De.y,De.x,0];return!!Me(t,Ae,Ce,Le,Oe)&&!!Me(t=[1,0,0,0,1,0,0,0,1],Ae,Ce,Le,Oe)&&(ze.crossVectors(Re,Pe),Me(t=[ze.x,ze.y,ze.z],Ae,Ce,Le,Oe))},t.clampPoint=function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new xe),t.copy(e).clamp(this.min,this.max)},t.distanceToPoint=function(e){return Te.copy(e).clamp(this.min,this.max).sub(e).length()},t.getBoundingSphere=function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Te).length(),e},t.intersect=function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},t.union=function(e){return this.min.min(e.min),this.max.max(e.max),this},t.applyMatrix4=function(e){return this.isEmpty()||(Se[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Se[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Se[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Se[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Se[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Se[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Se[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Se[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Se)),this},t.translate=function(e){return this.min.add(e),this.max.add(e),this},t.equals=function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},e}();function Me(e,t,n,r,i){for(var a=0,o=e.length-3;a<=o;a+=3){ke.fromArray(e,a);var s=i.x*Math.abs(ke.x)+i.y*Math.abs(ke.y)+i.z*Math.abs(ke.z),l=t.dot(ke),u=n.dot(ke),c=r.dot(ke);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}var Se=[new xe,new xe,new xe,new xe,new xe,new xe,new xe,new xe],Te=new xe,Ee=new we,Ae=new xe,Ce=new xe,Le=new xe,Re=new xe,Pe=new xe,De=new xe,Ie=new xe,Oe=new xe,ze=new xe,ke=new xe,Fe=new we,Ne=function(){function e(e,t){this.center=void 0!==e?e:new xe,this.radius=void 0!==t?t:-1}var t=e.prototype;return t.set=function(e,t){return this.center.copy(e),this.radius=t,this},t.setFromPoints=function(e,t){var n=this.center;void 0!==t?n.copy(t):Fe.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.center.copy(e.center),this.radius=e.radius,this},t.isEmpty=function(){return this.radius<0},t.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},t.containsPoint=function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},t.distanceToPoint=function(e){return e.distanceTo(this.center)-this.radius},t.intersectsSphere=function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},t.intersectsBox=function(e){return e.intersectsSphere(this)},t.intersectsPlane=function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},t.clampPoint=function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new xe),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},t.getBoundingBox=function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new we),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},t.applyMatrix4=function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},t.translate=function(e){return this.center.add(e),this},t.equals=function(e){return e.center.equals(this.center)&&e.radius===this.radius},e}(),Be=new xe,Ue=new xe,Ge=new xe,He=new xe,je=new xe,Ve=new xe,We=new xe,qe=function(){function e(e,t){this.origin=void 0!==e?e:new xe,this.direction=void 0!==t?t:new xe(0,0,-1)}var t=e.prototype;return t.set=function(e,t){return this.origin.copy(e),this.direction.copy(t),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},t.at=function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new xe),t.copy(this.direction).multiplyScalar(e).add(this.origin)},t.lookAt=function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},t.recast=function(e){return this.origin.copy(this.at(e,Be)),this},t.closestPointToPoint=function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new xe),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},t.distanceToPoint=function(e){return Math.sqrt(this.distanceSqToPoint(e))},t.distanceSqToPoint=function(e){var t=Be.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Be.copy(this.direction).multiplyScalar(t).add(this.origin),Be.distanceToSquared(e))},t.distanceSqToSegment=function(e,t,n,r){Ue.copy(e).add(t).multiplyScalar(.5),Ge.copy(t).sub(e).normalize(),He.copy(this.origin).sub(Ue);var i,a,o,s,l=.5*e.distanceTo(t),u=-this.direction.dot(Ge),c=He.dot(this.direction),h=-He.dot(Ge),d=He.lengthSq(),p=Math.abs(1-u*u);if(p>0)if(a=u*c-h,s=l*p,(i=u*h-c)>=0)if(a>=-s)if(a<=s){var f=1/p;o=(i*=f)*(i+u*(a*=f)+2*c)+a*(u*i+a+2*h)+d}else a=l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a=-l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;else a<=-s?o=-(i=Math.max(0,-(-u*l+c)))*i+(a=i>0?-l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d:a<=s?(i=0,o=(a=Math.min(Math.max(-l,-h),l))*(a+2*h)+d):o=-(i=Math.max(0,-(u*l+c)))*i+(a=i>0?l:Math.min(Math.max(-l,-h),l))*(a+2*h)+d;else a=u>0?-l:l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Ge).multiplyScalar(a).add(Ue),o},t.intersectSphere=function(e,t){Be.subVectors(e.center,this.origin);var n=Be.dot(this.direction),r=Be.dot(Be)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)},t.intersectsSphere=function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},t.distanceToPlane=function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},t.intersectPlane=function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},t.intersectsPlane=function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},t.intersectBox=function(e,t){var n,r,i,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(i=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),c>=0?(o=(e.min.z-h.z)*c,s=(e.max.z-h.z)*c):(o=(e.max.z-h.z)*c,s=(e.min.z-h.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},t.intersectsBox=function(e){return null!==this.intersectBox(e,Be)},t.intersectTriangle=function(e,t,n,r,i){je.subVectors(t,e),Ve.subVectors(n,e),We.crossVectors(je,Ve);var a,o=this.direction.dot(We);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}He.subVectors(this.origin,e);var s=a*this.direction.dot(Ve.crossVectors(He,Ve));if(s<0)return null;var l=a*this.direction.dot(je.cross(He));if(l<0)return null;if(s+l>o)return null;var u=-a*He.dot(We);return u<0?null:this.at(u/o,i)},t.applyMatrix4=function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},t.equals=function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},e}(),Xe=function(){function e(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var t=e.prototype;return t.set=function(e,t,n,r,i,a,o,s,l,u,c,h,d,p,f,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=a,v[9]=o,v[13]=s,v[2]=l,v[6]=u,v[10]=c,v[14]=h,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this},t.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.clone=function(){return(new e).fromArray(this.elements)},t.copy=function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},t.copyPosition=function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},t.extractBasis=function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},t.makeBasis=function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},t.extractRotation=function(e){var t=this.elements,n=e.elements,r=1/Ye.setFromMatrixColumn(e,0).length(),i=1/Ye.setFromMatrixColumn(e,1).length(),a=1/Ye.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},t.makeRotationFromEuler=function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var h=a*u,d=a*c,p=o*u,f=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-o*s,t[2]=f-h*l,t[6]=p+d*l,t[10]=a*s}else if("YXZ"===e.order){var m=s*u,v=s*c,g=l*u,y=l*c;t[0]=m+y*o,t[4]=g*o-v,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=v*o-g,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){var x=s*u,_=s*c,b=l*u,w=l*c;t[0]=x-w*o,t[4]=-a*c,t[8]=b+_*o,t[1]=_+b*o,t[5]=a*u,t[9]=w-x*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){var M=a*u,S=a*c,T=o*u,E=o*c;t[0]=s*u,t[4]=T*l-S,t[8]=M*l+E,t[1]=s*c,t[5]=E*l+M,t[9]=S*l-T,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var A=a*s,C=a*l,L=o*s,R=o*l;t[0]=s*u,t[4]=R-A*c,t[8]=L*c+C,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=C*c+L,t[10]=A-R*c}else if("XZY"===e.order){var P=a*s,D=a*l,I=o*s,O=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=P*c+O,t[5]=a*u,t[9]=D*c-I,t[2]=I*c-D,t[6]=o*u,t[10]=O*c+P}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},t.makeRotationFromQuaternion=function(e){return this.compose(Ke,e,Je)},t.lookAt=function(e,t,n){var r=this.elements;return et.subVectors(e,t),0===et.lengthSq()&&(et.z=1),et.normalize(),Qe.crossVectors(n,et),0===Qe.lengthSq()&&(1===Math.abs(n.z)?et.x+=1e-4:et.z+=1e-4,et.normalize(),Qe.crossVectors(n,et)),Qe.normalize(),$e.crossVectors(et,Qe),r[0]=Qe.x,r[4]=$e.x,r[8]=et.x,r[1]=Qe.y,r[5]=$e.y,r[9]=et.y,r[2]=Qe.z,r[6]=$e.z,r[10]=et.z,this},t.multiply=function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},t.premultiply=function(e){return this.multiplyMatrices(e,this)},t.multiplyMatrices=function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],v=n[14],g=n[3],y=n[7],x=n[11],_=n[15],b=r[0],w=r[4],M=r[8],S=r[12],T=r[1],E=r[5],A=r[9],C=r[13],L=r[2],R=r[6],P=r[10],D=r[14],I=r[3],O=r[7],z=r[11],k=r[15];return i[0]=a*b+o*T+s*L+l*I,i[4]=a*w+o*E+s*R+l*O,i[8]=a*M+o*A+s*P+l*z,i[12]=a*S+o*C+s*D+l*k,i[1]=u*b+c*T+h*L+d*I,i[5]=u*w+c*E+h*R+d*O,i[9]=u*M+c*A+h*P+d*z,i[13]=u*S+c*C+h*D+d*k,i[2]=p*b+f*T+m*L+v*I,i[6]=p*w+f*E+m*R+v*O,i[10]=p*M+f*A+m*P+v*z,i[14]=p*S+f*C+m*D+v*k,i[3]=g*b+y*T+x*L+_*I,i[7]=g*w+y*E+x*R+_*O,i[11]=g*M+y*A+x*P+_*z,i[15]=g*S+y*C+x*D+_*k,this},t.multiplyScalar=function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},t.determinant=function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],h=e[10],d=e[14];return e[3]*(+i*s*c-r*l*c-i*o*h+n*l*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*a*h-r*a*d+r*l*u-i*s*u)+e[11]*(+t*l*c-t*o*d-i*a*c+n*a*d+i*o*u-n*l*u)+e[15]*(-r*o*u-t*s*c+t*o*h+r*a*c-n*a*h+n*s*u)},t.transpose=function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},t.setPosition=function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},t.getInverse=function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var n=this.elements,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],h=r[7],d=r[8],p=r[9],f=r[10],m=r[11],v=r[12],g=r[13],y=r[14],x=r[15],_=p*y*h-g*f*h+g*c*m-u*y*m-p*c*x+u*f*x,b=v*f*h-d*y*h-v*c*m+l*y*m+d*c*x-l*f*x,w=d*g*h-v*p*h+v*u*m-l*g*m-d*u*x+l*p*x,M=v*p*c-d*g*c-v*u*f+l*g*f+d*u*y-l*p*y,S=i*_+a*b+o*w+s*M;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var T=1/S;return n[0]=_*T,n[1]=(g*f*s-p*y*s-g*o*m+a*y*m+p*o*x-a*f*x)*T,n[2]=(u*y*s-g*c*s+g*o*h-a*y*h-u*o*x+a*c*x)*T,n[3]=(p*c*s-u*f*s-p*o*h+a*f*h+u*o*m-a*c*m)*T,n[4]=b*T,n[5]=(d*y*s-v*f*s+v*o*m-i*y*m-d*o*x+i*f*x)*T,n[6]=(v*c*s-l*y*s-v*o*h+i*y*h+l*o*x-i*c*x)*T,n[7]=(l*f*s-d*c*s+d*o*h-i*f*h-l*o*m+i*c*m)*T,n[8]=w*T,n[9]=(v*p*s-d*g*s-v*a*m+i*g*m+d*a*x-i*p*x)*T,n[10]=(l*g*s-v*u*s+v*a*h-i*g*h-l*a*x+i*u*x)*T,n[11]=(d*u*s-l*p*s-d*a*h+i*p*h+l*a*m-i*u*m)*T,n[12]=M*T,n[13]=(d*g*o-v*p*o+v*a*f-i*g*f-d*a*y+i*p*y)*T,n[14]=(v*u*o-l*g*o-v*a*c+i*g*c+l*a*y-i*u*y)*T,n[15]=(l*p*o-d*u*o+d*a*c-i*p*c-l*a*f+i*u*f)*T,this},t.scale=function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},t.getMaxScaleOnAxis=function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},t.makeTranslation=function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},t.makeRotationX=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},t.makeRotationY=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},t.makeRotationZ=function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},t.makeRotationAxis=function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,u=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,u*o+n,u*s-r*a,0,l*s-r*o,u*s+r*a,i*s*s+n,0,0,0,0,1),this},t.makeScale=function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},t.makeShear=function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},t.compose=function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,u=a+a,c=o+o,h=i*l,d=i*u,p=i*c,f=a*u,m=a*c,v=o*c,g=s*l,y=s*u,x=s*c,_=n.x,b=n.y,w=n.z;return r[0]=(1-(f+v))*_,r[1]=(d+x)*_,r[2]=(p-y)*_,r[3]=0,r[4]=(d-x)*b,r[5]=(1-(h+v))*b,r[6]=(m+g)*b,r[7]=0,r[8]=(p+y)*w,r[9]=(m-g)*w,r[10]=(1-(h+f))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},t.decompose=function(e,t,n){var r=this.elements,i=Ye.set(r[0],r[1],r[2]).length(),a=Ye.set(r[4],r[5],r[6]).length(),o=Ye.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Ze.copy(this);var s=1/i,l=1/a,u=1/o;return Ze.elements[0]*=s,Ze.elements[1]*=s,Ze.elements[2]*=s,Ze.elements[4]*=l,Ze.elements[5]*=l,Ze.elements[6]*=l,Ze.elements[8]*=u,Ze.elements[9]*=u,Ze.elements[10]*=u,t.setFromRotationMatrix(Ze),n.x=i,n.y=a,n.z=o,this},t.makePerspective=function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),l=2*i/(n-r),u=(t+e)/(t-e),c=(n+r)/(n-r),h=-(a+i)/(a-i),d=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},t.makeOrthographic=function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),l=1/(n-r),u=1/(a-i),c=(t+e)*s,h=(n+r)*l,d=(a+i)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},t.equals=function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},e}(),Ye=new xe,Ze=new Xe,Ke=new xe(0,0,0),Je=new xe(1,1,1),Qe=new xe,$e=new xe,et=new xe,tt=function(){function e(t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=e.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=n,this._z=r,this._order=i}var t=e.prototype;return t.set=function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},t.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},t.copy=function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},t.setFromRotationMatrix=function(e,t,n){var r=ie.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],l=i[1],u=i[5],c=i[9],h=i[2],d=i[6],p=i[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,a),this._z=0);break;case"ZXY":this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,p));break;case"XZY":this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this},t.setFromQuaternion=function(e,t,n){return nt.makeRotationFromQuaternion(e),this.setFromRotationMatrix(nt,t,n)},t.setFromVector3=function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},t.reorder=function(e){return rt.setFromEuler(this),this.setFromQuaternion(rt,e)},t.equals=function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},t.fromArray=function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},t.toVector3=function(e){return e?e.set(this._x,this._y,this._z):new xe(this._x,this._y,this._z)},t._onChange=function(e){return this._onChangeCallback=e,this},t._onChangeCallback=function(){},oe(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}]),e}();tt.DefaultOrder="XYZ",tt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var nt=new Xe,rt=new ye,it=function(){function e(){this.mask=1}var t=e.prototype;return t.set=function(e){this.mask=1<<e|0},t.enable=function(e){this.mask|=1<<e|0},t.enableAll=function(){this.mask=-1},t.toggle=function(e){this.mask^=1<<e|0},t.disable=function(e){this.mask&=~(1<<e|0)},t.disableAll=function(){this.mask=0},t.test=function(e){return 0!=(this.mask&e.mask)},e}(),at=0,ot=new xe,st=new ye,lt=new Xe,ut=new xe,ct=new xe,ht=new xe,dt=new ye,pt=new xe(1,0,0),ft=new xe(0,1,0),mt=new xe(0,0,1),vt={type:"added"},gt={type:"removed"};function yt(){Object.defineProperty(this,"id",{value:at++}),this.uuid=ie.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=yt.DefaultUp.clone();var e=new xe,t=new tt,n=new ye,r=new xe(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Xe},normalMatrix:{value:new he}}),this.matrix=new Xe,this.matrixWorld=new Xe,this.matrixAutoUpdate=yt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new it,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}yt.DefaultUp=new xe(0,1,0),yt.DefaultMatrixAutoUpdate=!0,yt.prototype=Object.assign(Object.create(ee.prototype),{constructor:yt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return st.setFromAxisAngle(e,t),this.quaternion.multiply(st),this},rotateOnWorldAxis:function(e,t){return st.setFromAxisAngle(e,t),this.quaternion.premultiply(st),this},rotateX:function(e){return this.rotateOnAxis(pt,e)},rotateY:function(e){return this.rotateOnAxis(ft,e)},rotateZ:function(e){return this.rotateOnAxis(mt,e)},translateOnAxis:function(e,t){return ot.copy(e).applyQuaternion(this.quaternion),this.position.add(ot.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(pt,e)},translateY:function(e){return this.translateOnAxis(ft,e)},translateZ:function(e){return this.translateOnAxis(mt,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(lt.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?ut.copy(e):ut.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),ct.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?lt.lookAt(ct,ut,this.up):lt.lookAt(ut,ct,this.up),this.quaternion.setFromRotationMatrix(lt),r&&(lt.extractRotation(r.matrixWorld),st.setFromRotationMatrix(lt),this.quaternion.premultiply(st.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(vt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(gt)),this},clear:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(gt)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),lt.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),lt.multiply(e.parent.matrixWorld)),e.applyMatrix4(lt),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new xe),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new ye),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ct,e,ht),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new xe),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ct,dt,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new xe),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];i(e.shapes,u)}else i(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){for(var c=[],h=0,d=this.material.length;h<d;h++)c.push(i(e.materials,this.material[h]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(var p=0;p<this.children.length;p++)r.children.push(this.children[p].toJSON(e).object)}if(t){var f=x(e.geometries),m=x(e.materials),v=x(e.textures),g=x(e.images),y=x(e.shapes);f.length>0&&(n.geometries=f),m.length>0&&(n.materials=m),v.length>0&&(n.textures=v),g.length>0&&(n.images=g),y.length>0&&(n.shapes=y)}return n.object=r,n;function x(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var xt=new xe,_t=new xe,bt=new he,wt=function(){function e(e,t){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==e?e:new xe(1,0,0),this.constant=void 0!==t?t:0}var t=e.prototype;return t.set=function(e,t){return this.normal.copy(e),this.constant=t,this},t.setComponents=function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},t.setFromNormalAndCoplanarPoint=function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},t.setFromCoplanarPoints=function(e,t,n){var r=xt.subVectors(n,t).cross(_t.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},t.normalize=function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},t.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.distanceToPoint=function(e){return this.normal.dot(e)+this.constant},t.distanceToSphere=function(e){return this.distanceToPoint(e.center)-e.radius},t.projectPoint=function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new xe),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},t.intersectLine=function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new xe);var n=e.delta(xt),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:t.copy(n).multiplyScalar(i).add(e.start)},t.intersectsLine=function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},t.intersectsBox=function(e){return e.intersectsPlane(this)},t.intersectsSphere=function(e){return e.intersectsPlane(this)},t.coplanarPoint=function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new xe),e.copy(this.normal).multiplyScalar(-this.constant)},t.applyMatrix4=function(e,t){var n=t||bt.getNormalMatrix(e),r=this.coplanarPoint(xt).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},t.translate=function(e){return this.constant-=e.dot(this.normal),this},t.equals=function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},e}(),Mt=new xe,St=new xe,Tt=new xe,Et=new xe,At=new xe,Ct=new xe,Lt=new xe,Rt=new xe,Pt=new xe,Dt=new xe,It=function(){function e(e,t,n){this.a=void 0!==e?e:new xe,this.b=void 0!==t?t:new xe,this.c=void 0!==n?n:new xe}e.getNormal=function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new xe),r.subVectors(n,t),Mt.subVectors(e,t),r.cross(Mt);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},e.getBarycoord=function(e,t,n,r,i){Mt.subVectors(r,t),St.subVectors(n,t),Tt.subVectors(e,t);var a=Mt.dot(Mt),o=Mt.dot(St),s=Mt.dot(Tt),l=St.dot(St),u=St.dot(Tt),c=a*l-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new xe),0===c)return i.set(-2,-1,-1);var h=1/c,d=(l*s-o*u)*h,p=(a*u-o*s)*h;return i.set(1-d-p,p,d)},e.containsPoint=function(e,t,n,r){return this.getBarycoord(e,t,n,r,Et),Et.x>=0&&Et.y>=0&&Et.x+Et.y<=1},e.getUV=function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,Et),s.set(0,0),s.addScaledVector(i,Et.x),s.addScaledVector(a,Et.y),s.addScaledVector(o,Et.z),s},e.isFrontFacing=function(e,t,n,r){return Mt.subVectors(n,t),St.subVectors(e,t),Mt.cross(St).dot(r)<0};var t=e.prototype;return t.set=function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},t.setFromPointsAndIndices=function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},t.getArea=function(){return Mt.subVectors(this.c,this.b),St.subVectors(this.a,this.b),.5*Mt.cross(St).length()},t.getMidpoint=function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new xe),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},t.getPlane=function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new wt),e.setFromCoplanarPoints(this.a,this.b,this.c)},t.getBarycoord=function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)},t.getUV=function(t,n,r,i,a){return e.getUV(t,this.a,this.b,this.c,n,r,i,a)},t.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},t.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},t.intersectsBox=function(e){return e.intersectsTriangle(this)},t.closestPointToPoint=function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new xe);var n,r,i=this.a,a=this.b,o=this.c;At.subVectors(a,i),Ct.subVectors(o,i),Rt.subVectors(e,i);var s=At.dot(Rt),l=Ct.dot(Rt);if(s<=0&&l<=0)return t.copy(i);Pt.subVectors(e,a);var u=At.dot(Pt),c=Ct.dot(Pt);if(u>=0&&c<=u)return t.copy(a);var h=s*c-u*l;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(At,n);Dt.subVectors(e,o);var d=At.dot(Dt),p=Ct.dot(Dt);if(p>=0&&d<=p)return t.copy(o);var f=d*l-s*p;if(f<=0&&l>=0&&p<=0)return r=l/(l-p),t.copy(i).addScaledVector(Ct,r);var m=u*p-d*c;if(m<=0&&c-u>=0&&d-p>=0)return Lt.subVectors(o,a),r=(c-u)/(c-u+(d-p)),t.copy(a).addScaledVector(Lt,r);var v=1/(m+f+h);return n=f*v,r=h*v,t.copy(i).addScaledVector(At,n).addScaledVector(Ct,r)},t.equals=function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},e}(),Ot={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zt={h:0,s:0,l:0},kt={h:0,s:0,l:0};function Ft(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Nt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Bt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Ut=function(){function e(e,t,n){return Object.defineProperty(this,"isColor",{value:!0}),void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}var t=e.prototype;return t.set=function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},t.setScalar=function(e){return this.r=e,this.g=e,this.b=e,this},t.setHex=function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},t.setRGB=function(e,t,n){return this.r=e,this.g=t,this.b=n,this},t.setHSL=function(e,t,n){if(e=ie.euclideanModulo(e,1),t=ie.clamp(t,0,1),n=ie.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Ft(i,r,e+1/3),this.g=Ft(i,r,e),this.b=Ft(i,r,e-1/3)}return this},t.setStyle=function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(o,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u=n[1],c=u.length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},t.setColorName=function(e){var t=Ot[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},t.clone=function(){return new this.constructor(this.r,this.g,this.b)},t.copy=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},t.copyGammaToLinear=function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},t.copyLinearToGamma=function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},t.convertGammaToLinear=function(e){return this.copyGammaToLinear(this,e),this},t.convertLinearToGamma=function(e){return this.copyLinearToGamma(this,e),this},t.copySRGBToLinear=function(e){return this.r=Nt(e.r),this.g=Nt(e.g),this.b=Nt(e.b),this},t.copyLinearToSRGB=function(e){return this.r=Bt(e.r),this.g=Bt(e.g),this.b=Bt(e.b),this},t.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},t.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.getHSL=function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),l=(s+o)/2;if(s===o)t=0,n=0;else{var u=o-s;switch(n=l<=.5?u/(o+s):u/(2-o-s),o){case r:t=(i-a)/u+(i<a?6:0);break;case i:t=(a-r)/u+2;break;case a:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=l,e},t.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},t.offsetHSL=function(e,t,n){return this.getHSL(zt),zt.h+=e,zt.s+=t,zt.l+=n,this.setHSL(zt.h,zt.s,zt.l),this},t.add=function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},t.addColors=function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},t.addScalar=function(e){return this.r+=e,this.g+=e,this.b+=e,this},t.sub=function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},t.multiply=function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},t.multiplyScalar=function(e){return this.r*=e,this.g*=e,this.b*=e,this},t.lerp=function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},t.lerpHSL=function(e,t){this.getHSL(zt),e.getHSL(kt);var n=ie.lerp(zt.h,kt.h,t),r=ie.lerp(zt.s,kt.s,t),i=ie.lerp(zt.l,kt.l,t);return this.setHSL(n,r,i),this},t.equals=function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},t.fromArray=function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},t.toArray=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},t.fromBufferAttribute=function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},t.toJSON=function(){return this.getHex()},e}();Ut.NAMES=Ot,Ut.prototype.r=1,Ut.prototype.g=1,Ut.prototype.b=1;var Gt=function(){function e(e,t,n,r,i,a){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new xe,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Ut,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}var t=e.prototype;return t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var r=0,i=e.vertexColors.length;r<i;r++)this.vertexColors[r]=e.vertexColors[r].clone();return this},e}(),Ht=0;function jt(){Object.defineProperty(this,"id",{value:Ht++}),this.uuid=ie.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=t,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=K,this.stencilZFail=K,this.stencilZPass=K,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Vt(e){jt.call(this),this.type="MeshBasicMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}jt.prototype=Object.assign(Object.create(ee.prototype),{constructor:jt,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(jt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Vt.prototype=Object.create(jt.prototype),Vt.prototype.constructor=Vt,Vt.prototype.isMeshBasicMaterial=!0,Vt.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Wt=new xe,qt=new ce;function Xt(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=J,this.updateRange={offset:0,count:-1},this.version=0}function Yt(e,t,n){Xt.call(this,new Int8Array(e),t,n)}function Zt(e,t,n){Xt.call(this,new Uint8Array(e),t,n)}function Kt(e,t,n){Xt.call(this,new Uint8ClampedArray(e),t,n)}function Jt(e,t,n){Xt.call(this,new Int16Array(e),t,n)}function Qt(e,t,n){Xt.call(this,new Uint16Array(e),t,n)}function $t(e,t,n){Xt.call(this,new Int32Array(e),t,n)}function en(e,t,n){Xt.call(this,new Uint32Array(e),t,n)}function tn(e,t,n){Xt.call(this,new Float32Array(e),t,n)}function nn(e,t,n){Xt.call(this,new Float64Array(e),t,n)}Object.defineProperty(Xt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Xt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new Ut),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new ce),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new xe),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new me),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)qt.fromBufferAttribute(this,t),qt.applyMatrix3(e),this.setXY(t,qt.x,qt.y);else if(3===this.itemSize)for(var r=0,i=this.count;r<i;r++)Wt.fromBufferAttribute(this,r),Wt.applyMatrix3(e),this.setXYZ(r,Wt.x,Wt.y,Wt.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)Wt.x=this.getX(t),Wt.y=this.getY(t),Wt.z=this.getZ(t),Wt.applyMatrix4(e),this.setXYZ(t,Wt.x,Wt.y,Wt.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)Wt.x=this.getX(t),Wt.y=this.getY(t),Wt.z=this.getZ(t),Wt.applyNormalMatrix(e),this.setXYZ(t,Wt.x,Wt.y,Wt.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)Wt.x=this.getX(t),Wt.y=this.getY(t),Wt.z=this.getZ(t),Wt.transformDirection(e),this.setXYZ(t,Wt.x,Wt.y,Wt.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Yt.prototype=Object.create(Xt.prototype),Yt.prototype.constructor=Yt,Zt.prototype=Object.create(Xt.prototype),Zt.prototype.constructor=Zt,Kt.prototype=Object.create(Xt.prototype),Kt.prototype.constructor=Kt,Jt.prototype=Object.create(Xt.prototype),Jt.prototype.constructor=Jt,Qt.prototype=Object.create(Xt.prototype),Qt.prototype.constructor=Qt,$t.prototype=Object.create(Xt.prototype),$t.prototype.constructor=$t,en.prototype=Object.create(Xt.prototype),en.prototype.constructor=en,tn.prototype=Object.create(Xt.prototype),tn.prototype.constructor=tn,nn.prototype=Object.create(Xt.prototype),nn.prototype.constructor=nn;var rn=function(){function e(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}var t=e.prototype;return t.computeGroups=function(e){var t,n,r=[],i=void 0,a=e.faces;for(n=0;n<a.length;n++){var o=a[n];o.materialIndex!==i&&(i=o.materialIndex,void 0!==t&&(t.count=3*n-t.start,r.push(t)),t={start:3*n,materialIndex:i})}void 0!==t&&(t.count=3*n-t.start,r.push(t)),this.groups=r},t.fromGeometry=function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=e.morphTargets,l=s.length;if(l>0){t=[];for(var u=0;u<l;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var c,h=e.morphNormals,d=h.length;if(d>0){c=[];for(var p=0;p<d;p++)c[p]={name:h[p].name,data:[]};this.morphTargets.normal=c}var f=e.skinIndices,m=e.skinWeights,v=f.length===r.length,g=m.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var y=0;y<n.length;y++){var x=n[y];this.vertices.push(r[x.a],r[x.b],r[x.c]);var _=x.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var b=x.normal;this.normals.push(b,b,b)}var w=x.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var M=x.color;this.colors.push(M,M,M)}if(!0===a){var S=i[0][y];void 0!==S?this.uvs.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",y),this.uvs.push(new ce,new ce,new ce))}if(!0===o){var T=i[1][y];void 0!==T?this.uvs2.push(T[0],T[1],T[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",y),this.uvs2.push(new ce,new ce,new ce))}for(var E=0;E<l;E++){var A=s[E].vertices;t[E].data.push(A[x.a],A[x.b],A[x.c])}for(var C=0;C<d;C++){var L=h[C].vertexNormals[y];c[C].data.push(L.a,L.b,L.c)}v&&this.skinIndices.push(f[x.a],f[x.b],f[x.c]),g&&this.skinWeights.push(m[x.a],m[x.b],m[x.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},e}();function an(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}var on=1,sn=new Xe,ln=new yt,un=new xe,cn=new we,hn=new we,dn=new xe;function pn(){Object.defineProperty(this,"id",{value:on+=2}),this.uuid=ie.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}pn.prototype=Object.assign(Object.create(ee.prototype),{constructor:pn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(an(e)>65535?en:Qt)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new he).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return sn.makeRotationX(e),this.applyMatrix4(sn),this},rotateY:function(e){return sn.makeRotationY(e),this.applyMatrix4(sn),this},rotateZ:function(e){return sn.makeRotationZ(e),this.applyMatrix4(sn),this},translate:function(e,t,n){return sn.makeTranslation(e,t,n),this.applyMatrix4(sn),this},scale:function(e,t,n){return sn.makeScale(e,t,n),this.applyMatrix4(sn),this},lookAt:function(e){return ln.lookAt(e),ln.updateMatrix(),this.applyMatrix4(ln.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(un).negate(),this.translate(un.x,un.y,un.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new tn(3*t.vertices.length,3),r=new tn(3*t.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(t.vertices)),this.setAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new tn(t.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new tn(t,3)),this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var n=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(n=void 0,t.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(t);n.verticesNeedUpdate=t.verticesNeedUpdate,n.normalsNeedUpdate=t.normalsNeedUpdate,n.colorsNeedUpdate=t.colorsNeedUpdate,n.uvsNeedUpdate=t.uvsNeedUpdate,n.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=n}if(!0===t.verticesNeedUpdate){var r=this.attributes.position;void 0!==r&&(r.copyVector3sArray(t.vertices),r.needsUpdate=!0),t.verticesNeedUpdate=!1}if(!0===t.normalsNeedUpdate){var i=this.attributes.normal;void 0!==i&&(i.copyVector3sArray(t.normals),i.needsUpdate=!0),t.normalsNeedUpdate=!1}if(!0===t.colorsNeedUpdate){var a=this.attributes.color;void 0!==a&&(a.copyColorsArray(t.colors),a.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.uvsNeedUpdate){var o=this.attributes.uv;void 0!==o&&(o.copyVector2sArray(t.uvs),o.needsUpdate=!0),t.uvsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){var s=this.attributes.lineDistance;void 0!==s&&(s.copyArray(t.lineDistances),s.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new rn).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new Xt(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.setAttribute("normal",new Xt(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.setAttribute("color",new Xt(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new Xt(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new Xt(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[o],u=0,c=l.length;u<c;u++){var h=l[u],d=new tn(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var p=new tn(4*e.skinIndices.length,4);this.setAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var f=new tn(4*e.skinWeights.length,4);this.setAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new we);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new xe(-1/0,-1/0,-1/0),new xe(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];cn.setFromBufferAttribute(i),this.morphTargetsRelative?(dn.addVectors(this.boundingBox.min,cn.min),this.boundingBox.expandByPoint(dn),dn.addVectors(this.boundingBox.max,cn.max),this.boundingBox.expandByPoint(dn)):(this.boundingBox.expandByPoint(cn.min),this.boundingBox.expandByPoint(cn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ne);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new xe,1/0);if(e){var n=this.boundingSphere.center;if(cn.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];hn.setFromBufferAttribute(a),this.morphTargetsRelative?(dn.addVectors(cn.min,hn.min),cn.expandByPoint(dn),dn.addVectors(cn.max,hn.max),cn.expandByPoint(dn)):(cn.expandByPoint(hn.min),cn.expandByPoint(hn.max))}cn.getCenter(n);for(var o=0,s=0,l=e.count;s<l;s++)dn.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(dn));if(t)for(var u=0,c=t.length;u<c;u++)for(var h=t[u],d=this.morphTargetsRelative,p=0,f=h.count;p<f;p++)dn.fromBufferAttribute(h,p),d&&(un.fromBufferAttribute(e,p),dn.add(un)),o=Math.max(o,n.distanceToSquared(dn));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Xt(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,i=n.count;r<i;r++)n.setXYZ(r,0,0,0);var a=new xe,o=new xe,s=new xe,l=new xe,u=new xe,c=new xe,h=new xe,d=new xe;if(e)for(var p=0,f=e.count;p<f;p+=3){var m=e.getX(p+0),v=e.getX(p+1),g=e.getX(p+2);a.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,g),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),l.fromBufferAttribute(n,m),u.fromBufferAttribute(n,v),c.fromBufferAttribute(n,g),l.add(h),u.add(h),c.add(h),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(g,c.x,c.y,c.z)}else for(var y=0,x=t.count;y<x;y+=3)a.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),h.subVectors(s,o),d.subVectors(a,o),h.cross(d),n.setXYZ(y+0,h.x,h.y,h.z),n.setXYZ(y+1,h.x,h.y,h.z),n.setXYZ(y+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,l=Math.min(o.length,i.length-s),u=0,c=s;u<l;u++,c++)i[c]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)dn.fromBufferAttribute(e,t),dn.normalize(),e.setXYZ(t,dn.x,dn.y,dn.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r),o=0,s=0,l=0,u=t.length;l<u;l++){o=t[l]*r;for(var c=0;c<r;c++)a[s++]=n[o++]}return new Xt(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new pn,n=this.index.array,r=this.attributes;for(var i in r){var a=e(r[i],n);t.setAttribute(i,a)}var o=this.morphAttributes;for(var s in o){for(var l=[],u=o[s],c=0,h=u.length;c<h;c++){var d=e(u[c],n);l.push(d)}t.morphAttributes[s]=l}t.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,f=0,m=p.length;f<m;f++){var v=p[f];t.addGroup(v.start,v.count,v.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var a in i){var o=i[a],s=o.toJSON(e.data);""!==o.name&&(s.name=o.name),e.data.attributes[a]=s}var l={},u=!1;for(var c in this.morphAttributes){for(var h=this.morphAttributes[c],d=[],p=0,f=h.length;p<f;p++){var m=h[p],v=m.toJSON(e.data);""!==m.name&&(v.name=m.name),d.push(v)}d.length>0&&(l[c]=d,u=!0)}u&&(e.data.morphAttributes=l,e.data.morphTargetsRelative=this.morphTargetsRelative);var g=this.groups;g.length>0&&(e.data.groups=JSON.parse(JSON.stringify(g)));var y=this.boundingSphere;return null!==y&&(e.data.boundingSphere={center:y.center.toArray(),radius:y.radius}),e},clone:function(){return(new pn).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var i in r){var a=r[i];this.setAttribute(i,a.clone(t))}var o=e.morphAttributes;for(var s in o){for(var l=[],u=o[s],c=0,h=u.length;c<h;c++)l.push(u[c].clone(t));this.morphAttributes[s]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var d=e.groups,p=0,f=d.length;p<f;p++){var m=d[p];this.addGroup(m.start,m.count,m.materialIndex)}var v=e.boundingBox;null!==v&&(this.boundingBox=v.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var fn=new Xe,mn=new qe,vn=new Ne,gn=new xe,yn=new xe,xn=new xe,_n=new xe,bn=new xe,wn=new xe,Mn=new xe,Sn=new xe,Tn=new xe,En=new ce,An=new ce,Cn=new ce,Ln=new xe,Rn=new xe;function Pn(e,t){yt.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new pn,this.material=void 0!==t?t:new Vt,this.updateMorphTargets()}function Dn(e,t,n,r,i,a,o,s){if(null===(1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,2!==t.side,s)))return null;Rn.copy(s),Rn.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(Rn);return l<n.near||l>n.far?null:{distance:l,point:Rn.clone(),object:e}}function In(e,t,n,r,i,a,o,s,l,u,c,h){gn.fromBufferAttribute(i,u),yn.fromBufferAttribute(i,c),xn.fromBufferAttribute(i,h);var d=e.morphTargetInfluences;if(t.morphTargets&&a&&d){Mn.set(0,0,0),Sn.set(0,0,0),Tn.set(0,0,0);for(var p=0,f=a.length;p<f;p++){var m=d[p],v=a[p];0!==m&&(_n.fromBufferAttribute(v,u),bn.fromBufferAttribute(v,c),wn.fromBufferAttribute(v,h),o?(Mn.addScaledVector(_n,m),Sn.addScaledVector(bn,m),Tn.addScaledVector(wn,m)):(Mn.addScaledVector(_n.sub(gn),m),Sn.addScaledVector(bn.sub(yn),m),Tn.addScaledVector(wn.sub(xn),m)))}gn.add(Mn),yn.add(Sn),xn.add(Tn)}e.isSkinnedMesh&&(e.boneTransform(u,gn),e.boneTransform(c,yn),e.boneTransform(h,xn));var g=Dn(e,t,n,r,gn,yn,xn,Ln);if(g){s&&(En.fromBufferAttribute(s,u),An.fromBufferAttribute(s,c),Cn.fromBufferAttribute(s,h),g.uv=It.getUV(Ln,gn,yn,xn,En,An,Cn,new ce)),l&&(En.fromBufferAttribute(l,u),An.fromBufferAttribute(l,c),Cn.fromBufferAttribute(l,h),g.uv2=It.getUV(Ln,gn,yn,xn,En,An,Cn,new ce));var y=new Gt(u,c,h);It.getNormal(gn,yn,xn,y.normal),g.face=y}return g}Pn.prototype=Object.assign(Object.create(yt.prototype),{constructor:Pn,isMesh:!0,copy:function(e){return yt.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),vn.copy(r.boundingSphere),vn.applyMatrix4(a),!1!==e.ray.intersectsSphere(vn)&&(fn.getInverse(a),mn.copy(e.ray).applyMatrix4(fn),null===r.boundingBox||!1!==mn.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,l=r.morphAttributes.position,u=r.morphTargetsRelative,c=r.attributes.uv,h=r.attributes.uv2,d=r.groups,p=r.drawRange;if(null!==o)if(Array.isArray(i))for(var f=0,m=d.length;f<m;f++)for(var v=d[f],g=i[v.materialIndex],y=Math.max(v.start,p.start),x=Math.min(v.start+v.count,p.start+p.count);y<x;y+=3){var _=o.getX(y),b=o.getX(y+1),w=o.getX(y+2);(n=In(this,g,e,mn,s,l,u,c,h,_,b,w))&&(n.faceIndex=Math.floor(y/3),n.face.materialIndex=v.materialIndex,t.push(n))}else for(var M=Math.max(0,p.start),S=Math.min(o.count,p.start+p.count);M<S;M+=3){var T=o.getX(M),E=o.getX(M+1),A=o.getX(M+2);(n=In(this,i,e,mn,s,l,u,c,h,T,E,A))&&(n.faceIndex=Math.floor(M/3),t.push(n))}else if(void 0!==s)if(Array.isArray(i))for(var C=0,L=d.length;C<L;C++)for(var R=d[C],P=i[R.materialIndex],D=Math.max(R.start,p.start),I=Math.min(R.start+R.count,p.start+p.count);D<I;D+=3)(n=In(this,P,e,mn,s,l,u,c,h,D,D+1,D+2))&&(n.faceIndex=Math.floor(D/3),n.face.materialIndex=R.materialIndex,t.push(n));else for(var O=Math.max(0,p.start),z=Math.min(s.count,p.start+p.count);O<z;O+=3)(n=In(this,i,e,mn,s,l,u,c,h,O,O+1,O+2))&&(n.faceIndex=Math.floor(O/3),t.push(n))}else if(r.isGeometry){var k,F=Array.isArray(i),N=r.vertices,B=r.faces,U=r.faceVertexUvs[0];U.length>0&&(k=U);for(var G=0,H=B.length;G<H;G++){var j=B[G],V=F?i[j.materialIndex]:i;if(void 0!==V){var W=N[j.a],q=N[j.b],X=N[j.c];if(n=Dn(this,V,e,mn,W,q,X,Ln)){if(k&&k[G]){var Y=k[G];En.copy(Y[0]),An.copy(Y[1]),Cn.copy(Y[2]),n.uv=It.getUV(Ln,W,q,X,En,An,Cn,new ce)}n.face=j,n.faceIndex=G,t.push(n)}}}}}});var On=function(e){function t(t,n,r,i,a,o){var s;void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===a&&(a=1),void 0===o&&(o=1),(s=e.call(this)||this).type="BoxBufferGeometry",s.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:o};var l=le(s);i=Math.floor(i),a=Math.floor(a),o=Math.floor(o);var u=[],c=[],h=[],d=[],p=0,f=0;function m(e,t,n,r,i,a,o,s,m,v,g){for(var y=a/m,x=o/v,_=a/2,b=o/2,w=s/2,M=m+1,S=v+1,T=0,E=0,A=new xe,C=0;C<S;C++)for(var L=C*x-b,R=0;R<M;R++){var P=R*y-_;A[e]=P*r,A[t]=L*i,A[n]=w,c.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=s>0?1:-1,h.push(A.x,A.y,A.z),d.push(R/m),d.push(1-C/v),T+=1}for(var D=0;D<v;D++)for(var I=0;I<m;I++){var O=p+I+M*D,z=p+I+M*(D+1),k=p+(I+1)+M*(D+1),F=p+(I+1)+M*D;u.push(O,z,F),u.push(z,k,F),E+=6}l.addGroup(f,E,g),f+=E,p+=T}return m("z","y","x",-1,-1,r,n,t,o,a,0),m("z","y","x",1,-1,r,n,-t,o,a,1),m("x","z","y",1,1,t,r,n,i,o,2),m("x","z","y",1,-1,t,r,-n,i,o,3),m("x","y","z",1,-1,t,n,r,i,a,4),m("x","y","z",-1,-1,t,n,-r,i,a,5),s.setIndex(u),s.setAttribute("position",new tn(c,3)),s.setAttribute("normal",new tn(h,3)),s.setAttribute("uv",new tn(d,2)),s}return se(t,e),t}(pn);function zn(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function kn(e){for(var t={},n=0;n<e.length;n++){var r=zn(e[n]);for(var i in r)t[i]=r[i]}return t}var Fn={clone:zn,merge:kn};function Nn(e){jt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Bn(){yt.call(this),this.type="Camera",this.matrixWorldInverse=new Xe,this.projectionMatrix=new Xe,this.projectionMatrixInverse=new Xe}function Un(e,t,n,r){Bn.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Nn.prototype=Object.create(jt.prototype),Nn.prototype.constructor=Nn,Nn.prototype.isShaderMaterial=!0,Nn.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=zn(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},Nn.prototype.toJSON=function(e){var t=jt.prototype.toJSON.call(this,e);for(var n in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},Bn.prototype=Object.assign(Object.create(yt.prototype),{constructor:Bn,isCamera:!0,copy:function(e,t){return yt.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new xe),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){yt.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){yt.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Un.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Un,isPerspectiveCamera:!0,copy:function(e,t){return Bn.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*ie.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*ie.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*ie.RAD2DEG*Math.atan(Math.tan(.5*ie.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*ie.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=yt.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Gn=90;function Hn(e,t,n){if(yt.call(this),this.type="CubeCamera",!0===n.isWebGLCubeRenderTarget){this.renderTarget=n;var r=new Un(Gn,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new xe(1,0,0)),this.add(r);var i=new Un(Gn,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new xe(-1,0,0)),this.add(i);var a=new Un(Gn,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new xe(0,1,0)),this.add(a);var o=new Un(Gn,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new xe(0,-1,0)),this.add(o);var s=new Un(Gn,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new xe(0,0,1)),this.add(s);var l=new Un(Gn,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new xe(0,0,-1)),this.add(l),this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var u=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;var h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.xr.enabled=u}}else console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.")}function jn(e,t,n,i,a,o,s,l,u,c){e=void 0!==e?e:[],t=void 0!==t?t:r,s=void 0!==s?s:S,fe.call(this,e,t,n,i,a,o,s,l,u,c),this.flipY=!1,this._needsFlipEnvMap=!0}function Vn(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),ve.call(this,e,e,t),t=t||{},this.texture=new jn(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture._needsFlipEnvMap=!1}function Wn(e,t,n,r,i,a,o,s,l,u,c,h){fe.call(this,null,a,o,s,l,u,r,i,c,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==l?l:p,this.minFilter=void 0!==u?u:p,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Hn.prototype=Object.create(yt.prototype),Hn.prototype.constructor=Hn,jn.prototype=Object.create(fe.prototype),jn.prototype.constructor=jn,jn.prototype.isCubeTexture=!0,Object.defineProperty(jn.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Vn.prototype=Object.create(ve.prototype),Vn.prototype.constructor=Vn,Vn.prototype.isWebGLCubeRenderTarget=!0,Vn.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=T,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n=new On(5,5,5),r=new Nn({name:"CubemapFromEquirect",uniforms:zn({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:1,blending:0});r.uniforms.tEquirect.value=t;var i=new Pn(n,r),a=t.minFilter;return t.minFilter===g&&(t.minFilter=v),new Hn(1,10,this).update(e,i),t.minFilter=a,i.geometry.dispose(),i.material.dispose(),this},Vn.prototype.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)},Wn.prototype=Object.create(fe.prototype),Wn.prototype.constructor=Wn,Wn.prototype.isDataTexture=!0;var qn=new Ne,Xn=new xe,Yn=function(){function e(e,t,n,r,i,a){this.planes=[void 0!==e?e:new wt,void 0!==t?t:new wt,void 0!==n?n:new wt,void 0!==r?r:new wt,void 0!==i?i:new wt,void 0!==a?a:new wt]}var t=e.prototype;return t.set=function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},t.setFromProjectionMatrix=function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return t[0].setComponents(o-r,c-s,f-h,y-m).normalize(),t[1].setComponents(o+r,c+s,f+h,y+m).normalize(),t[2].setComponents(o+i,c+l,f+d,y+v).normalize(),t[3].setComponents(o-i,c-l,f-d,y-v).normalize(),t[4].setComponents(o-a,c-u,f-p,y-g).normalize(),t[5].setComponents(o+a,c+u,f+p,y+g).normalize(),this},t.intersectsObject=function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),qn.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(qn)},t.intersectsSprite=function(e){return qn.center.set(0,0,0),qn.radius=.7071067811865476,qn.applyMatrix4(e.matrixWorld),this.intersectsSphere(qn)},t.intersectsSphere=function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0},t.intersectsBox=function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Xn.x=r.normal.x>0?e.max.x:e.min.x,Xn.y=r.normal.y>0?e.max.y:e.min.y,Xn.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Xn)<0)return!1}return!0},t.containsPoint=function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0},e}();function Zn(){var e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Kn(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){if(t.isGLBufferAttribute){var a=r.get(t);(!a||a.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,n){var r=t.array,i=t.usage,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,t,i),o.version=t.version)}}}}var Jn=function(e){function t(t,n,r,i){var a;(a=e.call(this)||this).type="PlaneBufferGeometry",a.parameters={width:t,height:n,widthSegments:r,heightSegments:i};for(var o=(t=t||1)/2,s=(n=n||1)/2,l=Math.floor(r)||1,u=Math.floor(i)||1,c=l+1,h=u+1,d=t/l,p=n/u,f=[],m=[],v=[],g=[],y=0;y<h;y++)for(var x=y*p-s,_=0;_<c;_++){var b=_*d-o;m.push(b,-x,0),v.push(0,0,1),g.push(_/l),g.push(1-y/u)}for(var w=0;w<u;w++)for(var M=0;M<l;M++){var S=M+c*w,T=M+c*(w+1),E=M+1+c*(w+1),A=M+1+c*w;f.push(S,T,A),f.push(T,E,A)}return a.setIndex(f),a.setAttribute("position",new tn(m,3)),a.setAttribute("normal",new tn(v,3)),a.setAttribute("uv",new tn(g,2)),a}return se(t,e),t}(pn),Qn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},$n={common:{diffuse:{value:new Ut(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new he},uv2Transform:{value:new he},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ce(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ut(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new he}},sprite:{diffuse:{value:new Ut(15658734)},opacity:{value:1},center:{value:new ce(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new he}}},er={basic:{uniforms:kn([$n.common,$n.specularmap,$n.envmap,$n.aomap,$n.lightmap,$n.fog]),vertexShader:Qn.meshbasic_vert,fragmentShader:Qn.meshbasic_frag},lambert:{uniforms:kn([$n.common,$n.specularmap,$n.envmap,$n.aomap,$n.lightmap,$n.emissivemap,$n.fog,$n.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Qn.meshlambert_vert,fragmentShader:Qn.meshlambert_frag},phong:{uniforms:kn([$n.common,$n.specularmap,$n.envmap,$n.aomap,$n.lightmap,$n.emissivemap,$n.bumpmap,$n.normalmap,$n.displacementmap,$n.fog,$n.lights,{emissive:{value:new Ut(0)},specular:{value:new Ut(1118481)},shininess:{value:30}}]),vertexShader:Qn.meshphong_vert,fragmentShader:Qn.meshphong_frag},standard:{uniforms:kn([$n.common,$n.envmap,$n.aomap,$n.lightmap,$n.emissivemap,$n.bumpmap,$n.normalmap,$n.displacementmap,$n.roughnessmap,$n.metalnessmap,$n.fog,$n.lights,{emissive:{value:new Ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},toon:{uniforms:kn([$n.common,$n.aomap,$n.lightmap,$n.emissivemap,$n.bumpmap,$n.normalmap,$n.displacementmap,$n.gradientmap,$n.fog,$n.lights,{emissive:{value:new Ut(0)}}]),vertexShader:Qn.meshtoon_vert,fragmentShader:Qn.meshtoon_frag},matcap:{uniforms:kn([$n.common,$n.bumpmap,$n.normalmap,$n.displacementmap,$n.fog,{matcap:{value:null}}]),vertexShader:Qn.meshmatcap_vert,fragmentShader:Qn.meshmatcap_frag},points:{uniforms:kn([$n.points,$n.fog]),vertexShader:Qn.points_vert,fragmentShader:Qn.points_frag},dashed:{uniforms:kn([$n.common,$n.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qn.linedashed_vert,fragmentShader:Qn.linedashed_frag},depth:{uniforms:kn([$n.common,$n.displacementmap]),vertexShader:Qn.depth_vert,fragmentShader:Qn.depth_frag},normal:{uniforms:kn([$n.common,$n.bumpmap,$n.normalmap,$n.displacementmap,{opacity:{value:1}}]),vertexShader:Qn.normal_vert,fragmentShader:Qn.normal_frag},sprite:{uniforms:kn([$n.sprite,$n.fog]),vertexShader:Qn.sprite_vert,fragmentShader:Qn.sprite_frag},background:{uniforms:{uvTransform:{value:new he},t2D:{value:null}},vertexShader:Qn.background_vert,fragmentShader:Qn.background_frag},cube:{uniforms:kn([$n.envmap,{opacity:{value:1}}]),vertexShader:Qn.cube_vert,fragmentShader:Qn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qn.equirect_vert,fragmentShader:Qn.equirect_frag},distanceRGBA:{uniforms:kn([$n.common,$n.displacementmap,{referencePosition:{value:new xe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qn.distanceRGBA_vert,fragmentShader:Qn.distanceRGBA_frag},shadow:{uniforms:kn([$n.lights,$n.fog,{color:{value:new Ut(0)},opacity:{value:1}}]),vertexShader:Qn.shadow_vert,fragmentShader:Qn.shadow_frag}};function tr(e,t,n,r,i){var a,o,s=new Ut(0),u=0,c=null,h=0,d=null;function p(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,i)}return{getClearColor:function(){return s},setClearColor:function(e,t){s.set(e),p(s,u=void 0!==t?t:1)},getClearAlpha:function(){return u},setClearAlpha:function(e){p(s,u=e)},render:function(n,i,f,m){var v=!0===i.isScene?i.background:null;v&&v.isTexture&&(v=t.get(v));var g=e.xr,y=g.getSession&&g.getSession();y&&"additive"===y.environmentBlendMode&&(v=null),null===v?p(s,u):v&&v.isColor&&(p(v,1),m=!0),(e.autoClear||m)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),v&&(v.isCubeTexture||v.isWebGLCubeRenderTarget||v.mapping===l)?(void 0===o&&((o=new Pn(new On(1,1,1),new Nn({name:"BackgroundCubeMaterial",uniforms:zn(er.cube.uniforms),vertexShader:er.cube.vertexShader,fragmentShader:er.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),v.isWebGLCubeRenderTarget&&(v=v.texture),o.material.uniforms.envMap.value=v,o.material.uniforms.flipEnvMap.value=v.isCubeTexture&&v._needsFlipEnvMap?-1:1,c===v&&h===v.version&&d===e.toneMapping||(o.material.needsUpdate=!0,c=v,h=v.version,d=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):v&&v.isTexture&&(void 0===a&&((a=new Pn(new Jn(2,2),new Nn({name:"BackgroundMaterial",uniforms:zn(er.background.uniforms),vertexShader:er.background.vertexShader,fragmentShader:er.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=v,!0===v.matrixAutoUpdate&&v.updateMatrix(),a.material.uniforms.uvTransform.value.copy(v.matrix),c===v&&h===v.version&&d===e.toneMapping||(a.material.needsUpdate=!0,c=v,h=v.version,d=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function nr(e,t,n,r){var i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},l=d(null),u=l;function c(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],a=0;a<i;a++)t[a]=0,n[a]=0,r[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){for(var e=u.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function f(e){m(e,0)}function m(n,i){var a=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i)}function v(){for(var t=u.newAttributes,n=u.enabledAttributes,r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function g(t,n,i,a,o,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function y(){x(),u!==l&&c((u=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(i,l,h,y,x){var _=!1;if(o){var b=function(t,n,i){var o=!0===i.wireframe,l=s[t.id];void 0===l&&(l={},s[t.id]=l);var u=l[n.id];void 0===u&&(u={},l[n.id]=u);var c=u[o];return void 0===c&&(c=d(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[o]=c),c}(y,h,l);u!==b&&c((u=b).object),_=function(e,t){var n=u.attributes,r=e.attributes;if(Object.keys(n).length!==Object.keys(r).length)return!0;for(var i in r){var a=n[i],o=r[i];if(void 0===a)return!0;if(a.attribute!==o)return!0;if(a.data!==o.data)return!0}return u.index!==t}(y,x),_&&function(e,t){var n={},r=e.attributes;for(var i in r){var a=r[i],o={};o.attribute=a,a.data&&(o.data=a.data),n[i]=o}u.attributes=n,u.index=t}(y,x)}else{var w=!0===l.wireframe;u.geometry===y.id&&u.program===h.id&&u.wireframe===w||(u.geometry=y.id,u.program=h.id,u.wireframe=w,_=!0)}!0===i.isInstancedMesh&&(_=!0),null!==x&&n.update(x,34963),_&&(function(i,a,o,s){if(!1!==r.isWebGL2||!i.isInstancedMesh&&!s.isInstancedBufferGeometry||null!==t.get("ANGLE_instanced_arrays")){p();var l=s.attributes,u=o.getAttributes(),c=a.defaultAttributeValues;for(var h in u){var d=u[h];if(d>=0){var y=l[h];if(void 0!==y){var x=y.normalized,_=y.itemSize,b=n.get(y);if(void 0===b)continue;var w=b.buffer,M=b.type,S=b.bytesPerElement;if(y.isInterleavedBufferAttribute){var T=y.data,E=T.stride,A=y.offset;T&&T.isInstancedInterleavedBuffer?(m(d,T.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=T.meshPerAttribute*T.count)):f(d),e.bindBuffer(34962,w),g(d,_,M,x,E*S,A*S)}else y.isInstancedBufferAttribute?(m(d,y.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=y.meshPerAttribute*y.count)):f(d),e.bindBuffer(34962,w),g(d,_,M,x,0,0)}else if("instanceMatrix"===h){var C=n.get(i.instanceMatrix);if(void 0===C)continue;var L=C.buffer,R=C.type;m(d+0,1),m(d+1,1),m(d+2,1),m(d+3,1),e.bindBuffer(34962,L),e.vertexAttribPointer(d+0,4,R,!1,64,0),e.vertexAttribPointer(d+1,4,R,!1,64,16),e.vertexAttribPointer(d+2,4,R,!1,64,32),e.vertexAttribPointer(d+3,4,R,!1,64,48)}else if("instanceColor"===h){var P=n.get(i.instanceColor);if(void 0===P)continue;var D=P.buffer,I=P.type;m(d,1),e.bindBuffer(34962,D),e.vertexAttribPointer(d,3,I,!1,12,0)}else if(void 0!==c){var O=c[h];if(void 0!==O)switch(O.length){case 2:e.vertexAttrib2fv(d,O);break;case 3:e.vertexAttrib3fv(d,O);break;case 4:e.vertexAttrib4fv(d,O);break;default:e.vertexAttrib1fv(d,O)}}}}v()}}(i,l,h,y),null!==x&&e.bindBuffer(34963,n.get(x).buffer))},reset:y,resetDefaultState:x,dispose:function(){for(var e in y(),s){var t=s[e];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var i in r)h(r[i].object),delete r[i];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var i in r)h(r[i].object),delete r[i];delete n[e.id]}}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:v}}function rr(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=function(r,o,s){if(0!==s){var l,u;if(a)l=e,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](i,r,o,s),n.update(o,i,s)}}}function ir(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),c=e.getParameter(35660),h=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),v=e.getParameter(36349),g=c>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:a?e.getParameter(36183):0}}function ar(e){var t=this,n=null,r=0,i=!1,a=!1,o=new wt,s=new he,l={value:null,needsUpdate:!1};function u(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function c(e,n,r,i){var a=null!==e?e.length:0,u=null;if(0!==a){if(u=l.value,!0!==i||null===u){var c=r+4*a,h=n.matrixWorldInverse;s.getNormalMatrix(h),(null===u||u.length<c)&&(u=new Float32Array(c));for(var d=0,p=r;d!==a;++d,p+=4)o.copy(e[d]).applyMatrix4(h,s),o.normal.toArray(u,p),u[p+3]=o.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,a){var o=0!==e.length||t||0!==r||i;return i=t,n=c(e,a,0),r=e.length,o},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1,u()},this.setState=function(t,o,s){var h=t.clippingPlanes,d=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(!i||null===h||0===h.length||a&&!p)a?c(null):u();else{var m=a?0:r,v=4*m,g=f.clippingState||null;l.value=g,g=c(h,o,v,s);for(var y=0;y!==v;++y)g[y]=n[y];f.clippingState=g,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=m}}}function or(e){var t=new WeakMap;function n(e,t){return t===o?e.mapping=r:t===s&&(e.mapping=i),e}function a(e){var n=e.target;n.removeEventListener("dispose",a);var r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){var i=r.mapping;if(i===o||i===s){if(t.has(r))return n(t.get(r).texture,r.mapping);var l=r.image;if(l&&l.height>0){var u=e.getRenderList(),c=e.getRenderTarget(),h=e.getRenderState(),d=new Vn(l.height/2);return d.fromEquirectangularTexture(e,r),t.set(r,d),e.setRenderTarget(c),e.setRenderList(u),e.setRenderState(h),r.addEventListener("dispose",a),n(d.texture,r.mapping)}return null}}return r},dispose:function(){t=new WeakMap}}}function sr(e){var t={};return{has:function(n){if(void 0!==t[n])return null!==t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,null!==r},get:function(e){return this.has(e)||console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t[e]}}}function lr(e,t,n,r){var i=new WeakMap,a=new WeakMap;function o(e){var s=e.target,l=i.get(s);for(var u in null!==l.index&&t.remove(l.index),l.attributes)t.remove(l.attributes[u]);s.removeEventListener("dispose",o),i.delete(s);var c=a.get(l);c&&(t.remove(c),a.delete(l)),r.releaseStatesOfGeometry(l),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,i=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var l=0,u=s.length;l<u;l+=3){var c=s[l+0],h=s[l+1],d=s[l+2];n.push(c,h,h,d,d,c)}}else{var p=i.array;o=i.version;for(var f=0,m=p.length/3-1;f<m;f+=3){var v=f+0,g=f+1,y=f+2;n.push(v,g,g,y,y,v)}}var x=new(an(n)>65535?en:Qt)(n,1);x.version=o;var _=a.get(e);_&&t.remove(_),a.set(e,x)}return{get:function(e,t){var r=i.get(t);return r||(t.addEventListener("dispose",o),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new pn).setFromObject(e)),r=t._bufferGeometry),i.set(t,r),n.memory.geometries++,r)},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var i=e.morphAttributes;for(var a in i)for(var o=i[a],s=0,l=o.length;s<l;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=a.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function ur(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i,1)},this.renderInstances=function(r,l,u){if(0!==u){var c,h;if(s)c=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[h](i,l,a,r*o,u),n.update(l,i,u)}}}function cr(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function hr(e,t){return e[0]-t[0]}function dr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function pr(e){for(var t={},n=new Float32Array(8),r=[],i=0;i<8;i++)r[i]=[i,0];return{update:function(i,a,o,s){var l=i.morphTargetInfluences,u=void 0===l?0:l.length,c=t[a.id];if(void 0===c){c=[];for(var h=0;h<u;h++)c[h]=[h,0];t[a.id]=c}for(var d=0;d<u;d++){var p=c[d];p[0]=d,p[1]=l[d]}c.sort(dr);for(var f=0;f<8;f++)f<u&&c[f][1]?(r[f][0]=c[f][0],r[f][1]=c[f][1]):(r[f][0]=Number.MAX_SAFE_INTEGER,r[f][1]=0);r.sort(hr);for(var m=o.morphTargets&&a.morphAttributes.position,v=o.morphNormals&&a.morphAttributes.normal,g=0,y=0;y<8;y++){var x=r[y],_=x[0],b=x[1];_!==Number.MAX_SAFE_INTEGER&&b?(m&&a.getAttribute("morphTarget"+y)!==m[_]&&a.setAttribute("morphTarget"+y,m[_]),v&&a.getAttribute("morphNormal"+y)!==v[_]&&a.setAttribute("morphNormal"+y,v[_]),n[y]=b,g+=b):(m&&void 0!==a.getAttribute("morphTarget"+y)&&a.deleteAttribute("morphTarget"+y),v&&void 0!==a.getAttribute("morphNormal"+y)&&a.deleteAttribute("morphNormal"+y),n[y]=0)}var w=a.morphTargetsRelative?1:1-g;s.getUniforms().setValue(e,"morphTargetBaseInfluence",w),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function fr(e,t,n,r){var i=new WeakMap;return{update:function(e){var a=r.render.frame,o=e.geometry,s=t.get(e,o);return i.get(s)!==a&&(o.isGeometry&&s.updateFromObject(e),t.update(s),i.set(s,a)),e.isInstancedMesh&&(n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),s},dispose:function(){i=new WeakMap}}}function mr(e,t,n,r){fe.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=p,this.minFilter=p,this.wrapR=h,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function vr(e,t,n,r){fe.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=p,this.minFilter=p,this.wrapR=h,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}er.physical={uniforms:kn([er.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ce(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Ut(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},mr.prototype=Object.create(fe.prototype),mr.prototype.constructor=mr,mr.prototype.isDataTexture2DArray=!0,vr.prototype=Object.create(fe.prototype),vr.prototype.constructor=vr,vr.prototype.isDataTexture3D=!0;var gr=new fe,yr=new mr,xr=new vr,_r=new jn,br=[],wr=[],Mr=new Float32Array(16),Sr=new Float32Array(9),Tr=new Float32Array(4);function Er(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=br[i];if(void 0===a&&(a=new Float32Array(i),br[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Ar(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Cr(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Lr(e,t){var n=wr[t];void 0===n&&(n=new Int32Array(t),wr[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Rr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Pr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ar(n,t))return;e.uniform2fv(this.addr,t),Cr(n,t)}}function Dr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ar(n,t))return;e.uniform3fv(this.addr,t),Cr(n,t)}}function Ir(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ar(n,t))return;e.uniform4fv(this.addr,t),Cr(n,t)}}function Or(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ar(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Cr(n,t)}else{if(Ar(n,r))return;Tr.set(r),e.uniformMatrix2fv(this.addr,!1,Tr),Cr(n,r)}}function zr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ar(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Cr(n,t)}else{if(Ar(n,r))return;Sr.set(r),e.uniformMatrix3fv(this.addr,!1,Sr),Cr(n,r)}}function kr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ar(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Cr(n,t)}else{if(Ar(n,r))return;Mr.set(r),e.uniformMatrix4fv(this.addr,!1,Mr),Cr(n,r)}}function Fr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||gr,i)}function Nr(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||yr,i)}function Br(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||xr,i)}function Ur(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||_r,i)}function Gr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Hr(e,t){var n=this.cache;Ar(n,t)||(e.uniform2iv(this.addr,t),Cr(n,t))}function jr(e,t){var n=this.cache;Ar(n,t)||(e.uniform3iv(this.addr,t),Cr(n,t))}function Vr(e,t){var n=this.cache;Ar(n,t)||(e.uniform4iv(this.addr,t),Cr(n,t))}function Wr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function qr(e,t){e.uniform1fv(this.addr,t)}function Xr(e,t){e.uniform1iv(this.addr,t)}function Yr(e,t){e.uniform2iv(this.addr,t)}function Zr(e,t){e.uniform3iv(this.addr,t)}function Kr(e,t){e.uniform4iv(this.addr,t)}function Jr(e,t){var n=Er(t,this.size,2);e.uniform2fv(this.addr,n)}function Qr(e,t){var n=Er(t,this.size,3);e.uniform3fv(this.addr,n)}function $r(e,t){var n=Er(t,this.size,4);e.uniform4fv(this.addr,n)}function ei(e,t){var n=Er(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function ti(e,t){var n=Er(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function ni(e,t){var n=Er(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function ri(e,t,n){var r=t.length,i=Lr(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||gr,i[a])}function ii(e,t,n){var r=t.length,i=Lr(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||_r,i[a])}function ai(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Rr;case 35664:return Pr;case 35665:return Dr;case 35666:return Ir;case 35674:return Or;case 35675:return zr;case 35676:return kr;case 5124:case 35670:return Gr;case 35667:case 35671:return Hr;case 35668:case 35672:return jr;case 35669:case 35673:return Vr;case 5125:return Wr;case 35678:case 36198:case 36298:case 36306:case 35682:return Fr;case 35679:case 36299:case 36307:return Br;case 35680:case 36300:case 36308:case 36293:return Ur;case 36289:case 36303:case 36311:case 36292:return Nr}}(t.type)}function oi(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return qr;case 35664:return Jr;case 35665:return Qr;case 35666:return $r;case 35674:return ei;case 35675:return ti;case 35676:return ni;case 5124:case 35670:return Xr;case 35667:case 35671:return Yr;case 35668:case 35672:return Zr;case 35669:case 35673:return Kr;case 35678:case 36198:case 36298:case 36306:case 35682:return ri;case 35680:case 36300:case 36308:case 36293:return ii}}(t.type)}function si(e){this.id=e,this.seq=[],this.map={}}oi.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Cr(t,e)},si.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var li=/([\w\d_]+)(\])?(\[|\.)?/g;function ui(e,t){e.seq.push(t),e.map[t.id]=t}function ci(e,t,n){var r=e.name,i=r.length;for(li.lastIndex=0;;){var a=li.exec(r),o=li.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===i){ui(n,void 0===u?new ai(s,e,t):new oi(s,e,t));break}var c=n.map[s];void 0===c&&ui(n,c=new si(s)),n=c}}function hi(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);ci(i,e.getUniformLocation(t,i.name),this)}}function di(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}hi.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},hi.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},hi.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},hi.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var pi=0;function fi(e){switch(e){case q:return["Linear","( value )"];case X:return["sRGB","( value )"];case Z:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case Y:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function mi(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function vi(e,t){var n=fi(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function gi(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function yi(e){return""!==e}function xi(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function _i(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var bi=/^[ \t]*#include +<([\w\d./]+)>/gm;function wi(e){return e.replace(bi,Mi)}function Mi(e,t){var n=Qn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return wi(n)}var Si=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ti=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ei(e){return e.replace(Ti,Ci).replace(Si,Ai)}function Ai(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ci(0,t,n,r)}function Ci(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Li(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ri(e,t,n,a){var o,s,c,h,d=e.getContext(),p=n.defines,f=n.vertexShader,m=n.fragmentShader,v=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),g=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case r:case i:t="ENVMAP_TYPE_CUBE";break;case l:case u:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),y=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case i:case u:t="ENVMAP_MODE_REFRACTION"}return t}(n),x=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),_=e.gammaFactor>0?e.gammaFactor:1,b=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(yi).join("\n")}(n),w=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(p),M=d.createProgram(),S=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((o=[w].filter(yi).join("\n")).length>0&&(o+="\n"),(s=[b,w].filter(yi).join("\n")).length>0&&(s+="\n")):(o=[Li(n),"#define SHADER_NAME "+n.shaderName,w,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+y:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+v:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(yi).join("\n"),s=[b,Li(n),"#define SHADER_NAME "+n.shaderName,w,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+_,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+y:"",n.envMap?"#define "+x:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+v:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Qn.tonemapping_pars_fragment:"",0!==n.toneMapping?gi("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Qn.encodings_pars_fragment,n.map?vi("mapTexelToLinear",n.mapEncoding):"",n.matcap?vi("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?vi("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?vi("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?vi("lightMapTexelToLinear",n.lightMapEncoding):"",("linearToOutputTexel",c=n.outputEncoding,h=fi(c),"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+h[0]+h[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(yi).join("\n")),f=_i(f=xi(f=wi(f),n),n),m=_i(m=xi(m=wi(m),n),n),f=Ei(f),m=Ei(m),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(S="#version 300 es\n",o=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+o,s=["#define varying in",n.glslVersion===$?"":"out highp vec4 pc_fragColor;",n.glslVersion===$?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+s);var T,E,A=S+s+m,C=di(d,35633,S+o+f),L=di(d,35632,A);if(d.attachShader(M,C),d.attachShader(M,L),void 0!==n.index0AttributeName?d.bindAttribLocation(M,0,n.index0AttributeName):!0===n.morphTargets&&d.bindAttribLocation(M,0,"position"),d.linkProgram(M),e.debug.checkShaderErrors){var R=d.getProgramInfoLog(M).trim(),P=d.getShaderInfoLog(C).trim(),D=d.getShaderInfoLog(L).trim(),I=!0,O=!0;if(!1===d.getProgramParameter(M,35714)){I=!1;var z=mi(d,C,"vertex"),k=mi(d,L,"fragment");console.error("THREE.WebGLProgram: shader error: ",d.getError(),"35715",d.getProgramParameter(M,35715),"gl.getProgramInfoLog",R,z,k)}else""!==R?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",R):""!==P&&""!==D||(O=!1);O&&(this.diagnostics={runnable:I,programLog:R,vertexShader:{log:P,prefix:o},fragmentShader:{log:D,prefix:s}})}return d.deleteShader(C),d.deleteShader(L),this.getUniforms=function(){return void 0===T&&(T=new hi(d,M)),T},this.getAttributes=function(){return void 0===E&&(E=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(d,M)),E},this.destroy=function(){a.releaseStatesOfProgram(this),d.deleteProgram(M),this.program=void 0},this.name=n.shaderName,this.id=pi++,this.cacheKey=t,this.usedTimes=1,this.program=M,this.vertexShader=C,this.fragmentShader=L,this}function Pi(e,t,n,r,i,a){var o=[],s=r.isWebGL2,c=r.logarithmicDepthBuffer,h=r.floatVertexTextures,d=r.maxVertexUniforms,p=r.vertexTextures,f=r.precision,m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},v=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function g(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=q,t}return{getParameters:function(i,o,v,y,x){var _,b,w=y.fog,M=i.isMeshStandardMaterial?y.environment:null,S=t.get(i.envMap||M),T=m[i.type],E=x.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(h)return 1024;var n=d,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(x):0;if(null!==i.precision&&(f=r.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",f,"instead."),T){var A=er[T];_=A.vertexShader,b=A.fragmentShader}else _=i.vertexShader,b=i.fragmentShader;var C=e.getRenderTarget();return{isWebGL2:s,shaderID:T,shaderName:i.type,vertexShader:_,fragmentShader:b,defines:i.defines,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:f,instancing:!0===x.isInstancedMesh,instancingColor:!0===x.isInstancedMesh&&null!==x.instanceColor,supportsVertexTextures:p,outputEncoding:null!==C?g(C.texture):e.outputEncoding,map:!!i.map,mapEncoding:g(i.map),matcap:!!i.matcap,matcapEncoding:g(i.matcap),envMap:!!S,envMapMode:S&&S.mapping,envMapEncoding:g(S),envMapCubeUV:!!S&&(S.mapping===l||S.mapping===u),lightMap:!!i.lightMap,lightMapEncoding:g(i.lightMap),aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:g(i.emissiveMap),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,objectSpaceNormalMap:1===i.normalMapType,tangentSpaceNormalMap:0===i.normalMapType,clearcoatMap:!!i.clearcoatMap,clearcoatRoughnessMap:!!i.clearcoatRoughnessMap,clearcoatNormalMap:!!i.clearcoatNormalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,gradientMap:!!i.gradientMap,sheen:!!i.sheen,transmissionMap:!!i.transmissionMap,combine:i.combine,vertexTangents:i.normalMap&&i.vertexTangents,vertexColors:i.vertexColors,vertexUvs:!!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatMap||i.clearcoatRoughnessMap||i.clearcoatNormalMap||i.displacementMap||i.transmissionMap),uvsVertexOnly:!(i.map||i.bumpMap||i.normalMap||i.specularMap||i.alphaMap||i.emissiveMap||i.roughnessMap||i.metalnessMap||i.clearcoatNormalMap||i.transmissionMap||!i.displacementMap),fog:!!w,useFog:i.fog,fogExp2:w&&w.isFogExp2,flatShading:i.flatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:c,skinning:i.skinning&&E>0,maxBones:E,useVertexTexture:h,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&v.length>0,shadowMapType:e.shadowMap.type,toneMapping:i.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:2===i.side,flipSided:1===i.side,depthPacking:void 0!==i.depthPacking&&i.depthPacking,index0AttributeName:i.index0AttributeName,extensionDerivatives:i.extensions&&i.extensions.derivatives,extensionFragDepth:i.extensions&&i.extensions.fragDepth,extensionDrawBuffers:i.extensions&&i.extensions.drawBuffers,extensionShaderTextureLOD:i.extensions&&i.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var i=0;i<v.length;i++)n.push(t[v[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=m[e.type];if(n){var r=er[n];t=Fn.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,a=0,s=o.length;a<s;a++){var l=o[a];if(l.cacheKey===n){++(r=l).usedTimes;break}}return void 0===r&&(r=new Ri(e,n,t,i),o.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=o.indexOf(e);o[t]=o[o.length-1],o.pop(),e.destroy()}},programs:o}}function Di(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Ii(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Oi(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function zi(e){var t=[],n=0,r=[],i=[],a={id:-1};function o(r,i,o,s,l,u){var c=t[n],h=e.get(o);return void 0===c?(c={id:r.id,object:r,geometry:i,material:o,program:h.program||a,groupOrder:s,renderOrder:r.renderOrder,z:l,group:u},t[n]=c):(c.id=r.id,c.object=r,c.geometry=i,c.material=o,c.program=h.program||a,c.groupOrder=s,c.renderOrder=r.renderOrder,c.z=l,c.group=u),n++,c}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(e,t,n,a,s,l){var u=o(e,t,n,a,s,l);(!0===n.transparent?i:r).push(u)},unshift:function(e,t,n,a,s,l){var u=o(e,t,n,a,s,l);(!0===n.transparent?i:r).unshift(u)},finish:function(){for(var e=n,r=t.length;e<r;e++){var i=t[e];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Ii),i.length>1&&i.sort(t||Oi)}}}function ki(e){var t=new WeakMap;return{get:function(n,r){var i,a=t.get(n);return void 0===a?(i=new zi(e),t.set(n,new WeakMap),t.get(n).set(r,i)):void 0===(i=a.get(r))&&(i=new zi(e),a.set(r,i)),i},dispose:function(){t=new WeakMap}}}function Fi(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new xe,color:new Ut};break;case"SpotLight":n={position:new xe,direction:new xe,color:new Ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new xe,color:new Ut,distance:0,decay:0};break;case"HemisphereLight":n={direction:new xe,skyColor:new Ut,groundColor:new Ut};break;case"RectAreaLight":n={color:new Ut,position:new xe,halfWidth:new xe,halfHeight:new xe}}return e[t.id]=n,n}}}var Ni=0;function Bi(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ui(e,t){for(var n,r=new Fi,i=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ce};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ce,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},o=0;o<9;o++)a.probe.push(new xe);var s=new xe,l=new Xe,u=new Xe;return{setup:function(n,o,c){for(var h=0,d=0,p=0,f=0;f<9;f++)a.probe[f].set(0,0,0);var m=0,v=0,g=0,y=0,x=0,_=0,b=0,w=0,M=c.matrixWorldInverse;n.sort(Bi);for(var S=0,T=n.length;S<T;S++){var E=n[S],A=E.color,C=E.intensity,L=E.distance,R=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)h+=A.r*C,d+=A.g*C,p+=A.b*C;else if(E.isLightProbe)for(var P=0;P<9;P++)a.probe[P].addScaledVector(E.sh.coefficients[P],C);else if(E.isDirectionalLight){var D=r.get(E);if(D.color.copy(E.color).multiplyScalar(E.intensity),D.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),D.direction.sub(s),D.direction.transformDirection(M),E.castShadow){var I=E.shadow,O=i.get(E);O.shadowBias=I.bias,O.shadowNormalBias=I.normalBias,O.shadowRadius=I.radius,O.shadowMapSize=I.mapSize,a.directionalShadow[m]=O,a.directionalShadowMap[m]=R,a.directionalShadowMatrix[m]=E.shadow.matrix,_++}a.directional[m]=D,m++}else if(E.isSpotLight){var z=r.get(E);if(z.position.setFromMatrixPosition(E.matrixWorld),z.position.applyMatrix4(M),z.color.copy(A).multiplyScalar(C),z.distance=L,z.direction.setFromMatrixPosition(E.matrixWorld),s.setFromMatrixPosition(E.target.matrixWorld),z.direction.sub(s),z.direction.transformDirection(M),z.coneCos=Math.cos(E.angle),z.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),z.decay=E.decay,E.castShadow){var k=E.shadow,F=i.get(E);F.shadowBias=k.bias,F.shadowNormalBias=k.normalBias,F.shadowRadius=k.radius,F.shadowMapSize=k.mapSize,a.spotShadow[g]=F,a.spotShadowMap[g]=R,a.spotShadowMatrix[g]=E.shadow.matrix,w++}a.spot[g]=z,g++}else if(E.isRectAreaLight){var N=r.get(E);N.color.copy(A).multiplyScalar(C),N.position.setFromMatrixPosition(E.matrixWorld),N.position.applyMatrix4(M),u.identity(),l.copy(E.matrixWorld),l.premultiply(M),u.extractRotation(l),N.halfWidth.set(.5*E.width,0,0),N.halfHeight.set(0,.5*E.height,0),N.halfWidth.applyMatrix4(u),N.halfHeight.applyMatrix4(u),a.rectArea[y]=N,y++}else if(E.isPointLight){var B=r.get(E);if(B.position.setFromMatrixPosition(E.matrixWorld),B.position.applyMatrix4(M),B.color.copy(E.color).multiplyScalar(E.intensity),B.distance=E.distance,B.decay=E.decay,E.castShadow){var U=E.shadow,G=i.get(E);G.shadowBias=U.bias,G.shadowNormalBias=U.normalBias,G.shadowRadius=U.radius,G.shadowMapSize=U.mapSize,G.shadowCameraNear=U.camera.near,G.shadowCameraFar=U.camera.far,a.pointShadow[v]=G,a.pointShadowMap[v]=R,a.pointShadowMatrix[v]=E.shadow.matrix,b++}a.point[v]=B,v++}else if(E.isHemisphereLight){var H=r.get(E);H.direction.setFromMatrixPosition(E.matrixWorld),H.direction.transformDirection(M),H.direction.normalize(),H.skyColor.copy(E.color).multiplyScalar(C),H.groundColor.copy(E.groundColor).multiplyScalar(C),a.hemi[x]=H,x++}}y>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=$n.LTC_FLOAT_1,a.rectAreaLTC2=$n.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=$n.LTC_HALF_1,a.rectAreaLTC2=$n.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=h,a.ambient[1]=d,a.ambient[2]=p;var j=a.hash;j.directionalLength===m&&j.pointLength===v&&j.spotLength===g&&j.rectAreaLength===y&&j.hemiLength===x&&j.numDirectionalShadows===_&&j.numPointShadows===b&&j.numSpotShadows===w||(a.directional.length=m,a.spot.length=g,a.rectArea.length=y,a.point.length=v,a.hemi.length=x,a.directionalShadow.length=_,a.directionalShadowMap.length=_,a.pointShadow.length=b,a.pointShadowMap.length=b,a.spotShadow.length=w,a.spotShadowMap.length=w,a.directionalShadowMatrix.length=_,a.pointShadowMatrix.length=b,a.spotShadowMatrix.length=w,j.directionalLength=m,j.pointLength=v,j.spotLength=g,j.rectAreaLength=y,j.hemiLength=x,j.numDirectionalShadows=_,j.numPointShadows=b,j.numSpotShadows=w,a.version=Ni++)},state:a}}function Gi(e,t){var n=new Ui(e,t),r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:function(e){n.setup(r,i,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){i.push(e)}}}function Hi(e,t){var n=new WeakMap;return{get:function(r,i){var a;return!1===n.has(r)?(a=new Gi(e,t),n.set(r,new WeakMap),n.get(r).set(i,a)):!1===n.get(r).has(i)?(a=new Gi(e,t),n.get(r).set(i,a)):a=n.get(r).get(i),a},dispose:function(){n=new WeakMap}}}function ji(e){jt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Vi(e){jt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new xe,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}function Wi(e,t,n){var r=new Yn,i=new ce,a=new ce,o=new me,s=[],l=[],u={},c={0:1,1:0,2:2},h=new Nn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new ce},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),d=h.clone();d.defines.HORIZONAL_PASS=1;var f=new pn;f.setAttribute("position",new Xt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new Pn(f,h),g=this;function y(n,r){var i=t.update(m);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,m,null),d.uniforms.shadow_pass.value=n.mapPass.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,d,m,null)}function x(e,t,n){var r=e<<0|t<<1|n<<2,i=s[r];return void 0===i&&(i=new ji({depthPacking:3201,morphTargets:e,skinning:t}),s[r]=i),i}function _(e,t,n){var r=e<<0|t<<1|n<<2,i=l[r];return void 0===i&&(i=new Vi({morphTargets:e,skinning:t}),l[r]=i),i}function b(t,n,r,i,a,o,s){var l=null,h=x,d=t.customDepthMaterial;if(!0===i.isPointLight&&(h=_,d=t.customDistanceMaterial),void 0===d){var p=!1;!0===r.morphTargets&&(p=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var f=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?f=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),l=h(p,f,!0===t.isInstancedMesh)}else l=d;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var m=l.uuid,v=r.uuid,g=u[m];void 0===g&&(g={},u[m]=g);var y=g[v];void 0===y&&(y=l.clone(),g[v]=y),l=y}return l.visible=r.visible,l.wireframe=r.wireframe,l.side=3===s?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:c[r.side],l.clipShadows=r.clipShadows,l.clippingPlanes=r.clippingPlanes,l.clipIntersection=r.clipIntersection,l.wireframeLinewidth=r.wireframeLinewidth,l.linewidth=r.linewidth,!0===i.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(i.matrixWorld),l.nearDistance=a,l.farDistance=o),l}function w(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=t.update(n),u=n.material;if(Array.isArray(u))for(var c=l.groups,h=0,d=c.length;h<d;h++){var p=c[h],f=u[p.materialIndex];if(f&&f.visible){var m=b(n,l,f,o,a.near,a.far,s);e.renderBufferDirect(a,null,l,m,n,p)}}else if(u.visible){var v=b(n,l,u,o,a.near,a.far,s);e.renderBufferDirect(a,null,l,v,n,null)}}for(var g=n.children,y=0,x=g.length;y<x;y++)w(g[y],i,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,l){if(!1!==g.enabled&&(!1!==g.autoUpdate||!1!==g.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,m=t.length;f<m;f++){var x=t[f],_=x.shadow;if(void 0!==_){if(!1!==_.autoUpdate||!1!==_.needsUpdate){i.copy(_.mapSize);var b=_.getFrameExtents();if(i.multiply(b),a.copy(_.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(a.x=Math.floor(n/b.x),i.x=a.x*b.x,_.mapSize.x=a.x),i.y>n&&(a.y=Math.floor(n/b.y),i.y=a.y*b.y,_.mapSize.y=a.y)),null===_.map&&!_.isPointLightShadow&&3===this.type){var M={minFilter:v,magFilter:v,format:T};_.map=new ve(i.x,i.y,M),_.map.texture.name=x.name+".shadowMap",_.mapPass=new ve(i.x,i.y,M),_.camera.updateProjectionMatrix()}if(null===_.map){var S={minFilter:p,magFilter:p,format:T};_.map=new ve(i.x,i.y,S),_.map.texture.name=x.name+".shadowMap",_.camera.updateProjectionMatrix()}e.setRenderTarget(_.map),e.clear();for(var E=_.getViewportCount(),A=0;A<E;A++){var C=_.getViewport(A);o.set(a.x*C.x,a.y*C.y,a.x*C.z,a.y*C.w),d.viewport(o),_.updateMatrices(x,A),r=_.getFrustum(),w(s,l,_.camera,x,this.type)}_.isPointLightShadow||3!==this.type||y(_,l),_.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",x,"has no shadow.")}g.needsUpdate=!1,e.setRenderTarget(u,c,h)}}}function qi(e,n,r){var i,a,o=r.isWebGL2,s=new function(){var t=!1,n=new me,r=null,i=new me(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},l=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?k(2929):F(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},u=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(e){t||(e?k(2960):F(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null}}},c={},h=null,d=null,p=null,f=null,m=null,v=null,g=null,y=null,x=null,_=!1,b=null,w=null,M=null,S=null,T=null,E=e.getParameter(35661),A=!1,C=0,L=e.getParameter(7938);-1!==L.indexOf("WebGL")?(C=parseFloat(/^WebGL\ ([0-9])/.exec(L)[1]),A=C>=1):-1!==L.indexOf("OpenGL ES")&&(C=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(L)[1]),A=C>=2);var R=null,P={},D=new me,I=new me;function O(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var z={};function k(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function F(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}z[3553]=O(3553,3553,1),z[34067]=O(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),u.setClear(0),k(2929),l.setFunc(3),H(!1),j(1),k(2884),G(0);var N=((i={})[100]=32774,i[101]=32778,i[102]=32779,i);if(o)N[103]=32775,N[104]=32776;else{var B=n.get("EXT_blend_minmax");null!==B&&(N[103]=B.MIN_EXT,N[104]=B.MAX_EXT)}var U=((a={})[200]=0,a[201]=1,a[202]=768,a[204]=770,a[210]=776,a[208]=774,a[206]=772,a[203]=769,a[205]=771,a[209]=775,a[207]=773,a);function G(n,r,i,a,o,s,l,u){if(0!==n){if(d||(k(3042),d=!0),5===n)o=o||r,s=s||i,l=l||a,r===f&&o===g||(e.blendEquationSeparate(N[r],N[o]),f=r,g=o),i===m&&a===v&&s===y&&l===x||(e.blendFuncSeparate(U[i],U[a],U[s],U[l]),m=i,v=a,y=s,x=l),p=n,_=null;else if(n!==p||u!==_){if(f===t&&g===t||(e.blendEquation(32774),f=t,g=t),u)switch(n){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",n)}else switch(n){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",n)}m=null,v=null,y=null,x=null,p=n,_=u}}else d&&(F(3042),d=!1)}function H(t){b!==t&&(t?e.frontFace(2304):e.frontFace(2305),b=t)}function j(t){0!==t?(k(2884),t!==w&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):F(2884),w=t}function V(t,n,r){t?(k(32823),S===n&&T===r||(e.polygonOffset(n,r),S=n,T=r)):F(32823)}function W(t){void 0===t&&(t=33984+E-1),R!==t&&(e.activeTexture(t),R=t)}return{buffers:{color:s,depth:l,stencil:u},enable:k,disable:F,useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:G,setMaterial:function(e,t){2===e.side?F(2884):k(2884);var n=1===e.side;t&&(n=!n),H(n),1===e.blending&&!1===e.transparent?G(0):G(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),l.setFunc(e.depthFunc),l.setTest(e.depthTest),l.setMask(e.depthWrite),s.setMask(e.colorWrite);var r=e.stencilWrite;u.setTest(r),r&&(u.setMask(e.stencilWriteMask),u.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),u.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),V(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:H,setCullFace:j,setLineWidth:function(t){t!==M&&(A&&e.lineWidth(t),M=t)},setPolygonOffset:V,setScissorTest:function(e){e?k(3089):F(3089)},activeTexture:W,bindTexture:function(t,n){null===R&&W();var r=P[R];void 0===r&&(r={type:void 0,texture:void 0},P[R]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||z[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=P[R];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===D.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),D.copy(t))},viewport:function(t){!1===I.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),I.copy(t))},reset:function(){c={},R=null,P={},h=null,p=null,b=null,w=null,s.reset(),l.reset(),u.reset()}}}function Xi(e,t,n,r,i,a,o){var s,l,u,c=i.isWebGL2,d=i.maxTextures,g=i.maxCubemapSize,y=i.maxTextureSize,C=i.maxSamples,L=new WeakMap,R=!1;try{R="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function P(e,t){return R?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function D(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?ie.floorPowerOfTwo:Math.floor,o=a(i*e.width),s=a(i*e.height);void 0===u&&(u=P(o,s));var l=n?P(o,s):u;return l.width=o,l.height=s,l.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function I(e){return ie.isPowerOfTwo(e.width)&&ie.isPowerOfTwo(e.height)}function O(e,t){return e.generateMipmaps&&t&&e.minFilter!==p&&e.minFilter!==v}function z(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function k(n,r,i){if(!1===c)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function F(e){return e===p||e===f||e===m?9728:9729}function N(t){var n=t.target;n.removeEventListener("dispose",N),function(t){var n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(n),n.isVideoTexture&&L.delete(n),o.memory.textures--}function B(t){var n=t.target;n.removeEventListener("dispose",B),function(t){var n=r.get(t),i=r.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)e.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[a]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&e.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(t.texture),r.remove(t)}}(n),o.memory.textures--}var U=0;function G(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=o.render.frame;L.get(e)!==t&&(L.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void X(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function H(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,i){if(6===r.image.length){q(t,r),n.activeTexture(33984+i),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,l=[],u=0;u<6;u++)l[u]=o||s?s?r.image[u].image:r.image[u]:D(r.image[u],!1,!0,g);var h,d=l[0],p=I(d)||c,f=a.convert(r.format),m=a.convert(r.type),v=k(r.internalFormat,f,m);if(W(34067,r,p),o){for(var y=0;y<6;y++){h=l[y].mipmaps;for(var x=0;x<h.length;x++){var _=h[x];r.format!==T&&r.format!==S?null!==f?n.compressedTexImage2D(34069+y,x,v,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+y,x,v,_.width,_.height,0,f,m,_.data)}}t.__maxMipLevel=h.length-1}else{h=r.mipmaps;for(var b=0;b<6;b++)if(s){n.texImage2D(34069+b,0,v,l[b].width,l[b].height,0,f,m,l[b].data);for(var w=0;w<h.length;w++){var M=h[w].image[b].image;n.texImage2D(34069+b,w+1,v,M.width,M.height,0,f,m,M.data)}}else{n.texImage2D(34069+b,0,v,f,m,l[b]);for(var E=0;E<h.length;E++){var A=h[E];n.texImage2D(34069+b,E+1,v,f,m,A.image[b])}}t.__maxMipLevel=h.length}O(r,p)&&z(34067,r,d.width,d.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}}(o,t,i):(n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture))}var j=((s={})[1e3]=10497,s[1001]=33071,s[1002]=33648,s),V=((l={})[1003]=9728,l[1004]=9984,l[1005]=9986,l[1006]=9729,l[1007]=9985,l[1008]=9987,l);function W(n,a,o){o?(e.texParameteri(n,10242,j[a.wrapS]),e.texParameteri(n,10243,j[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,j[a.wrapR]),e.texParameteri(n,10240,V[a.magFilter]),e.texParameteri(n,10241,V[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===h&&a.wrapT===h||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,F(a.magFilter)),e.texParameteri(n,10241,F(a.minFilter)),a.minFilter!==p&&a.minFilter!==v&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=t.get("EXT_texture_filter_anisotropic");if(s){if(a.type===b&&null===t.get("OES_texture_float_linear"))return;if(a.type===w&&null===(c||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function q(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",N),t.__webglTexture=e.createTexture(),o.memory.textures++)}function X(t,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),q(t,r),n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var s,l=function(e){return!c&&(e.wrapS!==h||e.wrapT!==h||e.minFilter!==p&&e.minFilter!==v)}(r)&&!1===I(r.image),u=D(r.image,l,!1,y),d=I(u)||c,f=a.convert(r.format),m=a.convert(r.type),g=k(r.internalFormat,f,m);W(o,r,d);var w=r.mipmaps;if(r.isDepthTexture)g=6402,c?g=r.type===b?36012:r.type===_?33190:r.type===M?35056:33189:r.type===b&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===E&&6402===g&&r.type!==x&&r.type!==_&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=x,m=a.convert(r.type)),r.format===A&&6402===g&&(g=34041,r.type!==M&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=M,m=a.convert(r.type))),n.texImage2D(3553,0,g,u.width,u.height,0,f,m,null);else if(r.isDataTexture)if(w.length>0&&d){for(var C=0,L=w.length;C<L;C++)s=w[C],n.texImage2D(3553,C,g,s.width,s.height,0,f,m,s.data);r.generateMipmaps=!1,t.__maxMipLevel=w.length-1}else n.texImage2D(3553,0,g,u.width,u.height,0,f,m,u.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var R=0,P=w.length;R<P;R++)s=w[R],r.format!==T&&r.format!==S?null!==f?n.compressedTexImage2D(3553,R,g,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,R,g,s.width,s.height,0,f,m,s.data);t.__maxMipLevel=w.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,g,u.width,u.height,u.depth,0,f,m,u.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,g,u.width,u.height,u.depth,0,f,m,u.data),t.__maxMipLevel=0;else if(w.length>0&&d){for(var F=0,N=w.length;F<N;F++)s=w[F],n.texImage2D(3553,F,g,f,m,s);r.generateMipmaps=!1,t.__maxMipLevel=w.length-1}else n.texImage2D(3553,0,g,f,m,u),t.__maxMipLevel=0;O(r,d)&&z(o,r,u.width,u.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function Y(t,i,o,s){var l=a.convert(i.texture.format),u=a.convert(i.texture.type),c=k(i.texture.internalFormat,l,u);n.texImage2D(s,0,c,i.width,i.height,0,l,u,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Z(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var i=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===b?i=36012:o.type===_&&(i=33190));var s=K(n);e.renderbufferStorageMultisample(36161,s,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var l=K(n);e.renderbufferStorageMultisample(36161,l,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var u=a.convert(n.texture.format),c=a.convert(n.texture.type),h=k(n.texture.internalFormat,u,c);if(r){var d=K(n);e.renderbufferStorageMultisample(36161,d,h,n.width,n.height)}else e.renderbufferStorage(36161,h,n.width,n.height)}e.bindRenderbuffer(36161,null)}function K(e){return c&&e.isWebGLMultisampleRenderTarget?Math.min(C,e.samples):0}var J=!1,Q=!1;this.allocateTextureUnit=function(){var e=U;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),U+=1,e},this.resetTextureUnits=function(){U=0},this.setTexture2D=G,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?X(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?X(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=H,this.setupRenderTarget=function(t){var i=r.get(t),s=r.get(t.texture);t.addEventListener("dispose",B),s.__webglTexture=e.createTexture(),o.memory.textures++;var l=!0===t.isWebGLCubeRenderTarget,u=!0===t.isWebGLMultisampleRenderTarget,h=I(t)||c;if(!c||t.texture.format!==S||t.texture.type!==b&&t.texture.type!==w||(t.texture.format=T,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),l){i.__webglFramebuffer=[];for(var d=0;d<6;d++)i.__webglFramebuffer[d]=e.createFramebuffer()}else if(i.__webglFramebuffer=e.createFramebuffer(),u)if(c){i.__webglMultisampledFramebuffer=e.createFramebuffer(),i.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,i.__webglColorRenderbuffer);var p=a.convert(t.texture.format),f=a.convert(t.texture.type),m=k(t.texture.internalFormat,p,f),v=K(t);e.renderbufferStorageMultisample(36161,v,m,t.width,t.height),e.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(i.__webglDepthRenderbuffer=e.createRenderbuffer(),Z(i.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){n.bindTexture(34067,s.__webglTexture),W(34067,t.texture,h);for(var g=0;g<6;g++)Y(i.__webglFramebuffer[g],t,36064,34069+g);O(t.texture,h)&&z(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),W(3553,t.texture,h),Y(i.__webglFramebuffer,t,36064,3553),O(t.texture,h)&&z(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&function(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),G(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===E)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==A)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=e.createRenderbuffer(),Z(n.__webglDepthbuffer[a],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),Z(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(O(t,I(e)||c)){var i=e.isWebGLCubeRenderTarget?34067:3553,a=r.get(t).__webglTexture;n.bindTexture(i,a),z(i,t,e.width,e.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(c){var n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var i=t.width,a=t.height,o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===J&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),J=!0),e=e.texture),G(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===Q&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Q=!0),e=e.texture),H(e,t)}}function Yi(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===y)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(e===x)return 5123;if(1013===e)return 5124;if(e===_)return 5125;if(e===b)return 5126;if(e===w)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(e===S)return 6407;if(e===T)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(e===E)return 6402;if(e===A)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(e===C||e===L||e===R||e===P){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===C)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===L)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===R)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===P)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===D||e===I||e===O||e===z){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===D)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===I)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===O)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===z)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===k||e===F)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===k)return n.COMPRESSED_RGB8_ETC2;if(e===F)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:36492===e?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===M?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function Zi(e){Un.call(this),this.cameras=e||[]}function Ki(){yt.call(this),this.type="Group"}function Ji(){this._targetRay=null,this._grip=null,this._hand=null}function Qi(e,t){var n=this,r=null,i=1,a=null,o="local-floor",s=null,l=[],u=new Map,c=new Un;c.layers.enable(1),c.viewport=new me;var h=new Un;h.layers.enable(2),h.viewport=new me;var d=[c,h],p=new Zi;p.layers.enable(1),p.layers.enable(2);var f=null,m=null;function v(e){var t=u.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function g(){u.forEach((function(e,t){e.disconnect(t)})),u.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(e){a=e,S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function x(e){for(var t=r.inputSources,n=0;n<l.length;n++)u.set(t[n],l[n]);for(var i=0;i<e.removed.length;i++){var a=e.removed[i],o=u.get(a);o&&(o.dispatchEvent({type:"disconnected",data:a}),u.delete(a))}for(var s=0;s<e.added.length;s++){var c=e.added[s],h=u.get(c);h&&h.dispatchEvent({type:"connected",data:c})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=l[e];return void 0===t&&(t=new Ji,l[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){var t=l[e];return void 0===t&&(t=new Ji,l[e]=t),t.getGripSpace()},this.getHand=function(e){var t=l[e];return void 0===t&&(t=new Ji,l[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=function(e){if(null!==(r=e)){r.addEventListener("select",v),r.addEventListener("selectstart",v),r.addEventListener("selectend",v),r.addEventListener("squeeze",v),r.addEventListener("squeezestart",v),r.addEventListener("squeezeend",v),r.addEventListener("end",g);var n=t.getContextAttributes();!0!==n.xrCompatible&&t.makeXRCompatible();var a={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:i},s=new XRWebGLLayer(r,t,a);r.updateRenderState({baseLayer:s}),r.requestReferenceSpace(o).then(y),r.addEventListener("inputsourceschange",x)}};var _=new xe,b=new xe;function w(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){p.near=h.near=c.near=e.near,p.far=h.far=c.far=e.far,f===p.near&&m===p.far||(r.updateRenderState({depthNear:p.near,depthFar:p.far}),f=p.near,m=p.far);var t=e.parent,n=p.cameras;w(p,t);for(var i=0;i<n.length;i++)w(n[i],t);e.matrixWorld.copy(p.matrixWorld);for(var a=e.children,o=0,s=a.length;o<s;o++)a[o].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=_.distanceTo(b),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],u=(i[9]-1)/i[5],c=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=o*c,p=o*h,f=r/(-c+h),m=f*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var v=o+f,g=s+f,y=d-m,x=p+(r-m),w=l*s/g*v,M=u*s/g*v;e.projectionMatrix.makePerspective(y,x,w,M,v,g)}(p,c,h):p.projectionMatrix.copy(c.projectionMatrix),p};var M=null,S=new Zn;S.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(a))){var i=s.views,o=r.renderState.baseLayer;e.setFramebuffer(o.framebuffer);var u=!1;i.length!==p.cameras.length&&(p.cameras.length=0,u=!0);for(var c=0;c<i.length;c++){var h=i[c],f=o.getViewport(h),m=d[c];m.matrix.fromArray(h.transform.matrix),m.projectionMatrix.fromArray(h.projectionMatrix),m.viewport.set(f.x,f.y,f.width,f.height),0===c&&p.matrix.copy(m.matrix),!0===u&&p.cameras.push(m)}}for(var v=r.inputSources,g=0;g<l.length;g++){var y=l[g],x=v[g];y.update(x,n,a)}M&&M(t,n)})),this.setAnimationLoop=function(e){M=e},this.dispose=function(){}}function $i(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,i,a=e.get(n).envMap;if(a){t.envMap.value=a,t.flipEnvMap.value=a.isCubeTexture&&a._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var o=e.get(a).__maxMipLevel;void 0!==o&&(t.maxMipLevel.value=o)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?i=n.aoMap:n.lightMap&&(i=n.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uv2Transform.value.copy(i.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate()),e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){var i;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?i=t.map:t.alphaMap&&(i=t.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,i,a):r.isSpriteMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ea(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,d=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=q,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p=this,f=!1,m=null,v=0,g=0,x=null,_=null,M=-1,S=null,E=null,A=new me,C=new me,L=null,R=t.width,P=t.height,D=1,I=null,O=null,z=new me(0,0,R,P),k=new me(0,0,R,P),F=!1,N=new Yn,B=!1,U=!1,G=new Xe,H=new xe,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===x?D:1}var W,X,Y,Z,K,J,Q,$,ee,te,ne,re,ae,oe,se,le,ue,he,de,pe,fe,ve=n;function ge(e,n){for(var r=0;r<e.length;r++){var i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{var ye={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",Se,!1),t.addEventListener("webglcontextrestored",Te,!1),null===ve){var _e=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&_e.shift(),null===(ve=ge(_e,ye)))throw ge(_e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ve.getShaderPrecisionFormat&&(ve.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function be(){W=new sr(ve),!1===(X=new ir(ve,W,e)).isWebGL2&&(W.get("WEBGL_depth_texture"),W.get("OES_texture_float"),W.get("OES_texture_half_float"),W.get("OES_texture_half_float_linear"),W.get("OES_standard_derivatives"),W.get("OES_element_index_uint"),W.get("OES_vertex_array_object"),W.get("ANGLE_instanced_arrays")),W.get("OES_texture_float_linear"),pe=new Yi(ve,W,X),(Y=new qi(ve,W,X)).scissor(C.copy(k).multiplyScalar(D).floor()),Y.viewport(A.copy(z).multiplyScalar(D).floor()),Z=new cr(ve),K=new Di,J=new Xi(ve,W,Y,K,X,pe,Z),Q=new or(p),$=new Kn(ve,X),fe=new nr(ve,W,$,X),ee=new lr(ve,$,Z,fe),te=new fr(ve,ee,$,Z),ue=new pr(ve),se=new ar(K),ne=new Pi(p,Q,W,X,fe,se),re=new $i(K),ae=new ki(K),oe=new Hi(W,X),le=new tr(p,Q,Y,te,s),he=new rr(ve,W,Z,X),de=new ur(ve,W,Z,X),Z.programs=ne.programs,p.capabilities=X,p.extensions=W,p.properties=K,p.renderLists=ae,p.state=Y,p.info=Z}be();var we=new Qi(p,ve);this.xr=we;var Me=new Wi(p,te,X.maxTextureSize);function Se(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),f=!0}function Te(){console.log("THREE.WebGLRenderer: Context Restored."),f=!1,be()}function Ee(e){var t=e.target;t.removeEventListener("dispose",Ee),function(e){Ae(e),K.remove(e)}(t)}function Ae(e){var t=K.get(e).program;void 0!==t&&ne.releaseProgram(t)}this.shadowMap=Me,this.getContext=function(){return ve},this.getContextAttributes=function(){return ve.getContextAttributes()},this.forceContextLoss=function(){var e=W.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=W.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(e){void 0!==e&&(D=e,this.setSize(R,P,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new ce),e.set(R,P)},this.setSize=function(e,n,r){we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=e,P=n,t.width=Math.floor(e*D),t.height=Math.floor(n*D),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new ce),e.set(R*D,P*D).floor()},this.setDrawingBufferSize=function(e,n,r){R=e,P=n,D=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new me),e.copy(A)},this.getViewport=function(e){return e.copy(z)},this.setViewport=function(e,t,n,r){e.isVector4?z.set(e.x,e.y,e.z,e.w):z.set(e,t,n,r),Y.viewport(A.copy(z).multiplyScalar(D).floor())},this.getScissor=function(e){return e.copy(k)},this.setScissor=function(e,t,n,r){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,r),Y.scissor(C.copy(k).multiplyScalar(D).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(e){Y.setScissorTest(F=e)},this.setOpaqueSort=function(e){I=e},this.setTransparentSort=function(e){O=e},this.getClearColor=function(){return le.getClearColor()},this.setClearColor=function(){le.setClearColor.apply(le,arguments)},this.getClearAlpha=function(){return le.getClearAlpha()},this.setClearAlpha=function(){le.setClearAlpha.apply(le,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ve.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Se,!1),t.removeEventListener("webglcontextrestored",Te,!1),ae.dispose(),oe.dispose(),K.dispose(),Q.dispose(),te.dispose(),fe.dispose(),we.dispose(),Le.stop()},this.renderBufferImmediate=function(e,t){fe.initAttributes();var n=K.get(e);e.hasPositions&&!n.position&&(n.position=ve.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ve.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ve.createBuffer()),e.hasColors&&!n.color&&(n.color=ve.createBuffer());var r=t.getAttributes();e.hasPositions&&(ve.bindBuffer(34962,n.position),ve.bufferData(34962,e.positionArray,35048),fe.enableAttribute(r.position),ve.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(ve.bindBuffer(34962,n.normal),ve.bufferData(34962,e.normalArray,35048),fe.enableAttribute(r.normal),ve.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(ve.bindBuffer(34962,n.uv),ve.bufferData(34962,e.uvArray,35048),fe.enableAttribute(r.uv),ve.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(ve.bindBuffer(34962,n.color),ve.bufferData(34962,e.colorArray,35048),fe.enableAttribute(r.color),ve.vertexAttribPointer(r.color,3,5126,!1,0,0)),fe.disableUnusedAttributes(),ve.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=j);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=Oe(e,t,r,i);Y.setMaterial(r,o);var l=n.index,u=n.attributes.position;if(null===l){if(void 0===u||0===u.count)return}else if(0===l.count)return;var c,h=1;!0===r.wireframe&&(l=ee.getWireframeAttribute(n),h=2),(r.morphTargets||r.morphNormals)&&ue.update(i,n,r,s),fe.setup(i,r,s,n,l);var d=he;null!==l&&(c=$.get(l),(d=de).setIndex(c));var p=null!==l?l.count:u.count,f=n.drawRange.start*h,m=n.drawRange.count*h,v=null!==a?a.start*h:0,g=null!==a?a.count*h:1/0,y=Math.max(f,v),x=Math.min(p,f+m,v+g)-1,_=Math.max(0,x-y+1);if(0!==_){if(i.isMesh)!0===r.wireframe?(Y.setLineWidth(r.wireframeLinewidth*V()),d.setMode(1)):d.setMode(4);else if(i.isLine){var b=r.linewidth;void 0===b&&(b=1),Y.setLineWidth(b*V()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(y,_,i.count);else if(n.isInstancedBufferGeometry){var w=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,_,w)}else d.render(y,_)}},this.compile=function(e,t){(d=oe.get(e,t)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(t);var n=new WeakMap;e.traverse((function(t){var r=t.material;if(r)if(Array.isArray(r))for(var i=0;i<r.length;i++){var a=r[i];!1===n.has(a)&&(Ie(a,e,t),n.set(a))}else!1===n.has(r)&&(Ie(r,e,t),n.set(r))}))};var Ce=null,Le=new Zn;function Re(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||N.intersectsSprite(e)){r&&H.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G);var i=te.update(e),a=e.material;a.visible&&h.push(e,i,a,n,H.z,null)}}else if(e.isImmediateRenderObject)r&&H.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G),h.push(e,null,e.material,n,H.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Z.render.frame&&(e.skeleton.update(),e.skeleton.frame=Z.render.frame),!e.frustumCulled||N.intersectsObject(e))){r&&H.setFromMatrixPosition(e.matrixWorld).applyMatrix4(G);var o=te.update(e),s=e.material;if(Array.isArray(s))for(var l=o.groups,u=0,c=l.length;u<c;u++){var p=l[u],f=s[p.materialIndex];f&&f.visible&&h.push(e,o,f,n,H.z,p)}else s.visible&&h.push(e,o,s,n,H.z,null)}for(var m=e.children,v=0,g=m.length;v<g;v++)Re(m[v],t,n,r)}}function Pe(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,l=o.geometry,u=null===r?o.material:r,c=o.group;if(n.isArrayCamera){E=n;for(var h=n.cameras,p=0,f=h.length;p<f;p++){var m=h[p];s.layers.test(m.layers)&&(Y.viewport(A.copy(m.viewport)),d.setupLights(m),De(s,t,m,l,u,c))}}else E=null,De(s,t,n,l,u,c)}}function De(e,t,n,r,i,a){if(e.onBeforeRender(p,t,n,r,i,a),d=oe.get(t,E||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=Oe(n,t,i,e);Y.setMaterial(i),fe.reset(),function(e,t){e.render((function(e){p.renderBufferImmediate(e,t)}))}(e,o)}else p.renderBufferDirect(n,t,r,i,e,a);e.onAfterRender(p,t,n,r,i,a),d=oe.get(t,E||n)}function Ie(e,t,n){!0!==t.isScene&&(t=j);var r=K.get(e),i=d.state.lights,a=d.state.shadowsArray,o=i.state.version,s=ne.getParameters(e,i.state,a,t,n),l=ne.getProgramCacheKey(s),u=r.program,c=!0;if(void 0===u)e.addEventListener("dispose",Ee);else if(u.cacheKey!==l)Ae(e);else if(r.lightsStateVersion!==o)c=!1;else{if(void 0!==s.shaderID){var h=e.isMeshStandardMaterial?t.environment:null;return void(r.envMap=Q.get(e.envMap||h))}c=!1}c&&(s.uniforms=ne.getUniforms(e),e.onBeforeCompile(s,p),u=ne.acquireProgram(s,l),r.program=u,r.uniforms=s.uniforms,r.outputEncoding=s.outputEncoding);var f=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=se.numPlanes,r.numIntersection=se.numIntersection,f.clippingPlanes=se.uniform),r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=Q.get(e.envMap||r.environment),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(f.ambientLightColor.value=i.state.ambient,f.lightProbe.value=i.state.probe,f.directionalLights.value=i.state.directional,f.directionalLightShadows.value=i.state.directionalShadow,f.spotLights.value=i.state.spot,f.spotLightShadows.value=i.state.spotShadow,f.rectAreaLights.value=i.state.rectArea,f.ltc_1.value=i.state.rectAreaLTC1,f.ltc_2.value=i.state.rectAreaLTC2,f.pointLights.value=i.state.point,f.pointLightShadows.value=i.state.pointShadow,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),v=hi.seqWithValue(m.seq,f);r.uniformsList=v}function Oe(e,t,n,r){!0!==t.isScene&&(t=j),J.resetTextureUnits();var i=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===x?p.outputEncoding:x.texture.encoding,s=Q.get(n.envMap||a),l=K.get(n),u=d.state.lights;if(!0===B&&(!0===U||e!==S)){var c=e===S&&n.id===M;se.setState(n,e,c)}n.version===l.__version?n.fog&&l.fog!==i||l.environment!==a||l.needsLights&&l.lightsStateVersion!==u.state.version?Ie(n,t,r):void 0===l.numClippingPlanes||l.numClippingPlanes===se.numPlanes&&l.numIntersection===se.numIntersection?(l.outputEncoding!==o||l.envMap!==s)&&Ie(n,t,r):Ie(n,t,r):(Ie(n,t,r),l.__version=n.version);var h,f,m=!1,v=!1,g=!1,y=l.program,_=y.getUniforms(),w=l.uniforms;if(Y.useProgram(y.program)&&(m=!0,v=!0,g=!0),n.id!==M&&(M=n.id,v=!0),m||S!==e){if(_.setValue(ve,"projectionMatrix",e.projectionMatrix),X.logarithmicDepthBuffer&&_.setValue(ve,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),S!==e&&(S=e,v=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var E=_.map.cameraPosition;void 0!==E&&E.setValue(ve,H.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&_.setValue(ve,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&_.setValue(ve,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){_.setOptional(ve,r,"bindMatrix"),_.setOptional(ve,r,"bindMatrixInverse");var A=r.skeleton;if(A){var C=A.bones;if(X.floatVertexTextures){if(void 0===A.boneTexture){var L=Math.sqrt(4*C.length);L=ie.ceilPowerOfTwo(L),L=Math.max(L,4);var R=new Float32Array(L*L*4);R.set(A.boneMatrices);var I=new Wn(R,L,L,T,b);A.boneMatrices=R,A.boneTexture=I,A.boneTextureSize=L}_.setValue(ve,"boneTexture",A.boneTexture,J),_.setValue(ve,"boneTextureSize",A.boneTextureSize)}else _.setOptional(ve,A,"boneMatrices")}}return(v||l.receiveShadow!==r.receiveShadow)&&(l.receiveShadow=r.receiveShadow,_.setValue(ve,"receiveShadow",r.receiveShadow)),v&&(_.setValue(ve,"toneMappingExposure",p.toneMappingExposure),l.needsLights&&(f=g,(h=w).ambientLightColor.needsUpdate=f,h.lightProbe.needsUpdate=f,h.directionalLights.needsUpdate=f,h.directionalLightShadows.needsUpdate=f,h.pointLights.needsUpdate=f,h.pointLightShadows.needsUpdate=f,h.spotLights.needsUpdate=f,h.spotLightShadows.needsUpdate=f,h.rectAreaLights.needsUpdate=f,h.hemisphereLights.needsUpdate=f),i&&n.fog&&re.refreshFogUniforms(w,i),re.refreshMaterialUniforms(w,n,D,P),hi.upload(ve,l.uniformsList,w,J)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(hi.upload(ve,l.uniformsList,w,J),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&_.setValue(ve,"center",r.center),_.setValue(ve,"modelViewMatrix",r.modelViewMatrix),_.setValue(ve,"normalMatrix",r.normalMatrix),_.setValue(ve,"modelMatrix",r.matrixWorld),y}Le.setAnimationLoop((function(e){we.isPresenting||Ce&&Ce(e)})),"undefined"!=typeof window&&Le.setContext(window),this.setAnimationLoop=function(e){Ce=e,we.setAnimationLoop(e),null===e?Le.stop():Le.start()},this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==f){fe.resetDefaultState(),M=-1,S=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(t=we.getCamera(t)),!0===e.isScene&&e.onBeforeRender(p,e,t,n||x),(d=oe.get(e,t)).init(),G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),N.setFromProjectionMatrix(G),U=this.localClippingEnabled,B=se.init(this.clippingPlanes,U,t),(h=ae.get(e,t)).init(),Re(e,t,0,p.sortObjects),h.finish(),!0===p.sortObjects&&h.sort(I,O),!0===B&&se.beginShadows();var i=d.state.shadowsArray;Me.render(i,e,t),d.setupLights(t),!0===B&&se.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),le.render(h,e,t,r);var a=h.opaque,o=h.transparent;a.length>0&&Pe(a,e,t),o.length>0&&Pe(o,e,t),!0===e.isScene&&e.onAfterRender(p,e,t),null!==x&&(J.updateRenderTargetMipmap(x),J.updateMultisampleRenderTarget(x)),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){m!==e&&null===x&&ve.bindFramebuffer(36160,e),m=e},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return g},this.getRenderList=function(){return h},this.setRenderList=function(e){h=e},this.getRenderState=function(){return d},this.setRenderState=function(e){d=e},this.getRenderTarget=function(){return x},this.setRenderTarget=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),x=e,v=t,g=n,e&&void 0===K.get(e).__webglFramebuffer&&J.setupRenderTarget(e);var r=m,i=!1;if(e){var a=K.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=a[t],i=!0):r=e.isWebGLMultisampleRenderTarget?K.get(e).__webglMultisampledFramebuffer:a,A.copy(e.viewport),C.copy(e.scissor),L=e.scissorTest}else A.copy(z).multiplyScalar(D).floor(),C.copy(k).multiplyScalar(D).floor(),L=F;if(_!==r&&(ve.bindFramebuffer(36160,r),_=r),Y.viewport(A),Y.scissor(C),Y.setScissorTest(L),i){var o=K.get(e.texture);ve.framebufferTexture2D(36160,36064,34069+t,o.__webglTexture,n)}},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=K.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){var l=!1;s!==_&&(ve.bindFramebuffer(36160,s),l=!0);try{var u=e.texture,c=u.format,h=u.type;if(c!==T&&pe.convert(c)!==ve.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(h===y||pe.convert(h)===ve.getParameter(35738)||h===b&&(X.isWebGL2||W.get("OES_texture_float")||W.get("WEBGL_color_buffer_float"))||h===w&&(X.isWebGL2?W.get("EXT_color_buffer_float"):W.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ve.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ve.readPixels(t,n,r,i,pe.convert(c),pe.convert(h),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{l&&ve.bindFramebuffer(36160,_)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r),o=pe.convert(t.format);J.setTexture2D(t,0),ve.copyTexImage2D(3553,n,o,e.x,e.y,i,a,0),Y.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){void 0===r&&(r=0);var i=t.image.width,a=t.image.height,o=pe.convert(n.format),s=pe.convert(n.type);J.setTexture2D(n,0),ve.pixelStorei(37440,n.flipY),ve.pixelStorei(37441,n.premultiplyAlpha),ve.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ve.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?ve.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ve.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ve.generateMipmap(3553),Y.unbindTexture()},this.initTexture=function(e){J.setTexture2D(e,0),Y.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ta(e){ea.call(this,e)}ji.prototype=Object.create(jt.prototype),ji.prototype.constructor=ji,ji.prototype.isMeshDepthMaterial=!0,ji.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Vi.prototype=Object.create(jt.prototype),Vi.prototype.constructor=Vi,Vi.prototype.isMeshDistanceMaterial=!0,Vi.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Zi.prototype=Object.assign(Object.create(Un.prototype),{constructor:Zi,isArrayCamera:!0}),Ki.prototype=Object.assign(Object.create(yt.prototype),{constructor:Ki,isGroup:!0}),Object.assign(Ji.prototype,{constructor:Ji,getHandSpace:function(){if(null===this._hand&&(this._hand=new Ki,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){var t=new Ki;t.matrixAutoUpdate=!1,t.visible=!1,this._hand.joints.push(t),this._hand.add(t)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ki,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ki,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){var r=null,i=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e)if(l&&e.hand){a=!0;for(var u=0;u<=window.XRHand.LITTLE_PHALANX_TIP;u++)if(e.hand[u]){var c=t.getJointPose(e.hand[u],n),h=l.joints[u];null!==c&&(h.matrix.fromArray(c.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.jointRadius=c.radius),h.visible=null!==c;var d=l.joints[window.XRHand.INDEX_PHALANX_TIP],p=l.joints[window.XRHand.THUMB_PHALANX_TIP],f=d.position.distanceTo(p.position);l.inputState.pinching&&f>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&f<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)),null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,n))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale));return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}}),Object.assign(Qi.prototype,ee.prototype),ta.prototype=Object.assign(Object.create(ea.prototype),{constructor:ta,isWebGL1Renderer:!0});var na=function(){function e(e,t){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new Ut(e),this.density=void 0!==t?t:25e-5}var t=e.prototype;return t.clone=function(){return new e(this.color,this.density)},t.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}(),ra=function(){function e(e,t,n){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new Ut(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}var t=e.prototype;return t.clone=function(){return new e(this.color,this.near,this.far)},t.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}(),ia=function(e){function t(){var t;return t=e.call(this)||this,Object.defineProperty(le(t),"isScene",{value:!0}),t.type="Scene",t.background=null,t.environment=null,t.fog=null,t.overrideMaterial=null,t.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:le(t)})),t}se(t,e);var n=t.prototype;return n.copy=function(t,n){return e.prototype.copy.call(this,t,n),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},n.toJSON=function(t){var n=e.prototype.toJSON.call(this,t);return null!==this.background&&(n.object.background=this.background.toJSON(t)),null!==this.environment&&(n.object.environment=this.environment.toJSON(t)),null!==this.fog&&(n.object.fog=this.fog.toJSON()),n},t}(yt);function aa(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=J,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ie.generateUUID()}Object.defineProperty(aa.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(aa.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ie.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new aa(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ie.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var oa,sa=new xe;function la(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function ua(e){jt.call(this),this.type="SpriteMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.defineProperties(la.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(la.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)sa.x=this.getX(t),sa.y=this.getY(t),sa.z=this.getZ(t),sa.applyMatrix4(e),this.setXYZ(t,sa.x,sa.y,sa.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return new Xt(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new la(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,i=0;i<this.itemSize;i++)t.push(this.data.array[r+i]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),ua.prototype=Object.create(jt.prototype),ua.prototype.constructor=ua,ua.prototype.isSpriteMaterial=!0,ua.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var ca=new xe,ha=new xe,da=new xe,pa=new ce,fa=new ce,ma=new Xe,va=new xe,ga=new xe,ya=new xe,xa=new ce,_a=new ce,ba=new ce;function wa(e){if(yt.call(this),this.type="Sprite",void 0===oa){oa=new pn;var t=new aa(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);oa.setIndex([0,1,2,0,2,3]),oa.setAttribute("position",new la(t,3,0,!1)),oa.setAttribute("uv",new la(t,2,3,!1))}this.geometry=oa,this.material=void 0!==e?e:new ua,this.center=new ce(.5,.5)}function Ma(e,t,n,r,i,a){pa.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(fa.x=a*pa.x-i*pa.y,fa.y=i*pa.x+a*pa.y):fa.copy(pa),e.copy(t),e.x+=fa.x,e.y+=fa.y,e.applyMatrix4(ma)}wa.prototype=Object.assign(Object.create(yt.prototype),{constructor:wa,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ha.setFromMatrixScale(this.matrixWorld),ma.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),da.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ha.multiplyScalar(-da.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;Ma(va.set(-.5,-.5,0),da,a,ha,n,r),Ma(ga.set(.5,-.5,0),da,a,ha,n,r),Ma(ya.set(.5,.5,0),da,a,ha,n,r),xa.set(0,0),_a.set(1,0),ba.set(1,1);var o=e.ray.intersectTriangle(va,ga,ya,!1,ca);if(null!==o||(Ma(ga.set(-.5,.5,0),da,a,ha,n,r),_a.set(0,1),null!==(o=e.ray.intersectTriangle(va,ya,ga,!1,ca)))){var s=e.ray.origin.distanceTo(ca);s<e.near||s>e.far||t.push({distance:s,point:ca.clone(),uv:It.getUV(ca,va,ga,ya,xa,_a,ba,new ce),face:null,object:this})}},copy:function(e){return yt.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}});var Sa,Ta,Ea,Aa,Ca,La=new xe,Ra=new xe;function Pa(){yt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Da(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Pn.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Xe,this.bindMatrixInverse=new Xe}Pa.prototype=Object.assign(Object.create(yt.prototype),{constructor:Pa,isLOD:!0,copy:function(e){yt.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(this.levels.length>0){La.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(La);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){La.setFromMatrixPosition(e.matrixWorld),Ra.setFromMatrixPosition(this.matrixWorld);var n,r,i=La.distanceTo(Ra)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}},toJSON:function(e){var t=yt.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),Da.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Da,isSkinnedMesh:!0,copy:function(e){return Pn.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new me,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Pn.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:(Sa=new xe,Ta=new me,Ea=new me,Aa=new xe,Ca=new Xe,function(e,t){var n=this.skeleton,r=this.geometry;Ta.fromBufferAttribute(r.attributes.skinIndex,e),Ea.fromBufferAttribute(r.attributes.skinWeight,e),Sa.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var i=0;i<4;i++){var a=Ea.getComponent(i);if(0!==a){var o=Ta.getComponent(i);Ca.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Aa.copy(Sa).applyMatrix4(Ca),a)}}return t.applyMatrix4(this.bindMatrixInverse)})});var Ia=new Xe,Oa=new Xe;function za(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Xe)}}function ka(){yt.call(this),this.type="Bone"}Object.assign(za.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Xe;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.getInverse(this.boneInverses[e])}for(var r=0,i=this.bones.length;r<i;r++){var a=this.bones[r];a&&(a.parent&&a.parent.isBone?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:Oa;Ia.multiplyMatrices(o,t[i]),Ia.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new za(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),ka.prototype=Object.assign(Object.create(yt.prototype),{constructor:ka,isBone:!0});var Fa=new Xe,Na=new Xe,Ba=[],Ua=new Pn;function Ga(e,t,n){Pn.call(this,e,t),this.instanceMatrix=new Xt(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}function Ha(e){jt.call(this),this.type="LineBasicMaterial",this.color=new Ut(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}Ga.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Ga,isInstancedMesh:!0,copy:function(e){return Pn.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new Xt(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Ua.geometry=this.geometry,Ua.material=this.material,void 0!==Ua.material)for(var i=0;i<r;i++){this.getMatrixAt(i,Fa),Na.multiplyMatrices(n,Fa),Ua.matrixWorld=Na,Ua.raycast(e,Ba);for(var a=0,o=Ba.length;a<o;a++){var s=Ba[a];s.instanceId=i,s.object=this,t.push(s)}Ba.length=0}},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),Ha.prototype=Object.create(jt.prototype),Ha.prototype.constructor=Ha,Ha.prototype.isLineBasicMaterial=!0,Ha.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var ja=new xe,Va=new xe,Wa=new Xe,qa=new qe,Xa=new Ne;function Ya(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),yt.call(this),this.type="Line",this.geometry=void 0!==e?e:new pn,this.material=void 0!==t?t:new Ha,this.updateMorphTargets()}Ya.prototype=Object.assign(Object.create(yt.prototype),{constructor:Ya,isLine:!0,copy:function(e){return yt.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)ja.fromBufferAttribute(t,r-1),Va.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=ja.distanceTo(Va);e.setAttribute("lineDistance",new tn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices,o=e.lineDistances;o[0]=0;for(var s=1,l=a.length;s<l;s++)o[s]=o[s-1],o[s]+=a[s-1].distanceTo(a[s])}return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Xa.copy(n.boundingSphere),Xa.applyMatrix4(r),Xa.radius+=i,!1!==e.ray.intersectsSphere(Xa)){Wa.getInverse(r),qa.copy(e.ray).applyMatrix4(Wa);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new xe,l=new xe,u=new xe,c=new xe,h=this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,p=n.attributes.position;if(null!==d)for(var f=d.array,m=0,v=f.length-1;m<v;m+=h){var g=f[m],y=f[m+1];if(s.fromBufferAttribute(p,g),l.fromBufferAttribute(p,y),!(qa.distanceSqToSegment(s,l,c,u)>o)){c.applyMatrix4(this.matrixWorld);var x=e.ray.origin.distanceTo(c);x<e.near||x>e.far||t.push({distance:x,point:u.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else for(var _=0,b=p.count-1;_<b;_+=h)if(s.fromBufferAttribute(p,_),l.fromBufferAttribute(p,_+1),!(qa.distanceSqToSegment(s,l,c,u)>o)){c.applyMatrix4(this.matrixWorld);var w=e.ray.origin.distanceTo(c);w<e.near||w>e.far||t.push({distance:w,point:u.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else if(n.isGeometry)for(var M=n.vertices,S=M.length,T=0;T<S-1;T+=h)if(!(qa.distanceSqToSegment(M[T],M[T+1],c,u)>o)){c.applyMatrix4(this.matrixWorld);var E=e.ray.origin.distanceTo(c);E<e.near||E>e.far||t.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var Za=new xe,Ka=new xe;function Ja(e,t){Ya.call(this,e,t),this.type="LineSegments"}function Qa(e,t){Ya.call(this,e,t),this.type="LineLoop"}function $a(e){jt.call(this),this.type="PointsMaterial",this.color=new Ut(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}Ja.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Ja,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Za.fromBufferAttribute(t,r),Ka.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Za.distanceTo(Ka);e.setAttribute("lineDistance",new tn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var a=e.vertices,o=e.lineDistances,s=0,l=a.length;s<l;s+=2)Za.copy(a[s]),Ka.copy(a[s+1]),o[s]=0===s?0:o[s-1],o[s+1]=o[s]+Za.distanceTo(Ka);return this}}),Qa.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Qa,isLineLoop:!0}),$a.prototype=Object.create(jt.prototype),$a.prototype.constructor=$a,$a.prototype.isPointsMaterial=!0,$a.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var eo=new Xe,to=new qe,no=new Ne,ro=new xe;function io(e,t){yt.call(this),this.type="Points",this.geometry=void 0!==e?e:new pn,this.material=void 0!==t?t:new $a,this.updateMorphTargets()}function ao(e,t,n,r,i,a,o){var s=to.distanceSqToPoint(e);if(s<n){var l=new xe;to.closestPointToPoint(e,l),l.applyMatrix4(r);var u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:t,face:null,object:o})}}function oo(e,t,n,r,i,a,o,s,l){fe.call(this,e,t,n,r,i,a,o,s,l),this.format=void 0!==o?o:S,this.minFilter=void 0!==a?a:v,this.magFilter=void 0!==i?i:v,this.generateMipmaps=!1;var u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){u.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}function so(e,t,n,r,i,a,o,s,l,u,c,h){fe.call(this,null,a,o,s,l,u,r,i,c,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function lo(e,t,n,r,i,a,o,s,l){fe.call(this,e,t,n,r,i,a,o,s,l),this.needsUpdate=!0}function uo(e,t,n,r,i,a,o,s,l,u){if((u=void 0!==u?u:E)!==E&&u!==A)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===E&&(n=x),void 0===n&&u===A&&(n=M),fe.call(this,null,r,i,a,o,s,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:p,this.minFilter=void 0!==s?s:p,this.flipY=!1,this.generateMipmaps=!1}io.prototype=Object.assign(Object.create(yt.prototype),{constructor:io,isPoints:!0,copy:function(e){return yt.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),no.copy(n.boundingSphere),no.applyMatrix4(r),no.radius+=i,!1!==e.ray.intersectsSphere(no)){eo.getInverse(r),to.copy(e.ray).applyMatrix4(eo);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,l=n.attributes.position;if(null!==s)for(var u=s.array,c=0,h=u.length;c<h;c++){var d=u[c];ro.fromBufferAttribute(l,d),ao(ro,d,o,r,e,t,this)}else for(var p=0,f=l.count;p<f;p++)ro.fromBufferAttribute(l,p),ao(ro,p,o,r,e,t,this)}else for(var m=n.vertices,v=0,g=m.length;v<g;v++)ao(m[v],v,o,r,e,t,this)}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,a=r.length;i<a;i++){var o=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=i}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),oo.prototype=Object.assign(Object.create(fe.prototype),{constructor:oo,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var e=this.image;0=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),so.prototype=Object.create(fe.prototype),so.prototype.constructor=so,so.prototype.isCompressedTexture=!0,lo.prototype=Object.create(fe.prototype),lo.prototype.constructor=lo,lo.prototype.isCanvasTexture=!0,uo.prototype=Object.create(fe.prototype),uo.prototype.constructor=uo,uo.prototype.isDepthTexture=!0;var co=0,ho=new Xe,po=new yt,fo=new xe;function mo(){Object.defineProperty(this,"id",{value:co+=2}),this.uuid=ie.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}mo.prototype=Object.assign(Object.create(ee.prototype),{constructor:mo,isGeometry:!0,applyMatrix4:function(e){for(var t=(new he).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);for(var i=0,a=this.faces.length;i<a;i++){var o=this.faces[i];o.normal.applyMatrix3(t).normalize();for(var s=0,l=o.vertexNormals.length;s<l;s++)o.vertexNormals[s].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return ho.makeRotationX(e),this.applyMatrix4(ho),this},rotateY:function(e){return ho.makeRotationY(e),this.applyMatrix4(ho),this},rotateZ:function(e){return ho.makeRotationZ(e),this.applyMatrix4(ho),this},translate:function(e,t,n){return ho.makeTranslation(e,t,n),this.applyMatrix4(ho),this},scale:function(e,t,n){return ho.makeScale(e,t,n),this.applyMatrix4(ho),this},lookAt:function(e){return po.lookAt(e),po.updateMatrix(),this.applyMatrix4(po.matrix),this},fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index:void 0,r=e.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position,a=r.normal,o=r.color,s=r.uv,l=r.uv2;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var u=0;u<i.count;u++)t.vertices.push((new xe).fromBufferAttribute(i,u)),void 0!==o&&t.colors.push((new Ut).fromBufferAttribute(o,u));function c(e,n,r,i){var u=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],c=void 0===a?[]:[(new xe).fromBufferAttribute(a,e),(new xe).fromBufferAttribute(a,n),(new xe).fromBufferAttribute(a,r)],h=new Gt(e,n,r,c,u,i);t.faces.push(h),void 0!==s&&t.faceVertexUvs[0].push([(new ce).fromBufferAttribute(s,e),(new ce).fromBufferAttribute(s,n),(new ce).fromBufferAttribute(s,r)]),void 0!==l&&t.faceVertexUvs[1].push([(new ce).fromBufferAttribute(l,e),(new ce).fromBufferAttribute(l,n),(new ce).fromBufferAttribute(l,r)])}var h=e.groups;if(h.length>0)for(var d=0;d<h.length;d++)for(var p=h[d],f=p.start,m=f,v=f+p.count;m<v;m+=3)void 0!==n?c(n.getX(m),n.getX(m+1),n.getX(m+2),p.materialIndex):c(m,m+1,m+2,p.materialIndex);else if(void 0!==n)for(var g=0;g<n.count;g+=3)c(n.getX(g),n.getX(g+1),n.getX(g+2));else for(var y=0;y<i.count;y+=3)c(y,y+1,y+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(fo).negate(),this.translate(fo.x,fo.y,fo.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new Xe;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var e=new xe,t=new xe,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);for(var t=new Array(this.vertices.length),n=0,r=this.vertices.length;n<r;n++)t[n]=new xe;if(e)for(var i=new xe,a=new xe,o=0,s=this.faces.length;o<s;o++){var l=this.faces[o],u=this.vertices[l.a],c=this.vertices[l.b],h=this.vertices[l.c];i.subVectors(h,c),a.subVectors(u,c),i.cross(a),t[l.a].add(i),t[l.b].add(i),t[l.c].add(i)}else{this.computeFaceNormals();for(var d=0,p=this.faces.length;d<p;d++){var f=this.faces[d];t[f.a].add(f.normal),t[f.b].add(f.normal),t[f.c].add(f.normal)}}for(var m=0,v=this.vertices.length;m<v;m++)t[m].normalize();for(var g=0,y=this.faces.length;g<y;g++){var x=this.faces[g],_=x.vertexNormals;3===_.length?(_[0].copy(t[x.a]),_[1].copy(t[x.b]),_[2].copy(t[x.c])):(_[0]=t[x.a].clone(),_[1]=t[x.b].clone(),_[2]=t[x.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var e=0,t=this.faces.length;e<t;e++){var n=this.faces[e],r=n.vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var e=0,t=this.faces.length;e<t;e++){var n=this.faces[e];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);for(var r=0,i=n.vertexNormals.length;r<i;r++)n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}var a=new mo;a.faces=this.faces;for(var o=0,s=this.morphTargets.length;o<s;o++){if(!this.morphNormals[o]){this.morphNormals[o]={},this.morphNormals[o].faceNormals=[],this.morphNormals[o].vertexNormals=[];for(var l=this.morphNormals[o].faceNormals,u=this.morphNormals[o].vertexNormals,c=0,h=this.faces.length;c<h;c++){var d=new xe,p={a:new xe,b:new xe,c:new xe};l.push(d),u.push(p)}}var f=this.morphNormals[o];a.vertices=this.morphTargets[o].vertices,a.computeFaceNormals(),a.computeVertexNormals();for(var m=0,v=this.faces.length;m<v;m++){var g=this.faces[m],y=f.faceNormals[m],x=f.vertexNormals[m];y.copy(g.normal),x.a.copy(g.vertexNormals[0]),x.b.copy(g.vertexNormals[1]),x.c.copy(g.vertexNormals[2])}}for(var _=0,b=this.faces.length;_<b;_++){var w=this.faces[_];w.normal=w.__originalFaceNormal,w.vertexNormals=w.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new we),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ne),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,u=this.colors,c=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new he).getNormalMatrix(t));for(var h=0,d=o.length;h<d;h++){var p=o[h].clone();void 0!==t&&p.applyMatrix4(t),a.push(p)}for(var f=0,m=c.length;f<m;f++)u.push(c[f].clone());for(var v=0,g=l.length;v<g;v++){var y=l[v],x=void 0,_=void 0,b=y.vertexNormals,w=y.vertexColors,M=new Gt(y.a+i,y.b+i,y.c+i);M.normal.copy(y.normal),void 0!==r&&M.normal.applyMatrix3(r).normalize();for(var S=0,T=b.length;S<T;S++)x=b[S].clone(),void 0!==r&&x.applyMatrix3(r).normalize(),M.vertexNormals.push(x);M.color.copy(y.color);for(var E=0,A=w.length;E<A;E++)_=w[E],M.vertexColors.push(_.clone());M.materialIndex=y.materialIndex+n,s.push(M)}for(var C=0,L=e.faceVertexUvs.length;C<L;C++){var R=e.faceVertexUvs[C];void 0===this.faceVertexUvs[C]&&(this.faceVertexUvs[C]=[]);for(var P=0,D=R.length;P<D;P++){for(var I=R[P],O=[],z=0,k=I.length;z<k;z++)O.push(I[z].clone());this.faceVertexUvs[C].push(O)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){for(var e={},t=[],n=[],r=Math.pow(10,4),i=0,a=this.vertices.length;i<a;i++){var o=this.vertices[i],s=Math.round(o.x*r)+"_"+Math.round(o.y*r)+"_"+Math.round(o.z*r);void 0===e[s]?(e[s]=i,t.push(this.vertices[i]),n[i]=t.length-1):n[i]=n[e[s]]}for(var l=[],u=0,c=this.faces.length;u<c;u++){var h=this.faces[u];h.a=n[h.a],h.b=n[h.b],h.c=n[h.c];for(var d=[h.a,h.b,h.c],p=0;p<3;p++)if(d[p]===d[(p+1)%3]){l.push(u);break}}for(var f=l.length-1;f>=0;f--){var m=l[f];this.faces.splice(m,1);for(var v=0,g=this.faceVertexUvs.length;v<g;v++)this.faceVertexUvs[v].splice(m,1)}var y=this.vertices.length-t.length;return this.vertices=t,y},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new xe(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(r=[]),o&&o.length===t&&(i=[]);for(var s=0;s<t;s++){var l=e[s]._id;r&&r.push(a[l]),i&&i.push(o[l])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}for(var o=[],s=[],l={},u=[],c={},h=[],d={},p=0;p<this.faces.length;p++){var f=this.faces[p],m=void 0!==this.faceVertexUvs[0][p],v=f.normal.length()>0,g=f.vertexNormals.length>0,y=1!==f.color.r||1!==f.color.g||1!==f.color.b,x=f.vertexColors.length>0,_=0;if(_=S(_,0,0),_=S(_,1,!0),_=S(_,2,!1),_=S(_,3,m),_=S(_,4,v),_=S(_,5,g),_=S(_,6,y),_=S(_,7,x),o.push(_),o.push(f.a,f.b,f.c),o.push(f.materialIndex),m){var b=this.faceVertexUvs[0][p];o.push(A(b[0]),A(b[1]),A(b[2]))}if(v&&o.push(T(f.normal)),g){var w=f.vertexNormals;o.push(T(w[0]),T(w[1]),T(w[2]))}if(y&&o.push(E(f.color)),x){var M=f.vertexColors;o.push(E(M[0]),E(M[1]),E(M[2]))}}function S(e,t,n){return n?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function E(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function A(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]||(d[t]=h.length/2,h.push(e.x,e.y)),d[t]}return e.data={},e.data.vertices=r,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},clone:function(){return(new mo).copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var t=e.vertices,n=0,r=t.length;n<r;n++)this.vertices.push(t[n].clone());for(var i=e.colors,a=0,o=i.length;a<o;a++)this.colors.push(i[a].clone());for(var s=e.faces,l=0,u=s.length;l<u;l++)this.faces.push(s[l].clone());for(var c=0,h=e.faceVertexUvs.length;c<h;c++){var d=e.faceVertexUvs[c];void 0===this.faceVertexUvs[c]&&(this.faceVertexUvs[c]=[]);for(var p=0,f=d.length;p<f;p++){for(var m=d[p],v=[],g=0,y=m.length;g<y;g++){var x=m[g];v.push(x.clone())}this.faceVertexUvs[c].push(v)}}for(var _=e.morphTargets,b=0,w=_.length;b<w;b++){var M={};if(M.name=_[b].name,void 0!==_[b].vertices){M.vertices=[];for(var S=0,T=_[b].vertices.length;S<T;S++)M.vertices.push(_[b].vertices[S].clone())}if(void 0!==_[b].normals){M.normals=[];for(var E=0,A=_[b].normals.length;E<A;E++)M.normals.push(_[b].normals[E].clone())}this.morphTargets.push(M)}for(var C=e.morphNormals,L=0,R=C.length;L<R;L++){var P={};if(void 0!==C[L].vertexNormals){P.vertexNormals=[];for(var D=0,I=C[L].vertexNormals.length;D<I;D++){var O=C[L].vertexNormals[D],z={};z.a=O.a.clone(),z.b=O.b.clone(),z.c=O.c.clone(),P.vertexNormals.push(z)}}if(void 0!==C[L].faceNormals){P.faceNormals=[];for(var k=0,F=C[L].faceNormals.length;k<F;k++)P.faceNormals.push(C[L].faceNormals[k].clone())}this.morphNormals.push(P)}for(var N=e.skinWeights,B=0,U=N.length;B<U;B++)this.skinWeights.push(N[B].clone());for(var G=e.skinIndices,H=0,j=G.length;H<j;H++)this.skinIndices.push(G[H].clone());for(var V=e.lineDistances,W=0,q=V.length;W<q;W++)this.lineDistances.push(V[W]);var X=e.boundingBox;null!==X&&(this.boundingBox=X.clone());var Y=e.boundingSphere;return null!==Y&&(this.boundingSphere=Y.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var vo=function(e){function t(t,n,r,i,a,o){var s;return(s=e.call(this)||this).type="BoxGeometry",s.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:o},s.fromBufferGeometry(new On(t,n,r,i,a,o)),s.mergeVertices(),s}return se(t,e),t}(mo),go=function(e){function t(t,n,r,i){var a;(a=e.call(this)||this).type="CircleBufferGeometry",a.parameters={radius:t,segments:n,thetaStart:r,thetaLength:i},t=t||1,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var o=[],s=[],l=[],u=[],c=new xe,h=new ce;s.push(0,0,0),l.push(0,0,1),u.push(.5,.5);for(var d=0,p=3;d<=n;d++,p+=3){var f=r+d/n*i;c.x=t*Math.cos(f),c.y=t*Math.sin(f),s.push(c.x,c.y,c.z),l.push(0,0,1),h.x=(s[p]/t+1)/2,h.y=(s[p+1]/t+1)/2,u.push(h.x,h.y)}for(var m=1;m<=n;m++)o.push(m,m+1,0);return a.setIndex(o),a.setAttribute("position",new tn(s,3)),a.setAttribute("normal",new tn(l,3)),a.setAttribute("uv",new tn(u,2)),a}return se(t,e),t}(pn),yo=function(e){function t(t,n,r,i){var a;return(a=e.call(this)||this).type="CircleGeometry",a.parameters={radius:t,segments:n,thetaStart:r,thetaLength:i},a.fromBufferGeometry(new go(t,n,r,i)),a.mergeVertices(),a}return se(t,e),t}(mo),xo=function(e){function t(t,n,r,i,a,o,s,l){var u;(u=e.call(this)||this).type="CylinderBufferGeometry",u.parameters={radiusTop:t,radiusBottom:n,height:r,radialSegments:i,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l};var c=le(u);t=void 0!==t?t:1,n=void 0!==n?n:1,r=r||1,i=Math.floor(i)||8,a=Math.floor(a)||1,o=void 0!==o&&o,s=void 0!==s?s:0,l=void 0!==l?l:2*Math.PI;var h=[],d=[],p=[],f=[],m=0,v=[],g=r/2,y=0;function x(e){for(var r=m,a=new ce,o=new xe,u=0,v=!0===e?t:n,x=!0===e?1:-1,_=1;_<=i;_++)d.push(0,g*x,0),p.push(0,x,0),f.push(.5,.5),m++;for(var b=m,w=0;w<=i;w++){var M=w/i*l+s,S=Math.cos(M),T=Math.sin(M);o.x=v*T,o.y=g*x,o.z=v*S,d.push(o.x,o.y,o.z),p.push(0,x,0),a.x=.5*S+.5,a.y=.5*T*x+.5,f.push(a.x,a.y),m++}for(var E=0;E<i;E++){var A=r+E,C=b+E;!0===e?h.push(C,C+1,A):h.push(C+1,C,A),u+=3}c.addGroup(y,u,!0===e?1:2),y+=u}return function(){for(var e=new xe,o=new xe,u=0,x=(n-t)/r,_=0;_<=a;_++){for(var b=[],w=_/a,M=w*(n-t)+t,S=0;S<=i;S++){var T=S/i,E=T*l+s,A=Math.sin(E),C=Math.cos(E);o.x=M*A,o.y=-w*r+g,o.z=M*C,d.push(o.x,o.y,o.z),e.set(A,x,C).normalize(),p.push(e.x,e.y,e.z),f.push(T,1-w),b.push(m++)}v.push(b)}for(var L=0;L<i;L++)for(var R=0;R<a;R++){var P=v[R][L],D=v[R+1][L],I=v[R+1][L+1],O=v[R][L+1];h.push(P,D,O),h.push(D,I,O),u+=6}c.addGroup(y,u,0),y+=u}(),!1===o&&(t>0&&x(!0),n>0&&x(!1)),u.setIndex(h),u.setAttribute("position",new tn(d,3)),u.setAttribute("normal",new tn(p,3)),u.setAttribute("uv",new tn(f,2)),u}return se(t,e),t}(pn),_o=function(e){function t(t,n,r,i,a,o,s,l){var u;return(u=e.call(this)||this).type="CylinderGeometry",u.parameters={radiusTop:t,radiusBottom:n,height:r,radialSegments:i,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l},u.fromBufferGeometry(new xo(t,n,r,i,a,o,s,l)),u.mergeVertices(),u}return se(t,e),t}(mo),bo=function(e){function t(t,n,r,i,a,o,s){var l;return(l=e.call(this,0,t,n,r,i,a,o,s)||this).type="ConeGeometry",l.parameters={radius:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},l}return se(t,e),t}(_o),wo=function(e){function t(t,n,r,i,a,o,s){var l;return(l=e.call(this,0,t,n,r,i,a,o,s)||this).type="ConeBufferGeometry",l.parameters={radius:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},l}return se(t,e),t}(xo),Mo=function(e){function t(t,n,r,i){var a;(a=e.call(this)||this).type="PolyhedronBufferGeometry",a.parameters={vertices:t,indices:n,radius:r,detail:i},r=r||1;var o=[],s=[];function l(e,t,n,r){for(var i=r+1,a=[],o=0;o<=i;o++){a[o]=[];for(var s=e.clone().lerp(n,o/i),l=t.clone().lerp(n,o/i),c=i-o,h=0;h<=c;h++)a[o][h]=0===h&&o===i?s:s.clone().lerp(l,h/c)}for(var d=0;d<i;d++)for(var p=0;p<2*(i-d)-1;p++){var f=Math.floor(p/2);p%2==0?(u(a[d][f+1]),u(a[d+1][f]),u(a[d][f])):(u(a[d][f+1]),u(a[d+1][f+1]),u(a[d+1][f]))}}function u(e){o.push(e.x,e.y,e.z)}function c(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function h(e,t,n,r){r<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=r/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}function p(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return function(e){for(var t=new xe,r=new xe,i=new xe,a=0;a<n.length;a+=3)c(n[a+0],t),c(n[a+1],r),c(n[a+2],i),l(t,r,i,e)}(i=i||0),function(e){for(var t=new xe,n=0;n<o.length;n+=3)t.x=o[n+0],t.y=o[n+1],t.z=o[n+2],t.normalize().multiplyScalar(e),o[n+0]=t.x,o[n+1]=t.y,o[n+2]=t.z}(r),function(){for(var e=new xe,t=0;t<o.length;t+=3){e.x=o[t+0],e.y=o[t+1],e.z=o[t+2];var n=d(e)/2/Math.PI+.5,r=p(e)/Math.PI+.5;s.push(n,1-r)}(function(){for(var e=new xe,t=new xe,n=new xe,r=new xe,i=new ce,a=new ce,l=new ce,u=0,c=0;u<o.length;u+=9,c+=6){e.set(o[u+0],o[u+1],o[u+2]),t.set(o[u+3],o[u+4],o[u+5]),n.set(o[u+6],o[u+7],o[u+8]),i.set(s[c+0],s[c+1]),a.set(s[c+2],s[c+3]),l.set(s[c+4],s[c+5]),r.copy(e).add(t).add(n).divideScalar(3);var p=d(r);h(i,c+0,e,p),h(a,c+2,t,p),h(l,c+4,n,p)}})(),function(){for(var e=0;e<s.length;e+=6){var t=s[e+0],n=s[e+2],r=s[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);i>.9&&a<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),r<.2&&(s[e+4]+=1))}}()}(),a.setAttribute("position",new tn(o,3)),a.setAttribute("normal",new tn(o.slice(),3)),a.setAttribute("uv",new tn(s,2)),0===i?a.computeVertexNormals():a.normalizeNormals(),a}return se(t,e),t}(pn),So=function(e){function t(t,n){var r,i=(1+Math.sqrt(5))/2,a=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-a,-i,0,-a,i,0,a,-i,0,a,i,-a,-i,0,-a,i,0,a,-i,0,a,i,0,-i,0,-a,i,0,-a,-i,0,a,i,0,a];return(r=e.call(this,o,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,n)||this).type="DodecahedronBufferGeometry",r.parameters={radius:t,detail:n},r}return se(t,e),t}(Mo),To=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="DodecahedronGeometry",r.parameters={radius:t,detail:n},r.fromBufferGeometry(new So(t,n)),r.mergeVertices(),r}return se(t,e),t}(mo),Eo=new xe,Ao=new xe,Co=new xe,Lo=new It,Ro=function(e){function t(t,n){var r;(r=e.call(this)||this).type="EdgesGeometry",r.parameters={thresholdAngle:n},n=void 0!==n?n:1,t.isGeometry&&(t=(new pn).fromGeometry(t));for(var i=Math.pow(10,4),a=Math.cos(ie.DEG2RAD*n),o=t.getIndex(),s=t.getAttribute("position"),l=o?o.count:s.count,u=[0,0,0],c=["a","b","c"],h=new Array(3),d={},p=[],f=0;f<l;f+=3){o?(u[0]=o.getX(f),u[1]=o.getX(f+1),u[2]=o.getX(f+2)):(u[0]=f,u[1]=f+1,u[2]=f+2);var m=Lo.a,v=Lo.b,g=Lo.c;if(m.fromBufferAttribute(s,u[0]),v.fromBufferAttribute(s,u[1]),g.fromBufferAttribute(s,u[2]),Lo.getNormal(Co),h[0]=Math.round(m.x*i)+","+Math.round(m.y*i)+","+Math.round(m.z*i),h[1]=Math.round(v.x*i)+","+Math.round(v.y*i)+","+Math.round(v.z*i),h[2]=Math.round(g.x*i)+","+Math.round(g.y*i)+","+Math.round(g.z*i),h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(var y=0;y<3;y++){var x=(y+1)%3,_=h[y],b=h[x],w=Lo[c[y]],M=Lo[c[x]],S=_+"_"+b,T=b+"_"+_;T in d&&d[T]?(Co.dot(d[T].normal)<=a&&(p.push(w.x,w.y,w.z),p.push(M.x,M.y,M.z)),d[T]=null):S in d||(d[S]={index0:u[y],index1:u[x],normal:Co.clone()})}}for(var E in d)if(d[E]){var A=d[E],C=A.index0,L=A.index1;Eo.fromBufferAttribute(s,C),Ao.fromBufferAttribute(s,L),p.push(Eo.x,Eo.y,Eo.z),p.push(Ao.x,Ao.y,Ao.z)}return r.setAttribute("position",new tn(p,3)),r}return se(t,e),t}(pn);function Po(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=Qo(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=Qo(a,e[a],e[a+1],o);return o&&qo(o,o.next)&&($o(o),o=o.next),o}function Do(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!qo(r,r.next)&&0!==Wo(r.prev,r,r.next))r=r.next;else{if($o(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Io(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=Go(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,l,u=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;s>0||l>0&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(o>1)}(i)}(e,r,i,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?zo(e,r,i,a):Oo(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),$o(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Io(e=ko(Do(e),t,n),t,n,r,i,a,2):2===o&&Fo(e,t,n,r,i,a):Io(Do(e),t,n,r,i,a,1);break}}}function Oo(e){var t=e.prev,n=e,r=e.next;if(Wo(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(jo(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Wo(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function zo(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Wo(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,l=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,h=Go(s,l,t,n,r),d=Go(u,c,t,n,r),p=e.prevZ,f=e.nextZ;p&&p.z>=h&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&jo(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Wo(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&jo(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Wo(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&jo(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Wo(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&jo(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Wo(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ko(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!qo(i,a)&&Xo(i,r,r.next,a)&&Ko(i,a)&&Ko(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),$o(r),$o(r.next),r=e=a),r=r.next}while(r!==e);return Do(r)}function Fo(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Vo(o,s)){var l=Jo(o,s);return o=Do(o,o.next),l=Do(l,l.next),Io(o,t,n,r,i,a),void Io(l,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function No(e,t){return e.x-t.x}function Bo(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var l,u=n,c=n.x,h=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&jo(a<h?i:o,a,c,h,a<h?o:i,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(i-r.x),Ko(r,e)&&(l<d||l===d&&(r.x>n.x||r.x===n.x&&Uo(n,r)))&&(n=r,d=l)),r=r.next}while(r!==u);return n}(e,t),t){var n=Jo(t,e);Do(t,t.next),Do(n,n.next)}}function Uo(e,t){return Wo(e.prev,e,t.prev)<0&&Wo(t.next,e,e.next)<0}function Go(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ho(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function jo(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Vo(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Xo(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Ko(e,t)&&Ko(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Wo(e.prev,e,t.prev)||Wo(e,t.prev,t))||qo(e,t)&&Wo(e.prev,e,e.next)>0&&Wo(t.prev,t,t.next)>0)}function Wo(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function qo(e,t){return e.x===t.x&&e.y===t.y}function Xo(e,t,n,r){var i=Zo(Wo(e,t,n)),a=Zo(Wo(e,t,r)),o=Zo(Wo(n,r,e)),s=Zo(Wo(n,r,t));return i!==a&&o!==s||!(0!==i||!Yo(e,n,t))||!(0!==a||!Yo(e,r,t))||!(0!==o||!Yo(n,e,r))||!(0!==s||!Yo(n,t,r))}function Yo(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Zo(e){return e>0?1:e<0?-1:0}function Ko(e,t){return Wo(e.prev,e,e.next)<0?Wo(e,t,e.next)>=0&&Wo(e,e.prev,t)>=0:Wo(e,t,e.prev)<0||Wo(e,e.next,t)<0}function Jo(e,t){var n=new es(e.i,e.x,e.y),r=new es(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Qo(e,t,n,r){var i=new es(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function $o(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function es(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ts={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return ts.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];ns(e),rs(n,e);var a=e.length;t.forEach(ns);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,rs(n,t[o]);for(var s=function(e,t,n){n=n||2;var r,i,a,o,s,l,u,c=t&&t.length,h=c?t[0]*n:e.length,d=Po(e,0,h,n,!0),p=[];if(!d||d.next===d.prev)return p;if(c&&(d=function(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=Po(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(Ho(o));for(s.sort(No),i=0;i<s.length;i++)Bo(s[i],n),n=Do(n,n.next);return n}(e,t,d,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var f=n;f<h;f+=n)(s=e[f])<r&&(r=s),(l=e[f+1])<i&&(i=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-r,o-i))?1/u:0}return Io(d,p,n,r,i,u),p}(n,r),l=0;l<s.length;l+=3)i.push(s.slice(l,l+3));return i}};function ns(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function rs(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var is=function(e){function t(t,n){var r;(r=e.call(this)||this).type="ExtrudeBufferGeometry",r.parameters={shapes:t,options:n},t=Array.isArray(t)?t:[t];for(var i=le(r),a=[],o=[],s=0,l=t.length;s<l;s++)u(t[s]);function u(e){var t=[],r=void 0!==n.curveSegments?n.curveSegments:12,s=void 0!==n.steps?n.steps:1,l=void 0!==n.depth?n.depth:100,u=void 0===n.bevelEnabled||n.bevelEnabled,c=void 0!==n.bevelThickness?n.bevelThickness:6,h=void 0!==n.bevelSize?n.bevelSize:c-2,d=void 0!==n.bevelOffset?n.bevelOffset:0,p=void 0!==n.bevelSegments?n.bevelSegments:3,f=n.extrudePath,m=void 0!==n.UVGenerator?n.UVGenerator:as;void 0!==n.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=n.amount);var v,g,y,x,_,b=!1;f&&(v=f.getSpacedPoints(s),b=!0,u=!1,g=f.computeFrenetFrames(s,!1),y=new xe,x=new xe,_=new xe),u||(p=0,c=0,h=0,d=0);var w=e.extractPoints(r),M=w.shape,S=w.holes;if(!ts.isClockWise(M)){M=M.reverse();for(var T=0,E=S.length;T<E;T++){var A=S[T];ts.isClockWise(A)&&(S[T]=A.reverse())}}for(var C=ts.triangulateShape(M,S),L=M,R=0,P=S.length;R<P;R++){var D=S[R];M=M.concat(D)}function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var O=M.length,z=C.length;function k(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,h=o*u-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),p=Math.sqrt(l*l+u*u),f=t.x-s/d,m=t.y+o/d,v=((n.x-u/p-f)*u-(n.y+l/p-m)*l)/(o*u-s*l),g=(r=f+o*v-e.x)*r+(i=m+s*v-e.y)*i;if(g<=2)return new ce(r,i);a=Math.sqrt(g/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new ce(r/a,i/a)}for(var F=[],N=0,B=L.length,U=B-1,G=N+1;N<B;N++,U++,G++)U===B&&(U=0),G===B&&(G=0),F[N]=k(L[N],L[U],L[G]);for(var H,j=[],V=F.concat(),W=0,q=S.length;W<q;W++){var X=S[W];H=[];for(var Y=0,Z=X.length,K=Z-1,J=Y+1;Y<Z;Y++,K++,J++)K===Z&&(K=0),J===Z&&(J=0),H[Y]=k(X[Y],X[K],X[J]);j.push(H),V=V.concat(H)}for(var Q=0;Q<p;Q++){for(var $=Q/p,ee=c*Math.cos($*Math.PI/2),te=h*Math.sin($*Math.PI/2)+d,ne=0,re=L.length;ne<re;ne++){var ie=I(L[ne],F[ne],te);Ie(ie.x,ie.y,-ee)}for(var ae=0,oe=S.length;ae<oe;ae++){var se=S[ae];H=j[ae];for(var le=0,ue=se.length;le<ue;le++){var he=I(se[le],H[le],te);Ie(he.x,he.y,-ee)}}}for(var de=h+d,pe=0;pe<O;pe++){var fe=u?I(M[pe],V[pe],de):M[pe];b?(x.copy(g.normals[0]).multiplyScalar(fe.x),y.copy(g.binormals[0]).multiplyScalar(fe.y),_.copy(v[0]).add(x).add(y),Ie(_.x,_.y,_.z)):Ie(fe.x,fe.y,0)}for(var me=1;me<=s;me++)for(var ve=0;ve<O;ve++){var ge=u?I(M[ve],V[ve],de):M[ve];b?(x.copy(g.normals[me]).multiplyScalar(ge.x),y.copy(g.binormals[me]).multiplyScalar(ge.y),_.copy(v[me]).add(x).add(y),Ie(_.x,_.y,_.z)):Ie(ge.x,ge.y,l/s*me)}for(var ye=p-1;ye>=0;ye--){for(var _e=ye/p,be=c*Math.cos(_e*Math.PI/2),we=h*Math.sin(_e*Math.PI/2)+d,Me=0,Se=L.length;Me<Se;Me++){var Te=I(L[Me],F[Me],we);Ie(Te.x,Te.y,l+be)}for(var Ee=0,Ae=S.length;Ee<Ae;Ee++){var Ce=S[Ee];H=j[Ee];for(var Le=0,Re=Ce.length;Le<Re;Le++){var Pe=I(Ce[Le],H[Le],we);b?Ie(Pe.x,Pe.y+v[s-1].y,v[s-1].x+be):Ie(Pe.x,Pe.y,l+be)}}}function De(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var a=0,o=s+2*p;a<o;a++){var l=O*a,u=O*(a+1);ze(t+r+l,t+i+l,t+i+u,t+r+u)}}}function Ie(e,n,r){t.push(e),t.push(n),t.push(r)}function Oe(e,t,n){ke(e),ke(t),ke(n);var r=a.length/3,o=m.generateTopUV(i,a,r-3,r-2,r-1);Fe(o[0]),Fe(o[1]),Fe(o[2])}function ze(e,t,n,r){ke(e),ke(t),ke(r),ke(t),ke(n),ke(r);var o=a.length/3,s=m.generateSideWallUV(i,a,o-6,o-3,o-2,o-1);Fe(s[0]),Fe(s[1]),Fe(s[3]),Fe(s[1]),Fe(s[2]),Fe(s[3])}function ke(e){a.push(t[3*e+0]),a.push(t[3*e+1]),a.push(t[3*e+2])}function Fe(e){o.push(e.x),o.push(e.y)}!function(){var e=a.length/3;if(u){for(var t=0,n=O*t,r=0;r<z;r++){var o=C[r];Oe(o[2]+n,o[1]+n,o[0]+n)}n=O*(t=s+2*p);for(var l=0;l<z;l++){var c=C[l];Oe(c[0]+n,c[1]+n,c[2]+n)}}else{for(var h=0;h<z;h++){var d=C[h];Oe(d[2],d[1],d[0])}for(var f=0;f<z;f++){var m=C[f];Oe(m[0]+O*s,m[1]+O*s,m[2]+O*s)}}i.addGroup(e,a.length/3-e,0)}(),function(){var e=a.length/3,t=0;De(L,t),t+=L.length;for(var n=0,r=S.length;n<r;n++){var o=S[n];De(o,t),t+=o.length}i.addGroup(e,a.length/3-e,1)}()}return r.setAttribute("position",new tn(a,3)),r.setAttribute("uv",new tn(o,2)),r.computeVertexNormals(),r}return se(t,e),t.prototype.toJSON=function(){var e=pn.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)},t}(pn),as={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],l=t[3*r+1],u=t[3*i],c=t[3*i+1];return[new ce(a,o),new ce(s,l),new ce(u,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*r],c=t[3*r+1],h=t[3*r+2],d=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*a],v=t[3*a+1],g=t[3*a+2];return Math.abs(s-c)<.01?[new ce(o,1-l),new ce(u,1-h),new ce(d,1-f),new ce(m,1-g)]:[new ce(s,1-l),new ce(c,1-h),new ce(p,1-f),new ce(v,1-g)]}},os=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="ExtrudeGeometry",r.parameters={shapes:t,options:n},r.fromBufferGeometry(new is(t,n)),r.mergeVertices(),r}return se(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)},t}(mo),ss=function(e){function t(t,n){var r,i=(1+Math.sqrt(5))/2,a=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];return(r=e.call(this,a,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,n)||this).type="IcosahedronBufferGeometry",r.parameters={radius:t,detail:n},r}return se(t,e),t}(Mo),ls=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="IcosahedronGeometry",r.parameters={radius:t,detail:n},r.fromBufferGeometry(new ss(t,n)),r.mergeVertices(),r}return se(t,e),t}(mo),us=function(e){function t(t,n,r,i){var a;(a=e.call(this)||this).type="LatheBufferGeometry",a.parameters={points:t,segments:n,phiStart:r,phiLength:i},n=Math.floor(n)||12,r=r||0,i=i||2*Math.PI,i=ie.clamp(i,0,2*Math.PI);for(var o=[],s=[],l=[],u=1/n,c=new xe,h=new ce,d=0;d<=n;d++)for(var p=r+d*u*i,f=Math.sin(p),m=Math.cos(p),v=0;v<=t.length-1;v++)c.x=t[v].x*f,c.y=t[v].y,c.z=t[v].x*m,s.push(c.x,c.y,c.z),h.x=d/n,h.y=v/(t.length-1),l.push(h.x,h.y);for(var g=0;g<n;g++)for(var y=0;y<t.length-1;y++){var x=y+g*t.length,_=x,b=x+t.length,w=x+t.length+1,M=x+1;o.push(_,b,M),o.push(b,w,M)}if(a.setIndex(o),a.setAttribute("position",new tn(s,3)),a.setAttribute("uv",new tn(l,2)),a.computeVertexNormals(),i===2*Math.PI)for(var S=a.attributes.normal.array,T=new xe,E=new xe,A=new xe,C=n*t.length*3,L=0,R=0;L<t.length;L++,R+=3)T.x=S[R+0],T.y=S[R+1],T.z=S[R+2],E.x=S[C+R+0],E.y=S[C+R+1],E.z=S[C+R+2],A.addVectors(T,E).normalize(),S[R+0]=S[C+R+0]=A.x,S[R+1]=S[C+R+1]=A.y,S[R+2]=S[C+R+2]=A.z;return a}return se(t,e),t}(pn),cs=function(e){function t(t,n,r,i){var a;return(a=e.call(this)||this).type="LatheGeometry",a.parameters={points:t,segments:n,phiStart:r,phiLength:i},a.fromBufferGeometry(new us(t,n,r,i)),a.mergeVertices(),a}return se(t,e),t}(mo),hs=function(e){function t(t,n){var r;return(r=e.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,n)||this).type="OctahedronBufferGeometry",r.parameters={radius:t,detail:n},r}return se(t,e),t}(Mo),ds=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="OctahedronGeometry",r.parameters={radius:t,detail:n},r.fromBufferGeometry(new hs(t,n)),r.mergeVertices(),r}return se(t,e),t}(mo);function ps(e,t,n){pn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],i=[],a=[],o=[],s=1e-5,l=new xe,u=new xe,c=new xe,h=new xe,d=new xe;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var p=t+1,f=0;f<=n;f++)for(var m=f/n,v=0;v<=t;v++){var g=v/t;e(g,m,u),i.push(u.x,u.y,u.z),g-s>=0?(e(g-s,m,c),h.subVectors(u,c)):(e(g+s,m,c),h.subVectors(c,u)),m-s>=0?(e(g,m-s,c),d.subVectors(u,c)):(e(g,m+s,c),d.subVectors(c,u)),l.crossVectors(h,d).normalize(),a.push(l.x,l.y,l.z),o.push(g,m)}for(var y=0;y<n;y++)for(var x=0;x<t;x++){var _=y*p+x,b=y*p+x+1,w=(y+1)*p+x+1,M=(y+1)*p+x;r.push(_,b,M),r.push(b,w,M)}this.setIndex(r),this.setAttribute("position",new tn(i,3)),this.setAttribute("normal",new tn(a,3)),this.setAttribute("uv",new tn(o,2))}function fs(e,t,n){mo.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new ps(e,t,n)),this.mergeVertices()}ps.prototype=Object.create(pn.prototype),ps.prototype.constructor=ps,fs.prototype=Object.create(mo.prototype),fs.prototype.constructor=fs;var ms=function(e){function t(t,n,r,i){var a;return(a=e.call(this)||this).type="PlaneGeometry",a.parameters={width:t,height:n,widthSegments:r,heightSegments:i},a.fromBufferGeometry(new Jn(t,n,r,i)),a.mergeVertices(),a}return se(t,e),t}(mo),vs=function(e){function t(t,n,r,i){var a;return(a=e.call(this)||this).type="PolyhedronGeometry",a.parameters={vertices:t,indices:n,radius:r,detail:i},a.fromBufferGeometry(new Mo(t,n,r,i)),a.mergeVertices(),a}return se(t,e),t}(mo),gs=function(e){function t(t,n,r,i,a,o){var s;(s=e.call(this)||this).type="RingBufferGeometry",s.parameters={innerRadius:t,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:a,thetaLength:o},t=t||.5,n=n||1,a=void 0!==a?a:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8;for(var l=[],u=[],c=[],h=[],d=t,p=(n-t)/(i=void 0!==i?Math.max(1,i):1),f=new xe,m=new ce,v=0;v<=i;v++){for(var g=0;g<=r;g++){var y=a+g/r*o;f.x=d*Math.cos(y),f.y=d*Math.sin(y),u.push(f.x,f.y,f.z),c.push(0,0,1),m.x=(f.x/n+1)/2,m.y=(f.y/n+1)/2,h.push(m.x,m.y)}d+=p}for(var x=0;x<i;x++)for(var _=x*(r+1),b=0;b<r;b++){var w=b+_,M=w,S=w+r+1,T=w+r+2,E=w+1;l.push(M,S,E),l.push(S,T,E)}return s.setIndex(l),s.setAttribute("position",new tn(u,3)),s.setAttribute("normal",new tn(c,3)),s.setAttribute("uv",new tn(h,2)),s}return se(t,e),t}(pn),ys=function(e){function t(t,n,r,i,a,o){var s;return(s=e.call(this)||this).type="RingGeometry",s.parameters={innerRadius:t,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:a,thetaLength:o},s.fromBufferGeometry(new gs(t,n,r,i,a,o)),s.mergeVertices(),s}return se(t,e),t}(mo),xs=function(e){function t(t,n){var r;(r=e.call(this)||this).type="ShapeBufferGeometry",r.parameters={shapes:t,curveSegments:n},n=n||12;var i=[],a=[],o=[],s=[],l=0,u=0;if(!1===Array.isArray(t))h(t);else for(var c=0;c<t.length;c++)h(t[c]),r.addGroup(l,u,c),l+=u,u=0;function h(e){var t=a.length/3,r=e.extractPoints(n),l=r.shape,c=r.holes;!1===ts.isClockWise(l)&&(l=l.reverse());for(var h=0,d=c.length;h<d;h++){var p=c[h];!0===ts.isClockWise(p)&&(c[h]=p.reverse())}for(var f=ts.triangulateShape(l,c),m=0,v=c.length;m<v;m++){var g=c[m];l=l.concat(g)}for(var y=0,x=l.length;y<x;y++){var _=l[y];a.push(_.x,_.y,0),o.push(0,0,1),s.push(_.x,_.y)}for(var b=0,w=f.length;b<w;b++){var M=f[b],S=M[0]+t,T=M[1]+t,E=M[2]+t;i.push(S,T,E),u+=3}}return r.setIndex(i),r.setAttribute("position",new tn(a,3)),r.setAttribute("normal",new tn(o,3)),r.setAttribute("uv",new tn(s,2)),r}return se(t,e),t.prototype.toJSON=function(){var e=pn.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)},t}(pn),_s=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="ShapeGeometry","object"===(0,a.default)(n)&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),r.parameters={shapes:t,curveSegments:n},r.fromBufferGeometry(new xs(t,n)),r.mergeVertices(),r}return se(t,e),t.prototype.toJSON=function(){var e=mo.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)},t}(mo),bs=function(e){function t(t,n,r,i,a,o,s){var l;(l=e.call(this)||this).type="SphereBufferGeometry",l.parameters={radius:t,widthSegments:n,heightSegments:r,phiStart:i,phiLength:a,thetaStart:o,thetaLength:s},t=t||1,n=Math.max(3,Math.floor(n)||8),r=Math.max(2,Math.floor(r)||6),i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,o=void 0!==o?o:0,s=void 0!==s?s:Math.PI;for(var u=Math.min(o+s,Math.PI),c=0,h=[],d=new xe,p=new xe,f=[],m=[],v=[],g=[],y=0;y<=r;y++){var x=[],_=y/r,b=0;0==y&&0==o?b=.5/n:y==r&&u==Math.PI&&(b=-.5/n);for(var w=0;w<=n;w++){var M=w/n;d.x=-t*Math.cos(i+M*a)*Math.sin(o+_*s),d.y=t*Math.cos(o+_*s),d.z=t*Math.sin(i+M*a)*Math.sin(o+_*s),m.push(d.x,d.y,d.z),p.copy(d).normalize(),v.push(p.x,p.y,p.z),g.push(M+b,1-_),x.push(c++)}h.push(x)}for(var S=0;S<r;S++)for(var T=0;T<n;T++){var E=h[S][T+1],A=h[S][T],C=h[S+1][T],L=h[S+1][T+1];(0!==S||o>0)&&f.push(E,A,L),(S!==r-1||u<Math.PI)&&f.push(A,C,L)}return l.setIndex(f),l.setAttribute("position",new tn(m,3)),l.setAttribute("normal",new tn(v,3)),l.setAttribute("uv",new tn(g,2)),l}return se(t,e),t}(pn),ws=function(e){function t(t,n,r,i,a,o,s){var l;return(l=e.call(this)||this).type="SphereGeometry",l.parameters={radius:t,widthSegments:n,heightSegments:r,phiStart:i,phiLength:a,thetaStart:o,thetaLength:s},l.fromBufferGeometry(new bs(t,n,r,i,a,o,s)),l.mergeVertices(),l}return se(t,e),t}(mo),Ms=function(e){function t(t,n){var r;return(r=e.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,n)||this).type="TetrahedronBufferGeometry",r.parameters={radius:t,detail:n},r}return se(t,e),t}(Mo),Ss=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="TetrahedronGeometry",r.parameters={radius:t,detail:n},r.fromBufferGeometry(new Ms(t,n)),r.mergeVertices(),r}return se(t,e),t}(mo),Ts=function(e){function t(t,n){var r,i=(n=n||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new pn||le(r);var a=i.generateShapes(t,n.size);return n.depth=void 0!==n.height?n.height:50,void 0===n.bevelThickness&&(n.bevelThickness=10),void 0===n.bevelSize&&(n.bevelSize=8),void 0===n.bevelEnabled&&(n.bevelEnabled=!1),(r=e.call(this,a,n)||this).type="TextBufferGeometry",r}return se(t,e),t}(is),Es=function(e){function t(t,n){var r;return(r=e.call(this)||this).type="TextGeometry",r.parameters={text:t,parameters:n},r.fromBufferGeometry(new Ts(t,n)),r.mergeVertices(),r}return se(t,e),t}(mo),As=function(e){function t(t,n,r,i,a){var o;(o=e.call(this)||this).type="TorusBufferGeometry",o.parameters={radius:t,tube:n,radialSegments:r,tubularSegments:i,arc:a},t=t||1,n=n||.4,r=Math.floor(r)||8,i=Math.floor(i)||6,a=a||2*Math.PI;for(var s=[],l=[],u=[],c=[],h=new xe,d=new xe,p=new xe,f=0;f<=r;f++)for(var m=0;m<=i;m++){var v=m/i*a,g=f/r*Math.PI*2;d.x=(t+n*Math.cos(g))*Math.cos(v),d.y=(t+n*Math.cos(g))*Math.sin(v),d.z=n*Math.sin(g),l.push(d.x,d.y,d.z),h.x=t*Math.cos(v),h.y=t*Math.sin(v),p.subVectors(d,h).normalize(),u.push(p.x,p.y,p.z),c.push(m/i),c.push(f/r)}for(var y=1;y<=r;y++)for(var x=1;x<=i;x++){var _=(i+1)*y+x-1,b=(i+1)*(y-1)+x-1,w=(i+1)*(y-1)+x,M=(i+1)*y+x;s.push(_,b,M),s.push(b,w,M)}return o.setIndex(s),o.setAttribute("position",new tn(l,3)),o.setAttribute("normal",new tn(u,3)),o.setAttribute("uv",new tn(c,2)),o}return se(t,e),t}(pn),Cs=function(e){function t(t,n,r,i,a){var o;return(o=e.call(this)||this).type="TorusGeometry",o.parameters={radius:t,tube:n,radialSegments:r,tubularSegments:i,arc:a},o.fromBufferGeometry(new As(t,n,r,i,a)),o.mergeVertices(),o}return se(t,e),t}(mo),Ls=function(e){function t(t,n,r,i,a,o){var s;(s=e.call(this)||this).type="TorusKnotBufferGeometry",s.parameters={radius:t,tube:n,tubularSegments:r,radialSegments:i,p:a,q:o},t=t||1,n=n||.4,r=Math.floor(r)||64,i=Math.floor(i)||8,a=a||2,o=o||3;for(var l=[],u=[],c=[],h=[],d=new xe,p=new xe,f=new xe,m=new xe,v=new xe,g=new xe,y=new xe,x=0;x<=r;++x){var _=x/r*a*Math.PI*2;P(_,a,o,t,f),P(_+.01,a,o,t,m),g.subVectors(m,f),y.addVectors(m,f),v.crossVectors(g,y),y.crossVectors(v,g),v.normalize(),y.normalize();for(var b=0;b<=i;++b){var w=b/i*Math.PI*2,M=-n*Math.cos(w),S=n*Math.sin(w);d.x=f.x+(M*y.x+S*v.x),d.y=f.y+(M*y.y+S*v.y),d.z=f.z+(M*y.z+S*v.z),u.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),c.push(p.x,p.y,p.z),h.push(x/r),h.push(b/i)}}for(var T=1;T<=r;T++)for(var E=1;E<=i;E++){var A=(i+1)*(T-1)+(E-1),C=(i+1)*T+(E-1),L=(i+1)*T+E,R=(i+1)*(T-1)+E;l.push(A,C,R),l.push(C,L,R)}function P(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}return s.setIndex(l),s.setAttribute("position",new tn(u,3)),s.setAttribute("normal",new tn(c,3)),s.setAttribute("uv",new tn(h,2)),s}return se(t,e),t}(pn),Rs=function(e){function t(t,n,r,i,a,o,s){var l;return(l=e.call(this)||this).type="TorusKnotGeometry",l.parameters={radius:t,tube:n,tubularSegments:r,radialSegments:i,p:a,q:o},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),l.fromBufferGeometry(new Ls(t,n,r,i,a,o)),l.mergeVertices(),l}return se(t,e),t}(mo),Ps=function(e){function t(t,n,r,i,a){var o;(o=e.call(this)||this).type="TubeBufferGeometry",o.parameters={path:t,tubularSegments:n,radius:r,radialSegments:i,closed:a},n=n||64,r=r||1,i=i||8,a=a||!1;var s=t.computeFrenetFrames(n,a);o.tangents=s.tangents,o.normals=s.normals,o.binormals=s.binormals;var l=new xe,u=new xe,c=new ce,h=new xe,d=[],p=[],f=[],m=[];function v(e){h=t.getPointAt(e/n,h);for(var a=s.normals[e],o=s.binormals[e],c=0;c<=i;c++){var f=c/i*Math.PI*2,m=Math.sin(f),v=-Math.cos(f);u.x=v*a.x+m*o.x,u.y=v*a.y+m*o.y,u.z=v*a.z+m*o.z,u.normalize(),p.push(u.x,u.y,u.z),l.x=h.x+r*u.x,l.y=h.y+r*u.y,l.z=h.z+r*u.z,d.push(l.x,l.y,l.z)}}return function(){for(var e=0;e<n;e++)v(e);v(!1===a?n:0),function(){for(var e=0;e<=n;e++)for(var t=0;t<=i;t++)c.x=e/n,c.y=t/i,f.push(c.x,c.y)}(),function(){for(var e=1;e<=n;e++)for(var t=1;t<=i;t++){var r=(i+1)*(e-1)+(t-1),a=(i+1)*e+(t-1),o=(i+1)*e+t,s=(i+1)*(e-1)+t;m.push(r,a,s),m.push(a,o,s)}}()}(),o.setIndex(m),o.setAttribute("position",new tn(d,3)),o.setAttribute("normal",new tn(p,3)),o.setAttribute("uv",new tn(f,2)),o}return se(t,e),t.prototype.toJSON=function(){var e=pn.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},t}(pn),Ds=function(e){function t(t,n,r,i,a,o){var s;(s=e.call(this)||this).type="TubeGeometry",s.parameters={path:t,tubularSegments:n,radius:r,radialSegments:i,closed:a},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var l=new Ps(t,n,r,i,a);return s.tangents=l.tangents,s.normals=l.normals,s.binormals=l.binormals,s.fromBufferGeometry(l),s.mergeVertices(),s}return se(t,e),t}(mo),Is=function(e){function t(t){var n;(n=e.call(this)||this).type="WireframeGeometry";var r=[],i=[0,0],a={},o=["a","b","c"];if(t&&t.isGeometry){for(var s=t.faces,l=0,u=s.length;l<u;l++)for(var c=s[l],h=0;h<3;h++){var d=c[o[h]],p=c[o[(h+1)%3]];i[0]=Math.min(d,p),i[1]=Math.max(d,p);var f=i[0]+","+i[1];void 0===a[f]&&(a[f]={index1:i[0],index2:i[1]})}for(var m in a){var v=a[m],g=t.vertices[v.index1];r.push(g.x,g.y,g.z),g=t.vertices[v.index2],r.push(g.x,g.y,g.z)}}else if(t&&t.isBufferGeometry){var y=new xe;if(null!==t.index){var x=t.attributes.position,_=t.index,b=t.groups;0===b.length&&(b=[{start:0,count:_.count,materialIndex:0}]);for(var w=0,M=b.length;w<M;++w)for(var S=b[w],T=S.start,E=T,A=T+S.count;E<A;E+=3)for(var C=0;C<3;C++){var L=_.getX(E+C),R=_.getX(E+(C+1)%3);i[0]=Math.min(L,R),i[1]=Math.max(L,R);var P=i[0]+","+i[1];void 0===a[P]&&(a[P]={index1:i[0],index2:i[1]})}for(var D in a){var I=a[D];y.fromBufferAttribute(x,I.index1),r.push(y.x,y.y,y.z),y.fromBufferAttribute(x,I.index2),r.push(y.x,y.y,y.z)}}else for(var O=t.attributes.position,z=0,k=O.count/3;z<k;z++)for(var F=0;F<3;F++){var N=3*z+F;y.fromBufferAttribute(O,N),r.push(y.x,y.y,y.z);var B=3*z+(F+1)%3;y.fromBufferAttribute(O,B),r.push(y.x,y.y,y.z)}}return n.setAttribute("position",new tn(r,3)),n}return se(t,e),t}(pn),Os=Object.freeze({__proto__:null,BoxGeometry:vo,BoxBufferGeometry:On,CircleGeometry:yo,CircleBufferGeometry:go,ConeGeometry:bo,ConeBufferGeometry:wo,CylinderGeometry:_o,CylinderBufferGeometry:xo,DodecahedronGeometry:To,DodecahedronBufferGeometry:So,EdgesGeometry:Ro,ExtrudeGeometry:os,ExtrudeBufferGeometry:is,IcosahedronGeometry:ls,IcosahedronBufferGeometry:ss,LatheGeometry:cs,LatheBufferGeometry:us,OctahedronGeometry:ds,OctahedronBufferGeometry:hs,ParametricGeometry:fs,ParametricBufferGeometry:ps,PlaneGeometry:ms,PlaneBufferGeometry:Jn,PolyhedronGeometry:vs,PolyhedronBufferGeometry:Mo,RingGeometry:ys,RingBufferGeometry:gs,ShapeGeometry:_s,ShapeBufferGeometry:xs,SphereGeometry:ws,SphereBufferGeometry:bs,TetrahedronGeometry:Ss,TetrahedronBufferGeometry:Ms,TextGeometry:Es,TextBufferGeometry:Ts,TorusGeometry:Cs,TorusBufferGeometry:As,TorusKnotGeometry:Rs,TorusKnotBufferGeometry:Ls,TubeGeometry:Ds,TubeBufferGeometry:Ps,WireframeGeometry:Is});function zs(e){jt.call(this),this.type="ShadowMaterial",this.color=new Ut(0),this.transparent=!0,this.setValues(e)}function ks(e){Nn.call(this,e),this.type="RawShaderMaterial"}function Fs(e){jt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ut(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Ns(e){Fs.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ce(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=ie.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}function Bs(e){jt.call(this),this.type="MeshPhongMaterial",this.color=new Ut(16777215),this.specular=new Ut(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Us(e){jt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ut(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Gs(e){jt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Hs(e){jt.call(this),this.type="MeshLambertMaterial",this.color=new Ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ut(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function js(e){jt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ut(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ce(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Vs(e){Ha.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}zs.prototype=Object.create(jt.prototype),zs.prototype.constructor=zs,zs.prototype.isShadowMaterial=!0,zs.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this},ks.prototype=Object.create(Nn.prototype),ks.prototype.constructor=ks,ks.prototype.isRawShaderMaterial=!0,Fs.prototype=Object.create(jt.prototype),Fs.prototype.constructor=Fs,Fs.prototype.isMeshStandardMaterial=!0,Fs.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Ns.prototype=Object.create(Fs.prototype),Ns.prototype.constructor=Ns,Ns.prototype.isMeshPhysicalMaterial=!0,Ns.prototype.copy=function(e){return Fs.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Ut).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this},Bs.prototype=Object.create(jt.prototype),Bs.prototype.constructor=Bs,Bs.prototype.isMeshPhongMaterial=!0,Bs.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Us.prototype=Object.create(jt.prototype),Us.prototype.constructor=Us,Us.prototype.isMeshToonMaterial=!0,Us.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Gs.prototype=Object.create(jt.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isMeshNormalMaterial=!0,Gs.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Hs.prototype=Object.create(jt.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isMeshLambertMaterial=!0,Hs.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},js.prototype=Object.create(jt.prototype),js.prototype.constructor=js,js.prototype.isMeshMatcapMaterial=!0,js.prototype.copy=function(e){return jt.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Vs.prototype=Object.create(Ha.prototype),Vs.prototype.constructor=Vs,Vs.prototype.isLineDashedMaterial=!0,Vs.prototype.copy=function(e){return Ha.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Ws=Object.freeze({__proto__:null,ShadowMaterial:zs,SpriteMaterial:ua,RawShaderMaterial:ks,ShaderMaterial:Nn,PointsMaterial:$a,MeshPhysicalMaterial:Ns,MeshStandardMaterial:Fs,MeshPhongMaterial:Bs,MeshToonMaterial:Us,MeshNormalMaterial:Gs,MeshLambertMaterial:Hs,MeshDepthMaterial:ji,MeshDistanceMaterial:Vi,MeshBasicMaterial:Vt,MeshMatcapMaterial:js,LineDashedMaterial:Vs,LineBasicMaterial:Ha,Material:jt}),qs={arraySlice:function(e,t,n){return qs.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,l=0;l!==t;++l)i[o++]=e[s+l];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}},subclip:function(e,t,n,r,i){i=i||30;var a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],u=l.getValueSize(),c=[],h=[],d=0;d<l.times.length;++d){var p=l.times[d]*i;if(!(p<n||p>=r)){c.push(l.times[d]);for(var f=0;f<u;++f)h.push(l.values[d*u+f])}}0!==c.length&&(l.times=qs.convertArray(c,l.times.constructor),l.values=qs.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;for(var m=1/0,v=0;v<a.tracks.length;++v)m>a.tracks[v].times[0]&&(m=a.tracks[v].times[0]);for(var g=0;g<a.tracks.length;++g)a.tracks[g].shift(-1*m);return a.resetDuration(),a},makeClipAdditive:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=e),(void 0===r||r<=0)&&(r=30);for(var i=n.tracks.length,a=t/r,o=function(t){var r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)return"continue";var o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===o)return"continue";var s=0,l=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);var u=0,c=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=c/3);var h=r.times.length-1,d=void 0;if(a<=r.times[0]){var p=s,f=l-s;d=qs.arraySlice(r.values,p,f)}else if(a>=r.times[h]){var m=h*l+s,v=m+l-s;d=qs.arraySlice(r.values,m,v)}else{var g=r.createInterpolant(),y=s,x=l-s;g.evaluate(a),d=qs.arraySlice(g.resultBuffer,y,x)}"quaternion"===i&&(new ye).fromArray(d).normalize().conjugate().toArray(d);for(var _=o.times.length,b=0;b<_;++b){var w=b*c+u;if("quaternion"===i)ye.multiplyQuaternionsFlat(o.values,w,d,0,o.values,w);else for(var M=c-2*u,S=0;S<M;++S)o.values[w+S]-=d[S]}},s=0;s<i;++s)o(s);return e.blendMode=W,e}};function Xs(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Ys(e,t,n,r){Xs.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Zs(e,t,n,r){Xs.call(this,e,t,n,r)}function Ks(e,t,n,r){Xs.call(this,e,t,n,r)}function Js(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qs.convertArray(t,this.TimeBufferType),this.values=qs.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Qs(e,t,n){Js.call(this,e,t,n)}function $s(e,t,n,r){Js.call(this,e,t,n,r)}function el(e,t,n,r){Js.call(this,e,t,n,r)}function tl(e,t,n,r){Xs.call(this,e,t,n,r)}function nl(e,t,n,r){Js.call(this,e,t,n,r)}function rl(e,t,n,r){Js.call(this,e,t,n,r)}function il(e,t,n,r){Js.call(this,e,t,n,r)}function al(e,t,n,r){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.blendMode=void 0!==r?r:V,this.uuid=ie.generateUUID(),this.duration<0&&this.resetDuration()}function ol(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return el;case"vector":case"vector2":case"vector3":case"vector4":return il;case"color":return $s;case"quaternion":return nl;case"bool":case"boolean":return Qs;case"string":return rl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];qs.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Xs.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(var l=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===l)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var u=n+a>>>1;e<t[u]?a=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Xs.prototype,{beforeStart_:Xs.prototype.copySampleValue_,afterEnd_:Xs.prototype.copySampleValue_}),Ys.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Ys,DefaultSettings_:{endingStart:G,endingEnd:G},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case H:i=e,o=2*t-n;break;case j:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case H:a=e,s=2*n-t;break;case j:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=a*u},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(r-t),f=p*p,m=f*p,v=-h*m+2*h*f-h*p,g=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f,_=0;_!==o;++_)i[_]=v*a[u+_]+g*a[l+_]+y*a[s+_]+x*a[c+_];return i}}),Zs.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Zs,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(r-t),c=1-u,h=0;h!==o;++h)i[h]=a[l+h]*c+a[s+h]*u;return i}}),Ks.prototype=Object.assign(Object.create(Xs.prototype),{constructor:Ks,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Js,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:qs.convertArray(e.times,Array),values:qs.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(Js.prototype,{constructor:Js,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:B,InterpolantFactoryMethodDiscrete:function(e){return new Ks(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Zs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ys(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case N:t=this.InterpolantFactoryMethodDiscrete;break;case B:t=this.InterpolantFactoryMethodLinear;break;case U:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return N;case this.InterpolantFactoryMethodLinear:return B;case this.InterpolantFactoryMethodSmooth:return U}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=qs.arraySlice(n,i,a),this.values=qs.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&qs.isTypedArray(r))for(var l=0,u=r.length;l!==u;++l){var c=r[l];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,c),e=!1;break}}return e},optimize:function(){for(var e=qs.arraySlice(this.times),t=qs.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===U,i=e.length-1,a=1,o=1;o<i;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==l[0]))if(r)s=!0;else for(var u=o*n,c=u-n,h=u+n,d=0;d!==n;++d){var p=t[u+d];if(p!==t[c+d]||p!==t[h+d]){s=!0;break}}if(s){if(o!==a){e[a]=e[o];for(var f=o*n,m=a*n,v=0;v!==n;++v)t[m+v]=t[f+v]}++a}}if(i>0){e[a]=e[i];for(var g=i*n,y=a*n,x=0;x!==n;++x)t[y+x]=t[g+x];++a}return a!==e.length?(this.times=qs.arraySlice(e,0,a),this.values=qs.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this},clone:function(){var e=qs.arraySlice(this.times,0),t=qs.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Qs.prototype=Object.assign(Object.create(Js.prototype),{constructor:Qs,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:N,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),$s.prototype=Object.assign(Object.create(Js.prototype),{constructor:$s,ValueTypeName:"color"}),el.prototype=Object.assign(Object.create(Js.prototype),{constructor:el,ValueTypeName:"number"}),tl.prototype=Object.assign(Object.create(Xs.prototype),{constructor:tl,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),l=e*o,u=l+o;l!==u;l+=4)ye.slerpFlat(i,0,a,l-o,a,l,s);return i}}),nl.prototype=Object.assign(Object.create(Js.prototype),{constructor:nl,ValueTypeName:"quaternion",DefaultInterpolation:B,InterpolantFactoryMethodLinear:function(e){return new tl(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),rl.prototype=Object.assign(Object.create(Js.prototype),{constructor:rl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:N,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),il.prototype=Object.assign(Object.create(Js.prototype),{constructor:il,ValueTypeName:"vector"}),Object.assign(al,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(ol(n[i]).scale(r));return new al(e.name,e.duration,t,e.blendMode)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},i=0,a=n.length;i!==a;++i)t.push(Js.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],l=[];s.push((o+i-1)%i,o,(o+1)%i),l.push(0,1,0);var u=qs.getKeyframeOrder(s);s=qs.sortedArray(s,1,u),l=qs.sortedArray(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new el(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new al(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(i);if(l&&l.length>1){var u=l[1],c=r[u];c||(r[u]=c=[]),c.push(s)}}var h=[];for(var d in r)h.push(al.CreateFromMorphTargetSequence(d,r[d],t,n));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];qs.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[],u=0;u<l.length;u++){var c=l[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){var h={},d=void 0;for(d=0;d<c.length;d++)if(c[d].morphTargets)for(var p=0;p<c[d].morphTargets.length;p++)h[c[d].morphTargets[p]]=-1;for(var f in h){for(var m=[],v=[],g=0;g!==c[d].morphTargets.length;++g){var y=c[d];m.push(y.time),v.push(y.morphTarget===f?1:0)}r.push(new el(".morphTargetInfluence["+f+"]",m,v))}s=h.length*(a||1)}else{var x=".bones["+t[u].name+"]";n(il,x+".position",c,"pos",r),n(nl,x+".quaternion",c,"rot",r),n(il,x+".scale",c,"scl",r)}}return 0===r.length?null:new al(i,s,r,o)}}),Object.assign(al.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new al(this.name,this.duration,e,this.blendMode)}});var sl={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function ll(e,t,n){var r=this,i=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){var t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=l.length;t<n;t+=2){var r=l[t],i=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}var ul=new ll;function cl(e){this.manager=void 0!==e?e:ul,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(cl.prototype,{load:function(){},loadAsync:function(e,t){var n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var hl={};function dl(e){cl.call(this,e)}function pl(e){cl.call(this,e)}function fl(e){cl.call(this,e)}function ml(e){cl.call(this,e)}function vl(e){cl.call(this,e)}function gl(e){cl.call(this,e)}function yl(e){cl.call(this,e)}function xl(){this.type="Curve",this.arcLengthDivisions=200}function _l(e,t,n,r,i,a,o,s){xl.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function bl(e,t,n,r,i,a){_l.call(this,e,t,n,n,r,i,a),this.type="ArcCurve"}function wl(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,u=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,l*=o,u*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}dl.prototype=Object.assign(Object.create(cl.prototype),{constructor:dl,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=sl.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===hl[e]){var o,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var l=s[1],u=!!s[2],c=s[3];c=decodeURIComponent(c),u&&(c=atob(c));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var p=new Uint8Array(c.length),f=0;f<c.length;f++)p[f]=c.charCodeAt(f);h="blob"===d?new Blob([p.buffer],{type:l}):p.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(c,l);break;case"json":h=JSON.parse(c);break;default:h=c}setTimeout((function(){t&&t(h),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{for(var v in hl[e]=[],hl[e].push({onLoad:t,onProgress:n,onError:r}),(o=new XMLHttpRequest).open("GET",e,!0),o.addEventListener("load",(function(t){var n=this.response,r=hl[e];if(delete hl[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),sl.add(e,n);for(var a=0,o=r.length;a<o;a++){var s=r[a];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(var l=0,u=r.length;l<u;l++){var c=r[l];c.onError&&c.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),o.addEventListener("progress",(function(t){for(var n=hl[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}}),!1),o.addEventListener("error",(function(t){var n=hl[e];delete hl[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),o.addEventListener("abort",(function(t){var n=hl[e];delete hl[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.overrideMimeType&&o.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)o.setRequestHeader(v,this.requestHeader[v]);o.send(null)}return i.manager.itemStart(e),o}hl[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}}),pl.prototype=Object.assign(Object.create(cl.prototype),{constructor:pl,load:function(e,t,n,r){var i=this,a=new dl(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=al.parse(e[n]);t.push(r)}return t}}),fl.prototype=Object.assign(Object.create(cl.prototype),{constructor:fl,load:function(e,t,n,r){var i=this,a=[],o=new so;o.image=a;var s=new dl(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);var l=0;function u(u){s.load(e[u],(function(e){var n=i.parse(e,!0);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=v),o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var c=0,h=e.length;c<h;++c)u(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=v),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}),ml.prototype=Object.assign(Object.create(cl.prototype),{constructor:ml,load:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=sl.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),sl.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}),vl.prototype=Object.assign(Object.create(cl.prototype),{constructor:vl,load:function(e,t,n,r){var i=new jn,a=new ml(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6==++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var l=0;l<e.length;++l)s(l);return i}}),gl.prototype=Object.assign(Object.create(cl.prototype),{constructor:gl,load:function(e,t,n,r){var i=this,a=new Wn,o=new dl(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:h,a.wrapT=void 0!==n.wrapT?n.wrapT:h,a.magFilter=void 0!==n.magFilter?n.magFilter:v,a.minFilter=void 0!==n.minFilter?n.minFilter:v,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=g),1===n.mipmapCount&&(a.minFilter=v),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}),yl.prototype=Object.assign(Object.create(cl.prototype),{constructor:yl,load:function(e,t,n,r){var i=new fe,a=new ml(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?S:T,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),Object.assign(xl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),i=0;n.push(0);for(var a=1;a<=e;a++)i+=(t=this.getPoint(a/e)).distanceTo(r),n.push(i),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(r[i=l]===n)return i/(a-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(a-1)},getTangent:function(e,t){var n=1e-4,r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);var a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new ce:new xe);return s.copy(o).sub(a).normalize(),s},getTangentAt:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)},computeFrenetFrames:function(e,t){for(var n=new xe,r=[],i=[],a=[],o=new xe,s=new Xe,l=0;l<=e;l++){var u=l/e;r[l]=this.getTangentAt(u,new xe),r[l].normalize()}i[0]=new xe,a[0]=new xe;var c=Number.MAX_VALUE,h=Math.abs(r[0].x),d=Math.abs(r[0].y),p=Math.abs(r[0].z);h<=c&&(c=h,n.set(1,0,0)),d<=c&&(c=d,n.set(0,1,0)),p<=c&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(var f=1;f<=e;f++){if(i[f]=i[f-1].clone(),a[f]=a[f-1].clone(),o.crossVectors(r[f-1],r[f]),o.length()>Number.EPSILON){o.normalize();var m=Math.acos(ie.clamp(r[f-1].dot(r[f]),-1,1));i[f].applyMatrix4(s.makeRotationAxis(o,m))}a[f].crossVectors(r[f],i[f])}if(!0===t){var v=Math.acos(ie.clamp(i[0].dot(i[e]),-1,1));v/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(v=-v);for(var g=1;g<=e;g++)i[g].applyMatrix4(s.makeRotationAxis(r[g],v*g)),a[g].crossVectors(r[g],i[g])}return{tangents:r,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),_l.prototype=Object.create(xl.prototype),_l.prototype.constructor=_l,_l.prototype.isEllipseCurve=!0,_l.prototype.getPoint=function(e,t){for(var n=t||new ce,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=s-this.aX,d=l-this.aY;s=h*u-d*c+this.aX,l=h*c+d*u+this.aY}return n.set(s,l)},_l.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},_l.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},_l.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},bl.prototype=Object.create(_l.prototype),bl.prototype.constructor=bl,bl.prototype.isArcCurve=!0;var Ml=new xe,Sl=new wl,Tl=new wl,El=new wl;function Al(e,t,n,r){xl.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=void 0!==r?r:.5}function Cl(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function Ll(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Rl(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function Pl(e,t,n,r){xl.call(this),this.type="CubicBezierCurve",this.v0=e||new ce,this.v1=t||new ce,this.v2=n||new ce,this.v3=r||new ce}function Dl(e,t,n,r){xl.call(this),this.type="CubicBezierCurve3",this.v0=e||new xe,this.v1=t||new xe,this.v2=n||new xe,this.v3=r||new xe}function Il(e,t){xl.call(this),this.type="LineCurve",this.v1=e||new ce,this.v2=t||new ce}function Ol(e,t){xl.call(this),this.type="LineCurve3",this.v1=e||new xe,this.v2=t||new xe}function zl(e,t,n){xl.call(this),this.type="QuadraticBezierCurve",this.v0=e||new ce,this.v1=t||new ce,this.v2=n||new ce}function kl(e,t,n){xl.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new xe,this.v1=t||new xe,this.v2=n||new xe}function Fl(e){xl.call(this),this.type="SplineCurve",this.points=e||[]}Al.prototype=Object.create(xl.prototype),Al.prototype.constructor=Al,Al.prototype.isCatmullRomCurve3=!0,Al.prototype.getPoint=function(e,t){var n,r,i=t||new xe,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,l=Math.floor(s),u=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:0===u&&l===o-1&&(l=o-2,u=1),this.closed||l>0?n=a[(l-1)%o]:(Ml.subVectors(a[0],a[1]).add(a[0]),n=Ml);var c=a[l%o],h=a[(l+1)%o];if(this.closed||l+2<o?r=a[(l+2)%o]:(Ml.subVectors(a[o-1],a[o-2]).add(a[o-1]),r=Ml),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(n.distanceToSquared(c),d),f=Math.pow(c.distanceToSquared(h),d),m=Math.pow(h.distanceToSquared(r),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Sl.initNonuniformCatmullRom(n.x,c.x,h.x,r.x,p,f,m),Tl.initNonuniformCatmullRom(n.y,c.y,h.y,r.y,p,f,m),El.initNonuniformCatmullRom(n.z,c.z,h.z,r.z,p,f,m)}else"catmullrom"===this.curveType&&(Sl.initCatmullRom(n.x,c.x,h.x,r.x,this.tension),Tl.initCatmullRom(n.y,c.y,h.y,r.y,this.tension),El.initCatmullRom(n.z,c.z,h.z,r.z,this.tension));return i.set(Sl.calc(u),Tl.calc(u),El.calc(u)),i},Al.prototype.copy=function(e){xl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Al.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Al.prototype.fromJSON=function(e){xl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new xe).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Pl.prototype=Object.create(xl.prototype),Pl.prototype.constructor=Pl,Pl.prototype.isCubicBezierCurve=!0,Pl.prototype.getPoint=function(e,t){var n=t||new ce,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Rl(e,r.x,i.x,a.x,o.x),Rl(e,r.y,i.y,a.y,o.y)),n},Pl.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Pl.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Pl.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Dl.prototype=Object.create(xl.prototype),Dl.prototype.constructor=Dl,Dl.prototype.isCubicBezierCurve3=!0,Dl.prototype.getPoint=function(e,t){var n=t||new xe,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Rl(e,r.x,i.x,a.x,o.x),Rl(e,r.y,i.y,a.y,o.y),Rl(e,r.z,i.z,a.z,o.z)),n},Dl.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Dl.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Dl.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Il.prototype=Object.create(xl.prototype),Il.prototype.constructor=Il,Il.prototype.isLineCurve=!0,Il.prototype.getPoint=function(e,t){var n=t||new ce;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Il.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Il.prototype.getTangent=function(e,t){var n=t||new ce;return n.copy(this.v2).sub(this.v1).normalize(),n},Il.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Il.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Il.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ol.prototype=Object.create(xl.prototype),Ol.prototype.constructor=Ol,Ol.prototype.isLineCurve3=!0,Ol.prototype.getPoint=function(e,t){var n=t||new xe;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},Ol.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ol.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ol.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ol.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},zl.prototype=Object.create(xl.prototype),zl.prototype.constructor=zl,zl.prototype.isQuadraticBezierCurve=!0,zl.prototype.getPoint=function(e,t){var n=t||new ce,r=this.v0,i=this.v1,a=this.v2;return n.set(Ll(e,r.x,i.x,a.x),Ll(e,r.y,i.y,a.y)),n},zl.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},zl.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},zl.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},kl.prototype=Object.create(xl.prototype),kl.prototype.constructor=kl,kl.prototype.isQuadraticBezierCurve3=!0,kl.prototype.getPoint=function(e,t){var n=t||new xe,r=this.v0,i=this.v1,a=this.v2;return n.set(Ll(e,r.x,i.x,a.x),Ll(e,r.y,i.y,a.y),Ll(e,r.z,i.z,a.z)),n},kl.prototype.copy=function(e){return xl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},kl.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},kl.prototype.fromJSON=function(e){return xl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Fl.prototype=Object.create(xl.prototype),Fl.prototype.constructor=Fl,Fl.prototype.isSplineCurve=!0,Fl.prototype.getPoint=function(e,t){var n=t||new ce,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(Cl(o,s.x,l.x,u.x,c.x),Cl(o,s.y,l.y,u.y,c.y)),n},Fl.prototype.copy=function(e){xl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},Fl.prototype.toJSON=function(){var e=xl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},Fl.prototype.fromJSON=function(e){xl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new ce).fromArray(r))}return this};var Nl=Object.freeze({__proto__:null,ArcCurve:bl,CatmullRomCurve3:Al,CubicBezierCurve:Pl,CubicBezierCurve3:Dl,EllipseCurve:_l,LineCurve:Il,LineCurve3:Ol,QuadraticBezierCurve:zl,QuadraticBezierCurve3:kl,SplineCurve:Fl});function Bl(){xl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Ul(e){Bl.call(this),this.type="Path",this.currentPoint=new ce,e&&this.setFromPoints(e)}function Gl(e){Ul.call(this,e),this.uuid=ie.generateUUID(),this.type="Shape",this.holes=[]}function Hl(e,t){yt.call(this),this.type="Light",this.color=new Ut(e),this.intensity=void 0!==t?t:1}function jl(e,t,n){Hl.call(this,e,n),this.type="HemisphereLight",this.position.copy(yt.DefaultUp),this.updateMatrix(),this.groundColor=new Ut(t)}function Vl(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new ce(512,512),this.map=null,this.mapPass=null,this.matrix=new Xe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yn,this._frameExtents=new ce(1,1),this._viewportCount=1,this._viewports=[new me(0,0,1,1)]}function Wl(){Vl.call(this,new Un(50,1,.5,500)),this.focus=1}function ql(e,t,n,r,i,a){Hl.call(this,e,t),this.type="SpotLight",this.position.copy(yt.DefaultUp),this.updateMatrix(),this.target=new yt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new Wl}function Xl(){Vl.call(this,new Un(90,1,.5,500)),this._frameExtents=new ce(4,2),this._viewportCount=6,this._viewports=[new me(2,1,1,1),new me(0,1,1,1),new me(3,1,1,1),new me(1,1,1,1),new me(3,0,1,1),new me(1,0,1,1)],this._cubeDirections=[new xe(1,0,0),new xe(-1,0,0),new xe(0,0,1),new xe(0,0,-1),new xe(0,1,0),new xe(0,-1,0)],this._cubeUps=[new xe(0,1,0),new xe(0,1,0),new xe(0,1,0),new xe(0,1,0),new xe(0,0,1),new xe(0,0,-1)]}function Yl(e,t,n,r){Hl.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Xl}function Zl(e,t,n,r,i,a){Bn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function Kl(){Vl.call(this,new Zl(-5,5,5,-5,.5,500))}function Jl(e,t){Hl.call(this,e,t),this.type="DirectionalLight",this.position.copy(yt.DefaultUp),this.updateMatrix(),this.target=new yt,this.shadow=new Kl}function Ql(e,t){Hl.call(this,e,t),this.type="AmbientLight"}function $l(e,t,n,r){Hl.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}Bl.prototype=Object.assign(Object.create(xl.prototype),{constructor:Bl,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Il(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){xl.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=xl.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){xl.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new Nl[r.type]).fromJSON(r))}return this}}),Ul.prototype=Object.assign(Object.create(Bl.prototype),{constructor:Ul,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new Il(this.currentPoint.clone(),new ce(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,r){var i=new zl(this.currentPoint.clone(),new ce(e,t),new ce(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(e,t,n,r,i,a){var o=new Pl(this.currentPoint.clone(),new ce(e,t),new ce(n,r),new ce(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this},splineThru:function(e){var t=new Fl([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this},absarc:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this},ellipse:function(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,r,i,a,o,s),this},absellipse:function(e,t,n,r,i,a,o,s){var l=new _l(e,t,n,r,i,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);return this.currentPoint.copy(c),this},copy:function(e){return Bl.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Bl.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Bl.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Gl.prototype=Object.assign(Object.create(Ul.prototype),{constructor:Gl,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Ul.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=Ul.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){Ul.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new Ul).fromJSON(r))}return this}}),Hl.prototype=Object.assign(Object.create(yt.prototype),{constructor:Hl,isLight:!0,copy:function(e){return yt.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=yt.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),jl.prototype=Object.assign(Object.create(Hl.prototype),{constructor:jl,isHemisphereLight:!0,copy:function(e){return Hl.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Vl.prototype,{_projScreenMatrix:new Xe,_lightPositionWorld:new xe,_lookTarget:new xe,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),i.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i),t.updateMatrixWorld(),r.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Wl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Wl,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=2*ie.RAD2DEG*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),Vl.prototype.updateMatrices.call(this,e)}}),ql.prototype=Object.assign(Object.create(Hl.prototype),{constructor:ql,isSpotLight:!0,copy:function(e){return Hl.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Xl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Xl,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(e.matrixWorld),n.position.copy(i),a.copy(n.position),a.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),Yl.prototype=Object.assign(Object.create(Hl.prototype),{constructor:Yl,isPointLight:!0,copy:function(e){return Hl.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Zl.prototype=Object.assign(Object.create(Bn.prototype),{constructor:Zl,isOrthographicCamera:!0,copy:function(e,t){return Bn.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=yt.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Kl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Kl,isDirectionalLightShadow:!0,updateMatrices:function(e){Vl.prototype.updateMatrices.call(this,e)}}),Jl.prototype=Object.assign(Object.create(Hl.prototype),{constructor:Jl,isDirectionalLight:!0,copy:function(e){return Hl.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ql.prototype=Object.assign(Object.create(Hl.prototype),{constructor:Ql,isAmbientLight:!0}),$l.prototype=Object.assign(Object.create(Hl.prototype),{constructor:$l,isRectAreaLight:!0,copy:function(e){return Hl.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Hl.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});var eu=function(){function e(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new xe)}var t=e.prototype;return t.set=function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},t.zero=function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},t.getAt=function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t},t.getIrradianceAt=function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t},t.add=function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},t.addScaledSH=function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this},t.scale=function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},t.lerp=function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},t.equals=function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},t.copy=function(e){return this.set(e.coefficients)},t.clone=function(){return(new this.constructor).copy(this)},t.fromArray=function(e,t){void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this},t.toArray=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e},e.getBasisAt=function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)},e}();function tu(e,t){Hl.call(this,void 0,t),this.type="LightProbe",this.sh=void 0!==e?e:new eu}function nu(e){cl.call(this,e),this.textures={}}tu.prototype=Object.assign(Object.create(Hl.prototype),{constructor:tu,isLightProbe:!0,copy:function(e){return Hl.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){var t=Hl.prototype.toJSON.call(this,e);return t.object.sh=this.sh.toArray(),t}}),nu.prototype=Object.assign(Object.create(cl.prototype),{constructor:nu,load:function(e,t,n,r){var i=this,a=new dl(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Ws[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new Ut).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new Ut).setHex(a.value);break;case"v2":r.uniforms[i].value=(new ce).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new xe).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new me).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new he).fromArray(a.value);break;case"m4":r.uniforms[i].value=(new Xe).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new ce).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new ce).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r},setTextures:function(e){return this.textures=e,this}});var ru={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function iu(){pn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function au(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Xt.call(this,e,t,n),this.meshPerAttribute=r||1}function ou(e){cl.call(this,e)}iu.prototype=Object.assign(Object.create(pn.prototype),{constructor:iu,isInstancedBufferGeometry:!0,copy:function(e){return pn.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=pn.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),au.prototype=Object.assign(Object.create(Xt.prototype),{constructor:au,isInstancedBufferAttribute:!0,copy:function(e){return Xt.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Xt.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),ou.prototype=Object.assign(Object.create(cl.prototype),{constructor:ou,load:function(e,t,n,r){var i=this,a=new dl(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=new aa(new lu[i.type](a),i.stride);return o.uuid=i.uuid,t[r]=o,o}var i=e.isInstancedBufferGeometry?new iu:new pn,a=e.data.index;if(void 0!==a){var o=new lu[a.type](a.array);i.setIndex(new Xt(o,1))}var s=e.data.attributes;for(var l in s){var u=s[l],c=void 0;if(u.isInterleavedBufferAttribute)c=new la(r(e.data,u.data),u.itemSize,u.offset,u.normalized);else{var h=new lu[u.type](u.array);c=new(u.isInstancedBufferAttribute?au:Xt)(h,u.itemSize,u.normalized)}void 0!==u.name&&(c.name=u.name),i.setAttribute(l,c)}var d=e.data.morphAttributes;if(d)for(var p in d){for(var f=d[p],m=[],v=0,g=f.length;v<g;v++){var y=f[v],x=void 0;x=y.isInterleavedBufferAttribute?new la(r(e.data,y.data),y.itemSize,y.offset,y.normalized):new Xt(new lu[y.type](y.array),y.itemSize,y.normalized),void 0!==y.name&&(x.name=y.name),m.push(x)}i.morphAttributes[p]=m}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);var _=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==_)for(var b=0,w=_.length;b!==w;++b){var M=_[b];i.addGroup(M.start,M.count,M.materialIndex)}var S=e.data.boundingSphere;if(void 0!==S){var T=new xe;void 0!==S.center&&T.fromArray(S.center),i.boundingSphere=new Ne(T,S.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}});var su,lu={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array},uu=function(e){function t(t){return e.call(this,t)||this}se(t,e);var n=t.prototype;return n.load=function(e,t,n,r){var i=this,a=""===this.path?ru.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new dl(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},n.parse=function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},n.parseShape=function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new Gl).fromJSON(e[n]);t[i.uuid]=i}return t},n.parseGeometries=function(e,t){var n,r={};if(void 0!==e)for(var i=new ou,a=0,o=e.length;a<o;a++){var s=void 0,l=e[a];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Os[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Os[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Os[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Os[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Os[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Os[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Os[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Os[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Os[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Os[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new Os[l.type]((new Nl[l.path.type]).fromJSON(l.path),l.tubularSegments,l.radius,l.radialSegments,l.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Os[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Os[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var u=0,c=l.shapes.length;u<c;u++){var h=t[l.shapes[u]];n.push(h)}s=new Os[l.type](n,l.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var d=0,p=l.shapes.length;d<p;d++){var f=t[l.shapes[d]];n.push(f)}var m=l.options.extrudePath;void 0!==m&&(l.options.extrudePath=(new Nl[m.type]).fromJSON(m)),s=new Os[l.type](n,l.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(l);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),!0===s.isBufferGeometry&&void 0!==l.userData&&(s.userData=l.userData),r[l.uuid]=s}return r},n.parseMaterials=function(e,t){var n={},r={};if(void 0!==e){var i=new nu;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var l=[],u=0;u<s.materials.length;u++){var c=s.materials[u];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),l.push(n[c.uuid])}r[s.uuid]=l}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},n.parseAnimations=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=al.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},n.parseImages=function(e,t){var n,r=this,i={};function a(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var o=new ll(t);(n=new ml(o)).setCrossOrigin(this.crossOrigin);for(var s=0,l=e.length;s<l;s++){var u=e[s],c=u.url;if(Array.isArray(c)){i[u.uuid]=[];for(var h=0,d=c.length;h<d;h++){var p=c[h],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:r.resourcePath+p;i[u.uuid].push(a(f))}}else{var m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:r.resourcePath+u.url;i[u.uuid]=a(m)}}}return i},n.parseTextures=function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0;(s=Array.isArray(t[o.image])?new jn(t[o.image]):new fe(t[o.image])).needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,cu)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],hu),s.wrapT=n(o.wrap[1],hu)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,du)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,du)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),r[o.uuid]=s}return r},n.parseObject=function(e,t,n){var r,i,a;function o(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function s(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new ia,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new Ut(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new ra(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new na(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new Un(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new Zl(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new Ql(e.color,e.intensity);break;case"DirectionalLight":r=new Jl(e.color,e.intensity);break;case"PointLight":r=new Yl(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new $l(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new ql(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new jl(e.color,e.groundColor,e.intensity);break;case"LightProbe":r=(new tu).fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":r=new Pn(i=o(e.geometry),a=s(e.material));break;case"InstancedMesh":i=o(e.geometry),a=s(e.material);var l=e.count,u=e.instanceMatrix;(r=new Ga(i,a,l)).instanceMatrix=new Xt(new Float32Array(u.array),16);break;case"LOD":r=new Pa;break;case"Line":r=new Ya(o(e.geometry),s(e.material),e.mode);break;case"LineLoop":r=new Qa(o(e.geometry),s(e.material));break;case"LineSegments":r=new Ja(o(e.geometry),s(e.material));break;case"PointCloud":case"Points":r=new io(o(e.geometry),s(e.material));break;case"Sprite":r=new wa(s(e.material));break;case"Group":r=new Ki;break;default:r=new yt}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(r.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,h=0;h<c.length;h++)r.add(this.parseObject(c[h],t,n));if("LOD"===e.type){void 0!==e.autoUpdate&&(r.autoUpdate=e.autoUpdate);for(var d=e.levels,p=0;p<d.length;p++){var f=d[p],m=r.getObjectByProperty("uuid",f.object);void 0!==m&&r.addLevel(m,f.distance)}}return r},n.setTexturePath=function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)},t}(cl),cu={UVMapping:n,CubeReflectionMapping:r,CubeRefractionMapping:i,EquirectangularReflectionMapping:o,EquirectangularRefractionMapping:s,CubeUVReflectionMapping:l,CubeUVRefractionMapping:u},hu={RepeatWrapping:c,ClampToEdgeWrapping:h,MirroredRepeatWrapping:d},du={NearestFilter:p,NearestMipmapNearestFilter:f,NearestMipmapLinearFilter:m,LinearFilter:v,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:g};function pu(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),cl.call(this,e),this.options={premultiplyAlpha:"none"}}function fu(){this.type="ShapePath",this.color=new Ut,this.subPaths=[],this.currentPath=null}function mu(e){this.type="Font",this.data=e}function vu(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,l,u,c,h,d,p,f=new fu;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,g=m.length;v<g;)switch(m[v++]){case"m":o=m[v++]*t+n,s=m[v++]*t+r,f.moveTo(o,s);break;case"l":o=m[v++]*t+n,s=m[v++]*t+r,f.lineTo(o,s);break;case"q":l=m[v++]*t+n,u=m[v++]*t+r,c=m[v++]*t+n,h=m[v++]*t+r,f.quadraticCurveTo(c,h,l,u);break;case"b":l=m[v++]*t+n,u=m[v++]*t+r,c=m[v++]*t+n,h=m[v++]*t+r,d=m[v++]*t+n,p=m[v++]*t+r,f.bezierCurveTo(c,h,d,p,l,u)}return{offsetX:a.ha*t,path:f}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}function gu(e){cl.call(this,e)}pu.prototype=Object.assign(Object.create(cl.prototype),{constructor:pu,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=sl.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,i.options)})).then((function(n){sl.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}),Object.assign(fu.prototype,{moveTo:function(e,t){return this.currentPath=new Ul,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this},bezierCurveTo:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new Gl;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[a],l=-l,s=t[i],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=u*(e.x-o.x)-l*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i,a,o,s=ts.isClockWise,l=this.subPaths;if(0===l.length)return[];if(!0===t)return n(l);var u=[];if(1===l.length)return a=l[0],(o=new Gl).curves=a.curves,u.push(o),u;var c=!s(l[0].getPoints());c=e?!c:c;var h,d,p=[],f=[],m=[],v=0;f[v]=void 0,m[v]=[];for(var g=0,y=l.length;g<y;g++)i=s(h=(a=l[g]).getPoints()),(i=e?!i:i)?(!c&&f[v]&&v++,f[v]={s:new Gl,p:h},f[v].s.curves=a.curves,c&&v++,m[v]=[]):m[v].push({h:a,p:h[0]});if(!f[0])return n(l);if(f.length>1){for(var x=!1,_=[],b=0,w=f.length;b<w;b++)p[b]=[];for(var M=0,S=f.length;M<S;M++)for(var T=m[M],E=0;E<T.length;E++){for(var A=T[E],C=!0,L=0;L<f.length;L++)r(A.p,f[L].p)&&(M!==L&&_.push({froms:M,tos:L,hole:E}),C?(C=!1,p[L].push(A)):x=!0);C&&p[M].push(A)}_.length>0&&(x||(m=p))}for(var R=0,P=f.length;R<P;R++){o=f[R].s,u.push(o);for(var D=0,I=(d=m[R]).length;D<I;D++)o.holes.push(d[D].h)}return u}}),Object.assign(mu.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,l=0,u=0;u<r.length;u++){var c=r[u];if("\n"===c)s=0,l-=a;else{var h=vu(c,i,s,l,n);s+=h.offsetX,o.push(h.path)}}return o}(e,t,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),gu.prototype=Object.assign(Object.create(cl.prototype),{constructor:gu,load:function(e,t,n,r){var i=this,a=new dl(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new mu(e)}});var yu={getContext:function(){return void 0===su&&(su=new(window.AudioContext||window.webkitAudioContext)),su},setContext:function(e){su=e}};function xu(e){cl.call(this,e)}function _u(e,t,n){tu.call(this,void 0,n);var r=(new Ut).set(e),i=(new Ut).set(t),a=new xe(r.r,r.g,r.b),o=new xe(i.r,i.g,i.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}function bu(e,t){tu.call(this,void 0,t);var n=(new Ut).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}xu.prototype=Object.assign(Object.create(cl.prototype),{constructor:xu,load:function(e,t,n,r){var i=this,a=new dl(i.manager);a.setResponseType("arraybuffer"),a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{var a=n.slice(0);yu.getContext().decodeAudioData(a,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}}),_u.prototype=Object.assign(Object.create(tu.prototype),{constructor:_u,isHemisphereLightProbe:!0,copy:function(e){return tu.prototype.copy.call(this,e),this},toJSON:function(e){return tu.prototype.toJSON.call(this,e)}}),bu.prototype=Object.assign(Object.create(tu.prototype),{constructor:bu,isAmbientLightProbe:!0,copy:function(e){return tu.prototype.copy.call(this,e),this},toJSON:function(e){return tu.prototype.toJSON.call(this,e)}});var wu=new Xe,Mu=new Xe;function Su(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Un,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Un,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(Su.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),a=t.eyeSep/2,o=a*t.near/t.focus,s=t.near*Math.tan(ie.DEG2RAD*t.fov*.5)/t.zoom;Mu.elements[12]=-a,wu.elements[12]=a,n=-s*t.aspect+o,r=s*t.aspect+o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-o,r=s*t.aspect-o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Mu),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(wu)}});var Tu=function(){function e(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var t=e.prototype;return t.start=function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},t.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},t.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},t.getDelta=function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e},e}(),Eu=new xe,Au=new ye,Cu=new xe,Lu=new xe,Ru=function(e){function t(){var t;return(t=e.call(this)||this).type="AudioListener",t.context=yu.getContext(),t.gain=t.context.createGain(),t.gain.connect(t.context.destination),t.filter=null,t.timeDelta=0,t._clock=new Tu,t}se(t,e);var n=t.prototype;return n.getInput=function(){return this.gain},n.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},n.getFilter=function(){return this.filter},n.setFilter=function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},n.getMasterVolume=function(){return this.gain.gain.value},n.setMasterVolume=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},n.updateMatrixWorld=function(t){e.prototype.updateMatrixWorld.call(this,t);var n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Eu,Au,Cu),Lu.set(0,0,-1).applyQuaternion(Au),n.positionX){var i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Eu.x,i),n.positionY.linearRampToValueAtTime(Eu.y,i),n.positionZ.linearRampToValueAtTime(Eu.z,i),n.forwardX.linearRampToValueAtTime(Lu.x,i),n.forwardY.linearRampToValueAtTime(Lu.y,i),n.forwardZ.linearRampToValueAtTime(Lu.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(Eu.x,Eu.y,Eu.z),n.setOrientation(Lu.x,Lu.y,Lu.z,r.x,r.y,r.z)},t}(yt),Pu=function(e){function t(t){var n;return(n=e.call(this)||this).type="Audio",n.listener=t,n.context=t.context,n.gain=n.context.createGain(),n.gain.connect(t.getInput()),n.autoplay=!1,n.buffer=null,n.detune=0,n.loop=!1,n.loopStart=0,n.loopEnd=0,n.offset=0,n.duration=void 0,n.playbackRate=1,n.isPlaying=!1,n.hasPlaybackControl=!0,n.source=null,n.sourceType="empty",n._startedAt=0,n._progress=0,n._connected=!1,n.filters=[],n}se(t,e);var n=t.prototype;return n.getOutput=function(){return this.gain},n.setNodeSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},n.setMediaElementSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},n.setMediaStreamSource=function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},n.setBuffer=function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},n.play=function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},n.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},n.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},n.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},n.getFilters=function(){return this.filters},n.setFilters=function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this},n.setDetune=function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},n.getDetune=function(){return this.detune},n.getFilter=function(){return this.getFilters()[0]},n.setFilter=function(e){return this.setFilters(e?[e]:[])},n.setPlaybackRate=function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.getPlaybackRate=function(){return this.playbackRate},n.onEnded=function(){this.isPlaying=!1},n.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},n.setLoop=function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},n.setLoopStart=function(e){return this.loopStart=e,this},n.setLoopEnd=function(e){return this.loopEnd=e,this},n.getVolume=function(){return this.gain.gain.value},n.setVolume=function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},t}(yt),Du=new xe,Iu=new ye,Ou=new xe,zu=new xe,ku=function(e){function t(t){var n;return(n=e.call(this,t)||this).panner=n.context.createPanner(),n.panner.panningModel="HRTF",n.panner.connect(n.gain),n}se(t,e);var n=t.prototype;return n.getOutput=function(){return this.panner},n.getRefDistance=function(){return this.panner.refDistance},n.setRefDistance=function(e){return this.panner.refDistance=e,this},n.getRolloffFactor=function(){return this.panner.rolloffFactor},n.setRolloffFactor=function(e){return this.panner.rolloffFactor=e,this},n.getDistanceModel=function(){return this.panner.distanceModel},n.setDistanceModel=function(e){return this.panner.distanceModel=e,this},n.getMaxDistance=function(){return this.panner.maxDistance},n.setMaxDistance=function(e){return this.panner.maxDistance=e,this},n.setDirectionalCone=function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},n.updateMatrixWorld=function(t){if(e.prototype.updateMatrixWorld.call(this,t),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Du,Iu,Ou),zu.set(0,0,1).applyQuaternion(Iu);var n=this.panner;if(n.positionX){var r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Du.x,r),n.positionY.linearRampToValueAtTime(Du.y,r),n.positionZ.linearRampToValueAtTime(Du.z,r),n.orientationX.linearRampToValueAtTime(zu.x,r),n.orientationY.linearRampToValueAtTime(zu.y,r),n.orientationZ.linearRampToValueAtTime(zu.z,r)}else n.setPosition(Du.x,Du.y,Du.z),n.setOrientation(zu.x,zu.y,zu.z)}},t}(Pu),Fu=function(){function e(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}var t=e.prototype;return t.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},t.getAverageFrequency=function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length},e}();function Nu(e,t,n){var r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Nu.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},accumulateAdditive:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var l=t,u=t+t;l!==u;++l)if(n[l]!==n[l+t]){o.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]},_select:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,r){ye.slerpFlat(e,t,e,t,e,n,r)},_slerpAdditive:function(e,t,n,r,i){var a=this._workIndex*i;ye.multiplyQuaternionsFlat(e,a,e,t,e,n),ye.slerpFlat(e,t,e,t,e,a,r)},_lerp:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}},_lerpAdditive:function(e,t,n,r,i){for(var a=0;a!==i;++a){var o=t+a;e[o]=e[o]+e[n+a]*r}}});var Bu=new RegExp("[\\[\\]\\.:\\/]","g"),Uu="[^\\[\\]\\.:\\/]",Gu="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Hu=/((?:WC+[\/:])*)/.source.replace("WC",Uu),ju=/(WCOD+)?/.source.replace("WCOD",Gu),Vu=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Uu),Wu=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Uu),qu=new RegExp("^"+Hu+ju+Vu+Wu+"$"),Xu=["material","materials","bones"];function Yu(e,t,n){var r=n||Zu.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function Zu(e,t,n){this.path=t,this.parsedPath=n||Zu.parseTrackName(t),this.node=Zu.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Ku(){this.uuid=ie.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}Object.assign(Yu.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Zu,{Composite:Yu,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Zu.Composite(e,t,n):new Zu(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Bu,"")},parseTrackName:function(e){var t=qu.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Xu.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var i=n[r];if(i.name===t||i.uuid===t)return i;var a=e(i.children);if(a)return a}return null}(e.children);if(r)return r}return null}}),Object.assign(Zu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=Zu.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[r];if(void 0!==s){var l=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Zu.prototype,{_getValue_unbound:Zu.prototype.getValue,_setValue_unbound:Zu.prototype.setValue}),Object.assign(Ku.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length,o=void 0,s=e.length,l=this.nCachedObjects_,u=0,c=arguments.length;u!==c;++u){var h=arguments[u],d=h.uuid,p=t[d];if(void 0===p){p=s++,t[d]=p,e.push(h);for(var f=0,m=a;f!==m;++f)i[f].push(new Zu(h,n[f],r[f]))}else if(p<l){o=e[p];var v=--l,g=e[v];t[g.uuid]=p,e[p]=g,t[d]=v,e[v]=h;for(var y=0,x=a;y!==x;++y){var _=i[y],b=_[v],w=_[p];_[p]=b,void 0===w&&(w=new Zu(h,n[y],r[y])),_[v]=w}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l},remove:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=t[l];if(void 0!==u&&u>=i){var c=i++,h=e[c];t[h.uuid]=u,e[u]=h,t[l]=c,e[c]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[c],v=f[u];f[u]=m,f[c]=v}}}this.nCachedObjects_=i},uncache:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,i=this.nCachedObjects_,a=e.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],u=l.uuid,c=t[u];if(void 0!==c)if(delete t[u],c<i){var h=--i,d=e[h],p=--a,f=e[p];t[d.uuid]=c,e[c]=d,t[f.uuid]=h,e[h]=f,e.pop();for(var m=0,v=r;m!==v;++m){var g=n[m],y=g[h],x=g[p];g[c]=y,g[h]=x,g.pop()}}else{var _=--a,b=e[_];_>0&&(t[b.uuid]=c),e[c]=b,e.pop();for(var w=0,M=r;w!==M;++w){var S=n[w];S[c]=S[_],S.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var h=u,d=s.length;h!==d;++h){var p=s[h];c[h]=new Zu(p,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}});var Ju=function(){function e(e,t,n,r){this._mixer=e,this._clip=t,this._localRoot=n||null,this.blendMode=r||t.blendMode;for(var i=t.tracks,a=i.length,o=new Array(a),s={endingStart:G,endingEnd:G},l=0;l!==a;++l){var u=i[l].createInterpolant(null);o[l]=u,u.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var t=e.prototype;return t.play=function(){return this._mixer._activateAction(this),this},t.stop=function(){return this._mixer._deactivateAction(this),this.reset()},t.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},t.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},t.isScheduled=function(){return this._mixer._isActiveAction(this)},t.startAt=function(e){return this._startTime=e,this},t.setLoop=function(e,t){return this.loop=e,this.repetitions=t,this},t.setEffectiveWeight=function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},t.getEffectiveWeight=function(){return this._effectiveWeight},t.fadeIn=function(e){return this._scheduleFading(e,0,1)},t.fadeOut=function(e){return this._scheduleFading(e,1,0)},t.crossFadeFrom=function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this},t.crossFadeTo=function(e,t,n){return e.crossFadeFrom(this,t,n)},t.stopFading=function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},t.setEffectiveTimeScale=function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},t.getEffectiveTimeScale=function(){return this._effectiveTimeScale},t.setDuration=function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},t.syncWith=function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},t.halt=function(e){return this.warp(this._effectiveTimeScale,0,e)},t.warp=function(e,t,n){var r=this._mixer,i=r.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/a,l[1]=t/a,this},t.stopWarping=function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},t.getMixer=function(){return this._mixer},t.getClip=function(){return this._clip},t.getRoot=function(){return this._localRoot||this._mixer._root},t._update=function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var l=this._interpolants,u=this._propertyBindings;if(this.blendMode===W)for(var c=0,h=l.length;c!==h;++c)l[c].evaluate(o),u[c].accumulateAdditive(s);else for(var d=0,p=l.length;d!==p;++d)l[d].evaluate(o),u[d].accumulate(r,s)}}else this._updateWeight(e)},t._updateWeight=function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},t._updateTimeScale=function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t},t._updateTime=function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,i=this._loopCount,a=2202===n;if(0===e)return-1===i?r:a&&1==(1&i)?t-r:r;if(2200===n){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1==(1&i))return t-r}return r},t._setEndings=function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=H,r.endingEnd=H):(r.endingStart=e?this.zeroSlopeAtStart?H:G:j,r.endingEnd=t?this.zeroSlopeAtEnd?H:G:j)},t._scheduleFading=function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this},e}();function Qu(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Qu.prototype=Object.assign(Object.create(ee.prototype),{constructor:Qu,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var h=r[c],d=h.name,p=u[d];if(void 0!==p)a[c]=p;else{if(void 0!==(p=a[c])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[c].binding.parsedPath;++(p=new Nu(Zu.create(n,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),a[c]=p}o[c].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,s[u]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Zs(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t,n){var r=t||this._root,i=r.uuid,a="string"==typeof e?al.findByName(r,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],l=null;if(void 0===n&&(n=null!==a?a.blendMode:V),void 0!==s){var u=s.actionByRoot[i];if(void 0!==u&&u.blendMode===n)return u;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;var c=new Ju(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?al.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o)t[o]._update(r,e,i,a);for(var s=this._bindings,l=this._nActiveBindings,u=0;u!==l;++u)s[u].apply(a);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,c._cacheIndex=u,t[u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}});var $u=function(){function e(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}return e.prototype.clone=function(){return new e(void 0===this.value.clone?this.value:this.value.clone())},e}();function ec(e,t,n){aa.call(this,e,t),this.meshPerAttribute=n||1}function tc(e,t,n,r,i){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}function nc(e,t,n,r){this.ray=new qe(e,t),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new it,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function rc(e,t){return e.distance-t.distance}function ic(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)ic(i[a],t,n,!0)}ec.prototype=Object.assign(Object.create(aa.prototype),{constructor:ec,isInstancedInterleavedBuffer:!0,copy:function(e){return aa.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var t=aa.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){var t=aa.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(tc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(tc.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(nc.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return ic(e,this,r,t),r.sort(rc),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=e.length;i<a;i++)ic(e[i],this,r,t);return r.sort(rc),r}});var ac=function(){function e(e,t,n){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),this.radius=e,this.phi=t,this.theta=n,this}var t=e.prototype;return t.set=function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},t.makeSafe=function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},t.setFromVector3=function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},t.setFromCartesianCoords=function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ie.clamp(t/this.radius,-1,1))),this},e}(),oc=function(){function e(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}var t=e.prototype;return t.set=function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},t.setFromVector3=function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},t.setFromCartesianCoords=function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this},e}(),sc=new ce,lc=function(){function e(e,t){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==e?e:new ce(1/0,1/0),this.max=void 0!==t?t:new ce(-1/0,-1/0)}var t=e.prototype;return t.set=function(e,t){return this.min.copy(e),this.max.copy(t),this},t.setFromPoints=function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},t.setFromCenterAndSize=function(e,t){var n=sc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.min.copy(e.min),this.max.copy(e.max),this},t.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},t.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new ce),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},t.getSize=function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new ce),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},t.expandByPoint=function(e){return this.min.min(e),this.max.max(e),this},t.expandByVector=function(e){return this.min.sub(e),this.max.add(e),this},t.expandByScalar=function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},t.containsPoint=function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},t.containsBox=function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},t.getParameter=function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new ce),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},t.intersectsBox=function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},t.clampPoint=function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new ce),t.copy(e).clamp(this.min,this.max)},t.distanceToPoint=function(e){return sc.copy(e).clamp(this.min,this.max).sub(e).length()},t.intersect=function(e){return this.min.max(e.min),this.max.min(e.max),this},t.union=function(e){return this.min.min(e.min),this.max.max(e.max),this},t.translate=function(e){return this.min.add(e),this.max.add(e),this},t.equals=function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},e}(),uc=new xe,cc=new xe,hc=function(){function e(e,t){this.start=void 0!==e?e:new xe,this.end=void 0!==t?t:new xe}var t=e.prototype;return t.set=function(e,t){return this.start.copy(e),this.end.copy(t),this},t.clone=function(){return(new this.constructor).copy(this)},t.copy=function(e){return this.start.copy(e.start),this.end.copy(e.end),this},t.getCenter=function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new xe),e.addVectors(this.start,this.end).multiplyScalar(.5)},t.delta=function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new xe),e.subVectors(this.end,this.start)},t.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.distance=function(){return this.start.distanceTo(this.end)},t.at=function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new xe),this.delta(t).multiplyScalar(e).add(this.start)},t.closestPointToPointParameter=function(e,t){uc.subVectors(e,this.start),cc.subVectors(this.end,this.start);var n=cc.dot(cc),r=cc.dot(uc)/n;return t&&(r=ie.clamp(r,0,1)),r},t.closestPointToPoint=function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new xe),this.delta(n).multiplyScalar(r).add(this.start)},t.applyMatrix4=function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},t.equals=function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},e}();function dc(e){yt.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}dc.prototype=Object.create(yt.prototype),dc.prototype.constructor=dc,dc.prototype.isImmediateRenderObject=!0;var pc=new xe,fc=function(e){function t(t,n){var r;(r=e.call(this)||this).light=t,r.light.updateMatrixWorld(),r.matrix=t.matrixWorld,r.matrixAutoUpdate=!1,r.color=n;for(var i=new pn,a=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],o=0,s=1;o<32;o++,s++){var l=o/32*Math.PI*2,u=s/32*Math.PI*2;a.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new tn(a,3));var c=new Ha({fog:!1,toneMapped:!1});return r.cone=new Ja(i,c),r.add(r.cone),r.update(),r}se(t,e);var n=t.prototype;return n.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},n.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),pc.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(pc),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},t}(yt),mc=new xe,vc=new Xe,gc=new Xe,yc=function(e){function t(t){for(var n,r=xc(t),i=new pn,a=[],o=[],s=new Ut(0,0,1),l=new Ut(0,1,0),u=0;u<r.length;u++){var c=r[u];c.parent&&c.parent.isBone&&(a.push(0,0,0),a.push(0,0,0),o.push(s.r,s.g,s.b),o.push(l.r,l.g,l.b))}i.setAttribute("position",new tn(a,3)),i.setAttribute("color",new tn(o,3));var h=new Ha({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(n=e.call(this,i,h)||this).type="SkeletonHelper",n.isSkeletonHelper=!0,n.root=t,n.bones=r,n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n}return se(t,e),t.prototype.updateMatrixWorld=function(t){var n=this.bones,r=this.geometry,i=r.getAttribute("position");gc.getInverse(this.root.matrixWorld);for(var a=0,o=0;a<n.length;a++){var s=n[a];s.parent&&s.parent.isBone&&(vc.multiplyMatrices(gc,s.matrixWorld),mc.setFromMatrixPosition(vc),i.setXYZ(o,mc.x,mc.y,mc.z),vc.multiplyMatrices(gc,s.parent.matrixWorld),mc.setFromMatrixPosition(vc),i.setXYZ(o+1,mc.x,mc.y,mc.z),o+=2)}r.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,t)},t}(Ja);function xc(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,xc(e.children[n]));return t}var _c=function(e){function t(t,n,r){var i,a=new bs(n,4,2),o=new Vt({wireframe:!0,fog:!1,toneMapped:!1});return(i=e.call(this,a,o)||this).light=t,i.light.updateMatrixWorld(),i.color=r,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}se(t,e);var n=t.prototype;return n.dispose=function(){this.geometry.dispose(),this.material.dispose()},n.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},t}(Pn),bc=new xe,wc=new Ut,Mc=new Ut,Sc=function(e){function t(t,n,r){var i;(i=e.call(this)||this).light=t,i.light.updateMatrixWorld(),i.matrix=t.matrixWorld,i.matrixAutoUpdate=!1,i.color=r;var a=new hs(n);a.rotateY(.5*Math.PI),i.material=new Vt({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var o=a.getAttribute("position"),s=new Float32Array(3*o.count);return a.setAttribute("color",new Xt(s,3)),i.add(new Pn(a,i.material)),i.update(),i}se(t,e);var n=t.prototype;return n.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},n.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");wc.copy(this.light.color),Mc.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?wc:Mc;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(bc.setFromMatrixPosition(this.light.matrixWorld).negate())},t}(yt),Tc=function(e){function t(t,n,r,i){var a;t=t||10,n=n||10,r=new Ut(void 0!==r?r:4473924),i=new Ut(void 0!==i?i:8947848);for(var o=n/2,s=t/n,l=t/2,u=[],c=[],h=0,d=0,p=-l;h<=n;h++,p+=s){u.push(-l,0,p,l,0,p),u.push(p,0,-l,p,0,l);var f=h===o?r:i;f.toArray(c,d),d+=3,f.toArray(c,d),d+=3,f.toArray(c,d),d+=3,f.toArray(c,d),d+=3}var m=new pn;m.setAttribute("position",new tn(u,3)),m.setAttribute("color",new tn(c,3));var v=new Ha({vertexColors:!0,toneMapped:!1});return(a=e.call(this,m,v)||this).type="GridHelper",a}return se(t,e),t}(Ja),Ec=function(e){function t(t,n,r,i,a,o){var s;t=t||10,n=n||16,r=r||8,i=i||64,a=new Ut(void 0!==a?a:4473924),o=new Ut(void 0!==o?o:8947848);for(var l=[],u=[],c=0;c<=n;c++){var h=c/n*(2*Math.PI),d=Math.sin(h)*t,p=Math.cos(h)*t;l.push(0,0,0),l.push(d,0,p);var f=1&c?a:o;u.push(f.r,f.g,f.b),u.push(f.r,f.g,f.b)}for(var m=0;m<=r;m++)for(var v=1&m?a:o,g=t-t/r*m,y=0;y<i;y++){var x=y/i*(2*Math.PI),_=Math.sin(x)*g,b=Math.cos(x)*g;l.push(_,0,b),u.push(v.r,v.g,v.b),x=(y+1)/i*(2*Math.PI),_=Math.sin(x)*g,b=Math.cos(x)*g,l.push(_,0,b),u.push(v.r,v.g,v.b)}var w=new pn;w.setAttribute("position",new tn(l,3)),w.setAttribute("color",new tn(u,3));var M=new Ha({vertexColors:!0,toneMapped:!1});return(s=e.call(this,w,M)||this).type="PolarGridHelper",s}return se(t,e),t}(Ja),Ac=new xe,Cc=new xe,Lc=new xe,Rc=function(e){function t(t,n,r){var i;(i=e.call(this)||this).light=t,i.light.updateMatrixWorld(),i.matrix=t.matrixWorld,i.matrixAutoUpdate=!1,i.color=r,void 0===n&&(n=1);var a=new pn;a.setAttribute("position",new tn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));var o=new Ha({fog:!1,toneMapped:!1});return i.lightPlane=new Ya(a,o),i.add(i.lightPlane),(a=new pn).setAttribute("position",new tn([0,0,0,0,0,1],3)),i.targetLine=new Ya(a,o),i.add(i.targetLine),i.update(),i}se(t,e);var n=t.prototype;return n.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},n.update=function(){Ac.setFromMatrixPosition(this.light.matrixWorld),Cc.setFromMatrixPosition(this.light.target.matrixWorld),Lc.subVectors(Cc,Ac),this.lightPlane.lookAt(Cc),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Cc),this.targetLine.scale.z=Lc.length()},t}(yt),Pc=new xe,Dc=new Bn,Ic=function(e){function t(t){var n,r=new pn,i=new Ha({color:16777215,vertexColors:!0,toneMapped:!1}),a=[],o=[],s={},l=new Ut(16755200),u=new Ut(16711680),c=new Ut(43775),h=new Ut(16777215),d=new Ut(3355443);function p(e,t,n){f(e,n),f(t,n)}function f(e,t){a.push(0,0,0),o.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(a.length/3-1)}return p("n1","n2",l),p("n2","n4",l),p("n4","n3",l),p("n3","n1",l),p("f1","f2",l),p("f2","f4",l),p("f4","f3",l),p("f3","f1",l),p("n1","f1",l),p("n2","f2",l),p("n3","f3",l),p("n4","f4",l),p("p","n1",u),p("p","n2",u),p("p","n3",u),p("p","n4",u),p("u1","u2",c),p("u2","u3",c),p("u3","u1",c),p("c","t",h),p("p","c",d),p("cn1","cn2",d),p("cn3","cn4",d),p("cf1","cf2",d),p("cf3","cf4",d),r.setAttribute("position",new tn(a,3)),r.setAttribute("color",new tn(o,3)),(n=e.call(this,r,i)||this).type="CameraHelper",n.camera=t,n.camera.updateProjectionMatrix&&n.camera.updateProjectionMatrix(),n.matrix=t.matrixWorld,n.matrixAutoUpdate=!1,n.pointMap=s,n.update(),n}return se(t,e),t.prototype.update=function(){var e=this.geometry,t=this.pointMap;Dc.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Oc("c",t,e,Dc,0,0,-1),Oc("t",t,e,Dc,0,0,1),Oc("n1",t,e,Dc,-1,-1,-1),Oc("n2",t,e,Dc,1,-1,-1),Oc("n3",t,e,Dc,-1,1,-1),Oc("n4",t,e,Dc,1,1,-1),Oc("f1",t,e,Dc,-1,-1,1),Oc("f2",t,e,Dc,1,-1,1),Oc("f3",t,e,Dc,-1,1,1),Oc("f4",t,e,Dc,1,1,1),Oc("u1",t,e,Dc,.7,1.1,-1),Oc("u2",t,e,Dc,-.7,1.1,-1),Oc("u3",t,e,Dc,0,2,-1),Oc("cf1",t,e,Dc,-1,0,1),Oc("cf2",t,e,Dc,1,0,1),Oc("cf3",t,e,Dc,0,-1,1),Oc("cf4",t,e,Dc,0,1,1),Oc("cn1",t,e,Dc,-1,0,-1),Oc("cn2",t,e,Dc,1,0,-1),Oc("cn3",t,e,Dc,0,-1,-1),Oc("cn4",t,e,Dc,0,1,-1),e.getAttribute("position").needsUpdate=!0},t}(Ja);function Oc(e,t,n,r,i,a,o){Pc.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var l=n.getAttribute("position"),u=0,c=s.length;u<c;u++)l.setXYZ(s[u],Pc.x,Pc.y,Pc.z)}var zc,kc,Fc,Nc=new we,Bc=function(e){function t(t,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new Float32Array(24),o=new pn;return o.setIndex(new Xt(i,1)),o.setAttribute("position",new Xt(a,3)),(r=e.call(this,o,new Ha({color:n,toneMapped:!1}))||this).object=t,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}se(t,e);var n=t.prototype;return n.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Nc.setFromObject(this.object),!Nc.isEmpty()){var t=Nc.min,n=Nc.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},n.setFromObject=function(e){return this.object=e,this.update(),this},n.copy=function(e){return Ja.prototype.copy.call(this,e),this.object=e.object,this},t}(Ja),Uc=function(e){function t(t,n){var r;void 0===n&&(n=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),a=new pn;return a.setIndex(new Xt(i,1)),a.setAttribute("position",new tn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(r=e.call(this,a,new Ha({color:n,toneMapped:!1}))||this).box=t,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return se(t,e),t.prototype.updateMatrixWorld=function(t){var n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,t))},t}(Ja),Gc=function(e){function t(t,n,r){var i,a=void 0!==r?r:16776960,o=new pn;o.setAttribute("position",new tn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),(i=e.call(this,o,new Ha({color:a,toneMapped:!1}))||this).type="PlaneHelper",i.plane=t,i.size=void 0===n?1:n;var s=new pn;return s.setAttribute("position",new tn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),s.computeBoundingSphere(),i.add(new Pn(s,new Vt({color:a,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),i}return se(t,e),t.prototype.updateMatrixWorld=function(t){var n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?1:0,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,t)},t}(Ya),Hc=new xe,jc=function(e){function t(t,n,r,i,a,o){var s;return(s=e.call(this)||this).type="ArrowHelper",void 0===t&&(t=new xe(0,0,1)),void 0===n&&(n=new xe(0,0,0)),void 0===r&&(r=1),void 0===i&&(i=16776960),void 0===a&&(a=.2*r),void 0===o&&(o=.2*a),void 0===zc&&((zc=new pn).setAttribute("position",new tn([0,0,0,0,1,0],3)),(kc=new xo(0,.5,1,5,1)).translate(0,-.5,0)),s.position.copy(n),s.line=new Ya(zc,new Ha({color:i,toneMapped:!1})),s.line.matrixAutoUpdate=!1,s.add(s.line),s.cone=new Pn(kc,new Vt({color:i,toneMapped:!1})),s.cone.matrixAutoUpdate=!1,s.add(s.cone),s.setDirection(t),s.setLength(r,a,o),s}se(t,e);var n=t.prototype;return n.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Hc.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Hc,t)}},n.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},n.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},n.copy=function(t){return e.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},t}(yt),Vc=function(e){function t(t){var n;void 0===t&&(t=1);var r=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=new pn;i.setAttribute("position",new tn(r,3)),i.setAttribute("color",new tn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var a=new Ha({vertexColors:!0,toneMapped:!1});return(n=e.call(this,i,a)||this).type="AxesHelper",n}return se(t,e),t}(Ja),Wc=Math.pow(2,8),qc=[.125,.215,.35,.446,.526,.582],Xc=5+qc.length,Yc=((Fc={})[3e3]=0,Fc[3001]=1,Fc[3002]=2,Fc[3004]=3,Fc[3005]=4,Fc[3006]=5,Fc[3007]=6,Fc),Zc=new Zl,Kc=oh(),Jc=Kc._lodPlanes,Qc=Kc._sizeLods,$c=Kc._sigmas,eh=null,th=(1+Math.sqrt(5))/2,nh=1/th,rh=[new xe(1,1,1),new xe(-1,1,1),new xe(1,1,-1),new xe(-1,1,-1),new xe(0,th,nh),new xe(0,th,-nh),new xe(nh,0,th),new xe(-nh,0,th),new xe(th,nh,0),new xe(-th,nh,0)],ih=function(){function e(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=(20,new ks({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(20)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new xe(0,1,0)},inputEncoding:{value:Yc[3e3]},outputEncoding:{value:Yc[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var t=e.prototype;return t.fromScene=function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=.1),void 0===r&&(r=100),eh=this._renderer.getRenderTarget();var i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i},t.fromEquirectangular=function(e){return this._fromTexture(e)},t.fromCubemap=function(e){return this._fromTexture(e)},t.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=ch(),this._compileMaterial(this._cubemapShader))},t.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=uh(),this._compileMaterial(this._equirectShader))},t.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Jc.length;e++)Jc[e].dispose()},t._cleanup=function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(eh),e.scissorTest=!1,lh(e,0,0,e.width,e.height)},t._fromTexture=function(e){eh=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},t._allocateTargets=function(e){var t={magFilter:p,minFilter:p,generateMipmaps:!1,type:y,format:1023,encoding:ah(e)?e.encoding:Z,depthBuffer:!1},n=sh(t);return n.depthBuffer=!e,this._pingPongRenderTarget=sh(t),n},t._compileMaterial=function(e){var t=new Pn(Jc[0],e);this._renderer.compile(t,Zc)},t._sceneToCubeUV=function(e,t,n,r){var i=new Un(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.outputEncoding,u=s.toneMapping,c=s.getClearColor(),h=s.getClearAlpha();s.toneMapping=0,s.outputEncoding=q;var d=e.background;if(d&&d.isColor){d.convertSRGBToLinear();var p=Math.max(d.r,d.g,d.b),f=Math.min(Math.max(Math.ceil(Math.log2(p)),-128),127);d=d.multiplyScalar(Math.pow(2,-f));var m=(f+128)/255;s.setClearColor(d,m),e.background=null}for(var v=0;v<6;v++){var g=v%3;0==g?(i.up.set(0,a[v],0),i.lookAt(o[v],0,0)):1==g?(i.up.set(0,0,a[v]),i.lookAt(0,o[v],0)):(i.up.set(0,a[v],0),i.lookAt(0,0,o[v])),lh(r,g*Wc,v>2?Wc:0,Wc,Wc),s.setRenderTarget(r),s.render(e,i)}s.toneMapping=u,s.outputEncoding=l,s.setClearColor(c,h)},t._textureToCubeUV=function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=ch()):null==this._equirectShader&&(this._equirectShader=uh());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new Pn(Jc[0],r),a=r.uniforms;a.envMap.value=e,e.isCubeTexture||a.texelSize.value.set(1/e.image.width,1/e.image.height),a.inputEncoding.value=Yc[e.encoding],a.outputEncoding.value=Yc[t.texture.encoding],lh(t,0,0,3*Wc,2*Wc),n.setRenderTarget(t),n.render(i,Zc)},t._applyPMREM=function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<Xc;r++){var i=Math.sqrt($c[r]*$c[r]-$c[r-1]*$c[r-1]),a=rh[(r-1)%rh.length];this._blur(e,r-1,r,i,a)}t.autoClear=n},t._blur=function(e,t,n,r,i){var a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)},t._halfBlur=function(e,t,n,r,i,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new Pn(Jc[r],l),c=l.uniforms,h=Qc[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,p=i/d,f=isFinite(i)?1+Math.floor(3*p):20;f>20&&console.warn("sigmaRadians, "+i+", is too large and will clip, as it requested "+f+" samples when the maximum is set to 20");for(var m=[],v=0,g=0;g<20;++g){var y=g/p,x=Math.exp(-y*y/2);m.push(x),0==g?v+=x:g<f&&(v+=2*x)}for(var _=0;_<m.length;_++)m[_]=m[_]/v;c.envMap.value=e.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=d,c.mipInt.value=8-n,c.inputEncoding.value=Yc[e.texture.encoding],c.outputEncoding.value=Yc[e.texture.encoding];var b=Qc[r];lh(t,3*Math.max(0,Wc-2*b),(0===r?0:2*Wc)+2*b*(r>4?r-8+4:0),3*b,2*b),s.setRenderTarget(t),s.render(u,Zc)},e}();function ah(e){return void 0!==e&&e.type===y&&(e.encoding===q||e.encoding===X||e.encoding===Y)}function oh(){for(var e=[],t=[],n=[],r=8,i=0;i<Xc;i++){var a=Math.pow(2,r);t.push(a);var o=1/a;i>4?o=qc[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),l=-s/2,u=1+s/2,c=[l,l,u,l,u,u,l,l,u,u,l,u],h=new Float32Array(108),d=new Float32Array(72),p=new Float32Array(36),f=0;f<6;f++){var m=f%3*2/3-1,v=f>2?0:-1,g=[m,v,0,m+2/3,v,0,m+2/3,v+1,0,m,v,0,m+2/3,v+1,0,m,v+1,0];h.set(g,18*f),d.set(c,12*f);var y=[f,f,f,f,f,f];p.set(y,6*f)}var x=new pn;x.setAttribute("position",new Xt(h,3)),x.setAttribute("uv",new Xt(d,2)),x.setAttribute("faceIndex",new Xt(p,1)),e.push(x),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function sh(e){var t=new ve(3*Wc,3*Wc,e);return t.texture.mapping=l,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function lh(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function uh(){return new ks({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new ce(1,1)},inputEncoding:{value:Yc[3e3]},outputEncoding:{value:Yc[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function ch(){return new ks({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Yc[3e3]},outputEncoding:{value:Yc[3e3]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function hh(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Al.call(this,e),this.type="catmullrom",this.closed=!0}function dh(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Al.call(this,e),this.type="catmullrom"}function ph(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Al.call(this,e),this.type="catmullrom"}xl.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(xl.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Bl.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new mo,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new xe(i.x,i.y,i.z||0))}return t}}),Object.assign(Ul.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),hh.prototype=Object.create(Al.prototype),dh.prototype=Object.create(Al.prototype),ph.prototype=Object.create(Al.prototype),Object.assign(ph.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Tc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},yc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(cl.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ru.extractUrlBase(e)}}),cl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(lc.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(we.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Ne.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Yn.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},hc.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(ie,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ie.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ie.ceilPowerOfTwo(e)}}),Object.assign(he.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Xe.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new xe).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)}}),wt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},ye.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(qe.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(It.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(It,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),It.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),It.getNormal(e,t,n,r)}}),Object.assign(Gl.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new os(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new _s(this,e)}}),Object.assign(ce.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xe.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(me.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(mo.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(yt.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(yt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Pn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Pn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Pa.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(za.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Da.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(xl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Un.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Hl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Xt.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Q},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Q)}}}),Object.assign(Xt.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Q:J),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(pn.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Xt(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(pn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(iu.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(nc.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(aa.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Q},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(aa.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Q:J),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(is.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(ia.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties($u.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(jt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ut}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Bs.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Ns.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Nn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(ea.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(ea.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?X:q}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Wi.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ve.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Pu.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new xu).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Fu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Hn.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Hn.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)};var fh={merge:function(e,t,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};de.crossOrigin=void 0,de.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new yl;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},de.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new vl;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},de.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},de.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var mh={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"122"}})),e.ACESFilmicToneMapping=4,e.AddEquation=t,e.AddOperation=2,e.AdditiveAnimationBlendMode=W,e.AdditiveBlending=2,e.AlphaFormat=1021,e.AlwaysDepth=1,e.AlwaysStencilFunc=519,e.AmbientLight=Ql,e.AmbientLightProbe=bu,e.AnimationClip=al,e.AnimationLoader=pl,e.AnimationMixer=Qu,e.AnimationObjectGroup=Ku,e.AnimationUtils=qs,e.ArcCurve=bl,e.ArrayCamera=Zi,e.ArrowHelper=jc,e.Audio=Pu,e.AudioAnalyser=Fu,e.AudioContext=yu,e.AudioListener=Ru,e.AudioLoader=xu,e.AxesHelper=Vc,e.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Vc(e)},e.BackSide=1,e.BasicDepthPacking=3200,e.BasicShadowMap=0,e.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new gl(e)},e.Bone=ka,e.BooleanKeyframeTrack=Qs,e.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Bc(e,t)},e.Box2=lc,e.Box3=we,e.Box3Helper=Uc,e.BoxBufferGeometry=On,e.BoxGeometry=vo,e.BoxHelper=Bc,e.BufferAttribute=Xt,e.BufferGeometry=pn,e.BufferGeometryLoader=ou,e.ByteType=1010,e.Cache=sl,e.Camera=Bn,e.CameraHelper=Ic,e.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},e.CanvasTexture=lo,e.CatmullRomCurve3=Al,e.CineonToneMapping=3,e.CircleBufferGeometry=go,e.CircleGeometry=yo,e.ClampToEdgeWrapping=h,e.Clock=Tu,e.ClosedSplineCurve3=hh,e.Color=Ut,e.ColorKeyframeTrack=$s,e.CompressedTexture=so,e.CompressedTextureLoader=fl,e.ConeBufferGeometry=wo,e.ConeGeometry=bo,e.CubeCamera=Hn,e.CubeGeometry=vo,e.CubeReflectionMapping=r,e.CubeRefractionMapping=i,e.CubeTexture=jn,e.CubeTextureLoader=vl,e.CubeUVReflectionMapping=l,e.CubeUVRefractionMapping=u,e.CubicBezierCurve=Pl,e.CubicBezierCurve3=Dl,e.CubicInterpolant=Ys,e.CullFaceBack=1,e.CullFaceFront=2,e.CullFaceFrontBack=3,e.CullFaceNone=0,e.Curve=xl,e.CurvePath=Bl,e.CustomBlending=5,e.CustomToneMapping=5,e.CylinderBufferGeometry=xo,e.CylinderGeometry=_o,e.Cylindrical=oc,e.DataTexture=Wn,e.DataTexture2DArray=mr,e.DataTexture3D=vr,e.DataTextureLoader=gl,e.DecrementStencilOp=7683,e.DecrementWrapStencilOp=34056,e.DefaultLoadingManager=ul,e.DepthFormat=E,e.DepthStencilFormat=A,e.DepthTexture=uo,e.DirectionalLight=Jl,e.DirectionalLightHelper=Rc,e.DiscreteInterpolant=Ks,e.DodecahedronBufferGeometry=So,e.DodecahedronGeometry=To,e.DoubleSide=2,e.DstAlphaFactor=206,e.DstColorFactor=208,e.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Xt(e,t).setUsage(Q)},e.DynamicCopyUsage=35050,e.DynamicDrawUsage=Q,e.DynamicReadUsage=35049,e.EdgesGeometry=Ro,e.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ja(new Ro(e.geometry),new Ha({color:void 0!==t?t:16777215}))},e.EllipseCurve=_l,e.EqualDepth=4,e.EqualStencilFunc=514,e.EquirectangularReflectionMapping=o,e.EquirectangularRefractionMapping=s,e.Euler=tt,e.EventDispatcher=ee,e.ExtrudeBufferGeometry=is,e.ExtrudeGeometry=os,e.Face3=Gt,e.Face4=function(e,t,n,r,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Gt(e,t,n,i,a,o)},e.FaceColors=1,e.FileLoader=dl,e.FlatShading=1,e.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new tn(e,t)},e.Float32BufferAttribute=tn,e.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new nn(e,t)},e.Float64BufferAttribute=nn,e.FloatType=b,e.Fog=ra,e.FogExp2=na,e.Font=mu,e.FontLoader=gu,e.FrontSide=0,e.Frustum=Yn,e.GLBufferAttribute=tc,e.GLSL1="100",e.GLSL3=$,e.GammaEncoding=Y,e.Geometry=mo,e.GeometryUtils=fh,e.GreaterDepth=6,e.GreaterEqualDepth=5,e.GreaterEqualStencilFunc=518,e.GreaterStencilFunc=516,e.GridHelper=Tc,e.Group=Ki,e.HalfFloatType=w,e.HemisphereLight=jl,e.HemisphereLightHelper=Sc,e.HemisphereLightProbe=_u,e.IcosahedronBufferGeometry=ss,e.IcosahedronGeometry=ls,e.ImageBitmapLoader=pu,e.ImageLoader=ml,e.ImageUtils=de,e.ImmediateRenderObject=dc,e.IncrementStencilOp=7682,e.IncrementWrapStencilOp=34055,e.InstancedBufferAttribute=au,e.InstancedBufferGeometry=iu,e.InstancedInterleavedBuffer=ec,e.InstancedMesh=Ga,e.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Jt(e,t)},e.Int16BufferAttribute=Jt,e.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new $t(e,t)},e.Int32BufferAttribute=$t,e.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Yt(e,t)},e.Int8BufferAttribute=Yt,e.IntType=1013,e.InterleavedBuffer=aa,e.InterleavedBufferAttribute=la,e.Interpolant=Xs,e.InterpolateDiscrete=N,e.InterpolateLinear=B,e.InterpolateSmooth=U,e.InvertStencilOp=5386,e.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},e.KeepStencilOp=K,e.KeyframeTrack=Js,e.LOD=Pa,e.LatheBufferGeometry=us,e.LatheGeometry=cs,e.Layers=it,e.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},e.LessDepth=2,e.LessEqualDepth=3,e.LessEqualStencilFunc=515,e.LessStencilFunc=513,e.Light=Hl,e.LightProbe=tu,e.Line=Ya,e.Line3=hc,e.LineBasicMaterial=Ha,e.LineCurve=Il,e.LineCurve3=Ol,e.LineDashedMaterial=Vs,e.LineLoop=Qa,e.LinePieces=1,e.LineSegments=Ja,e.LineStrip=0,e.LinearEncoding=q,e.LinearFilter=v,e.LinearInterpolant=Zs,e.LinearMipMapLinearFilter=1008,e.LinearMipMapNearestFilter=1007,e.LinearMipmapLinearFilter=g,e.LinearMipmapNearestFilter=1007,e.LinearToneMapping=1,e.Loader=cl,e.LoaderUtils=ru,e.LoadingManager=ll,e.LogLuvEncoding=3003,e.LoopOnce=2200,e.LoopPingPong=2202,e.LoopRepeat=2201,e.LuminanceAlphaFormat=1025,e.LuminanceFormat=1024,e.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},e.Material=jt,e.MaterialLoader=nu,e.Math=ie,e.MathUtils=ie,e.Matrix3=he,e.Matrix4=Xe,e.MaxEquation=104,e.Mesh=Pn,e.MeshBasicMaterial=Vt,e.MeshDepthMaterial=ji,e.MeshDistanceMaterial=Vi,e.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},e.MeshLambertMaterial=Hs,e.MeshMatcapMaterial=js,e.MeshNormalMaterial=Gs,e.MeshPhongMaterial=Bs,e.MeshPhysicalMaterial=Ns,e.MeshStandardMaterial=Fs,e.MeshToonMaterial=Us,e.MinEquation=103,e.MirroredRepeatWrapping=d,e.MixOperation=1,e.MultiMaterial=function(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},e.MultiplyBlending=4,e.MultiplyOperation=0,e.NearestFilter=p,e.NearestMipMapLinearFilter=1005,e.NearestMipMapNearestFilter=1004,e.NearestMipmapLinearFilter=m,e.NearestMipmapNearestFilter=f,e.NeverDepth=0,e.NeverStencilFunc=512,e.NoBlending=0,e.NoColors=0,e.NoToneMapping=0,e.NormalAnimationBlendMode=V,e.NormalBlending=1,e.NotEqualDepth=7,e.NotEqualStencilFunc=517,e.NumberKeyframeTrack=el,e.Object3D=yt,e.ObjectLoader=uu,e.ObjectSpaceNormalMap=1,e.OctahedronBufferGeometry=hs,e.OctahedronGeometry=ds,e.OneFactor=201,e.OneMinusDstAlphaFactor=207,e.OneMinusDstColorFactor=209,e.OneMinusSrcAlphaFactor=205,e.OneMinusSrcColorFactor=203,e.OrthographicCamera=Zl,e.PCFShadowMap=1,e.PCFSoftShadowMap=2,e.PMREMGenerator=ih,e.ParametricBufferGeometry=ps,e.ParametricGeometry=fs,e.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new wa(e)},e.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new $a(e)},e.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new io(e,t)},e.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new $a(e)},e.Path=Ul,e.PerspectiveCamera=Un,e.Plane=wt,e.PlaneBufferGeometry=Jn,e.PlaneGeometry=ms,e.PlaneHelper=Gc,e.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new io(e,t)},e.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new $a(e)},e.PointLight=Yl,e.PointLightHelper=_c,e.Points=io,e.PointsMaterial=$a,e.PolarGridHelper=Ec,e.PolyhedronBufferGeometry=Mo,e.PolyhedronGeometry=vs,e.PositionalAudio=ku,e.PropertyBinding=Zu,e.PropertyMixer=Nu,e.QuadraticBezierCurve=zl,e.QuadraticBezierCurve3=kl,e.Quaternion=ye,e.QuaternionKeyframeTrack=nl,e.QuaternionLinearInterpolant=tl,e.REVISION="122",e.RGBADepthPacking=3201,e.RGBAFormat=T,e.RGBAIntegerFormat=1033,e.RGBA_ASTC_10x10_Format=37819,e.RGBA_ASTC_10x5_Format=37816,e.RGBA_ASTC_10x6_Format=37817,e.RGBA_ASTC_10x8_Format=37818,e.RGBA_ASTC_12x10_Format=37820,e.RGBA_ASTC_12x12_Format=37821,e.RGBA_ASTC_4x4_Format=37808,e.RGBA_ASTC_5x4_Format=37809,e.RGBA_ASTC_5x5_Format=37810,e.RGBA_ASTC_6x5_Format=37811,e.RGBA_ASTC_6x6_Format=37812,e.RGBA_ASTC_8x5_Format=37813,e.RGBA_ASTC_8x6_Format=37814,e.RGBA_ASTC_8x8_Format=37815,e.RGBA_BPTC_Format=36492,e.RGBA_ETC2_EAC_Format=F,e.RGBA_PVRTC_2BPPV1_Format=z,e.RGBA_PVRTC_4BPPV1_Format=O,e.RGBA_S3TC_DXT1_Format=L,e.RGBA_S3TC_DXT3_Format=R,e.RGBA_S3TC_DXT5_Format=P,e.RGBDEncoding=3006,e.RGBEEncoding=Z,e.RGBEFormat=1023,e.RGBFormat=S,e.RGBIntegerFormat=1032,e.RGBM16Encoding=3005,e.RGBM7Encoding=3004,e.RGB_ETC1_Format=36196,e.RGB_ETC2_Format=k,e.RGB_PVRTC_2BPPV1_Format=I,e.RGB_PVRTC_4BPPV1_Format=D,e.RGB_S3TC_DXT1_Format=C,e.RGFormat=1030,e.RGIntegerFormat=1031,e.RawShaderMaterial=ks,e.Ray=qe,e.Raycaster=nc,e.RectAreaLight=$l,e.RedFormat=1028,e.RedIntegerFormat=1029,e.ReinhardToneMapping=2,e.RepeatWrapping=c,e.ReplaceStencilOp=7681,e.ReverseSubtractEquation=102,e.RingBufferGeometry=gs,e.RingGeometry=ys,e.SRGB8_ALPHA8_ASTC_10x10_Format=37851,e.SRGB8_ALPHA8_ASTC_10x5_Format=37848,e.SRGB8_ALPHA8_ASTC_10x6_Format=37849,e.SRGB8_ALPHA8_ASTC_10x8_Format=37850,e.SRGB8_ALPHA8_ASTC_12x10_Format=37852,e.SRGB8_ALPHA8_ASTC_12x12_Format=37853,e.SRGB8_ALPHA8_ASTC_4x4_Format=37840,e.SRGB8_ALPHA8_ASTC_5x4_Format=37841,e.SRGB8_ALPHA8_ASTC_5x5_Format=37842,e.SRGB8_ALPHA8_ASTC_6x5_Format=37843,e.SRGB8_ALPHA8_ASTC_6x6_Format=37844,e.SRGB8_ALPHA8_ASTC_8x5_Format=37845,e.SRGB8_ALPHA8_ASTC_8x6_Format=37846,e.SRGB8_ALPHA8_ASTC_8x8_Format=37847,e.Scene=ia,e.SceneUtils=mh,e.ShaderChunk=Qn,e.ShaderLib=er,e.ShaderMaterial=Nn,e.ShadowMaterial=zs,e.Shape=Gl,e.ShapeBufferGeometry=xs,e.ShapeGeometry=_s,e.ShapePath=fu,e.ShapeUtils=ts,e.ShortType=1011,e.Skeleton=za,e.SkeletonHelper=yc,e.SkinnedMesh=Da,e.SmoothShading=2,e.Sphere=Ne,e.SphereBufferGeometry=bs,e.SphereGeometry=ws,e.Spherical=ac,e.SphericalHarmonics3=eu,e.Spline=ph,e.SplineCurve=Fl,e.SplineCurve3=dh,e.SpotLight=ql,e.SpotLightHelper=fc,e.Sprite=wa,e.SpriteMaterial=ua,e.SrcAlphaFactor=204,e.SrcAlphaSaturateFactor=210,e.SrcColorFactor=202,e.StaticCopyUsage=35046,e.StaticDrawUsage=J,e.StaticReadUsage=35045,e.StereoCamera=Su,e.StreamCopyUsage=35042,e.StreamDrawUsage=35040,e.StreamReadUsage=35041,e.StringKeyframeTrack=rl,e.SubtractEquation=101,e.SubtractiveBlending=3,e.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},e.TangentSpaceNormalMap=0,e.TetrahedronBufferGeometry=Ms,e.TetrahedronGeometry=Ss,e.TextBufferGeometry=Ts,e.TextGeometry=Es,e.Texture=fe,e.TextureLoader=yl,e.TorusBufferGeometry=As,e.TorusGeometry=Cs,e.TorusKnotBufferGeometry=Ls,e.TorusKnotGeometry=Rs,e.Triangle=It,e.TriangleFanDrawMode=2,e.TriangleStripDrawMode=1,e.TrianglesDrawMode=0,e.TubeBufferGeometry=Ps,e.TubeGeometry=Ds,e.UVMapping=n,e.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Qt(e,t)},e.Uint16BufferAttribute=Qt,e.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new en(e,t)},e.Uint32BufferAttribute=en,e.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Zt(e,t)},e.Uint8BufferAttribute=Zt,e.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Kt(e,t)},e.Uint8ClampedBufferAttribute=Kt,e.Uniform=$u,e.UniformsLib=$n,e.UniformsUtils=Fn,e.UnsignedByteType=y,e.UnsignedInt248Type=M,e.UnsignedIntType=_,e.UnsignedShort4444Type=1017,e.UnsignedShort5551Type=1018,e.UnsignedShort565Type=1019,e.UnsignedShortType=x,e.VSMShadowMap=3,e.Vector2=ce,e.Vector3=xe,e.Vector4=me,e.VectorKeyframeTrack=il,e.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new xe(e,t,n)},e.VertexColors=2,e.VideoTexture=oo,e.WebGL1Renderer=ta,e.WebGLCubeRenderTarget=Vn,e.WebGLMultisampleRenderTarget=ge,e.WebGLRenderTarget=ve,e.WebGLRenderTargetCube=function(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Vn(e,n)},e.WebGLRenderer=ea,e.WebGLUtils=Yi,e.WireframeGeometry=Is,e.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ja(new Is(e.geometry),new Ha({color:void 0!==t?t:16777215}))},e.WrapAroundEnding=j,e.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new dl(e)},e.ZeroCurvatureEnding=G,e.ZeroFactor=200,e.ZeroSlopeEnding=H,e.ZeroStencilOp=0,e.sRGBEncoding=X,Object.defineProperty(e,"__esModule",{value:!0})},"object"===("undefined"==typeof n?"undefined":(0,a.default)(n))&&"undefined"!=typeof t?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i((r="undefined"!=typeof globalThis?globalThis:r||self).THREE={})},{"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/typeof":17}],60:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/createClass")),a=r(e("@babel/runtime/helpers/classCallCheck")),o=r(e("@babel/runtime/helpers/defineProperty")),s=(e("./AudioItem").default,e("../core/properties")),l=e("../utils/math"),u=e("min-signal"),c=(0,i.default)((function e(){var t=this;(0,a.default)(this,e),(0,o.default)(this,"fadeToVolume",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t._volumeFrom=t.volume,t.targetVolume=e,t._volumeTime=0,t._volumeDuration=n,0===n&&(t.volume=t.targetVolume,t.onFadeCompleted.dispatch(t.volume))})),(0,o.default)(this,"add",(function(e){t.children.push(e)})),(0,o.default)(this,"addSingle",(function(e){t.children.push(e),t._isSingle=!0,t.onFadeCompleted.add((function(t){0===t&&e.stop()}))})),(0,o.default)(this,"playSingle",(function(){t.children[0].play()})),(0,o.default)(this,"stopSingle",(function(){t.children[0].stop()})),(0,o.default)(this,"stop",(function(){t.children.forEach((function(e){return e.stop()}))})),(0,o.default)(this,"setFinalVolume",(function(e){t.volume!==t.targetVolume&&(t._volumeDuration?(t._volumeTime=Math.min(t._volumeDuration,t._volumeTime+s.deltaTime),t.volume=l.mix(t._volumeFrom,t.targetVolume,t._volumeTime/t._volumeDuration)):t.volume=t.targetVolume,t.volume==t.targetVolume&&t.onFadeCompleted.dispatch(t.volume)),e*=t.volume,t.children.forEach((function(t){t.setFinalVolume(e)}))})),this.children=[],this.volume=1,this.targetVolume=1,this._volumeFrom=0,this._volumeDuration=0,this._volumeTime=0,this._isSingle=!1,this._isVideo=!1,this.onFadeCompleted=new u}));n.default=c},{"../core/properties":68,"../utils/math":115,"./AudioItem":61,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/defineProperty":6,"@babel/runtime/helpers/interopRequireDefault":10,"min-signal":23}],61:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("three"),l=e("../core/properties"),u=e("../core/settings"),c=e("min-signal"),h=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.preload,h=void 0===a||a,d=r.isPositional,p=void 0!==d&&d,f=r.autoplay,m=void 0!==f&&f,v=r.loop,g=void 0!==v&&v,y=r.isMutable,x=void 0!==y&&y,_=r.fileSize,b=void 0===_?100:_,w=r.elem,M=void 0===w?null:w;(0,i.default)(this,e),(0,o.default)(this,"load",(function(e){if(n.elem)n.elem.src=n.url;else{var t=n.preload?"add":"load";l.loader[t](n.url,{weight:n.fileSize,type:"xhr",responseType:"arraybuffer",hasLoading:!0,onLoad:function(t){n._buffer=t,n.hasInitialized&&n._decodeAudioData(),e&&e()}})}})),(0,o.default)(this,"init",(function(e){n.hasInitialized||(n.hasInitialized=!0,n.audioObject=n.isPositional?new s.PositionalAudio(e):new s.Audio(e),n.positionObjectParent&&n.positionObjectParent.add(n.audioObject),n._orginalOnEnd=n.audioObject.onEnded.bind(n.audioObject),n.audioObject.onEnded=n.onEnd.bind(n),n.isPositional&&n.setRefDistance(n.refDistance),n.elem?(n.elem.loop=n.loop,n.audioObject.setMediaElementSource(n.elem),n.elem.addEventListener("ended",n.onEnd.bind(n)),n.autoplay&&n.play()):(n.audioObject.setLoop(n.loop),n._buffer&&n._decodeAudioData()))})),(0,o.default)(this,"onEnd",(function(){n._orginalOnEnd&&n._orginalOnEnd(),n.onEnded.dispatch()})),(0,o.default)(this,"setFinalVolume",(function(e){var t;null===(t=n.audioObject)||void 0===t||t.setVolume(e*n.volume)})),(0,o.default)(this,"_decodeAudioData",(function(){var e=n._buffer.slice(0);s.AudioContext.getContext().decodeAudioData(e,(function(e){n.audioObject.setBuffer(e),n.autoplay&&n.play()}))})),(0,o.default)(this,"setRefDistance",(function(e){n.refDistance=e,n.isPositional&&n.audioObject&&n.audioObject.setRefDistance(n.refDistance)})),(0,o.default)(this,"play",(function(){n.autoplay=!0,n.audioObject&&!n.audioObject.isPlaying&&(n.elem?(n.elem.play(),n.elem.currentTime=.01,n.audioObject.isPlaying=!0):n.audioObject.play(),n.onPlayed.dispatch())})),(0,o.default)(this,"stop",(function(){n.autoplay=!1,n.audioObject&&n.audioObject.isPlaying&&(n.elem?(n.elem.pause(),n.audioObject.isPlaying=!1):n.audioObject.stop(),n.onEnded.dispatch())})),this.url=u.AUDIO_PATH+t,this.preload=h,this.isPositional=!!p,this.positionObjectParent=null,this.autoplay=m,this.loop=g,this.isMutable=x,this.elem=M,this.audioObject=null,this.hasInitialized=!1,this.volume=1,this.fileSize=b,this.refDistance=1,this._buffer=null,this._orginalOnEnd=null,this.onPlayed=new c,this.onEnded=new c}return(0,a.default)(e,[{key:"setPositionObjectParent",value:function(e){this.hasInitialized?e?e.add(this.audioObject):this.audioObject.parent&&this.audioObject.parent.remove(this.audioObject):this.positionObjectParent=e}}]),e}();n.default=h},{"../core/properties":68,"../core/settings":69,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/defineProperty":6,"@babel/runtime/helpers/interopRequireDefault":10,"min-signal":23,three:59}],62:[function(e,t,n){"use strict";var r=e("../core/properties"),i=e("../utils/math"),a=e("../input/input"),o=e("./AudioGroup").default,s=e("./AudioItem").default,l=e("../scenes/scenes"),u=e("three"),c=e("min-signal");n.preInit=function(){for(var e=0;e<T.length;e++){var t=T[e],r=n.groups[t]=new o;n.master.add(r)}n.groups.bush=new o("bush"),n.groups.scene.add(n.groups.bush),window.addEventListener("blur",E),window.addEventListener("focus",A),a.onDowned.add(L),(p=document.getElementById("audio-btn")).addEventListener("click",D),p.style.pointerEvents="auto",R("bgm","ui",!1,!0,!1,!0),R("river","scene",!0,!0),R("forest","scene",!0,!0),R("tap0","ui",!0),R("tap1","ui",!0),R("hover0","ui",!0),R("hover1","ui",!0),R("flip0","ui",!0),R("flip1","ui",!0),R("flip2","ui",!0),R("wolf","ui",!0),R("spring","ui",!0),R("frog","ui",!0),R("splash0","scene",!0,!1,!0),R("splash1","scene",!0,!1,!0),R("bush0","bush",!0,!1,!0),R("bush1","bush",!0,!1,!0);for(var i=l.getAllAudioIds(),s=0;s<i.length;s++)R(i[s],"dialog",!0)},n.init=function(){O((function(e){for(var t in x)x[t].init(e)})),x.bgm.play(),window.sss=x.bgm,p.addEventListener("mouseenter",C),p.addEventListener("mouseleave",C)},n.play=P,n.playSceneBase=function(e){var t=x[e];t!==d&&(d&&d.stop(),(d=t).muted=!1,d.play())},n.playTap=function(){return P("tap"+ ++_%2)},n.playHover=C,n.playFlip=function(){return P("flip"+ ++w%3)},n.playSplash=function(){return P("splash"+ ++M%2)},n.playBush=function(){return P("bush"+ ++S%2)},n.enable=I,n.getListener=O,n.update=z,n.master=new o,n.groups={},n.uiGroup=new o,n.dialogGroup=new o,n.sceneGroup=new o;var h,d,p,f=0,m=!1,v=!0,g=!1,y=new c,x=n.audioItems={},_=0,b=0,w=0,M=0,S=0,T=["ui","dialog","scene"];function E(){v=!1,z(0),g=!0}function A(){f=0,v=!0,z(1),g=!1}function C(){return P("hover"+ ++b%2)}function L(e){a.onDowned.remove(L),h=new u.AudioListener,r.camera.add(h),y.dispatch(h),I(!0)}function R(e,t,r,i,a,o){var l;o&&(l=document.createElement("audio"));var u=x[e]=new s(e+".mp3",{preload:!!r,loop:i,elem:l,isPositional:!!a});return n.groups[t].add(u),u.load(),u}function P(e){return m&&x[e].play(),x[e]}function D(){I(!m)}function I(e){m=!!e,p.classList.toggle("is-active",m)}function O(e){h?e(h):y.add(e)}function z(e){if(h){var t=m?1:-1;f=i.saturate(f+t*e*.5);var r=v&&!g;n.master.setFinalVolume(f*(v?1:0),r)}}},{"../core/properties":68,"../input/input":76,"../scenes/scenes":96,"../utils/math":115,"./AudioGroup":60,"./AudioItem":61,"min-signal":23,three:59}],63:[function(e,t,n){"use strict";var r=e("three");t.exports=r.DeviceOrientationControls=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.hasValue=!1,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var n,i,a,o,s=function(e){t.deviceOrientation=e},l=function(){t.screenOrientation=window.orientation||0},u=(n=new r.Vector3(0,0,1),i=new r.Euler,a=new r.Quaternion,o=new r.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,r,s,l){i.set(r,t,-s,"YXZ"),e.setFromEuler(i),e.multiply(o),e.multiply(a.setFromAxisAngle(n,-l))});this.connect=function(){l(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",l,!1),window.addEventListener("deviceorientation",s,!1))})).catch((function(e){})):(window.addEventListener("orientationchange",l,!1),window.addEventListener("deviceorientation",s,!1)),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",l,!1),window.removeEventListener("deviceorientation",s,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var n=e.alpha?r.Math.degToRad(e.alpha)+t.alphaOffset:0,i=e.beta?r.Math.degToRad(e.beta):0,a=e.gamma?r.Math.degToRad(e.gamma):0,o=t.screenOrientation?r.Math.degToRad(t.screenOrientation):0;u(t.object.quaternion,n,i,a,o),t.hasValue=e.alpha&&e.beta&&e.gamma}}},this.dispose=function(){t.disconnect()},this.connect()}},{three:59}],64:[function(e,t,n){"use strict";var r=e("three");t.exports=r.OrbitControls=function(e,t){var n,i,a,o,s;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new r.Vector3,this.minDistance=0,this.maxDistance=10,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},this.touches={ONE:r.TOUCH.ROTATE,TWO:r.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(u),l.update(),p=d.NONE},this.update=(n=new r.Vector3,i=(new r.Quaternion).setFromUnitVectors(e.up,new r.Vector3(0,1,0)),a=i.clone().inverse(),o=new r.Vector3,s=new r.Quaternion,function(){var e=l.object.position;return n.copy(e).sub(l.target),n.applyQuaternion(i),m.setFromVector3(n),l.autoRotate&&p===d.NONE&&R(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(m.theta+=v.theta*l.dampingFactor,m.phi+=v.phi*l.dampingFactor):(m.theta+=v.theta,m.phi+=v.phi),m.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,m.theta)),m.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=g,m.radius=Math.max(l.minDistance,Math.min(l.maxDistance,m.radius)),!0===l.enableDamping?l.target.addScaledVector(y,l.dampingFactor):l.target.add(y),n.setFromSpherical(m),n.applyQuaternion(a),e.copy(l.target).add(n),l.object.lookAt(l.target),!0===l.enableDamping?(v.theta*=1-l.dampingFactor,v.phi*=1-l.dampingFactor,y.multiplyScalar(1-l.dampingFactor)):(v.set(0,0,0),y.set(0,0,0)),g=1,!!(x||o.distanceToSquared(l.object.position)>f||8*(1-s.dot(l.object.quaternion))>f)&&(l.dispatchEvent(u),o.copy(l.object.position),s.copy(l.object.quaternion),x=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",ee,!1),l.domElement.removeEventListener("mousedown",q,!1),l.domElement.removeEventListener("wheel",Z,!1),l.domElement.removeEventListener("touchstart",J,!1),l.domElement.removeEventListener("touchend",$,!1),l.domElement.removeEventListener("touchmove",Q,!1),document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),window.removeEventListener("keydown",K,!1)};var l=this,u={type:"change"},c={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},p=d.NONE,f=1e-6,m=new r.Spherical,v=new r.Spherical,g=1,y=new r.Vector3,x=!1,_=new r.Vector2,b=new r.Vector2,w=new r.Vector2,M=new r.Vector2,S=new r.Vector2,T=new r.Vector2,E=new r.Vector2,A=new r.Vector2,C=new r.Vector2;function L(){return Math.pow(.95,l.zoomSpeed)}function R(e){v.theta-=e}function P(e){v.phi-=e}var D,I=(D=new r.Vector3,function(e,t){D.setFromMatrixColumn(t,0),D.multiplyScalar(-e),y.add(D)}),O=function(){var e=new r.Vector3;return function(t,n){!0===l.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(l.object.up,e)),e.multiplyScalar(t),y.add(e)}}(),z=function(){var e=new r.Vector3;return function(t,n){var r=l.domElement===document?l.domElement.body:l.domElement;if(l.object.isPerspectiveCamera){var i=l.object.position;e.copy(i).sub(l.target);var a=e.length();a*=Math.tan(l.object.fov/2*Math.PI/180),I(2*t*a/r.clientHeight,l.object.matrix),O(2*n*a/r.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(I(t*(l.object.right-l.object.left)/l.object.zoom/r.clientWidth,l.object.matrix),O(n*(l.object.top-l.object.bottom)/l.object.zoom/r.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function k(e){l.object.isPerspectiveCamera?g/=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),x=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function F(e){l.object.isPerspectiveCamera?g*=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),x=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function N(e){_.set(e.clientX,e.clientY)}function B(e){M.set(e.clientX,e.clientY)}function U(e){if(1==e.touches.length)_.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(t,n)}}function G(e){if(1==e.touches.length)M.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(t,n)}}function H(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);E.set(0,r)}function j(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,n)}w.subVectors(b,_).multiplyScalar(l.rotateSpeed);var r=l.domElement===document?l.domElement.body:l.domElement;R(2*Math.PI*w.x/r.clientHeight),P(2*Math.PI*w.y/r.clientHeight),_.copy(b)}function V(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,n)}T.subVectors(S,M).multiplyScalar(l.panSpeed),z(T.x,T.y),M.copy(S)}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);A.set(0,r),C.set(0,Math.pow(A.y/E.y,l.zoomSpeed)),k(C.y),E.copy(A)}function q(e){if(!1!==l.enabled){switch(e.preventDefault(),l.domElement.focus?l.domElement.focus():window.focus(),e.button){case 0:switch(l.mouseButtons.LEFT){case r.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enablePan)return;B(e),p=d.PAN}else{if(!1===l.enableRotate)return;N(e),p=d.ROTATE}break;case r.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enableRotate)return;N(e),p=d.ROTATE}else{if(!1===l.enablePan)return;B(e),p=d.PAN}break;default:p=d.NONE}break;case 1:if(l.mouseButtons.MIDDLE===r.MOUSE.DOLLY){if(!1===l.enableZoom)return;!function(e){E.set(e.clientX,e.clientY)}(e),p=d.DOLLY}else p=d.NONE;break;case 2:switch(l.mouseButtons.RIGHT){case r.MOUSE.ROTATE:if(!1===l.enableRotate)return;N(e),p=d.ROTATE;break;case r.MOUSE.PAN:if(!1===l.enablePan)return;B(e),p=d.PAN;break;default:p=d.NONE}}p!==d.NONE&&(document.addEventListener("mousemove",X,!1),document.addEventListener("mouseup",Y,!1),l.dispatchEvent(c))}}function X(e){if(!1!==l.enabled)switch(e.preventDefault(),p){case d.ROTATE:if(!1===l.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),w.subVectors(b,_).multiplyScalar(l.rotateSpeed);var t=l.domElement===document?l.domElement.body:l.domElement;R(2*Math.PI*w.x/t.clientHeight),P(2*Math.PI*w.y/t.clientHeight),_.copy(b),l.update()}(e);break;case d.DOLLY:if(!1===l.enableZoom)return;!function(e){A.set(e.clientX,e.clientY),C.subVectors(A,E),C.y>0?k(L()):C.y<0&&F(L()),E.copy(A),l.update()}(e);break;case d.PAN:if(!1===l.enablePan)return;!function(e){S.set(e.clientX,e.clientY),T.subVectors(S,M).multiplyScalar(l.panSpeed),z(T.x,T.y),M.copy(S),l.update()}(e)}}function Y(e){!1!==l.enabled&&(document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),l.dispatchEvent(h),p=d.NONE)}function Z(e){!1===l.enabled||!1===l.enableZoom||p!==d.NONE&&p!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),l.dispatchEvent(c),function(e){e.deltaY<0?F(L()):e.deltaY>0&&k(L()),l.update()}(e),l.dispatchEvent(h))}function K(e){!1!==l.enabled&&!1!==l.enableKeys&&!1!==l.enablePan&&function(e){var t=!1;switch(e.keyCode){case l.keys.UP:z(0,l.keyPanSpeed),t=!0;break;case l.keys.BOTTOM:z(0,-l.keyPanSpeed),t=!0;break;case l.keys.LEFT:z(l.keyPanSpeed,0),t=!0;break;case l.keys.RIGHT:z(-l.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),l.update())}(e)}function J(e){if(!1!==l.enabled){switch(e.cancelable&&e.preventDefault(),e.touches.length){case 1:switch(l.touches.ONE){case r.TOUCH.ROTATE:if(!1===l.enableRotate)return;U(e),p=d.TOUCH_ROTATE;break;case r.TOUCH.PAN:if(!1===l.enablePan)return;G(e),p=d.TOUCH_PAN;break;default:p=d.NONE}break;case 2:switch(l.touches.TWO){case r.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&H(e),l.enablePan&&G(e)}(e),p=d.TOUCH_DOLLY_PAN;break;case r.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&H(e),l.enableRotate&&U(e)}(e),p=d.TOUCH_DOLLY_ROTATE;break;default:p=d.NONE}break;default:p=d.NONE}p!==d.NONE&&l.dispatchEvent(c)}}function Q(e){if(!1!==l.enabled)switch(e.cancelable&&e.preventDefault(),p){case d.TOUCH_ROTATE:if(!1===l.enableRotate)return;j(e),l.update();break;case d.TOUCH_PAN:if(!1===l.enablePan)return;V(e),l.update();break;case d.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&W(e),l.enablePan&&V(e)}(e),l.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&W(e),l.enableRotate&&j(e)}(e),l.update();break;default:p=d.NONE}}function $(e){!1!==l.enabled&&(l.dispatchEvent(h),p=d.NONE)}function ee(e){!1!==l.enabled&&e.preventDefault()}l.domElement.addEventListener("contextmenu",ee,!1),l.domElement.addEventListener("mousedown",q,!1),l.domElement.addEventListener("wheel",Z,!1),l.domElement.addEventListener("touchstart",J,!1),l.domElement.addEventListener("touchend",$,!1),l.domElement.addEventListener("touchmove",Q,!1),window.addEventListener("keydown",K,!1),this.update()},r.OrbitControls.prototype=Object.create(r.EventDispatcher.prototype),r.OrbitControls.prototype.constructor=r.OrbitControls,Object.defineProperties(r.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),r.MapControls=function(e,t){r.OrbitControls.call(this,e,t),this.mouseButtons.LEFT=r.MOUSE.PAN,this.mouseButtons.RIGHT=r.MOUSE.ROTATE,this.touches.ONE=r.TOUCH.PAN,this.touches.TWO=r.TOUCH.DOLLY_ROTATE},r.MapControls.prototype=Object.create(r.EventDispatcher.prototype),r.MapControls.prototype.constructor=r.MapControls},{three:59}],65:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/assertThisInitialized")),s=r(e("@babel/runtime/helpers/get")),l=r(e("@babel/runtime/helpers/inherits")),u=r(e("@babel/runtime/helpers/possibleConstructorReturn")),c=r(e("@babel/runtime/helpers/getPrototypeOf"));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var d=e("three"),p=new d.Raycaster,f=new d.Vector3,m=new d.Vector3,v=new d.Quaternion,g={X:new d.Vector3(1,0,0),Y:new d.Vector3(0,1,0),Z:new d.Vector3(0,0,1)},y={type:"change"},x={type:"mouseDown"},_={type:"mouseUp",mode:null},b={type:"objectChange"},w=function(e){(0,l.default)(n,e);var t=h(n);function n(e,r){var a;(0,i.default)(this,n),a=t.call(this),void 0===r&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),r=document),a.visible=!1,a.domElement=r,a.domElement.style.touchAction="none";var s=new j;a._gizmo=s,a.add(s);var l=new V;a._plane=l,a.add(l);var u=(0,o.default)(a);function c(e,t){var n=t;Object.defineProperty(u,e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,l[e]=t,s[e]=t,u.dispatchEvent({type:e+"-changed",value:t}),u.dispatchEvent(y))}}),u[e]=t,l[e]=t,s[e]=t}c("camera",e),c("object",void 0),c("enabled",!0),c("axis",null),c("mode","translate"),c("translationSnap",null),c("rotationSnap",null),c("scaleSnap",null),c("space","world"),c("size",.6),c("dragging",!1),c("showX",!0),c("showY",!0),c("showZ",!0);var h=new d.Vector3,p=new d.Vector3,f=new d.Quaternion,m=new d.Quaternion,v=new d.Vector3,g=new d.Quaternion,x=new d.Vector3,_=new d.Vector3,b=new d.Vector3,w=new d.Vector3;return c("worldPosition",h),c("worldPositionStart",p),c("worldQuaternion",f),c("worldQuaternionStart",m),c("cameraPosition",v),c("cameraQuaternion",g),c("pointStart",x),c("pointEnd",_),c("rotationAxis",b),c("rotationAngle",0),c("eye",w),a._offset=new d.Vector3,a._startNorm=new d.Vector3,a._endNorm=new d.Vector3,a._cameraScale=new d.Vector3,a._parentPosition=new d.Vector3,a._parentQuaternion=new d.Quaternion,a._parentQuaternionInv=new d.Quaternion,a._parentScale=new d.Vector3,a._worldScaleStart=new d.Vector3,a._worldQuaternionInv=new d.Quaternion,a._worldScale=new d.Vector3,a._positionStart=new d.Vector3,a._quaternionStart=new d.Quaternion,a._scaleStart=new d.Vector3,a._getPointer=M.bind((0,o.default)(a)),a._onPointerDown=T.bind((0,o.default)(a)),a._onPointerHover=S.bind((0,o.default)(a)),a._onPointerMove=E.bind((0,o.default)(a)),a._onPointerUp=A.bind((0,o.default)(a)),a.domElement.addEventListener("pointerdown",a._onPointerDown),a.domElement.addEventListener("pointermove",a._onPointerHover),a.domElement.addEventListener("pointerup",a._onPointerUp),a}return(0,a.default)(n,[{key:"updateMatrixWorld",value:function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).inverse(),this._worldQuaternionInv.copy(this.worldQuaternion).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),(0,s.default)((0,c.default)(n.prototype),"updateMatrixWorld",this).call(this,this)}},{key:"pointerHover",value:function(e){if(void 0!==this.object&&!0!==this.dragging){p.setFromCamera(e,this.camera);var t=C(this._gizmo.picker[this.mode],p);this.axis=t?t.object.name:null}}},{key:"pointerDown",value:function(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){p.setFromCamera(e,this.camera);var t=C(this._plane,p,!0);if(t){var n=this.space;if("scale"===this.mode?n="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(n="world"),"local"===n&&"rotate"===this.mode){var r=this.rotationSnap;"X"===this.axis&&r&&(this.object.rotation.x=Math.round(this.object.rotation.x/r)*r),"Y"===this.axis&&r&&(this.object.rotation.y=Math.round(this.object.rotation.y/r)*r),"Z"===this.axis&&r&&(this.object.rotation.z=Math.round(this.object.rotation.z/r)*r)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)}this.dragging=!0,x.mode=this.mode,this.dispatchEvent(x)}}},{key:"pointerMove",value:function(e){var t=this.axis,n=this.mode,r=this.object,i=this.space;if("scale"===n?i="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(i="world"),void 0!==r&&null!==t&&!1!==this.dragging&&-1===e.button){p.setFromCamera(e,this.camera);var a=C(this._plane,p,!0);if(a){if(this.pointEnd.copy(a.point).sub(this.worldPositionStart),"translate"===n)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===i&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===i&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===i&&(r.position.applyQuaternion(v.copy(this._quaternionStart).inverse()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===i&&(r.parent&&r.position.add(f.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(f.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){var o=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(o*=-1),m.set(o,o,o)}else f.copy(this.pointStart),m.copy(this.pointEnd),f.applyQuaternion(this._worldQuaternionInv),m.applyQuaternion(this._worldQuaternionInv),m.divide(f),-1===t.search("X")&&(m.x=1),-1===t.search("Y")&&(m.y=1),-1===t.search("Z")&&(m.z=1);r.scale.copy(this._scaleStart).multiply(m),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){this._offset.copy(this.pointEnd).sub(this.pointStart);var s=20/this.worldPosition.distanceTo(f.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(f.copy(this.rotationAxis).cross(this.eye))*s):"X"!==t&&"Y"!==t&&"Z"!==t||(this.rotationAxis.copy(g[t]),f.copy(g[t]),"local"===i&&f.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(f.cross(this.eye).normalize())*s),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===i&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(v.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(v.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(y),this.dispatchEvent(b)}}}},{key:"pointerUp",value:function(e){0===e.button&&(this.dragging&&null!==this.axis&&(_.mode=this.mode,this.dispatchEvent(_)),this.dragging=!1,this.axis=null)}},{key:"dispose",value:function(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}},{key:"attach",value:function(e){return this.object=e,this.visible=!0,this}},{key:"detach",value:function(){return this.object=void 0,this.visible=!1,this.axis=null,this}},{key:"getRaycaster",value:function(){return p}},{key:"getMode",value:function(){return this.mode}},{key:"setMode",value:function(e){this.mode=e}},{key:"setTranslationSnap",value:function(e){this.translationSnap=e}},{key:"setRotationSnap",value:function(e){this.rotationSnap=e}},{key:"setScaleSnap",value:function(e){this.scaleSnap=e}},{key:"setSize",value:function(e){this.size=e}},{key:"setSpace",value:function(e){this.space=e}},{key:"update",value:function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}]),n}(d.Object3D);function M(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};var t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}function S(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function T(e){this.enabled&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function E(e){this.enabled&&this.pointerMove(this._getPointer(e))}function A(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function C(e,t,n){for(var r=t.intersectObject(e,!0),i=0;i<r.length;i++)if(r[i].object.visible||n)return r[i];return!1}w.prototype.isTransformControls=!0;var L=new d.Euler,R=new d.Vector3(0,1,0),P=new d.Vector3(0,0,0),D=new d.Matrix4,I=new d.Quaternion,O=new d.Quaternion,z=new d.Vector3,k=new d.Matrix4,F=new d.Vector3(1,0,0),N=new d.Vector3(0,1,0),B=new d.Vector3(0,0,1),U=new d.Vector3,G=new d.Vector3,H=new d.Vector3,j=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;(0,i.default)(this,n),(e=t.call(this)).type="TransformControlsGizmo";var r=new d.MeshBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),a=new d.LineBasicMaterial({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),o=r.clone();o.opacity=.15;var s=a.clone();s.opacity=.5;var l=r.clone();l.color.setHex(16711680);var u=r.clone();u.color.setHex(65280);var c=r.clone();c.color.setHex(255);var h=r.clone();h.color.setHex(16711680),h.opacity=.5;var p=r.clone();p.color.setHex(65280),p.opacity=.5;var f=r.clone();f.color.setHex(255),f.opacity=.5;var m=r.clone();m.opacity=.025;var v=r.clone();v.color.setHex(16776960),v.opacity=.15;var g=r.clone();g.color.setHex(16776960),g.opacity=.3;var y=r.clone();y.color.setHex(7895160);var x=new d.CylinderGeometry(0,.04,.1,12);x.translate(0,.05,0),new d.BoxGeometry(.08,.08,.08).translate(0,.04,0);var _=new d.BufferGeometry;_.setAttribute("position",new d.Float32BufferAttribute([0,0,0,1,0,0],3));var b=new d.CylinderGeometry(.0075,.0075,.5,3);function w(e,t){var n=new d.TorusGeometry(e,.0075,3,64,t*Math.PI*2);return n.rotateY(Math.PI/2),n.rotateX(Math.PI/2),n}b.translate(0,.25,0);var M,S={X:[[new d.Mesh(x,l),[.5,0,0],[0,0,-Math.PI/2]],[new d.Mesh(x,l),[-.5,0,0],[0,0,Math.PI/2]],[new d.Mesh(b,l),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new d.Mesh(x,u),[0,.5,0]],[new d.Mesh(x,u),[0,-.5,0],[Math.PI,0,0]],[new d.Mesh(b,u)]],Z:[[new d.Mesh(x,c),[0,0,.5],[Math.PI/2,0,0]],[new d.Mesh(x,c),[0,0,-.5],[-Math.PI/2,0,0]],[new d.Mesh(b,c),null,[Math.PI/2,0,0]]],XYZ:[[new d.Mesh(new d.OctahedronGeometry(.1,0),m.clone()),[0,0,0]]],XY:[[new d.Mesh(new d.BoxGeometry(.15,.15,.01),f.clone()),[.15,.15,0]]],YZ:[[new d.Mesh(new d.BoxGeometry(.15,.15,.01),h.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new d.Mesh(new d.BoxGeometry(.15,.15,.01),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},T={X:[[new d.Mesh(new d.CylinderGeometry(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new d.Mesh(new d.CylinderGeometry(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new d.Mesh(new d.CylinderGeometry(.2,0,.6,4),o),[0,.3,0]],[new d.Mesh(new d.CylinderGeometry(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new d.Mesh(new d.CylinderGeometry(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new d.Mesh(new d.CylinderGeometry(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new d.Mesh(new d.OctahedronGeometry(.2,0),o)]],XY:[[new d.Mesh(new d.BoxGeometry(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new d.Mesh(new d.BoxGeometry(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new d.Mesh(new d.BoxGeometry(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]]},E={START:[[new d.Mesh(new d.OctahedronGeometry(.01,2),s),null,null,null,"helper"]],END:[[new d.Mesh(new d.OctahedronGeometry(.01,2),s),null,null,null,"helper"]],DELTA:[[new d.Line((M=new d.BufferGeometry,M.setAttribute("position",new d.Float32BufferAttribute([0,0,0,1,1,1],3)),M),s),null,null,null,"helper"]],X:[[new d.Line(_,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new d.Line(_,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new d.Line(_,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},A={XYZE:[[new d.Mesh(w(.5,1),y),null,[0,Math.PI/2,0]]],X:[[new d.Mesh(w(.5,.5),l)]],Y:[[new d.Mesh(w(.5,.5),u),null,[0,0,-Math.PI/2]]],Z:[[new d.Mesh(w(.5,.5),c),null,[0,Math.PI/2,0]]],E:[[new d.Mesh(w(.75,1),v),null,[0,Math.PI/2,0]]]},C={AXIS:[[new d.Line(_,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},L={XYZE:[[new d.Mesh(new d.SphereGeometry(.25,10,8),o)]],X:[[new d.Mesh(new d.TorusGeometry(.5,.1,4,24),o),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new d.Mesh(new d.TorusGeometry(.5,.1,4,24),o),[0,0,0],[Math.PI/2,0,0]]],Z:[[new d.Mesh(new d.TorusGeometry(.5,.1,4,24),o),[0,0,0],[0,0,-Math.PI/2]]],E:[[new d.Mesh(new d.TorusGeometry(.75,.1,2,24),o)]]},R={XYZ:[[new d.Mesh(new d.BoxGeometry(1,1,1),m.clone())]]},P={XYZ:[[new d.Mesh(new d.BoxGeometry(2,2,2),o),[0,0,0]]]},D={X:[[new d.Line(_,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new d.Line(_,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new d.Line(_,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function I(e){var t=new d.Object3D;for(var n in e)for(var r=e[n].length;r--;){var i=e[n][r][0].clone(),a=e[n][r][1],o=e[n][r][2],s=e[n][r][3],l=e[n][r][4];i.name=n,i.tag=l,a&&i.position.set(a[0],a[1],a[2]),o&&i.rotation.set(o[0],o[1],o[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();var u=i.geometry.clone();u.applyMatrix4(i.matrix),i.geometry=u,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t}return e.gizmo={},e.picker={},e.helper={},e.add(e.gizmo.translate=I(S)),e.add(e.gizmo.rotate=I(A)),e.add(e.gizmo.scale=I(R)),e.add(e.picker.translate=I(T)),e.add(e.picker.rotate=I(L)),e.add(e.picker.scale=I(P)),e.add(e.helper.translate=I(E)),e.add(e.helper.rotate=I(C)),e.add(e.helper.scale=I(D)),e.picker.translate.visible=!1,e.picker.rotate.visible=!1,e.picker.scale.visible=!1,e}return(0,a.default)(n,[{key:"updateMatrixWorld",value:function(e){var t=this,r="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:O;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var i=[];i=(i=(i=i.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var a=function(e){var n=i[e];n.visible=!0,n.rotation.set(0,0,0),n.position.copy(t.worldPosition);var a;if(a=t.camera.isOrthographicCamera?(t.camera.top-t.camera.bottom)/t.camera.zoom:t.worldPosition.distanceTo(t.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*t.camera.fov/360)/t.camera.zoom,7),n.scale.set(1,1,1).multiplyScalar(a*t.size/4),"helper"===n.tag)return n.visible=!1,"AXIS"===n.name?(n.position.copy(t.worldPositionStart),n.visible=!!t.axis,"X"===t.axis&&(v.setFromEuler(L.set(0,0,0)),n.quaternion.copy(r).multiply(v),Math.abs(R.copy(F).applyQuaternion(r).dot(t.eye))>.9&&(n.visible=!1)),"Y"===t.axis&&(v.setFromEuler(L.set(0,0,Math.PI/2)),n.quaternion.copy(r).multiply(v),Math.abs(R.copy(N).applyQuaternion(r).dot(t.eye))>.9&&(n.visible=!1)),"Z"===t.axis&&(v.setFromEuler(L.set(0,Math.PI/2,0)),n.quaternion.copy(r).multiply(v),Math.abs(R.copy(B).applyQuaternion(r).dot(t.eye))>.9&&(n.visible=!1)),"XYZE"===t.axis&&(v.setFromEuler(L.set(0,Math.PI/2,0)),R.copy(t.rotationAxis),n.quaternion.setFromRotationMatrix(D.lookAt(P,R,N)),n.quaternion.multiply(v),n.visible=t.dragging),"E"===t.axis&&(n.visible=!1)):"START"===n.name?(n.position.copy(t.worldPositionStart),n.visible=t.dragging):"END"===n.name?(n.position.copy(t.worldPosition),n.visible=t.dragging):"DELTA"===n.name?(n.position.copy(t.worldPositionStart),n.quaternion.copy(t.worldQuaternionStart),f.set(1e-10,1e-10,1e-10).add(t.worldPositionStart).sub(t.worldPosition).multiplyScalar(-1),f.applyQuaternion(t.worldQuaternionStart.clone().inverse()),n.scale.copy(f),n.visible=t.dragging):(n.quaternion.copy(r),t.dragging?n.position.copy(t.worldPositionStart):n.position.copy(t.worldPosition),t.axis&&(n.visible=-1!==t.axis.search(n.name))),"continue";if(n.quaternion.copy(r),"translate"===t.mode||"scale"===t.mode){var o=.99;"X"===n.name&&Math.abs(R.copy(F).applyQuaternion(r).dot(t.eye))>o&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"Y"===n.name&&Math.abs(R.copy(N).applyQuaternion(r).dot(t.eye))>o&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"Z"===n.name&&Math.abs(R.copy(B).applyQuaternion(r).dot(t.eye))>o&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"XY"===n.name&&Math.abs(R.copy(B).applyQuaternion(r).dot(t.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"YZ"===n.name&&Math.abs(R.copy(F).applyQuaternion(r).dot(t.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),"XZ"===n.name&&Math.abs(R.copy(N).applyQuaternion(r).dot(t.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1)}else"rotate"===t.mode&&(I.copy(r),R.copy(t.eye).applyQuaternion(v.copy(r).inverse()),-1!==n.name.search("E")&&n.quaternion.setFromRotationMatrix(D.lookAt(t.eye,P,N)),"X"===n.name&&(v.setFromAxisAngle(F,Math.atan2(-R.y,R.z)),v.multiplyQuaternions(I,v),n.quaternion.copy(v)),"Y"===n.name&&(v.setFromAxisAngle(N,Math.atan2(R.x,R.z)),v.multiplyQuaternions(I,v),n.quaternion.copy(v)),"Z"===n.name&&(v.setFromAxisAngle(B,Math.atan2(R.y,R.x)),v.multiplyQuaternions(I,v),n.quaternion.copy(v)));n.visible=n.visible&&(-1===n.name.indexOf("X")||t.showX),n.visible=n.visible&&(-1===n.name.indexOf("Y")||t.showY),n.visible=n.visible&&(-1===n.name.indexOf("Z")||t.showZ),n.visible=n.visible&&(-1===n.name.indexOf("E")||t.showX&&t.showY&&t.showZ),n.material._color=n.material._color||n.material.color.clone(),n.material._opacity=n.material._opacity||n.material.opacity,n.material.color.copy(n.material._color),n.material.opacity=n.material._opacity,t.enabled&&t.axis&&(n.name===t.axis||t.axis.split("").some((function(e){return n.name===e})))&&(n.material.color.setHex(16776960),n.material.opacity=.15)},o=0;o<i.length;o++)a(o);(0,s.default)((0,c.default)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(d.Object3D);j.prototype.isTransformControlsGizmo=!0;var V=function(e){(0,l.default)(n,e);var t=h(n);function n(){var e;return(0,i.default)(this,n),(e=t.call(this,new d.PlaneGeometry(1e5,1e5,2,2),new d.MeshBasicMaterial({visible:!1,wireframe:!0,side:d.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1}))).type="TransformControlsPlane",e}return(0,a.default)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),U.copy(F).applyQuaternion("local"===t?this.worldQuaternion:O),G.copy(N).applyQuaternion("local"===t?this.worldQuaternion:O),H.copy(B).applyQuaternion("local"===t?this.worldQuaternion:O),R.copy(G),this.mode){case"translate":case"scale":switch(this.axis){case"X":R.copy(this.eye).cross(U),z.copy(U).cross(R);break;case"Y":R.copy(this.eye).cross(G),z.copy(G).cross(R);break;case"Z":R.copy(this.eye).cross(H),z.copy(H).cross(R);break;case"XY":z.copy(H);break;case"YZ":z.copy(U);break;case"XZ":R.copy(H),z.copy(G);break;case"XYZ":case"E":z.set(0,0,0)}break;default:z.set(0,0,0)}0===z.length()?this.quaternion.copy(this.cameraQuaternion):(k.lookAt(f.set(0,0,0),z,R),this.quaternion.setFromRotationMatrix(k)),(0,s.default)((0,c.default)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(d.Mesh);V.prototype.isTransformControlsPlane=!0,d.TransformControls=w,d.TransformControlsGizmo=j,d.TransformControlsPlane=V,t.exports=w},{"@babel/runtime/helpers/assertThisInitialized":3,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/get":7,"@babel/runtime/helpers/getPrototypeOf":8,"@babel/runtime/helpers/inherits":9,"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/possibleConstructorReturn":13,three:59}],66:[function(e,t,n){"use strict";var r,i,a,o,s,l,u=e("../core/browser"),c=e("../core/settings"),h=e("../core/properties"),d=e("../motions/BrownianMotion"),p=e("three"),f=(e("glslify"),e("./OrbitControls")),m=e("./DeviceOrientationControls");n.preInit=function(){var e=h.camera;b=new p.Vector3,new p.Vector3,e.position.copy(g),r=h.brownianMotion=new d,i=e.clone(),n.orbitControls=new f(i,c.canvas),n.orbitControls.target0.copy(y),n.orbitControls.reset(),u.isMobile&&(l=new p.Camera,o=new p.Quaternion,s=new p.Quaternion,a=new m(l))},n.init=function(){c.LOOK_DEV_MODE&&(h.skipCameraMovement=!0)},n.setOrbitPlacement=function(e,t){if(c.LOOK_DEV_MODE){var r=h.camera;r.position.fromArray(e),r.rotation.fromArray(t),b.set(0,0,-1).applyQuaternion(r.quaternion).multiplyScalar(h.cameraDistance).add(r.position),n.orbitControls.position0.copy(r.position),n.orbitControls.target0.copy(b),n.orbitControls.reset()}},n.resize=function(e,t){},n.update=function(e){var t=h.camera;t.matrix.identity(),t.matrix.decompose(t.position,t.quaternion,t.scale);var d=h.skipCameraMovement?0:1;c.LOOK_DEV_MODE?(t.position.copy(g),n.orbitControls.update(),i.updateMatrix(),i.matrix.decompose(t.position,t.quaternion,t.scale)):(t.position.copy(n.basePosition),t.rotation.copy(n.baseRotation)),b.set(0,0,-1).applyQuaternion(t.quaternion);var p=h.cameraDistance;h.camera.filmGauge=41.4214,h.camera.setFocalLength(50);var f=t.fov;t.fov=f+h.cameraDollyZoomFovOffset;var m=p;m=m*Math.tan(f/360*Math.PI/2)/Math.tan(t.fov/360*Math.PI/2)-m,t.translateZ(m),h.cameraDollyZoomZOffset=m,h.introRatio>.9&&(h.cameraDollyZoomFovOffset*=.975),t.updateProjectionMatrix(),t.fov=f,t.translateZ(-p),u.isMobile?(a.update(),a.hasValue&&(v||(s.copy(l.quaternion),o.copy(l.quaternion)),s.slerp(l.quaternion,.02),o.slerp(s,.02),x.copy(o).inverse().multiply(s),v=!0)):(_.set(h.cameraLookX*d,h.cameraLookY*d,0),x.setFromEuler(_)),t.quaternion.multiply(x),t.translateZ(p),t.matrix.compose(t.position,t.quaternion,t.scale),r.positionAmplitude=h.cameraShakePositionStrength*h.cameraShakeStrength*d,r.positionFrequency=h.cameraShakePositionSpeed,r.rotationAmplitude=h.cameraShakeRotationStrength*h.cameraShakeStrength*d,r.rotationFrequency=h.cameraShakeRotationSpeed,r.update(e),t.matrix.multiply(r.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale),b.set(0,0,-1).applyQuaternion(t.quaternion)},n.container=null,n.orbitControls=null,n.basePosition=new p.Vector3,n.baseRotation=new p.Euler;var v=!1,g=new p.Vector3(6,3,2),y=new p.Vector3(1.42098,0,0),x=new p.Quaternion,_=new p.Euler,b=new p.Vector3;new p.Vector3},{"../core/browser":67,"../core/properties":68,"../core/settings":69,"../motions/BrownianMotion":82,"./DeviceOrientationControls":63,"./OrbitControls":64,glslify:21,three:59}],67:[function(e,t,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),n.videoFormat=n.transitionStyle=n.transformStyle=n.transformPerspectiveStyle=n.transformOriginStyle=n.transform3dStyle=n.isSupportOpacity=n.isSafari=n.isRetina=n.isMobile=n.isIOS=n.isIFrame=n.isIE=n.isFirefox=n.isEdge=n.isChrome=n.filterStyle=n.devicePixelRatio=n.cpuCoreCount=n.baseUrl=n.audioFormat=n.WebAudioContext=void 0;var i="Webkit Moz O ms".split(" "),a=document.createElement("div").style,o=window,s=document,l=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase(),u=P("video",["video/mp4","video/ogv"]);n.videoFormat=u;var c=P("audio",["audio/mp3","audio/ogg"]);n.audioFormat=c;var h=o.self!==o.top;n.isIFrame=h;var d=o.devicePixelRatio&&o.devicePixelRatio>=1.5;n.isRetina=d;var p=a.opacity!==r;n.isSupportOpacity=p;var f=navigator.hardwareConcurrency||1;n.cpuCoreCount=f;var m=l.indexOf("edge")>-1;n.isEdge=m;var v=l.indexOf("msie")>-1;n.isIE=v;var g=l.indexOf("firefox")>-1;n.isFirefox=g;var y=!m&&l.indexOf("chrome")>-1;n.isChrome=y;var x=!m&&!y&&l.indexOf("safari")>-1;n.isSafari=x;var _=/(iPad|iPhone|Android)/i.test(l);n.isMobile=_;var b=/(iPad|iPhone)/i.test(l);n.isIOS=b;var w=v?r:D("filter");n.filterStyle=w;var M=D("transition");n.transitionStyle=M;var S=D("transform");n.transformStyle=S;var T=D("transform","perspective");n.transform3dStyle=T;var E=D("perspective");n.transformPerspectiveStyle=E;var A=D("transformOrigin");n.transformOriginStyle=A;var C=o.AudioContext||o.webkitAudioContext;n.WebAudioContext=C;var L=document.location.origin;n.baseUrl=L;var R=window.devicePixelRatio||1;function P(e,t){var n,r;try{switch(e){case"video":n=new o.Video;break;case"audio":n=new o.Audio}}catch(t){n=s.createElement(e)}for(var i=0,a=t.length;i<a;i++)if(n.canPlayType&&n.canPlayType(t[i])){r=t[i].substr(t[i].indexOf("/")+1);break}return r}function D(e,t){return function(e,t){return t>1?i[t-2]+e.charAt(0).toUpperCase()+e.slice(1):1===t&&e}(e,function(e){for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=i.length;n--;)if(a[i[n]+t]!==r)return n+2;return a[e]!==r?1:0}(t||e))}n.devicePixelRatio=R},{}],68:[function(e,t,n){"use strict";var r=e("../ui/constants"),i=e("min-signal");e("three"),n.loader=e("quick-loader").create(),n.gl=null,n.isSupportWebGL=null,n.renderer=null,n.scene=null,n.camera=null,n.postprocessing=null,n.sharedUniforms={u_resolution:{value:null},u_bgColor:{value:null},u_time:{value:0},u_timeScale:{value:0}},n.resolution=null,n.isStageReady=!1,n.hasInitialized=!1,n.isAudioActive=!1,n.domElement=null,n.rawWidth=0,n.rawHeight=0,n.width=0,n.height=0,n.time=0,n.dt=0,n.hitTestList=[],n.bgColorHex="#fff",n.opacity=1,n.bloomAmount=.5,n.bloomRadius=1,n.bloomThreshold=.2,n.bloomSmoothWidth=.65,n.haloWidth=.8,n.haloRGBShift=.03,n.haloStrength=.3,n.haloMaskInner=.8255,n.haloMaskOuter=1,n.vignetteFrom=.3,n.vignetteTo=1.45,n.vignetteColorHex="#000000",n.saturation=1,n.contrast=0,n.brightness=1,n.tintColorHex="#ffcb7e",n.tintOpacity=.1,n.borderSize=15,n.borderNoiseScale=1,n.borderNoiseSpeed=.1,n.borderNoiseIntensity=.1,n.cameraLookX=0,n.cameraLookY=0,n.cameraLookStrength=.03,n.cameraLookEaseDamp=.075,n.skipCameraMovement=!1,n.cameraDistance=5,n.cameraShakeStrength=1,n.cameraShakePositionStrength=.12,n.cameraShakePositionSpeed=.3,n.cameraShakeRotationStrength=.003,n.cameraShakeRotationSpeed=.3,n.bokehEnabled=!0,n.bokehFNumber=.07,n.bokehFocusDistance=9,n.bokehFocalLength=.463,n.bokehKFilmHeight=36,n.introRatio=0,n.cameraDollyZoomFovOffset=0,n.cameraDollyZoomZOffset=0,n.status=r.STATUS.PRELOAD,n.statusSignal=new i,n.onStarted=new i},{"../ui/constants":106,"min-signal":23,"quick-loader":45,three:59}],69:[function(e,t,n){"use strict";var r=e("mout/lang/isBoolean"),i=e("mout/lang/isInteger"),a=e("mout/queryString/parse")(window.location.href),o=e("./browser");for(var s in n.AUDIO_PATH="assets/audios/",n.MODEL_PATH="assets/models/",n.IMAGE_PATH="assets/images/",n.TEXTURE_PATH="assets/textures/",n.CUBEMAP_PATH="assets/cubeMap/",n.GLOBAL_ID="webglApi",n.canvas=null,n.gl=null,n.webglOpts={antialias:!1,alpha:!1,xrCompatible:!0},n.RENDER_TARGET_FLOAT_TYPE=null,n.DATA_FLOAT_TYPE=null,n.USE_FLOAT_PACKING=!1,n.USE_WEBGL2=!(o.isSafari||o.isIOS),n.DPR=Math.min(1.5,o.devicePixelRatio)||1,n.MAX_PIXEL_COUNT=3686400,n.CROSS_ORIGINS={},n.SKIP_ANIMATION=!1,n.SKIP_PRELOADER=!1,n.SKIP_ENDING=!1,n.LOOK_DEV_MODE=!1,n.DEFAULT_SCENE=0,a)if(void 0!==n[s]){var l=a[s];r(n[s])?n[s]=!(0==l):i(n[s])&&(n[s]=parseInt(l,10))}},{"./browser":67,"mout/lang/isBoolean":29,"mout/lang/isInteger":30,"mout/queryString/parse":43}],70:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.blur=v,n.blur9=function(e,t,n,r,i,a){v(m(),.25,e,t,n,r,i,a)},n.blur9RGBA=function(e,t,n,r,i,a){v(m(!0),.25,e,t,n,r,i,a)},n.getBlur9DepthMaterial=function(e,t){t=!!t;var n=(e=!!e)?t?o:l:t?s:u,i=d.MAX_VARYING_VECTORS>8;return n||(n=new p.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:r},u_delta:{type:"v2",value:new p.Vector2}},vertexShader:i?d.precisionPrefix+f(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_delta;\nvarying vec2 v_uv[9];\n\nvoid main() {\n    vec2 uv = position.xy * 0.5 + 0.5;\n\n    v_uv[0] = uv;\n\n    vec2 delta = u_delta;\n    v_uv[1] = uv - delta;\n    v_uv[2] = uv + delta;\n\n    delta += u_delta;\n    v_uv[3] = uv - delta;\n    v_uv[4] = uv + delta;\n\n    delta += u_delta;\n    v_uv[5] = uv - delta;\n    v_uv[6] = uv + delta;\n\n    delta += u_delta;\n    v_uv[7] = uv - delta;\n    v_uv[8] = uv + delta;\n\n    gl_Position = vec4( position, 1.0 );\n\n}\n"]):d.vertexShader,fragmentShader:d.precisionPrefix+f(i?["#define GLSLIFY 1\n#include <packing>\n\nuniform sampler2D u_texture;\nuniform float u_cameraFarSubNear;\nuniform float u_cameraNearMulFar;\nuniform float u_cameraNear;\nuniform float u_cameraFar;\n\nvarying vec2 v_uv[9];\n\n#if FROM_LINEAR\nfloat tap (vec2 uv) {\n    return unpackRGBAToDepth(texture2D(u_texture, uv));\n}\n#else\nfloat tap (vec2 uv) {\n    return u_cameraNearMulFar / (unpackRGBAToDepth(texture2D(u_texture, uv) * u_cameraFarSubNear - u_cameraFar);\n}\n#endif\n\n#if TO_LINEAR\nfloat encode (float depth) {\n    return packDepthToRGBA(depth);\n}\n#else\nfloat encode (float depth) {\n    return packDepthToRGBA((u_cameraNear + depth) * u_cameraFar) / (u_cameraFarSubNear * viewZ);\n}\n#endif\n\nvoid main() {\n        vec4 color = tap(v_uv[0]) * 0.1633;\n        color += tap( v_uv[1]) * 0.1531;\n        color += tap( v_uv[2]) * 0.1531;\n        color += tap( v_uv[3]) * 0.12245;\n        color += tap( v_uv[4]) * 0.12245;\n        color += tap( v_uv[5]) * 0.0918;\n        color += tap( v_uv[6]) * 0.0918;\n        color += tap( v_uv[7]) * 0.051;\n        color += tap( v_uv[8]) * 0.051;\n\n        gl_FragColor = encode(color);\n}\n"]:["#define GLSLIFY 1\n#include <packing>\n\nuniform sampler2D u_texture;\nuniform vec2 u_delta;\nuniform float u_cameraFarSubNear;\nuniform float u_cameraNearMulFar;\nuniform float u_cameraNear;\nuniform float u_cameraFar;\n\nvarying vec2 v_uv;\n\n#if FROM_LINEAR\nfloat tap (vec2 uv) {\n    return unpackRGBAToDepth(texture2D(u_texture, uv));\n}\n#else\nfloat tap (vec2 uv) {\n    return u_cameraNearMulFar / (unpackRGBAToDepth(texture2D(u_texture, uv) * u_cameraFarSubNear - u_cameraFar);\n}\n#endif\n\n#if TO_LINEAR\nfloat encode (float depth) {\n    return packDepthToRGBA(depth);\n}\n#else\nfloat encode (float depth) {\n    return packDepthToRGBA((u_cameraNear + depth) * u_cameraFar) / (u_cameraFarSubNear * viewZ);\n}\n#endif\n\nvoid main() {\n        vec4 color = tap(v_uv) * 0.1633;\n\n        vec2 delta = u_delta;\n        color += tap(v_uv - delta) * 0.1531;\n        color += tap(v_uv + delta) * 0.1531;\n\n        delta += u_delta;\n        color += tap(v_uv - delta) * 0.12245;\n        color += tap(v_uv + delta) * 0.12245;\n\n        delta += u_delta;\n        color += tap(v_uv - delta) * 0.0918;\n        color += tap(v_uv + delta) * 0.0918;\n\n        delta += u_delta;\n        color += tap(v_uv - delta) * 0.051;\n        color += tap(v_uv + delta) * 0.051;\n\n        gl_FragColor = encode(color);\n}\n"]),blending:p.NoBlending,transparent:!0,defines:{FROM_LINEAR:e,TO_LINEAR:t}})),e?t?o=n:l=n:t?s=n:u=n,n},n.getBlur9Material=m;var r,i,a,o,s,l,u,c,h,d=e("../../helpers/fboHelper"),p=e("three"),f=e("glslify");function m(e){var t=(e=!!e)?a:i,n=d.MAX_VARYING_VECTORS>8;return t||(t=new p.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:r},u_delta:{type:"v2",value:new p.Vector2}},vertexShader:n?d.precisionPrefix+f(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_delta;\nvarying vec2 v_uv[9];\n\nvoid main() {\n    vec2 uv = position.xy * 0.5 + 0.5;\n\n    v_uv[0] = uv;\n\n    vec2 delta = u_delta;\n    v_uv[1] = uv - delta;\n    v_uv[2] = uv + delta;\n\n    delta += u_delta;\n    v_uv[3] = uv - delta;\n    v_uv[4] = uv + delta;\n\n    delta += u_delta;\n    v_uv[5] = uv - delta;\n    v_uv[6] = uv + delta;\n\n    delta += u_delta;\n    v_uv[7] = uv - delta;\n    v_uv[8] = uv + delta;\n\n    gl_Position = vec4( position, 1.0 );\n\n}\n"]):d.vertexShader,fragmentShader:d.precisionPrefix+f(n?["#define GLSLIFY 1\nuniform sampler2D u_texture;\nvarying vec2 v_uv[9];\n\nvoid main() {\n\n    #ifdef USE_RGBA\n        vec4 color = texture2D( u_texture, v_uv[0] ) * 0.1633;\n        color += texture2D( u_texture,  v_uv[1] ) * 0.1531;\n        color += texture2D( u_texture,  v_uv[2] ) * 0.1531;\n        color += texture2D( u_texture,  v_uv[3] ) * 0.12245;\n        color += texture2D( u_texture,  v_uv[4] ) * 0.12245;\n        color += texture2D( u_texture,  v_uv[5] ) * 0.0918;\n        color += texture2D( u_texture,  v_uv[6] ) * 0.0918;\n        color += texture2D( u_texture,  v_uv[7] ) * 0.051;\n        color += texture2D( u_texture,  v_uv[8] ) * 0.051;\n\n        gl_FragColor = color;\n    #else\n        vec4 center = texture2D( u_texture, v_uv[0] );\n        vec3 color = center.rgb * 0.1633;\n        color += texture2D( u_texture,  v_uv[1] ).rgb * 0.1531;\n        color += texture2D( u_texture,  v_uv[2] ).rgb * 0.1531;\n        color += texture2D( u_texture,  v_uv[3] ).rgb * 0.12245;\n        color += texture2D( u_texture,  v_uv[4] ).rgb * 0.12245;\n        color += texture2D( u_texture,  v_uv[5] ).rgb * 0.0918;\n        color += texture2D( u_texture,  v_uv[6] ).rgb * 0.0918;\n        color += texture2D( u_texture,  v_uv[7] ).rgb * 0.051;\n        color += texture2D( u_texture,  v_uv[8] ).rgb * 0.051;\n\n        gl_FragColor = vec4(color, center.a);\n    #endif\n\n}\n"]:["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec2 u_delta;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\n    #ifdef USE_RGBA\n        vec4 color = texture2D( u_texture, v_uv ) * 0.1633;\n\n        vec2 delta = u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.1531;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.1531;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.12245;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.12245;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.0918;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.0918;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ) * 0.051;\n        color += texture2D( u_texture,  v_uv + delta ) * 0.051;\n\n        gl_FragColor = color;\n\n    #else\n        vec4 center = texture2D( u_texture, v_uv );\n        vec3 color = center.rgb * 0.1633;\n\n        vec2 delta = u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.1531;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.1531;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.12245;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.12245;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.0918;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.0918;\n\n        delta += u_delta;\n        color += texture2D( u_texture,  v_uv - delta ).rgb * 0.051;\n        color += texture2D( u_texture,  v_uv + delta ).rgb * 0.051;\n\n        gl_FragColor = vec4(color, center.a);\n\n    #endif\n\n}\n"]),blending:p.NoBlending,transparent:e,defines:{USE_RGBA:e}}),e?a=t:i=t),t}function v(e,t,n,r,i,a,o,s){var l=Math.ceil(i.width*r)||0,u=Math.ceil(i.height*r)||0;a||(e.transparent?(h||(h=d.createRenderTarget(1,1,!0)),a=h):(c||(c=d.createRenderTarget(1,1)),a=c)),a.setSize(l,u),o?s||o.setSize(i.width,i.height):o=i,e.uniforms.u_texture.value=i.texture||i,e.uniforms.u_delta.value.set(n/l*t,0),d.render(e,a),e.uniforms.u_texture.value=a.texture||a,e.uniforms.u_delta.value.set(0,n/u*t),d.render(e,o)}},{"../../helpers/fboHelper":72,glslify:21,three:59}],71:[function(e,t,n){"use strict";var r=e("three"),i=e("glslify"),a=e("../../utils/math"),o=e("../../helpers/fboHelper"),s=e("../../helpers/shaderHelper");(n=t.exports=function(e){this.tmpRenderTarget=o.createRenderTarget(1,1,!0),this.fixedMaxMipmapLevel=e||16,this.maxMipmapLevel=0,this.textureSize=new r.Vector2;var t=u+1;this.geometry=c(t),this.oddGeometry=c(t)}).init=function(){s.addChunk("lodMipmapSample",i(["#define GLSLIFY 1\nvec2 getMipUv (vec2 uv, float lod, vec2 textureSize, vec2 mipmapTextureSize) {\n\tfloat isNonZeroLod = step(0.5, lod);\n\tvec2 xy = vec2(\n\t\tisNonZeroLod * textureSize.x / mipmapTextureSize.x,\n\t\t1.0 - 1.0 / pow(2.0, max(0.0, lod - 1.0))\n\t);\n\tvec2 wh = (max(vec2(1.0), floor(textureSize / pow(2.0, lod))));\n\treturn xy + (0.5 + uv * (wh - 1.0)) / mipmapTextureSize;\n}\n\nvec2 getMipUv (vec2 uv, float lod, vec2 textureSize, vec2 mipmapTextureSize, out vec4 clampRect) {\n\tfloat isNonZeroLod = step(0.5, lod);\n\tvec2 xy = vec2(\n\t\tisNonZeroLod * textureSize.x / mipmapTextureSize.x,\n\t\t1.0 - 1.0 / pow(2.0, max(0.0, lod - 1.0))\n\t);\n\tvec2 wh = (max(vec2(1.0), floor(textureSize / pow(2.0, lod))));\n\tvec2 halfTexelSize = 0.5 / mipmapTextureSize;\n\n\tclampRect = vec4(\n\t\txy + halfTexelSize,\n\t\txy + wh / mipmapTextureSize - halfTexelSize\n\t);\n\t\n\treturn xy + (0.5 + uv * (wh - 1.0)) / mipmapTextureSize;\n}\n\nvec4 lodMipmapSampleNearestCubic (sampler2D tex, vec2 uv, float lod, vec2 textureSize, vec2 mipmapTextureSize) {\n\tvec4 clampRect;\n\tuv = getMipUv(uv, lod, textureSize, mipmapTextureSize, clampRect);\n\treturn textureBicubic(tex, uv, mipmapTextureSize, clampRect);\n}\n\nvec4 lodMipmapSampleNearest (sampler2D tex, vec2 uv, float lod, vec2 textureSize, vec2 mipmapTextureSize) {\n\treturn texture2D(tex, getMipUv(uv, lod, textureSize, mipmapTextureSize));\n}\n\nvec4 lodMipmapSampleCubic (sampler2D tex, vec2 uv, float lod, vec2 textureSize, vec2 mipmapTextureSize) {\n\tfloat lodFloor = floor(lod);\n\tfloat lodCeil = lodFloor + 1.0;\n\tfloat lodFract = lod - lodFloor;\n\n\tvec4 loClamp, hiClamp;\n\tvec2 loUv = getMipUv(uv, lodFloor, textureSize, mipmapTextureSize, loClamp);\n\tvec2 hiUv = getMipUv(uv, lodCeil, textureSize, mipmapTextureSize, hiClamp);\n\treturn mix(\n\t\ttextureBicubic(tex, loUv, mipmapTextureSize, loClamp),\n\t\ttextureBicubic(tex, hiUv, mipmapTextureSize, hiClamp),\n\t\tlodFract\n\t);\n}\n\nvec4 lodMipmapSample (sampler2D tex, vec2 uv, float lod, vec2 textureSize, vec2 mipmapTextureSize) {\n\tfloat lodFloor = floor(lod);\n\tfloat lodCeil = lodFloor + 1.0;\n\tfloat lodFract = lod - lodFloor;\n\treturn mix(\n\t\ttexture2D(tex, getMipUv(uv, lodFloor, textureSize, mipmapTextureSize)),\n\t\ttexture2D(tex, getMipUv(uv, lodCeil, textureSize, mipmapTextureSize)),\n\t\tlodFract\n\t);\n}\n"]))};var l=n.prototype;l.resize=function(e,t,n,r){var i=a.powerTwoFloorBase(t);this.maxMipmapLevel=Math.min(i,this.fixedMaxMipmapLevel),this.tmpRenderTarget.setSize(n,r),this.textureSize.set(n,r);for(var o=this.geometry.attributes.position.array,s=this.geometry.attributes.uv.array,l=0,u=0,c=i;u<c;u++){var h=(u>0?e:0)/n,d=(r-(r>>Math.max(0,u-1)))/r,p=Math.max(1,e>>u)/n,f=Math.max(1,t>>u)/r;s[l+0]=h,s[l+1]=d+f,s[l+2]=h,s[l+3]=d,s[l+4]=h+p,s[l+5]=d+f,s[l+6]=h+p,s[l+7]=d+f,s[l+8]=h,s[l+9]=d,s[l+10]=h+p,s[l+11]=d,l+=12}var m=this.oddGeometry.attributes.uv.array,v=this.oddGeometry.attributes.position.array;l=0;for(var g=0,y=0,x=0,_=0,b=i-1;_<b;_++)o[g+0]=2*s[l+12]-1,o[g+1]=2*s[l+13]-1,o[g+3]=2*s[l+14]-1,o[g+4]=2*s[l+15]-1,o[g+6]=2*s[l+16]-1,o[g+7]=2*s[l+17]-1,o[g+9]=2*s[l+18]-1,o[g+10]=2*s[l+19]-1,o[g+12]=2*s[l+20]-1,o[g+13]=2*s[l+21]-1,o[g+15]=2*s[l+22]-1,o[g+16]=2*s[l+23]-1,(_+1)%2&&(v[x+0]=2*(m[y+0]=s[l+12])-1,v[x+1]=2*(m[y+1]=s[l+13])-1,v[x+3]=2*(m[y+2]=s[l+14])-1,v[x+4]=2*(m[y+3]=s[l+15])-1,v[x+6]=2*(m[y+4]=s[l+16])-1,v[x+7]=2*(m[y+5]=s[l+17])-1,v[x+9]=2*(m[y+6]=s[l+18])-1,v[x+10]=2*(m[y+7]=s[l+19])-1,v[x+12]=2*(m[y+8]=s[l+20])-1,v[x+13]=2*(m[y+9]=s[l+21])-1,v[x+15]=2*(m[y+10]=s[l+22])-1,v[x+16]=2*(m[y+11]=s[l+23])-1,y+=12,x+=18),l+=12,g+=18;this.geometry.attributes.uv.needsUpdate=!0,this.geometry.attributes.position.needsUpdate=!0,this.oddGeometry.attributes.uv.needsUpdate=!0,this.oddGeometry.attributes.position.needsUpdate=!0},l.render=function(e){var t=o.getColorState(),n=o.uvCopyMaterial;this.textureSize.x==e.width&&this.textureSize.y==e.height||(e.setSize(e.width,e.height),this.resize(Math.round(e.width/3*2),e.height,e.width,e.height)),o.renderer.autoClear=!1;for(var r=e,i=this.tmpRenderTarget,a=0,s=0,l=this.maxMipmapLevel-1;s<l;s++){n.uniforms.u_texture.value=r.texture,this.geometry.drawRange.start=6*s,this.geometry.drawRange.count=6,o.renderGeometry(this.geometry,n,i),i===this.tmpRenderTarget&&a++;var u=i;i=r,r=u}this.oddGeometry.drawRange.start=0,this.oddGeometry.drawRange.count=6*a,n.uniforms.u_texture.value=this.tmpRenderTarget.texture,o.renderGeometry(this.oddGeometry,n,e),o.setColorState(t)};var u=14;function c(e){var t=new Float32Array(6*e*2),n=new Float32Array(6*e*3),i=new r.BufferGeometry;return i.setAttribute("position",new r.BufferAttribute(n,3)),i.setAttribute("uv",new r.BufferAttribute(t,2)),i}},{"../../helpers/fboHelper":72,"../../helpers/shaderHelper":73,"../../utils/math":115,glslify:21,three:59}],72:[function(e,t,n){"use strict";var r=e("three"),i=e("glslify");n.init=function(e,t){l=n.renderer=e,n.floatType=t,n.scene=new r.Scene,n.camera=new r.Camera,n.camera.position.z=1,(u=n.triGeom=new r.BufferGeometry).setAttribute("position",new r.BufferAttribute(new Float32Array([-1,-1,0,4,-1,0,-1,4,0]),3)),n.quadGeom=new r.PlaneBufferGeometry(2,2),n.tri=new r.Mesh(u),n.tri.frustumCulled=!1,n.scene.add(n.tri);var c=n.precisionPrefix="precision "+l.capabilities.precision+" float;\n",h=n.precisionPrefix2="#version 300 es\nprecision "+l.capabilities.precision+" float;\nprecision "+l.capabilities.precision+" int;\n#define IS_WEBGL2 true\n";n.vertexShader=c+i(["#define GLSLIFY 1\nattribute vec3 position;\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = position.xy * 0.5 + 0.5;\n    gl_Position = vec4(position, 1.0 );\n}\n"]),n.prefixES100Vertex=[h,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n",n.prefixES100Fragment=[h,"#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n",l.getContext().getExtension("OES_standard_derivatives"),n.copyMaterial=new r.RawShaderMaterial({uniforms:{u_texture:{value:null}},vertexShader:n.vertexShader,fragmentShader:c+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending}),n.uvCopyMaterial=new r.RawShaderMaterial({uniforms:{u_texture:{value:null}},vertexShader:c+i(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n    gl_Position = vec4(position, 1.0 );\n}\n"]),fragmentShader:c+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending}),n.clearMaterial=new r.RawShaderMaterial({uniforms:{u_color:{value:new r.Vector4(1,1,1,1)}},vertexShader:n.vertexShader,fragmentShader:c+i(["#define GLSLIFY 1\nuniform vec4 u_color;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = u_color;\n}\n"]),depthTest:!1,depthWrite:!1,transparent:!0,blending:r.NoBlending}),a=new r.Scene;var d=new r.PlaneBufferGeometry(1,1);d.translate(.5,-.5,0),s=new r.RawShaderMaterial({uniforms:{u_texture:{value:null},u_transform:{value:new r.Vector4(0,0,1,1)}},vertexShader:c+i(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform vec4 u_transform;\n\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n    gl_Position = vec4( position.xy * u_transform.zw + u_transform.xy, 0.0, 1.0 );\n}\n"]),fragmentShader:c+i(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n"]),depthTest:!1,depthWrite:!1,blending:r.NoBlending}),o=new r.Mesh(d,s),a.frustumCulled=!1,a.add(o)},n.copy=function(e,t){var r=n.copyMaterial;r.uniforms.u_texture.value=e,c(r,t)},n.uvCopy=function(e,t){var r=n.uvCopyMaterial;r.uniforms.u_texture.value=e,c(r,t)},n.render=c,n.renderGeometry=function(e,t,r){n.tri.geometry=e,c(t,r),n.tri.geometry=u},n.renderMesh=function(e,t){n.tri.visible=!1,n.scene.add(e),t&&l.setRenderTarget(t||null),l.render(n.scene,n.camera),t&&l.setRenderTarget(null),n.scene.remove(e),n.tri.visible=!0},n.debugTo=function(e,t,i,o,u){t=t||200,i=i||200,o=o||0,u=u||0;var c=l.getSize(new r.Vector2);o=o/c.width*2-1,u=1-u/c.height*2,t=t/c.width*2,i=i/c.height*2,s.uniforms.u_texture.value=e,s.uniforms.u_transform.value.set(o,u,t,i);var p=h();l.autoClearColor=!1,l.setRenderTarget(null),l.render(a,n.camera),d(p)},n.clearColor=function(e,t,i,a,o){var s=n.clearMaterial;s.uniforms.u_color.value.set(e,t,i,a),s.transparent=a<1,s.blending=a<1?r.NormalBlending:r.NoBlending,c(n.clearMaterial,o),s.transparent=!1,s.blending=r.NoBlending},n.getColorState=h,n.setColorState=d,n.createRenderTarget=p,n.createMultisampleRenderTarget=function(e,t,i,a,o){return l.capabilities.isWebGL2?new r.WebGLMultisampleRenderTarget(e,t,{wrapS:r.ClampToEdgeWrapping,wrapT:r.ClampToEdgeWrapping,magFilter:a?r.NearestFilter:r.LinearFilter,minFilter:a?r.NearestFilter:r.LinearFilter,format:i?r.RGBAFormat:r.RGBFormat,type:o?n.floatType:r.UnsignedByteType,anisotropy:0,encoding:r.LinearEncoding,depthBuffer:!1,stencilBuffer:!1}):p(e,t,i,a,o)},n.clearMultisampleRenderTargetState=function(){var e=l.getRenderTarget();if(e&&e.isWebGLMultisampleRenderTarget){var t=l.properties.get(e),n=l.getContext();n.bindFramebuffer(n.READ_FRAMEBUFFER,t.__webglMultisampledFramebuffer),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,t.__webglFramebuffer);var r=e.width,i=e.height,a=n.COLOR_BUFFER_BIT;e.depthBuffer&&(a|=n.DEPTH_BUFFER_BIT),e.stencilBuffer&&(a|=n.STENCIL_BUFFER_BIT),n.blitFramebuffer(0,0,r,i,0,0,r,i,a,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,t.__webglMultisampledFramebuffer)}};var a,o,s,l=n.renderer=null,u=(n.quadGeom=null,n.triGeom=null);function c(e,t){n.tri.material=e,t&&l.setRenderTarget(t),l.render(n.scene,n.camera),t&&l.setRenderTarget(null)}function h(){return{autoClear:l.autoClear,autoClearColor:l.autoClearColor,autoClearStencil:l.autoClearStencil,autoClearDepth:l.autoClearDepth,clearColor:l.getClearColor().getHex(),clearAlpha:l.getClearAlpha()}}function d(e){l.setClearColor(e.clearColor,e.clearAlpha),l.autoClear=e.autoClear,l.autoClearColor=e.autoClearColor,l.autoClearStencil=e.autoClearStencil,l.autoClearDepth=e.autoClearDepth}function p(e,t,i,a,o){return new r.WebGLRenderTarget(e,t,{wrapS:r.ClampToEdgeWrapping,wrapT:r.ClampToEdgeWrapping,magFilter:a?r.NearestFilter:r.LinearFilter,minFilter:a?r.NearestFilter:r.LinearFilter,format:i?r.RGBAFormat:r.RGBFormat,type:o?n.floatType:r.UnsignedByteType,anisotropy:0,encoding:r.LinearEncoding,depthBuffer:!1,stencilBuffer:!1})}n.tri=null,n.scene=null,n.camera=null,n.clearMaterial=null,n.floatType=null,n.precisionPrefix="",n.precisionPrefix2="",n.vertexShader=""},{glslify:21,three:59}],73:[function(e,t,n){"use strict";var r=e("three");function i(e){return e.replace(/#define\sGLSLIFY\s./,"")}function a(e){return"#include <"+e+">"}n.glslifyStrip=i,n.addChunk=function(e,t){r.ShaderChunk[e]=i(t)},n.insertBefore=function(e,t,n,r){return r&&(t=a(t)),e.replace(t,i(n)+"\n"+t)},n.insertAfter=function(e,t,n,r){return r&&(t=a(t)),e.replace(t,t+"\n"+i(n)+"\n")},n.replace=function(e,t,n,r){return r&&(t=a(t)),e.replace(t,"\n"+i(n)+"\n")}},{three:59}],74:[function(e,t,n){"use strict";var r=e("three");function i(e){new r.DataTexture(new Uint8Array(e)).format=r.RGBAFormat}n.init=function(){n.blackTexture=i([0,0,0,1]),n.whiteTexture=i([1,1,1,1]),n.transparentTexture=i([0,0,0,0])},n.blackTexture=null,n.whiteTexture=null,n.transparentTexture=null},{three:59}],75:[function(e,t,n){"use strict";var r,i,a,o,s=e("@babel/runtime/helpers/interopRequireDefault")(e("./ui/ui")),l=e("./core/browser"),u=e("./core/settings"),c=e("./core/properties"),h=e("./helpers/fboHelper"),d=e("./helpers/textureHelper"),p=e("./helpers/shaderHelper"),f=e("./post/Postprocessing"),m=e("./post/smaa/Smaa"),v=e("./post/bloom/Bloom"),g=e("./post/bokeh/Bokeh"),y=e("./post/final/Final"),x=e("./audios/audios"),_=e("./scenes/scenes"),b=e("./utils/math"),w=e("./utils/ease"),M=e("./controls/cameraControls"),S=e("./input/input"),T=e("./visuals/visuals"),E=e("three"),A=e("glslify"),C=e("mout/object/mixIn"),L=e("./effects/mipmapper/Mipmapper"),R=e("./loaders/BufItem"),P=e("./loaders/TextureItem");window[u.GLOBAL_ID]=t.exports=n=u;var D=+new Date/1e3,I=!1;function O(e){C(u,e),u.USE_WEBGL2||m.updateTextures(),x.init(),_.init(),M.init(),s.default.init(),T.init(),i.add(T.container),c.hasInitialized=!0,z(c.rawWidth,c.rawHeight),_.start(),function(){if(u.LOOK_DEV_MODE&&window.dat){var e=new dat.GUI,t=e.addFolder("bloom");t.add(c,"bloomAmount",0,5,1e-5).listen(),t.add(c,"bloomRadius",-1,1,1e-5).listen(),t.add(c,"bloomThreshold",0,1,1e-5).listen(),t.add(c,"bloomSmoothWidth",0,2,1e-5).listen(),t.add(c,"haloWidth",0,2,1e-5).listen(),t.add(c,"haloRGBShift",0,.2,1e-5).listen(),t.add(c,"haloStrength",0,3,1e-5).listen(),t.add(c,"haloMaskInner",0,1,1e-5).listen(),t.add(c,"haloMaskOuter",0,1,1e-5).listen(),t.open();var n=e.addFolder("color");n.add(c,"vignetteFrom",0,3,1e-5).listen(),n.add(c,"vignetteTo",0,3,1e-5).listen(),n.addColor(c,"vignetteColorHex").listen(),n.add(c,"saturation",0,3,1e-5).listen(),n.add(c,"contrast",-1,3,1e-5).listen(),n.add(c,"brightness",0,2,1e-5).listen(),n.addColor(c,"tintColorHex").listen(),n.add(c,"tintOpacity",0,1,1e-5).listen(),n.open();var r=e.addFolder("bokeh");r.add(c,"bokehFNumber",1e-4,1,1e-5).listen(),r.add(c,"bokehFocusDistance",0,20,1e-5).listen(),r.add(c,"bokehFocalLength",0,3,1e-5).listen(),r.add(c,"bokehKFilmHeight",1e-5,90,1e-5).listen(),r.add(c.bokeh,"quality",0,3,1).listen(),r.open()}}()}function z(e,t){if(c.isStageReady){var n=u.DPR,i=e*n,l=t*n;if(i*l>u.MAX_PIXEL_COUNT){var h=i/l;l=Math.sqrt(u.MAX_PIXEL_COUNT/h),i=Math.ceil(l*h),l=Math.ceil(l),c.final.useBicubicOut=!0}else c.final.useBicubicOut=!1;c.rawWidth=e,c.rawHeight=t,c.width=i,c.height=l,c.resolution.set(i,l),a.aspect=i/l,a.updateProjectionMatrix(),r.setSize(i,l),o.setSize(i,l),u.canvas.style.width=e+"px",u.canvas.style.height=t+"px",s.default.resize(e,t),T.resize(i,l)}}function k(){z(window.innerWidth,window.innerHeight)}function F(){var e,t;requestAnimationFrame(F),t=(e=+new Date/1e3)-D,D=e,c.isStageReady&&(c.dt=t,c.time+=t,c.cameraLookX+=(S.mouseXY.y*c.cameraLookStrength-c.cameraLookX)*c.cameraLookEaseDamp,c.cameraLookY+=(-S.mouseXY.x*c.cameraLookStrength-c.cameraLookY)*c.cameraLookEaseDamp,_.update(t),s.default.update(t),c.sharedUniforms.u_time.value=c.time,c.sharedUniforms.u_timeScale.value=t,c.bgColor.setStyle(c.bgColorHex),r.setClearColor(c.bgColor,1),M.update(t),c.hasInitialized&&T.update(t),c.bloom.amount=c.bloomAmount,c.bloom.radius=c.bloomRadius,c.bloom.threshold=c.bloomThreshold,c.bloom.smoothWidth=c.bloomSmoothWidth,c.bloom.haloWidth=.03*Math.cos(c.time)+c.haloWidth,c.bloom.haloRGBShift=c.haloRGBShift,c.bloom.haloStrength=c.haloStrength,c.bloom.haloMaskInner=c.haloMaskInner,c.bloom.haloMaskOuter=c.haloMaskOuter,c.final.vignetteFrom=c.vignetteFrom,c.final.vignetteTo=c.vignetteTo,c.final.vignetteColor.setStyle(c.vignetteColorHex),c.final.saturation=c.saturation,c.final.contrast=c.contrast,c.final.brightness=c.brightness,c.final.tintColor.setStyle(c.tintColorHex),c.final.tintOpacity=c.tintOpacity,c.final.bgColor.setStyle(c.bgColorHex),c.final.opacity=c.opacity,c.final.blurRatio=1-c.opacity,c.final.borderSize.set(c.borderSize,c.borderSize),c.final.borderNoiseScale=c.borderNoiseScale,c.final.borderNoiseSpeed=c.borderNoiseSpeed,c.final.borderNoiseIntensity=c.borderNoiseIntensity,c.final.maskInRatio=b.fit(c.introRatio,0,.5,0,1),c.bokeh.enabled=c.bokehEnabled,c.bokeh.fNumber=c.bokehFNumber,c.bokeh.focusDistance=c.bokehFocusDistance+c.cameraDollyZoomZOffset,c.bokeh.focalLength=c.bokehFocalLength,c.bokeh.kFilmHeight=c.bokehKFilmHeight,c.final.maskRatio=Math.round(1e4*b.fit(c.introRatio,.5,1,1,0,w.easeInSine))/1e4,(!s.default.about._isActive&&c.introRatio>0||c.hasInitialized&&!I)&&(I=!0,o.render(i,a,!0)),window.__debugTexture&&h.debugTo(window.__debugTexture,1536,512),x.update(t),S.update(t))}(function(e){if(u.canvas=e,u.USE_WEBGL2&&window.WebGL2RenderingContext)try{return u.gl=e.getContext("webgl2",u.webglOpts),u.RENDER_TARGET_FLOAT_TYPE=E.FloatType,u.DATA_FLOAT_TYPE=E.FloatType,!0}catch(e){}if(u.USE_WEBGL2=!1,window.WebGLRenderingContext)try{var t=u.gl=e.getContext("webgl",u.webglOpts)||e.getContext("experimental-webgl",u.webglOpts);return(t.getExtension("OES_texture_float")||t.getExtension("OES_texture_half_float"))&&t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(u.RENDER_TARGET_FLOAT_TYPE=l.isIOS||!t.getExtension("OES_texture_float")?E.HalfFloatType:E.FloatType,u.DATA_FLOAT_TYPE=E.FloatType):(u.USE_FLOAT_PACKING=!0,u.RENDER_TARGET_FLOAT_TYPE=u.DATA_FLOAT_TYPE=E.UnsignedByteType),!0}catch(e){return!1}return!1})(document.getElementById("app"))&&function(){document.documentElement.classList.add("is-"+(l.isMobile?"mobile":"desktop"));for(var e=0;e<u.CROSS_ORIGINS.length;e++){var t=u.CROSS_ORIGINS[e];n.loader.setCrossOrigin(t.baseUrl,t.value)}c.loader.register(R),c.loader.register(P),r=c.renderer=new E.WebGLRenderer({canvas:u.canvas,context:u.gl}),p.addChunk("textureBicubic",A(["#define GLSLIFY 1\nvec4 cubic(float v) {\n    vec4 n = vec4(1.0, 2.0, 3.0, 4.0) - v;\n    vec4 s = n * n * n;\n    float x = s.x;\n    float y = s.y - 4.0 * s.x;\n    float z = s.z - 4.0 * s.y + 6.0 * s.x;\n    float w = 6.0 - x - y - z;\n    return vec4(x, y, z, w);\n}\n\n// https://stackoverflow.com/questions/13501081/efficient-bicubic-filtering-code-in-glsl\nvec4 textureBicubic(sampler2D t, vec2 texCoords, vec2 textureSize) {\n   vec2 invTexSize = 1.0 / textureSize;\n   texCoords = texCoords * textureSize - 0.5;\n\n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2 (-0.5, 1.5).xyxy;\n\n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4 (xcubic.yw, ycubic.yw) / s;\n\n    offset *= invTexSize.xxyy;\n\n    vec4 sample0 = texture2D(t, offset.xz);\n    vec4 sample1 = texture2D(t, offset.yz);\n    vec4 sample2 = texture2D(t, offset.xw);\n    vec4 sample3 = texture2D(t, offset.yw);\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(\n       mix(sample3, sample2, sx), mix(sample1, sample0, sx)\n    , sy);\n}\n\nvec4 textureBicubic(sampler2D t, vec2 texCoords, vec2 textureSize, vec4 clampRect) {\n   vec2 invTexSize = 1.0 / textureSize;\n   texCoords = texCoords * textureSize - 0.5;\n\n    vec2 fxy = fract(texCoords);\n    texCoords -= fxy;\n    vec4 xcubic = cubic(fxy.x);\n    vec4 ycubic = cubic(fxy.y);\n\n    vec4 c = texCoords.xxyy + vec2 (-0.5, 1.5).xyxy;\n\n    vec4 s = vec4(xcubic.xz + xcubic.yw, ycubic.xz + ycubic.yw);\n    vec4 offset = c + vec4 (xcubic.yw, ycubic.yw) / s;\n\n    offset *= invTexSize.xxyy;\n\n    vec4 sample0 = texture2D(t, clamp(offset.xz, clampRect.xy, clampRect.zw));\n    vec4 sample1 = texture2D(t, clamp(offset.yz, clampRect.xy, clampRect.zw));\n    vec4 sample2 = texture2D(t, clamp(offset.xw, clampRect.xy, clampRect.zw));\n    vec4 sample3 = texture2D(t, clamp(offset.yw, clampRect.xy, clampRect.zw));\n\n    float sx = s.x / (s.x + s.y);\n    float sy = s.z / (s.z + s.w);\n\n    return mix(\n       mix(sample3, sample2, sx), mix(sample1, sample0, sx)\n    , sy);\n}"])),i=c.scene=new E.Scene,a=c.camera=new E.PerspectiveCamera(30,1,.05,20),i.add(a),c.sharedUniforms.u_resolution.value=c.resolution=new E.Vector2,c.sharedUniforms.u_bgColor.value=c.bgColor=new E.Color,h.init(r,u.RENDER_TARGET_FLOAT_TYPE),d.init(),o=c.postprocessing=new f(!0),L.init(),c.bokeh=new g({quality:l.isMobile?0:1}),o.useDepthTexture&&o.queue.push(c.bokeh),r.capabilities.isWebGL2||(m.setTextures(c.loader.add(u.TEXTURE_PATH+"smaa-area.png",{weight:32}).content,c.loader.add(u.TEXTURE_PATH+"smaa-search.png",{weight:.1}).content),o.queue.push(c.smaa=new m)),o.queue.push(c.bloom=new v),o.queue.push(c.final=new y({maskTexture:c.loader.add(u.TEXTURE_PATH+"mask.webp",{type:"texture"}).content})),c.isStageReady=!0,x.preInit(),_.preInit(),S.init(document.body,u.canvas),M.preInit(),T.preInit(),s.default.preInit(O),window.addEventListener("resize",k),k(),F()}()},{"./audios/audios":62,"./controls/cameraControls":66,"./core/browser":67,"./core/properties":68,"./core/settings":69,"./effects/mipmapper/Mipmapper":71,"./helpers/fboHelper":72,"./helpers/shaderHelper":73,"./helpers/textureHelper":74,"./input/input":76,"./loaders/BufItem":80,"./loaders/TextureItem":81,"./post/Postprocessing":84,"./post/bloom/Bloom":85,"./post/bokeh/Bokeh":86,"./post/final/Final":87,"./post/smaa/Smaa":88,"./scenes/scenes":96,"./ui/ui":112,"./utils/ease":114,"./utils/math":115,"./visuals/visuals":127,"@babel/runtime/helpers/interopRequireDefault":10,glslify:21,"mout/object/mixIn":40,three:59}],76:[function(e,t,n){"use strict";var r=e("three"),i=e("min-signal");n.init=function(){var e=document;e.addEventListener("mousedown",s),e.addEventListener("touchstart",c(s,!0)),e.addEventListener("mousemove",l),e.addEventListener("touchmove",c(l,!0)),e.addEventListener("mouseup",u),e.addEventListener("touchend",c(u,!0)),e.addEventListener("mousewheel",o,!0),e.addEventListener("DOMMouseScroll",o,!0)},n.update=function(e){n.prevThroughElems.length=0,n.prevThroughElems.concat(n.currThroughElems),n.wheelDelta=0,n.prevMousePixelXY.copy(n.mousePixelXY)},n.hasThroughElem=function(e,t){for(var r=n[t+"ThroughElems"]||n.currThroughElems,i=r.length;i--;)if(r[i]===e)return!0;return!1},n.hasThroughElemWithClass=function(e,t){for(var r=n[t+"ThroughElems"]||n.currThroughElems,i=r.length;i--;)if(r[i].classList.contains(e))return r[i];return null},n.onDowned=new i,n.onMoved=new i,n.onUped=new i,n.onClicked=new i,n.onWheeled=new i,n.wasDown=!1,n.isDown=!0,n.downTime=0,n.downXY=new r.Vector2,n.downPixelXY=new r.Vector2,n.hasClicked=!1,n.mouseXY=new r.Vector2,n.mousePixelXY=new r.Vector2,n.prevMousePixelXY=new r.Vector2,n.wheelDelta=0,n.downThroughElems=[],n.currThroughElems=[],n.prevThroughElems=[],n.clickThroughElems=[];var a=0;function o(e){var t=+new Date;if(!(t-a<35)){a=t;var r=(e=e||_win.event).wheelDelta;r?r/=40:r=-e.detail,n.wheelDelta+=Math.min(3,Math.max(r,-3)),n.onWheeled.dispatch(e.target,n.wheelDelta)}}function s(e){n.isDown=!0,n.downTime=+new Date,n.prevThroughElems.length=0,p(e,n.downThroughElems),h(e,n.downXY),d(e,n.downPixelXY),n.onDowned.dispatch(e),l(e)}function l(e){h(e,n.mouseXY),d(e,n.mousePixelXY),p(e,n.currThroughElems),n.onMoved.dispatch(e)}function u(e){var t=e.clientX-n.downPixelXY.x,r=e.clientY-n.downPixelXY.y;Math.sqrt(t*t+r*r)<40&&+new Date-n.downTime<300&&(p(e,n.clickThroughElems),h(e,n.mouseXY),n.hasClicked=!0,n.onClicked.dispatch(e)),n.isDown=!1,n.onUped.dispatch(e)}function c(e,t){return function(n){t&&n.usePrevtDefault&&event.usePreventDefault(),e.call(this,n.changedTouches[0]||n.touches[0])}}function h(e,t){return t.set(e.clientX/window.innerWidth*2-1,1-e.clientY/window.innerHeight*2),t}function d(e,t){t.set(e.clientX,e.clientY)}function p(e,t){var n=e.target;for(t.length=0;n.parentNode;)t.push(n),n=n.parentNode}},{"min-signal":23,three:59}],77:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CustomEase=void 0;var r,i=e("./utils/paths.js"),a=e("gsap"),o=function(){a.gsap?(a.gsap.registerEase("_CE",h.create),r=1):console.warn("Please gsap.registerPlugin(CustomEase)")},s=function(e){return~~(1e3*e+(e<0?-.5:.5))/1e3},l=/[-+=\.]*\d+[\.e\-\+]*\d*[e\-\+]*\d*/gi,u=/[cLlsSaAhHvVtTqQ]/g,c=function e(t,n,r,i,a,o,s,l,u,c,h){var d,p=(t+r)/2,f=(n+i)/2,m=(r+a)/2,v=(i+o)/2,g=(a+s)/2,y=(o+l)/2,x=(p+m)/2,_=(f+v)/2,b=(m+g)/2,w=(v+y)/2,M=(x+b)/2,S=(_+w)/2,T=s-t,E=l-n,A=Math.abs((r-s)*E-(i-l)*T),C=Math.abs((a-s)*E-(o-l)*T);return c||(c=[{x:t,y:n},{x:s,y:l}],h=1),c.splice(h||c.length-1,0,{x:M,y:S}),(A+C)*(A+C)>u*(T*T+E*E)&&(d=c.length,e(t,n,p,f,x,_,M,S,u,c,h),e(M,S,b,w,g,y,s,l,u,c,h+1+(c.length-d))),c},h=function(){function e(e,t,n){r||o(),this.id=e,this.setData(t,n)}var t=e.prototype;return t.setData=function(e,t){t=t||{};var n,r,o,s,h,d,p,f,m,v=(e=e||"0,0,1,1").match(l),g=1,y=[],x=[],_=t.precision||1,b=_<=1;if(this.data=e,(u.test(e)||~e.indexOf("M")&&e.indexOf("C")<0)&&(v=(0,i.stringToRawPath)(e)[0]),4===(n=v.length))v.unshift(0,0),v.push(1,1),n=8;else if((n-2)%6)throw"Invalid CustomEase";for(0==+v[0]&&1==+v[n-2]||function(e,t,n){n||0===n||(n=Math.max(+e[e.length-1],+e[1]));var r,i=-1*+e[0],a=-n,o=e.length,s=1/(+e[o-2]+i),l=-t||(Math.abs(+e[o-1]-+e[1])<.01*(+e[o-2]-+e[0])?function(e){var t,n=e.length,r=1e20;for(t=1;t<n;t+=6)+e[t]<r&&(r=+e[t]);return r}(e)+a:+e[o-1]+a);for(l=l?1/l:-s,r=0;r<o;r+=2)e[r]=(+e[r]+i)*s,e[r+1]=(+e[r+1]+a)*l}(v,t.height,t.originY),this.segment=v,s=2;s<n;s+=6)r={x:+v[s-2],y:+v[s-1]},o={x:+v[s+4],y:+v[s+5]},y.push(r,o),c(r.x,r.y,+v[s],+v[s+1],+v[s+2],+v[s+3],o.x,o.y,1/(2e5*_),y,y.length-1);for(n=y.length,s=0;s<n;s++)p=y[s],f=y[s-1]||p,(p.x>f.x||f.y!==p.y&&f.x===p.x||p===f)&&p.x<=1?(f.cx=p.x-f.x,f.cy=p.y-f.y,f.n=p,f.nx=p.x,b&&s>1&&Math.abs(f.cy/f.cx-y[s-2].cy/y[s-2].cx)>2&&(b=0),f.cx<g&&(f.cx?g=f.cx:(f.cx=.001,s===n-1&&(f.x-=.001,g=Math.min(g,.001),b=0)))):(y.splice(s--,1),n--);if(h=1/(n=1/g+1|0),d=0,p=y[0],b){for(s=0;s<n;s++)m=s*h,p.nx<m&&(p=y[++d]),r=p.y+(m-p.x)/p.cx*p.cy,x[s]={x:m,cx:h,y:r,cy:0,nx:9},s&&(x[s-1].cy=r-x[s-1].y);x[n-1].cy=y[y.length-1].y-r}else{for(s=0;s<n;s++)p.nx<s*h&&(p=y[++d]),x[s]=p;d<y.length-1&&(x[s-1]=y[y.length-2])}return this.ease=function(e){var t=x[e*n|0]||x[n-1];return t.nx<e&&(t=t.n),t.y+(e-t.x)/t.cx*t.cy},this.ease.custom=this,this.id&&a.gsap.registerEase(this.id,this.ease),this},t.getSVGData=function(t){return e.getSVGData(this,t)},e.create=function(t,n,r){return new e(t,n,r).ease},e.register=function(e){o()},e.get=function(e){return a.gsap.parseEase(e)},e.getSVGData=function(t,n){var r,o,l,u,c,h,d,p,f,m,v=(n=n||{}).width||100,g=n.height||100,y=n.x||0,x=(n.y||0)+g,_=a.gsap.utils.toArray(n.path)[0];if(n.invert&&(g=-g,x=0),"string"==typeof t&&(t=a.gsap.parseEase(t)),t.custom&&(t=t.custom),t instanceof e)r=(0,i.rawPathToString)((0,i.transformRawPath)([t.segment],v,0,0,-g,y,x));else{for(r=[y,x],u=1/(d=Math.max(5,200*(n.precision||1))),p=5/(d+=2),f=s(y+u*v),o=((m=s(x+t(u)*-g))-x)/(f-y),l=2;l<d;l++)c=s(y+l*u*v),h=s(x+t(l*u)*-g),(Math.abs((h-m)/(c-f)-o)>p||l===d-1)&&(r.push(f,m),o=(h-m)/(c-f)),f=c,m=h;r="M"+r.join(",")}return _&&_.setAttribute("d",r),r},e}();n.default=n.CustomEase=h,a.gsap.registerPlugin(h),h.version="3.6.1"},{"./utils/paths.js":78,gsap:22}],78:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bezierToPoints=function e(t,n,r,i,a,o,s,l,u,c,h){var p,f=(t+r)/2,m=(n+i)/2,v=(r+a)/2,g=(i+o)/2,y=(a+s)/2,x=(o+l)/2,_=(f+v)/2,b=(m+g)/2,w=(v+y)/2,M=(g+x)/2,S=(_+w)/2,T=(b+M)/2,E=s-t,A=l-n,C=d((r-s)*A-(i-l)*E),L=d((a-s)*A-(o-l)*E);return c||(c=[t,n,s,l],h=2),c.splice(h||c.length-2,0,S,T),(C+L)*(C+L)>u*(E*E+A*A)&&(p=c.length,e(t,n,f,m,_,b,S,T,u,c,h),e(S,T,w,M,y,x,s,l,u,c,h+2+(c.length-p))),c},n.cacheRawPathMeasurements=D,n.convertToPath=function(e,t){var n,r,i,o,s,l,u,c,h,d,p,f,m,v,g,y,x,_,b,w,M,S,T=e.tagName.toLowerCase(),E=.552284749831;return"path"!==T&&e.getBBox?(l=function(e,t){var n,r=document.createElementNS("http://www.w3.org/2000/svg","path"),i=[].slice.call(e.attributes),a=i.length;for(t=","+t+",";--a>-1;)n=i[a].nodeName.toLowerCase(),t.indexOf(","+n+",")<0&&r.setAttributeNS(null,n,i[a].nodeValue);return r}(e,"x,y,width,height,cx,cy,rx,ry,r,x1,x2,y1,y2,points"),S=function(e,t){for(var n=t?t.split(","):[],r={},i=n.length;--i>-1;)r[n[i]]=+e.getAttribute(n[i])||0;return r}(e,L[T]),"rect"===T?(o=S.rx,s=S.ry||o,r=S.x,i=S.y,d=S.width-2*o,p=S.height-2*s,n=o||s?"M"+(y=(v=(m=r+o)+d)+o)+","+(_=i+s)+" V"+(b=_+p)+" C"+[y,w=b+s*E,g=v+o*E,M=b+s,v,M,v-(v-m)/3,M,m+(v-m)/3,M,m,M,f=r+o*(1-E),M,r,w,r,b,r,b-(b-_)/3,r,_+(b-_)/3,r,_,r,x=i+s*(1-E),f,i,m,i,m+(v-m)/3,i,v-(v-m)/3,i,v,i,g,i,y,x,y,_].join(",")+"z":"M"+(r+d)+","+i+" v"+p+" h"+-d+" v"+-p+" h"+d+"z"):"circle"===T||"ellipse"===T?("circle"===T?c=(o=s=S.r)*E:(o=S.rx,c=(s=S.ry)*E),n="M"+((r=S.cx)+o)+","+(i=S.cy)+" C"+[r+o,i+c,r+(u=o*E),i+s,r,i+s,r-u,i+s,r-o,i+c,r-o,i,r-o,i-c,r-u,i-s,r,i-s,r+u,i-s,r+o,i-c,r+o,i].join(",")+"z"):"line"===T?n="M"+S.x1+","+S.y1+" L"+S.x2+","+S.y2:"polyline"!==T&&"polygon"!==T||(n="M"+(r=(h=(e.getAttribute("points")+"").match(a)||[]).shift())+","+(i=h.shift())+" L"+h.join(","),"polygon"===T&&(n+=","+r+","+i+"z")),l.setAttribute("d",B(l._gsRawPath=k(n))),t&&e.parentNode&&(e.parentNode.insertBefore(l,e),e.parentNode.removeChild(e)),l):e},n.copyRawPath=A,n.flatPointsToSegment=function(e,t){void 0===t&&(t=1);for(var n=e[0],r=0,i=[n,r],a=2;a<e.length;a+=2)i.push(n,r,e[a],r=(e[a]-n)*t/2,n=e[a],-r);return i},n.getClosestData=function(e,t,n,i){var a,o,s,l,u={j:0,i:0,t:0},c=m;for(o=0;o<e.length;o++)for(l=e[o],a=0;a<l.length;a+=6)s=N(1,t,n,0,1,i||20,l[a],l[a+1],l[a+2],l[a+3],l[a+4],l[a+5],l[a+6],l[a+7]),c>r&&(c=r,u.j=o,u.i=a,u.t=s);return u},n.getPositionOnPath=function(e,t,n,r){var i,a,o,s,l,u,c,h,d,p=e[0],f=r||{};if((t<0||t>1)&&(t=b(t)),e.length>1){for(o=e.totalLength*t,l=u=0;(l+=e[u++].totalLength)<o;)p=e[u];t=(o-(s=l-p.totalLength))/(l-s)||0}return i=p.samples,a=p.resolution,o=p.totalLength*t,s=(u=p.lookup[t<1?~~(o/p.minLength):p.lookup.length-1]||0)?i[u-1]:0,(l=i[u])<o&&(s=l,l=i[++u]),d=1-(c=1/a*((o-s)/(l-s)+u%a)||0),h=p[u=6*~~(u/a)],f.x=w((c*c*(p[u+6]-h)+3*d*(c*(p[u+4]-h)+d*(p[u+2]-h)))*c+h),f.y=w((c*c*(p[u+7]-(h=p[u+1]))+3*d*(c*(p[u+5]-h)+d*(p[u+3]-h)))*c+h),n&&(f.angle=p.totalLength?R(p,u,c>=1?1-1e-9:c||1e-9):p.angle||0),f},n.getRawPath=function(e){var t,n=(e=v(e)&&s.test(e)&&document.querySelector(e)||e).getAttribute?e:0;return n&&(e=e.getAttribute("d"))?(n._gsPath||(n._gsPath={}),(t=n._gsPath[e])&&!t._dirty?t:n._gsPath[e]=k(e)):e?v(e)?k(e):g(e[0])?[e]:e:console.warn("Expecting a <path> element or an SVG path data string")},n.getRotationAtProgress=function(e,t){var n=O(e,t>=1?1-1e-9:t||1e-9);return R(n.segment,n.i,n.t)},n.pointsToSegment=function(e,t,n){d(e[0]-e[2])<1e-4&&d(e[1]-e[3])<1e-4&&(e=e.slice(2));var r,i,a,o,s,l,u,m,v,g,y,x,_,b,M=e.length-2,S=+e[0],T=+e[1],E=+e[2],A=+e[3],C=[S,T,S,T],L=E-S,R=A-T,P=Math.abs(e[M]-S)<.001&&Math.abs(e[M+1]-T)<.001;for(isNaN(n)&&(n=Math.PI/10),P&&(e.push(E,A),E=S,A=T,S=e[M-2],T=e[M-1],e.unshift(S,T),M+=4),t=t||0===t?+t:1,s=2;s<M;s+=2)r=S,i=T,S=E,T=A,E=+e[s+2],A=+e[s+3],S===E&&T===A||(x=(l=L)*l+(m=R)*m,_=(L=E-S)*L+(R=A-T)*R,b=(u=E-r)*u+(v=A-i)*v,y=(a=Math.acos((x+_-b)/p(4*x*_)))/Math.PI*t,g=p(x)*y,y*=p(_),S===r&&T===i||(a>n?(o=f(v,u),C.push(w(S-h(o)*g),w(T-c(o)*g),w(S),w(T),w(S+h(o)*y),w(T+c(o)*y))):(o=f(m,l),C.push(w(S-h(o)*g),w(T-c(o)*g)),o=f(R,L),C.push(w(S),w(T),w(S+h(o)*y),w(T+c(o)*y)))));return S!==E||T!==A||C.length<4?C.push(w(E),w(A),w(E),w(A)):C.length-=2,P&&(C.splice(0,6),C.length=C.length-6),C},n.rawPathToString=B,n.reverseSegment=C,n.simplifyPoints=function(e,t){var n,r,i,a,o,s,l,u=parseFloat(e[0]),c=parseFloat(e[1]),h=[u,c],d=e.length-2;for(t=Math.pow(t||1,2),n=2;n<d;n+=2)(a=u-(r=parseFloat(e[n])))*a+(o=c-(i=parseFloat(e[n+1])))*o>t&&(h.push(r,i),u=r,c=i);return h.push(parseFloat(e[d]),parseFloat(e[d+1])),F(h,0,l=h.length-2,t,s=[h[0],h[1]]),s.push(h[l],h[l+1]),s},n.sliceRawPath=function(e,t,n){n="undefined"==typeof n?1:M(n)||0,t=M(t)||0;var r=Math.max(0,~~(d(n-t)-1e-8)),i=A(e);if(t>n&&(t=1-t,n=1-n,function(e,t){var n=e.length;for(e.reverse();n--;)e[n].reversed||C(e[n])}(i),i.totalLength=0),t<0||n<0){var a=Math.abs(~~Math.min(t,n))+1;t+=a,n+=a}i.totalLength||D(i);var o,s,l,u,c,h,p,f,m=n>1,v=O(i,t,y,!0),g=O(i,n,x),_=g.segment,b=v.segment,w=g.segIndex,T=v.segIndex,L=g.i,P=v.i,z=T===w,k=L===P&&z;if(m||r){for(o=w<T||z&&L<P||k&&g.t<v.t,S(i,T,P,v.t)&&(T++,o||(w++,k?(g.t=(g.t-v.t)/(1-v.t),L=0):z&&(L-=P))),1-(n-t)<1e-5?w=T-1:!g.t&&w?w--:S(i,w,L,g.t)&&o&&T++,1===v.t&&(T=(T+1)%i.length),c=[],p=1+(h=i.length)*r,f=T,p+=(h-T+w)%h,u=0;u<p;u++)E(c,i[f++%h]);i=c}else if(l=1===g.t?6:I(_,L,g.t),t!==n)for(s=I(b,P,k?v.t/g.t:v.t),z&&(l+=s),_.splice(L+l+2),(s||P)&&b.splice(0,P+s),u=i.length;u--;)(u<T||u>w)&&i.splice(u,1);else _.angle=R(_,L+l,0),v=_[L+=l],g=_[L+1],_.length=_.totalLength=0,_.totalPoints=i.totalPoints=8,_.push(v,g,v,g,v,g,v,g);return i.totalLength=0,i},n.stringToRawPath=k,n.subdivideSegment=I,n.subdivideSegmentNear=function(e,t,n,i,a){var o,s,l=n.length,u=m,c=0,h=0;for(i=i||20,a=a||3,s=0;s<l;s+=6)o=N(1,e,t,0,1,i,n[s],n[s+1],n[s+2],n[s+3],n[s+4],n[s+5],n[s+6],n[s+7]),u>r&&(u=r,c=o,h=s);return I(n,h,o=N(a,e,t,c-.05,c+.05,i,n[h],n[h+1],n[h+2],n[h+3],n[h+4],n[h+5],n[h+6],n[h+7])),h+6},n.transformRawPath=function(e,t,n,r,i,a,o){for(var s,l,u,c,h,d=e.length;--d>-1;)for(l=(s=e[d]).length,u=0;u<l;u+=2)c=s[u],h=s[u+1],s[u]=c*t+h*r+a,s[u+1]=c*n+h*i+o;return e._dirty=1,e};var r,i=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,a=/(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,o=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/gi,s=/(^[#\.][a-z]|[a-y][a-z])/i,l=Math.PI/180,u=180/Math.PI,c=Math.sin,h=Math.cos,d=Math.abs,p=Math.sqrt,f=Math.atan2,m=1e8,v=function(e){return"string"==typeof e},g=function(e){return"number"==typeof e},y={},x={},_=1e5,b=function(e){return Math.round((e+m)%1*_)/_||(e<0?0:1)},w=function(e){return Math.round(e*_)/_||0},M=function(e){return Math.round(1e10*e)/1e10||0},S=function(e,t,n,r){var i=e[t],a=1===r?6:I(i,n,r);if(a&&a+n+2<i.length)return e.splice(t,0,i.slice(0,n+a+2)),i.splice(0,n+a),1},T=function(e,t){return t.totalLength=e.totalLength,e.samples?(t.samples=e.samples.slice(0),t.lookup=e.lookup.slice(0),t.minLength=e.minLength,t.resolution=e.resolution):e.totalPoints&&(t.totalPoints=e.totalPoints),t},E=function(e,t){var n=e.length,r=e[n-1]||[],i=r.length;n&&t[0]===r[i-2]&&t[1]===r[i-1]&&(t=r.concat(t.slice(2)),n--),e[n]=t};function A(e){for(var t=[],n=0;n<e.length;n++)t[n]=T(e[n],e[n].slice(0));return T(e,t)}function C(e){var t,n=0;for(e.reverse();n<e.length;n+=2)t=e[n],e[n]=e[n+1],e[n+1]=t;e.reversed=!e.reversed}var L={rect:"rx,ry,x,y,width,height",circle:"r,cx,cy",ellipse:"rx,ry,cx,cy",line:"x1,x2,y1,y2"};function R(e,t,n){var r,i=e[t],a=e[t+2],o=e[t+4];return i+=(a-i)*n,i+=((a+=(o-a)*n)-i)*n,r=a+(o+(e[t+6]-o)*n-a)*n-i,i=e[t+1],i+=((a=e[t+3])-i)*n,i+=((a+=((o=e[t+5])-a)*n)-i)*n,w(f(a+(o+(e[t+7]-o)*n-a)*n-i,r)*u)}function P(e,t,n){t=t||0,e.samples||(e.samples=[],e.lookup=[]);var r,i,a,o,s,l,u,c,h,f,v,g,y,x,_,b,w,M=~~e.resolution||12,S=1/M,T=n?t+6*n+1:e.length,E=e[t],A=e[t+1],C=t?t/6*M:0,L=e.samples,R=e.lookup,P=(t?e.minLength:m)||m,D=L[C+n*M-1],I=t?L[C-1]:0;for(L.length=R.length=0,i=t+2;i<T;i+=6){if(a=e[i+4]-E,o=e[i+2]-E,s=e[i]-E,c=e[i+5]-A,h=e[i+3]-A,f=e[i+1]-A,l=u=v=g=0,d(a)<1e-5&&d(c)<1e-5&&d(s)+d(f)<1e-5)e.length>8&&(e.splice(i,6),i-=6,T-=6);else for(r=1;r<=M;r++)l=u-(u=((x=S*r)*x*a+3*(y=1-x)*(x*o+y*s))*x),v=g-(g=(x*x*c+3*y*(x*h+y*f))*x),(b=p(v*v+l*l))<P&&(P=b),I+=b,L[C++]=I;E+=a,A+=c}if(D)for(D-=I;C<L.length;C++)L[C]+=D;if(L.length&&P)for(e.totalLength=w=L[L.length-1]||0,e.minLength=P,b=_=0,r=0;r<w;r+=P)R[b++]=L[_]<r?++_:_;else e.totalLength=L[0]=0;return t?I-L[t/2-1]:I}function D(e,t){var n,r,i;for(i=n=r=0;i<e.length;i++)e[i].resolution=~~t||12,r+=e[i].length,n+=P(e[i]);return e.totalPoints=r,e.totalLength=n,e}function I(e,t,n){if(n<=0||n>=1)return 0;var r=e[t],i=e[t+1],a=e[t+2],o=e[t+3],s=e[t+4],l=e[t+5],u=r+(a-r)*n,c=a+(s-a)*n,h=i+(o-i)*n,d=o+(l-o)*n,p=u+(c-u)*n,f=h+(d-h)*n,m=s+(e[t+6]-s)*n,v=l+(e[t+7]-l)*n;return c+=(m-c)*n,d+=(v-d)*n,e.splice(t+2,4,w(u),w(h),w(p),w(f),w(p+(c-p)*n),w(f+(d-f)*n),w(c),w(d),w(m),w(v)),e.samples&&e.samples.splice(t/6*e.resolution|0,0,0,0,0,0,0,0),6}function O(e,t,n,r){n=n||{},e.totalLength||D(e),(t<0||t>1)&&(t=b(t));var i,a,o,s,l,u,c,h=0,d=e[0];if(t)if(1===t)c=1,u=(d=e[h=e.length-1]).length-8;else{if(e.length>1){for(o=e.totalLength*t,l=u=0;(l+=e[u++].totalLength)<o;)h=u;t=(o-(s=l-(d=e[h]).totalLength))/(l-s)||0}i=d.samples,a=d.resolution,o=d.totalLength*t,s=(u=d.lookup[~~(o/d.minLength)]||0)?i[u-1]:0,(l=i[u])<o&&(s=l,l=i[++u]),c=1/a*((o-s)/(l-s)+u%a),u=6*~~(u/a),r&&1===c&&(u+6<d.length?(u+=6,c=0):h+1<e.length&&(u=c=0,d=e[++h]))}else c=u=h=0,d=e[0];return n.t=c,n.i=u,n.path=e,n.segment=d,n.segIndex=h,n}function z(e,t,n,r,i,a,o,s,u){if(e!==s||t!==u){n=d(n),r=d(r);var f=i%360*l,m=h(f),v=c(f),g=Math.PI,y=2*g,x=(e-s)/2,_=(t-u)/2,b=m*x+v*_,w=-v*x+m*_,M=b*b,S=w*w,T=M/(n*n)+S/(r*r);T>1&&(n=p(T)*n,r=p(T)*r);var E=n*n,A=r*r,C=(E*A-E*S-A*M)/(E*S+A*M);C<0&&(C=0);var L=(a===o?-1:1)*p(C),R=L*(n*w/r),P=L*(-r*b/n),D=(e+s)/2+(m*R-v*P),I=(t+u)/2+(v*R+m*P),O=(b-R)/n,z=(w-P)/r,k=(-b-R)/n,F=(-w-P)/r,N=O*O+z*z,B=(z<0?-1:1)*Math.acos(O/p(N)),U=(O*F-z*k<0?-1:1)*Math.acos((O*k+z*F)/p(N*(k*k+F*F)));isNaN(U)&&(U=g),!o&&U>0?U-=y:o&&U<0&&(U+=y),B%=y,U%=y;var G,H=Math.ceil(d(U)/(y/4)),j=[],V=U/H,W=4/3*c(V/2)/(1+h(V/2)),q=m*n,X=v*n,Y=v*-r,Z=m*r;for(G=0;G<H;G++)b=h(i=B+G*V),w=c(i),O=h(i+=V),z=c(i),j.push(b-W*w,w+W*b,O+W*z,z-W*O,O,z);for(G=0;G<j.length;G+=2)b=j[G],w=j[G+1],j[G]=b*q+w*Y+D,j[G+1]=b*X+w*Z+I;return j[G-2]=s,j[G-1]=u,j}}function k(e){var t,n,r,a,s,l,u,c,h,p,f,m,v,g,y,x=(e+"").replace(o,(function(e){var t=+e;return t<1e-4&&t>-1e-4?0:t})).match(i)||[],_=[],b=0,w=0,M=2/3,S=x.length,T=0,E="ERROR: malformed path: "+e,A=function(e,t,n,r){p=(n-e)/3,f=(r-t)/3,u.push(e+p,t+f,n-p,r-f,n,r)};if(!e||!isNaN(x[0])||isNaN(x[1]))return console.log(E),_;for(t=0;t<S;t++)if(v=s,isNaN(x[t])?l=(s=x[t].toUpperCase())!==x[t]:t--,r=+x[t+1],a=+x[t+2],l&&(r+=b,a+=w),t||(c=r,h=a),"M"===s)u&&(u.length<8?_.length-=1:T+=u.length),b=c=r,w=h=a,u=[r,a],_.push(u),t+=2,s="L";else if("C"===s)u||(u=[0,0]),l||(b=w=0),u.push(r,a,b+1*x[t+3],w+1*x[t+4],b+=1*x[t+5],w+=1*x[t+6]),t+=6;else if("S"===s)p=b,f=w,"C"!==v&&"S"!==v||(p+=b-u[u.length-4],f+=w-u[u.length-3]),l||(b=w=0),u.push(p,f,r,a,b+=1*x[t+3],w+=1*x[t+4]),t+=4;else if("Q"===s)p=b+(r-b)*M,f=w+(a-w)*M,l||(b=w=0),b+=1*x[t+3],w+=1*x[t+4],u.push(p,f,b+(r-b)*M,w+(a-w)*M,b,w),t+=4;else if("T"===s)p=b-u[u.length-4],f=w-u[u.length-3],u.push(b+p,w+f,r+(b+1.5*p-r)*M,a+(w+1.5*f-a)*M,b=r,w=a),t+=2;else if("H"===s)A(b,w,b=r,w),t+=1;else if("V"===s)A(b,w,b,w=r+(l?w-b:0)),t+=1;else if("L"===s||"Z"===s)"Z"===s&&(r=c,a=h,u.closed=!0),("L"===s||d(b-r)>.5||d(w-a)>.5)&&(A(b,w,r,a),"L"===s&&(t+=2)),b=r,w=a;else if("A"===s){if(g=x[t+4],y=x[t+5],p=x[t+6],f=x[t+7],n=7,g.length>1&&(g.length<3?(f=p,p=y,n--):(f=y,p=g.substr(2),n-=2),y=g.charAt(1),g=g.charAt(0)),m=z(b,w,+x[t+1],+x[t+2],+x[t+3],+g,+y,(l?b:0)+1*p,(l?w:0)+1*f),t+=n,m)for(n=0;n<m.length;n++)u.push(m[n]);b=u[u.length-2],w=u[u.length-1]}else console.log(E);return(t=u.length)<6?(_.pop(),t=0):u[0]===u[t-2]&&u[1]===u[t-1]&&(u.closed=!0),_.totalPoints=T+t,_}function F(e,t,n,r,i){var a,o,s,l,u,c,h,d,p,f,m,v,g=r,y=e[t],x=e[t+1],_=e[n],b=e[n+1];for(o=t+2;o<n;o+=2)l=e[o],u=e[o+1],f=void 0,void 0,void 0,v=(p=b)-(h=x),((m=(d=_)-(c=y))||v)&&((f=((l-c)*m+(u-h)*v)/(m*m+v*v))>1?(c=d,h=p):f>0&&(c+=m*f,h+=v*f)),(s=Math.pow(l-c,2)+Math.pow(u-h,2))>g&&(a=o,g=s);g>r&&(a-t>2&&F(e,t,a,r,i),i.push(e[a],e[a+1]),n-a>2&&F(e,a,n,r,i))}function N(e,t,n,i,a,o,s,l,u,c,h,d,p,f){var v,g,y,x,_=(a-i)/o,b=0,w=i;for(r=m;w<=a;)(v=(g=(x=1-w)*x*x*s+3*x*x*w*u+3*x*w*w*h+w*w*w*p-t)*g+(y=x*x*x*l+3*x*x*w*c+3*x*w*w*d+w*w*w*f-n)*y)<r&&(r=v,b=w),w+=_;return e>1?N(e-1,t,n,Math.max(b-_,0),Math.min(b+_,1),o,s,l,u,c,h,d,p,f):b}function B(e){g(e[0])&&(e=[e]);var t,n,r,i,a="",o=e.length;for(n=0;n<o;n++){for(i=e[n],a+="M"+w(i[0])+","+w(i[1])+" C",t=i.length,r=2;r<t;r++)a+=w(i[r++])+","+w(i[r++])+" "+w(i[r++])+","+w(i[r++])+" "+w(i[r++])+","+w(i[r])+" ";i.closed&&(a+="z")}return a}},{}],79:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.splitText=n.byWord=n.byLetter=void 0;var i=r(e("@babel/runtime/helpers/toConsumableArray")),a=function(e,t){var n=document.createElement("span");return n.textContent=e,n.style.setProperty("--index",t),n},o=function(e){return(0,i.default)(e).map(a)};n.byLetter=o;var s=function(e){return e.split(" ").map(a)};n.byWord=s,n.splitText=function(){document.querySelectorAll("[split-by]").forEach((function(e){var t=e.getAttribute("split-by"),n=null,r=[],a=0;if(e.innerHTML=e.innerHTML.replace(/<a.+?<\/a>/g,(function(e){var t="%"+a+++"%";return r[r.length]=e,t})),"letter"===t?n=o(e.innerText):"word"===t&&(n=s(e.innerText)),n){var l;(l=e.firstChild).replaceWith.apply(l,(0,i.default)(n));for(var u=e.innerHTML,c=0;c<a;c++)u=u.replace("%"+c+"%",r[c]);e.innerHTML=u}}))}},{"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/toConsumableArray":16}],80:[function(e,t,n){"use strict";var r=e("../core/properties"),i=e("three"),a=r.loader.ITEM_CLASSES.xhr;function o(e,t){e&&(t.responseType="arraybuffer",s.constructor.apply(this,arguments))}t.exports=o,o.type="buf",o.extensions=["buf"];var s=a.prototype,l=o.prototype=new a;l.constructor=o,l._onLoad=function(){if(!this.content){for(var e=this.xmlhttp.response,t=new Uint32Array(e,0,1)[0],n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e,4,t))),r=n.vertexCount,a=n.indexCount,o=4+t,l=new i.BufferGeometry,u=n.attributes,c=0,h=u.length;c<h;c++){var d=u[c],p=d.id,f="indices"===p?a:r,m=d.componentSize,v=window[d.storageType],g=new v(e,o,f*m),y=v.BYTES_PER_ELEMENT,x=void 0;if(d.needsPack){var _=d.packedComponents,b=_.length,w=1<<8*y,M=0===d.storageType.indexOf("Int")?.5*w:0,S=1/w;x=new Float32Array(f*m);for(var T=0,E=0;T<f;T++)for(var A=0;A<b;A++){var C=_[A];x[E]=(g[E]+M)*S*C.delta+C.from,E++}}else x=g;"indices"===p?l.setIndex(new i.BufferAttribute(x,1)):l.setAttribute(p,new i.BufferAttribute(x,m)),o+=f*m*y}this.content=l}this.xmlhttp=void 0,s._onLoad.call(this)},o.retrieve=function(){return!1}},{"../core/properties":68,three:59}],81:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("../core/properties")),i=e("three"),a=r.default.loader.ITEM_CLASSES.image,o=a.prototype.constructor;function s(e,t){if(e){var n=t.content||new i.Texture(new Image);switch(t.content=n.image,n.minFilter=t.minFilter||i.LinearMipMapLinearFilter,n.minFilter){case i.NearestMipMapNearestFilter:case i.NearestMipMapLinearFilter:case i.LinearMipMapNearestFilter:case i.LinearMipMapLinearFilter:n.generateMipmaps=!0,n.anisotropy=t.anisotropy||r.default.renderer.capabilities.getMaxAnisotropy();break;default:n.generateMipmaps=!1}n.format=e.indexOf(".jpg")>-1?i.RGBFormat:i.RGBAFormat,n.flipY=void 0===t.flipY||t.flipY,t.wrap?n.wrapS=n.wrapT=t.wrap:(t.wrapS&&(n.wrapS=t.wrapS),t.wrapT&&(n.wrapT=t.wrapT)),l.constructor.apply(this,arguments),this.content=n}}t.exports=s,s.type="texture",s.extensions=[];var l=a.prototype,u=s.prototype=new a;u.constructor=s,u.load=function(){o.prototype.load.apply(this,arguments);var e=this.content.image;e.onload=this.boundOnLoad,e.src=this.url},u._onLoad=function(){delete this.content.image.onload,this.width=this.content.image.width,this.height=this.content.image.height,this.content.needsUpdate=!0,o.prototype._onLoad.call(this)},s.retrieve=function(){return!1}},{"../core/properties":68,"@babel/runtime/helpers/interopRequireDefault":10,three:59}],82:[function(e,t,n){"use strict";var r=e("three");function i(){this.position=new r.Vector3,this.rotation=new r.Quaternion,this.scale=new r.Vector3(1,1,1),this.matrix=new r.Matrix4,this.enablePositionNoise=!0,this.enableRotationNoise=!0,this.positionFrequency=.25,this.rotationFrequency=.25,this.positionAmplitude=.3,this.rotationAmplitude=.003,this.positionScale=new r.Vector3(1,1,1),this.rotationScale=new r.Vector3(1,1,0),this.positionFractalLevel=3,this.rotationFractalLevel=3,this.times=new Float32Array(6),this.rehash()}t.exports=i;var a=i.prototype;a.rehash=function(){for(var e=0;e<6;e++)this.times[e]=-1e4*Math.random()},a.update=function(e){var t;if(e=void 0===e?1e3/60:e,this.enablePositionNoise){for(t=0;t<3;t++)this.times[t]+=this.positionFrequency*e;s.set(c(this.times[0],this.positionFractalLevel),c(this.times[1],this.positionFractalLevel),c(this.times[2],this.positionFractalLevel)),s.multiply(this.positionScale),s.multiplyScalar(this.positionAmplitude*l),this.position.copy(s)}if(this.enableRotationNoise){for(t=0;t<3;t++)this.times[t+3]+=this.rotationFrequency*e;s.set(c(this.times[3],this.rotationFractalLevel),c(this.times[4],this.rotationFractalLevel),c(this.times[5],this.rotationFractalLevel)),s.multiply(this.rotationScale),s.multiplyScalar(this.rotationAmplitude*l),o.set(s.x,s.y,s.z),this.rotation.setFromEuler(o)}this.matrix.compose(this.position,this.rotation,this.scale)};var o=new r.Euler,s=new r.Vector3,l=1/.75,u=new function(){for(var e=1,t=1,n=[],r=0;r<256;++r)n.push(Math.random()-.5);return{getVal:function(r){var i=r*t,a=Math.floor(i),o=i-a,s=o*o*(3-2*o),l=255&a,u=l+1&255;return function(e,t,n){return e*(1-n)+t*n}(n[l],n[u],s)*e},setAmplitude:function(t){e=t},setScale:function(e){t=e}}};function c(e,t){for(var n=0,r=.5,i=0;i<t;i++)n+=r*u.getVal(e),e*=2,r*=.5;return n}},{three:59}],83:[function(e,t,n){"use strict";var r=e("three"),i=e("mout/object/merge"),a=e("../helpers/fboHelper");function o(e){i(this,{uniforms:{u_texture:{},u_resolution:{value:null},u_fullResolution:{value:null},u_isVR:{value:!1}},defines:{},enabled:!0,vertexShader:"",fragmentShader:"",isRawMaterial:!0,depthTest:!1,depthWrite:!1,blending:r.NoBlending,transparent:!0},e),this.vertexShader||(this.vertexShader=a.vertexShader),this.addRawShaderPrefix&&this.isRawMaterial&&(this.vertexShader=a.precisionPrefix+this.vertexShader,this.fragmentShader=a.precisionPrefix+this.fragmentShader),this.material=new(this.isRawMaterial?r.RawShaderMaterial:r.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,defines:this.defines,depthTest:this.depthTest,depthWrite:this.depthWrite,blending:this.blending,transparent:this.transparent})}t.exports=o;var s=o.prototype;s.setPostprocessing=function(e){this.uniforms.u_resolution.value=e.resolution},s.dispose=function(){},s.needsRender=function(){return!0},s.render=function(e,t){this.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.material,t?null:e.toRenderTarget),e.swap()}},{"../helpers/fboHelper":72,"mout/object/merge":39,three:59}],84:[function(e,t,n){"use strict";var r=e("three"),i=e("../helpers/fboHelper"),a=e("min-signal");function o(e){var t;l||n.init(),this.width=1,this.height=1,this.scene=null,this.camera=null,this.resolution=new r.Vector2(0,0),this.texelSize=new r.Vector2(0,0),this.aspect=new r.Vector2(1,1),this.onBeforeSceneRendered=new a,this.onAfterSceneRendered=new a,this.onAfterRendered=new a,this.sceneRenderTarget=i.createMultisampleRenderTarget(1,1,!0),this.sceneRenderTarget.depthBuffer=!0,this.fromRenderTarget=i.createRenderTarget(1,1,!0),this.toRenderTarget=this.fromRenderTarget.clone(),this.useDepthTexture=!!e&&(i.renderer.capabilities.isWebGL2||i.renderer.extensions.get("WEBGL_depth_texture")),this.fromTexture=this.fromRenderTarget.texture,this.toTexture=this.toRenderTarget.texture,this.sceneTexture=this.sceneRenderTarget.texture,this.mesh=new r.Mesh,this.queue=[],this.sharedUniforms={u_sceneTexture:{value:this.sceneRenderTarget.texture},u_sceneDepthTexture:{value:null},u_cameraNear:{value:0},u_cameraFar:{value:1},u_cameraFovRad:{value:1},u_resolution:{value:this.resolution},u_texelSize:{value:this.texelSize},u_aspect:{value:this.aspect}},this.useDepthTexture&&((t=new r.DepthTexture).type=r.UnsignedShortType,i.renderer.capabilities.isWebGL2&&(t.type=r.UnsignedIntType),t.minFilter=r.NearestFilter,t.magFilter=r.NearestFilter,i.renderer.capabilities.isWebGL2||(t.format=r.DepthStencilFormat,t.type=r.UnsignedInt248Type),this.sceneRenderTarget.depthTexture=t,this.depthTexture=this.sharedUniforms.u_sceneDepthTexture.value=t)}var s=o.prototype;n=t.exports=o,s.swap=function(){var e=this.fromRenderTarget;this.fromRenderTarget=this.toRenderTarget,this.toRenderTarget=e,this.fromTexture=this.fromRenderTarget.texture,this.toTexture=this.toRenderTarget.texture},s.setSize=function(e,t){this.width=e,this.height=t,this.resolution.set(e,t),this.texelSize.set(1/e,1/t);var n=t/Math.sqrt(e*e+t*t)*2;this.aspect.set(e/t*n,n),this.sceneRenderTarget.setSize(e,t),this.fromRenderTarget.setSize(e,t),this.toRenderTarget.setSize(e,t)},s.dispose=function(){this.fromRenderTarget&&this.fromRenderTarget.dispose(),this.toRenderTarget&&this.toRenderTarget.dispose(),this.prevSceneRenderTarget&&this.prevSceneRenderTarget.dispose(),this.sceneRenderTarget&&this.sceneRenderTarget.dispose()},s.renderMaterial=function(e,t){this.mesh.material=e,i.renderMesh(this.mesh,t)},s.render=function(e,t,n){this.scene=e,this.camera=t,this.mesh.geometry=i.renderer.xr.enabled?u:l;var r,a=this.queue.filter(c),o=this.sharedUniforms;if(o.u_sceneTexture.value=this.sceneRenderTarget.texture,o.u_cameraNear.value=t.near,o.u_cameraFar.value=t.far,o.u_cameraFovRad.value=t.fov/180*Math.PI,this.onBeforeSceneRendered.dispatch(),a.length){i.renderer.setRenderTarget(this.sceneRenderTarget),i.renderer.render(e,t),i.renderer.setRenderTarget(null),i.copy(this.sceneRenderTarget.texture,this.fromRenderTarget),this.onAfterSceneRendered.dispatch(this.sceneRenderTarget);var s=i.getColorState();i.renderer.autoClear=!1;for(var h=0,d=a.length;h<d;h++){var p=h===d-1&&n;(r=a[h]).setPostprocessing(this),r.render(this,p)}i.setColorState(s)}else i.renderer.render(e,t),this.onAfterSceneRendered.dispatch();this.onAfterRendered.dispatch()};var l=n.geom=null,u=n.vrGeom=null;function c(e){return e.enabled&&e.needsRender()}n.init=function(){(l=n.geom=n.geom||new r.BufferGeometry).setAttribute("position",new r.BufferAttribute(new Float32Array([-1,-1,0,4,-1,0,-1,4,0]),3)),l.setAttribute("a_uvClamp",new r.BufferAttribute(new Float32Array([0,0,1,1,0,0,1,1,0,0,1,1]),4)),(u=n.vrGeom=n.vrGeom||new r.BufferGeometry).setAttribute("position",new r.BufferAttribute(new Float32Array([-4,-1,0,0,-1,0,0,4,0,0,-1,0,4,-1,0,0,4,0]),3)),u.setAttribute("a_uvClamp",new r.BufferAttribute(new Float32Array([0,0,.5,1,0,0,.5,1,0,0,.5,1,.5,0,1,1,.5,0,1,1,.5,0,1,1]),4))}},{"../helpers/fboHelper":72,"min-signal":23,three:59}],85:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=e("../../utils/math"),o=e("mout/object/merge"),s=e("three"),l=e("glslify");function u(e){var t=(e=o({useHighPass:!0,ITERATION:5,amount:4,radius:.1,threshold:.2,smoothWidth:1,haloWidth:.7,haloRGBShift:.03,haloStrength:.21,haloMaskInner:.3,haloMaskOuter:.5},e)).ITERATION;this.directionX=new s.Vector2(1,0),this.directionY=new s.Vector2(0,1);var n=this.highPassRenderTarget=i.createRenderTarget(1,1,!0);this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.blurMaterials=[];for(var r=0;r<t;r++)this.renderTargetsHorizontal.push(n.clone()),this.renderTargetsVertical.push(n.clone());for(var a={u_bloomStrength:{value:1},u_bloomWeights:{value:[]}},u=0;u<t;u++)a["u_blurTexture"+u]={value:this.renderTargetsVertical[u].texture};c.constructor.call(this,o({uniforms:a,defines:{ITERATION:t},fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\n\nuniform sampler2D u_blurTexture0;\n#if ITERATION > 1\nuniform sampler2D u_blurTexture1;\n#endif\n#if ITERATION > 2\nuniform sampler2D u_blurTexture2;\n#endif\n#if ITERATION > 3\nuniform sampler2D u_blurTexture3;\n#endif\n#if ITERATION > 4\nuniform sampler2D u_blurTexture4;\n#endif\nuniform float u_bloomWeights[ITERATION];\n\n#include <common>\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\nvoid main() {\n\tvec4 c = texture2D(u_texture, v_uv);\n\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\tfloat v = dot( c.xyz, luma );\n\tfloat a = 1.0 - v;//max(0.0, 1.2 - v);//mix(1.0, 0.1, v);\n\n\tgl_FragColor = c + (\n\t\tu_bloomWeights[0] * texture2D(u_blurTexture0, v_uv)\n\t\t#if ITERATION > 1\n\t\t+ u_bloomWeights[1] * texture2D(u_blurTexture1, v_uv)\n\t\t#endif\n\t\t#if ITERATION > 2\n\t\t+ u_bloomWeights[2] * texture2D(u_blurTexture2, v_uv)\n\t\t#endif\n\t\t#if ITERATION > 3\n\t\t+ u_bloomWeights[3] * texture2D(u_blurTexture3, v_uv)\n\t\t#endif\n\t\t#if ITERATION > 4\n\t\t+ u_bloomWeights[4] * texture2D(u_blurTexture4, v_uv)\n\t\t#endif\n\t) * a;\n\n    gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\tgl_FragColor.a = 1.0;\n}\n"]),blending:s.NoBlending},e)),this.highPassMaterial=new s.RawShaderMaterial({uniforms:{u_texture:{value:null},u_luminosityThreshold:{value:1},u_smoothWidth:{value:1},u_haloWidth:{value:1},u_haloRGBShift:{value:1},u_haloStrength:{value:1},u_haloMaskInner:{value:1},u_haloMaskOuter:{value:1},u_texelSize:null,u_aspect:null},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\n\n#ifdef USE_HALO\nuniform vec2 u_texelSize;\nuniform vec2 u_aspect;\nuniform float u_haloWidth;\nuniform float u_haloRGBShift;\nuniform float u_haloStrength;\nuniform float u_haloMaskInner;\nuniform float u_haloMaskOuter;\n#endif\n\nvarying vec2 v_uv;\n\nvoid main() {\n\n\tvec4 texel = texture2D( u_texture, v_uv );\n\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\tfloat v = dot( texel.xyz, luma );\n\tvec4 outputColor = vec4(0.0, 0.0, 0.0, 1.0);\n\tfloat alpha = smoothstep( u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v );\n\toutputColor = mix( outputColor, texel, alpha );\n\tgl_FragColor = vec4(outputColor.rgb, 1.0);\n\n\t#ifdef USE_HALO\n\t\tvec2 toCenter = (v_uv - 0.5) * u_aspect;\n\n\t\tvec2 ghostUv = 1.0 - (toCenter + 0.5);\n\t\tvec2 ghostVec = (vec2(0.5) - ghostUv);\n\n\t\tvec2 direction = normalize(ghostVec);\n\t\tvec2 haloVec = direction * u_haloWidth;\n\n\t\tvec3 distortion = vec3(-u_texelSize.x, 0.0, u_texelSize.x) * u_haloRGBShift;\n\t\tvec2 uv = ghostUv + haloVec;\n\n\t\tgl_FragColor.rgb += vec3(\n\t\t\ttexture2D(u_texture, uv + direction * distortion.r).r,\n\t\t\ttexture2D(u_texture, uv + direction * distortion.g).g,\n\t\t\ttexture2D(u_texture, uv + direction * distortion.b).b\n\t\t) * u_haloStrength * smoothstep(u_haloMaskInner, u_haloMaskOuter, length(toCenter));\n\t#endif\n}\n"])});for(var h=0;h<this.ITERATION;h++){var d=3+2*h;this.blurMaterials[h]=new s.RawShaderMaterial({uniforms:{u_texture:{value:null},u_resolution:{value:new s.Vector2},u_direction:{value:null}},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+l(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\nuniform vec2 u_resolution;\nuniform vec2 u_direction;\n\nfloat gaussianPdf(in float x, in float sigma) {\n  return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n}\nvoid main() {\n  vec2 invSize = 1.0 / u_resolution;\n  float fSigma = float(SIGMA);\n  float weightSum = gaussianPdf(0.0, fSigma);\n  vec3 diffuseSum = texture2D( u_texture, v_uv).rgb * weightSum;\n  for( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n    float x = float(i);\n    float w = gaussianPdf(x, fSigma);\n    vec2 uvOffset = u_direction * invSize * x;\n    vec3 sample1 = texture2D( u_texture, v_uv + uvOffset).rgb;\n    vec3 sample2 = texture2D( u_texture, v_uv - uvOffset).rgb;\n    diffuseSum += (sample1 + sample2) * w;\n    weightSum += 2.0 * w;\n  }\n  gl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n}\n"]),defines:{KERNEL_RADIUS:d,SIGMA:d}})}}var c=r.prototype,h=u.prototype=Object.create(c);h.constructor=u,h.setPostprocessing=function(e){c.setPostprocessing.call(this,e);var t=e.width,n=e.height,r=Math.ceil(t/2),i=Math.ceil(n/2);this.highPassRenderTarget.setSize(r,i);for(var a=0;a<this.ITERATION;a++)this.renderTargetsHorizontal[a].setSize(r,i),this.renderTargetsVertical[a].setSize(r,i),this.blurMaterials[a].uniforms.u_resolution.value=new s.Vector2(r,i),r=Math.ceil(r/2),i=Math.ceil(i/2)},h.dispose=function(){this.highPassRenderTarget&&this.highPassRenderTarget.dispose();for(var e=0;e<this.ITERATION;e++)this.renderTargetsHorizontal[e]&&this.renderTargetsHorizontal[e].dispose(),this.renderTargetsVertical[e]&&this.renderTargetsVertical[e].dispose()},h.needsRender=function(){return!!this.amount},h.render=function(e,t){var n=this.ITERATION;if(this.useHighPass){this.highPassMaterial.uniforms.u_texture.value=e.fromTexture,this.highPassMaterial.uniforms.u_luminosityThreshold.value=this.threshold,this.highPassMaterial.uniforms.u_smoothWidth.value=this.smoothWidth,this.highPassMaterial.uniforms.u_haloWidth.value=this.haloWidth,this.highPassMaterial.uniforms.u_haloRGBShift.value=this.haloRGBShift*e.width,this.highPassMaterial.uniforms.u_haloStrength.value=this.haloStrength,this.highPassMaterial.uniforms.u_haloMaskInner.value=this.haloMaskInner,this.highPassMaterial.uniforms.u_haloMaskOuter.value=this.haloMaskOuter,this.highPassMaterial.uniforms.u_texelSize=e.sharedUniforms.u_texelSize,this.highPassMaterial.uniforms.u_aspect=e.sharedUniforms.u_aspect;var r=this.haloStrength>0;this.highPassMaterial.defines.USE_HALO!==r&&(this.highPassMaterial.defines.USE_HALO=r,this.highPassMaterial.needsUpdate=!0),e.renderMaterial(this.highPassMaterial,this.highPassRenderTarget)}for(var i=this.useHighPass?this.highPassRenderTarget:e.fromRenderTarget,o=0;o<n;o++){var s=this.blurMaterials[o];s.uniforms.u_texture.value=i.texture,s.uniforms.u_direction.value=this.directionX,e.renderMaterial(s,this.renderTargetsHorizontal[o]),s.uniforms.u_texture.value=this.renderTargetsHorizontal[o].texture,s.uniforms.u_direction.value=this.directionY,e.renderMaterial(s,this.renderTargetsVertical[o]),i=this.renderTargetsVertical[o]}this.material.uniforms.u_texture.value=e.fromTexture;for(var l=0;l<n;l++){var u=(n-l)/n;this.uniforms.u_bloomWeights.value[l]=this.amount*a.mix(u,1.2-u,this.radius)/Math.pow(2,n-l-1)}c.render.call(this,e,t)},t.exports=u},{"../../helpers/fboHelper":72,"../../utils/math":115,"../PostEffect":83,glslify:21,"mout/object/merge":39,three:59}],86:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=(e("../../utils/math"),e("mout/object/mixIn")),o=e("glslify"),s=e("three");function l(e){e=a({fNumber:.07,focusDistance:5,useCameraFov:!1,focalLength:.463,kFilmHeight:36,quality:1,_prevQuality:-1,useFloatTexture:!1,_prevUseFloatTexture:null,useAdditionalBlur:!0,_halfWidth:0,_halfHeight:0},e),this.sharedUniforms={u_depthTexture:{value:null},u_texelSize:{value:null},u_focusDistance:{value:0},u_fNumber:{value:0},u_lensCoeff:{value:0},u_maxCoC:{value:0},u_rcpMaxCoC:{value:0},u_rcpAspect:{value:0},u_cameraNear:{value:0},u_cameraFar:{value:0},u_halfTexelSize:{value:new s.Vector2}},this.rt2=i.createRenderTarget(1,1,!0),this.rt3=i.createRenderTarget(1,1,!0),this.cocMaterial=new s.RawShaderMaterial({uniforms:{u_texture:{value:null},u_hashNoise:{value:0},u_depthTexture:this.sharedUniforms.u_depthTexture,u_texelSize:this.sharedUniforms.u_texelSize,u_focusDistance:this.sharedUniforms.u_focusDistance,u_lensCoeff:this.sharedUniforms.u_lensCoeff,u_maxCoC:this.sharedUniforms.u_maxCoC,u_rcpMaxCoC:this.sharedUniforms.u_rcpMaxCoC,u_cameraNear:this.sharedUniforms.u_cameraNear,u_cameraFar:this.sharedUniforms.u_cameraFar},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_depthTexture;\nuniform vec2 u_texelSize;\nuniform float u_focusDistance;\nuniform float u_lensCoeff;\nuniform float u_maxCoC;\nuniform float u_rcpMaxCoC;\nuniform float u_cameraNear;\nuniform float u_cameraFar;\n\nvarying vec2 v_uv;\n\n// Max between three components\nfloat max3(vec3 xyz) { return max(xyz.x, max(xyz.y, xyz.z)); }\n\n#ifndef USE_FLOAT\nuniform float u_hashNoise;\nfloat hash13(vec3 p3) {\n\tp3  = fract(p3 * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\n#endif\n\n// Fragment shader: Downsampling, prefiltering and CoC calculation\nfloat getViewZ (vec2 uv) {\n\tfloat depth = texture2D(u_depthTexture, uv).r * 2.0 - 1.0;\n\treturn 2.0 * u_cameraNear * u_cameraFar / (u_cameraFar + u_cameraNear - depth * (u_cameraFar - u_cameraNear));\n}\n\nvoid main () {\n    // Sample source colors.\n    vec3 duv = u_texelSize.xyx * vec3(0.5, 0.5, -0.5);\n    vec3 c0 = texture2D(u_texture, v_uv - duv.xy).rgb;\n    vec3 c1 = texture2D(u_texture, v_uv - duv.zy).rgb;\n    vec3 c2 = texture2D(u_texture, v_uv + duv.zy).rgb;\n    vec3 c3 = texture2D(u_texture, v_uv + duv.xy).rgb;\n\n    // Sample linear depths.\n\tvec2 uvAlt = v_uv; // yFlippedUV? https://github.com/keijiro/KinoBokeh/blob/master/Assets/Kino/Bokeh/Shader/Common.cginc\n    float d0 = getViewZ(uvAlt - duv.xy);\n    float d1 = getViewZ(uvAlt - duv.zy);\n    float d2 = getViewZ(uvAlt + duv.zy);\n    float d3 = getViewZ(uvAlt + duv.xy);\n    vec4 depths = vec4(d0, d1, d2, d3);\n\n    // Calculate the radiuses of CoCs at these sample points.\n    float focusDistance = u_focusDistance;\n    // focusDistance = getViewZ(vec2(0.5));\n    \n\n    vec4 cocs = (depths - focusDistance) * u_lensCoeff / depths;\n    cocs = clamp(cocs, -u_maxCoC, u_maxCoC);\n\n    // Premultiply CoC to reduce background bleeding.\n    vec4 weights = clamp(abs(cocs) * u_rcpMaxCoC, vec4(0.0), vec4(1.0));\n\n// #if defined(PREFILTER_LUMA_WEIGHT)\n    // Apply luma weights to reduce flickering.\n    // Inspired by goo.gl/j1fhLe goo.gl/mfuZ4h\n    weights.x *= 1.0 / (max3(c0) + 1.0);\n    weights.y *= 1.0 / (max3(c1) + 1.0);\n    weights.z *= 1.0 / (max3(c2) + 1.0);\n    weights.w *= 1.0 / (max3(c3) + 1.0);\n// #endif\n\n    // Weighted average of the color samples\n    vec3 avg = c0 * weights.x + c1 * weights.y + c2 * weights.z + c3 * weights.w;\n    avg /= dot(weights, vec4(1.0));\n\n    // Output CoC = average of CoCs\n    float coc = dot(cocs, vec4(0.25));\n\n    // Premultiply CoC again.\n    avg *= smoothstep(0.0, u_texelSize.y * 2.0, abs(coc));\n\n    gl_FragColor = vec4(avg, coc);\n    #ifndef USE_FLOAT\n    gl_FragColor = sign(gl_FragColor) * sqrt(abs(gl_FragColor));\n    gl_FragColor = gl_FragColor * 0.5 + 0.5 + hash13(vec3(gl_FragCoord.xy, u_hashNoise)) / 255.0;\n    #endif\n}"])}),this.simMaterial=new s.RawShaderMaterial({uniforms:{u_cocTexture:{value:null},u_cocTexelSize:this.sharedUniforms.u_halfTexelSize,u_rcpAspect:this.sharedUniforms.u_rcpAspect,u_maxCoC:this.sharedUniforms.u_maxCoC},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\n#if QUALITY == 0\n\n// rings = 2\n// points per ring = 5\nconst int kSampleCount = 16;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0.0,0.0);\n    kDiskKernel[1] = vec2(0.54545456,0.0);\n    kDiskKernel[2] = vec2(0.16855472,0.5187581);\n    kDiskKernel[3] = vec2(-0.44128203,0.3206101);\n    kDiskKernel[4] = vec2(-0.44128197,-0.3206102);\n    kDiskKernel[5] = vec2(0.1685548,-0.5187581);\n    kDiskKernel[6] = vec2(1.0,0.0);\n    kDiskKernel[7] = vec2(0.809017,0.58778524);\n    kDiskKernel[8] = vec2(0.30901697,0.95105654);\n    kDiskKernel[9] = vec2(-0.30901703,0.9510565);\n    kDiskKernel[10] = vec2(-0.80901706,0.5877852);\n    kDiskKernel[11] = vec2(-1.0,0.0);\n    kDiskKernel[12] = vec2(-0.80901694,-0.58778536);\n    kDiskKernel[13] = vec2(-0.30901664,-0.9510566);\n    kDiskKernel[14] = vec2(0.30901712,-0.9510565);\n    kDiskKernel[15] = vec2(0.80901694,-0.5877853);\n}\n\n#endif\n\n#if QUALITY == 1\n\n// rings = 3\n// points per ring = 7\nconst int kSampleCount = 22;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0.0,0.0);\n    kDiskKernel[1] = vec2(0.53333336,0.0);\n    kDiskKernel[2] = vec2(0.3325279,0.4169768);\n    kDiskKernel[3] = vec2(-0.11867785,0.5199616);\n    kDiskKernel[4] = vec2(-0.48051673,0.2314047);\n    kDiskKernel[5] = vec2(-0.48051673,-0.23140468);\n    kDiskKernel[6] = vec2(-0.11867763,-0.51996166);\n    kDiskKernel[7] = vec2(0.33252785,-0.4169769);\n    kDiskKernel[8] = vec2(1.0,0.0);\n    kDiskKernel[9] = vec2(0.90096885,0.43388376);\n    kDiskKernel[10] = vec2(0.6234898,0.7818315);\n    kDiskKernel[11] = vec2(0.22252098,0.9749279);\n    kDiskKernel[12] = vec2(-0.22252095,0.9749279);\n    kDiskKernel[13] = vec2(-0.62349,0.7818314);\n    kDiskKernel[14] = vec2(-0.90096885,0.43388382);\n    kDiskKernel[15] = vec2(-1.0,0.0);\n    kDiskKernel[16] = vec2(-0.90096885,-0.43388376);\n    kDiskKernel[17] = vec2(-0.6234896,-0.7818316);\n    kDiskKernel[18] = vec2(-0.22252055,-0.974928);\n    kDiskKernel[19] = vec2(0.2225215,-0.9749278);\n    kDiskKernel[20] = vec2(0.6234897,-0.7818316);\n    kDiskKernel[21] = vec2(0.90096885,-0.43388376);\n}\n\n#endif\n\n#if QUALITY == 2\n\n// rings = 4\n// points per ring = 7\nconst int kSampleCount = 43;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0.0,0.0);\n    kDiskKernel[1] = vec2(0.36363637,0.0);\n    kDiskKernel[2] = vec2(0.22672357,0.28430238);\n    kDiskKernel[3] = vec2(-0.08091671,0.35451925);\n    kDiskKernel[4] = vec2(-0.32762504,0.15777594);\n    kDiskKernel[5] = vec2(-0.32762504,-0.15777591);\n    kDiskKernel[6] = vec2(-0.08091656,-0.35451928);\n    kDiskKernel[7] = vec2(0.22672352,-0.2843024);\n    kDiskKernel[8] = vec2(0.6818182,0.0);\n    kDiskKernel[9] = vec2(0.614297,0.29582983);\n    kDiskKernel[10] = vec2(0.42510667,0.5330669);\n    kDiskKernel[11] = vec2(0.15171885,0.6647236);\n    kDiskKernel[12] = vec2(-0.15171883,0.6647236);\n    kDiskKernel[13] = vec2(-0.4251068,0.53306687);\n    kDiskKernel[14] = vec2(-0.614297,0.29582986);\n    kDiskKernel[15] = vec2(-0.6818182,0);\n    kDiskKernel[16] = vec2(-0.614297,-0.29582983);\n    kDiskKernel[17] = vec2(-0.42510656,-0.53306705);\n    kDiskKernel[18] = vec2(-0.15171856,-0.66472363);\n    kDiskKernel[19] = vec2(0.1517192,-0.6647235);\n    kDiskKernel[20] = vec2(0.4251066,-0.53306705);\n    kDiskKernel[21] = vec2(0.614297,-0.29582983);\n    kDiskKernel[22] = vec2(1.0,0.0);\n    kDiskKernel[23] = vec2(0.9555728,0.2947552);\n    kDiskKernel[24] = vec2(0.82623875,0.5633201);\n    kDiskKernel[25] = vec2(0.6234898,0.7818315);\n    kDiskKernel[26] = vec2(0.36534098,0.93087375);\n    kDiskKernel[27] = vec2(0.07473,0.9972038);\n    kDiskKernel[28] = vec2(-0.22252095,0.9749279);\n    kDiskKernel[29] = vec2(-0.50000006,0.8660254);\n    kDiskKernel[30] = vec2(-0.73305196,0.6801727);\n    kDiskKernel[31] = vec2(-0.90096885,0.43388382);\n    kDiskKernel[32] = vec2(-0.98883086,0.14904208);\n    kDiskKernel[33] = vec2(-0.9888308,-0.14904249);\n    kDiskKernel[34] = vec2(-0.90096885,-0.43388376);\n    kDiskKernel[35] = vec2(-0.73305184,-0.6801728);\n    kDiskKernel[36] = vec2(-0.4999999,-0.86602545);\n    kDiskKernel[37] = vec2(-0.222521,-0.9749279);\n    kDiskKernel[38] = vec2(0.07473029,-0.99720377);\n    kDiskKernel[39] = vec2(0.36534148,-0.9308736);\n    kDiskKernel[40] = vec2(0.6234897,-0.7818316);\n    kDiskKernel[41] = vec2(0.8262388,-0.56332);\n    kDiskKernel[42] = vec2(0.9555729,-0.29475483);\n}\n\n#endif\n\n#if QUALITY == 3\n\n// rings = 5\n// points per ring = 7\nconst int kSampleCount = 71;\nvec2 kDiskKernel[kSampleCount];\n\nvoid initKernel () {\n    kDiskKernel[0] = vec2(0,0);\n    kDiskKernel[1] = vec2(0.2758621,0.0);\n    kDiskKernel[2] = vec2(0.1719972,0.21567768);\n    kDiskKernel[3] = vec2(-0.061385095,0.26894566);\n    kDiskKernel[4] = vec2(-0.24854316,0.1196921);\n    kDiskKernel[5] = vec2(-0.24854316,-0.11969208);\n    kDiskKernel[6] = vec2(-0.061384983,-0.2689457);\n    kDiskKernel[7] = vec2(0.17199717,-0.21567771);\n    kDiskKernel[8] = vec2(0.51724136,0.0);\n    kDiskKernel[9] = vec2(0.46601835,0.22442262);\n    kDiskKernel[10] = vec2(0.32249472,0.40439558);\n    kDiskKernel[11] = vec2(0.11509705,0.50427306);\n    kDiskKernel[12] = vec2(-0.11509704,0.50427306);\n    kDiskKernel[13] = vec2(-0.3224948,0.40439552);\n    kDiskKernel[14] = vec2(-0.46601835,0.22442265);\n    kDiskKernel[15] = vec2(-0.51724136,0.0);\n    kDiskKernel[16] = vec2(-0.46601835,-0.22442262);\n    kDiskKernel[17] = vec2(-0.32249463,-0.40439564);\n    kDiskKernel[18] = vec2(-0.11509683,-0.5042731);\n    kDiskKernel[19] = vec2(0.11509732,-0.504273);\n    kDiskKernel[20] = vec2(0.32249466,-0.40439564);\n    kDiskKernel[21] = vec2(0.46601835,-0.22442262);\n    kDiskKernel[22] = vec2(0.7586207,0.0);\n    kDiskKernel[23] = vec2(0.7249173,0.22360738);\n    kDiskKernel[24] = vec2(0.6268018,0.4273463);\n    kDiskKernel[25] = vec2(0.47299224,0.59311354);\n    kDiskKernel[26] = vec2(0.27715522,0.7061801);\n    kDiskKernel[27] = vec2(0.056691725,0.75649947);\n    kDiskKernel[28] = vec2(-0.168809,0.7396005);\n    kDiskKernel[29] = vec2(-0.3793104,0.65698475);\n    kDiskKernel[30] = vec2(-0.55610836,0.51599306);\n    kDiskKernel[31] = vec2(-0.6834936,0.32915324);\n    kDiskKernel[32] = vec2(-0.7501475,0.113066405);\n    kDiskKernel[33] = vec2(-0.7501475,-0.11306671);\n    kDiskKernel[34] = vec2(-0.6834936,-0.32915318);\n    kDiskKernel[35] = vec2(-0.5561083,-0.5159932);\n    kDiskKernel[36] = vec2(-0.37931028,-0.6569848);\n    kDiskKernel[37] = vec2(-0.16880904,-0.7396005);\n    kDiskKernel[38] = vec2(0.056691945,-0.7564994);\n    kDiskKernel[39] = vec2(0.2771556,-0.7061799);\n    kDiskKernel[40] = vec2(0.47299215,-0.59311366);\n    kDiskKernel[41] = vec2(0.62680185,-0.4273462);\n    kDiskKernel[42] = vec2(0.72491735,-0.22360711);\n    kDiskKernel[43] = vec2(1.0,0.0);\n    kDiskKernel[44] = vec2(0.9749279,0.22252093);\n    kDiskKernel[45] = vec2(0.90096885,0.43388376);\n    kDiskKernel[46] = vec2(0.7818315,0.6234898);\n    kDiskKernel[47] = vec2(0.6234898,0.7818315);\n    kDiskKernel[48] = vec2(0.43388364,0.9009689);\n    kDiskKernel[49] = vec2(0.22252098,0.9749279);\n    kDiskKernel[50] = vec2(0.0,1.0);\n    kDiskKernel[51] = vec2(-0.22252095,0.9749279);\n    kDiskKernel[52] = vec2(-0.43388385,0.90096885);\n    kDiskKernel[53] = vec2(-0.62349,0.7818314);\n    kDiskKernel[54] = vec2(-0.7818317,0.62348956);\n    kDiskKernel[55] = vec2(-0.90096885,0.43388382);\n    kDiskKernel[56] = vec2(-0.9749279,0.22252093);\n    kDiskKernel[57] = vec2(-1.0,0.0);\n    kDiskKernel[58] = vec2(-0.9749279,-0.22252087);\n    kDiskKernel[59] = vec2(-0.90096885,-0.43388376);\n    kDiskKernel[60] = vec2(-0.7818314,-0.6234899);\n    kDiskKernel[61] = vec2(-0.6234896,-0.7818316);\n    kDiskKernel[62] = vec2(-0.43388346,-0.900969);\n    kDiskKernel[63] = vec2(-0.22252055,-0.974928);\n    kDiskKernel[64] = vec2(0.0,-1.0);\n    kDiskKernel[65] = vec2(0.2225215,-0.9749278);\n    kDiskKernel[66] = vec2(0.4338835,-0.90096897);\n    kDiskKernel[67] = vec2(0.6234897,-0.7818316);\n    kDiskKernel[68] = vec2(0.78183144,-0.62348986);\n    kDiskKernel[69] = vec2(0.90096885,-0.43388376);\n    kDiskKernel[70] = vec2(0.9749279,-0.22252086);\n}\n\n#endif\n\nuniform sampler2D u_cocTexture;\nuniform vec2 u_cocTexelSize;\n\n// Camera parameters\nuniform float u_rcpAspect;\nuniform float u_maxCoC;\n// uniform float u_rcpMaxCoC;\n\nvarying vec2 v_uv;\n\nvoid main () {\n\tinitKernel();\n\n\tvec4 samp0 = texture2D(u_cocTexture, v_uv);\n    #ifndef USE_FLOAT\n    samp0 = samp0 * 2.0 - 1.0;\n    samp0 = sign(samp0) * samp0 * samp0;\n    #endif\n\n    vec4 bgAcc = vec4(0.0); // Background: far field bokeh\n    vec4 fgAcc = vec4(0.0); // Foreground: near field bokeh\n\n    for (int si = 0; si < kSampleCount; si++) {\n        vec2 disp = kDiskKernel[si] * u_maxCoC;\n        float dist = length(disp);\n\n        vec2 duv = vec2(disp.x * u_rcpAspect, disp.y);\n        vec4 samp = texture2D(u_cocTexture, v_uv + duv);\n        #ifndef USE_FLOAT\n        samp = samp * 2.0 - 1.0;\n        samp = sign(samp) * samp * samp;\n        #endif\n\n        // BG: Compare CoC of the current sample and the center sample\n        // and select smaller one.\n        float bgCoC = max(min(samp0.a, samp.a), 0.0);\n\n        // Compare the CoC to the sample distance.\n        // Add a small margin to smooth out.\n        float margin = u_cocTexelSize.y * 2.0;\n        float bgWeight = clamp((bgCoC   - dist + margin) / margin, 0.0, 1.0);\n        float fgWeight = clamp((-samp.a - dist + margin) / margin, 0.0, 1.0);\n\n        // Cut influence from focused areas because they're darkened by CoC\n        // premultiplying. This is only needed for near field.\n        fgWeight *= step(u_cocTexelSize.y, -samp.a);\n\n        // Accumulation\n        bgAcc += vec4(samp.rgb, 1.0) * bgWeight;\n        fgAcc += vec4(samp.rgb, 1.0) * fgWeight;\n    }\n\n    // Get the weighted average.\n    // bgAcc.rgb /= bgAcc.a + (bgAcc.a == 0); // zero-div guard\n    // fgAcc.rgb /= fgAcc.a + (fgAcc.a == 0);\n    bgAcc.rgb /= bgAcc.a + step(bgAcc.a, 0.0); // zero-div guard\n    fgAcc.rgb /= fgAcc.a + step(fgAcc.a, 0.0);\n\n    // BG: Calculate the alpha value only based on the center CoC.\n    // This is a rather aggressive approximation but provides stable results.\n    bgAcc.a = smoothstep(u_cocTexelSize.y, u_cocTexelSize.y * 2.0, samp0.a);\n\n    // FG: Normalize the total of the weights.\n    fgAcc.a *= 3.14159265359 / float(kSampleCount);\n\n    // Alpha premultiplying\n    vec3 rgb = vec3(0.0);\n    rgb = mix(rgb, bgAcc.rgb, clamp(bgAcc.a, 0.0, 1.0));\n    rgb = mix(rgb, fgAcc.rgb, clamp(fgAcc.a, 0.0, 1.0));\n\n    // Combined alpha value\n    float alpha = (1.0 - clamp(bgAcc.a, 0.0, 1.0)) * (1.0 - clamp(fgAcc.a, 0.0, 1.0));\n\n    gl_FragColor = vec4(rgb, alpha);\n}"])}),this.blurMaterial=new s.RawShaderMaterial({uniforms:{u_bokehTexture:{value:null},u_bokehTexelSize:this.sharedUniforms.u_halfTexelSize},vertexShader:i.precisionPrefix+i.vertexShader,fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nuniform sampler2D u_bokehTexture;\nuniform vec2 u_bokehTexelSize;\n\nvarying vec2 v_uv;\n\nvoid main () {\n    // 9-tap tent filter\n    vec4 duv = u_bokehTexelSize.xyxy * vec4(1.0, 1.0, -1.0, 0.0);\n    vec4 acc;\n\n    acc  = texture2D(u_bokehTexture, v_uv - duv.xy);\n    acc += texture2D(u_bokehTexture, v_uv - duv.wy) * 2.0;\n    acc += texture2D(u_bokehTexture, v_uv - duv.zy);\n\n    acc += texture2D(u_bokehTexture, v_uv + duv.zw) * 2.0;\n    acc += texture2D(u_bokehTexture, v_uv ) * 4.0;\n    acc += texture2D(u_bokehTexture, v_uv + duv.xw) * 2.0;\n\n    acc += texture2D(u_bokehTexture, v_uv + duv.zy);\n    acc += texture2D(u_bokehTexture, v_uv + duv.wy) * 2.0;\n    acc += texture2D(u_bokehTexture, v_uv + duv.xy);\n\n    gl_FragColor = acc * 0.0625;\n}"])}),u.constructor.call(this,a({uniforms:{u_blurTexture:{value:null}},fragmentShader:i.precisionPrefix+o(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\nuniform sampler2D u_blurTexture;\nvoid main() {\n\tvec4 cs = texture2D(u_texture, v_uv);\n\tvec4 cb = texture2D(u_blurTexture, v_uv);\n\tvec3 rgb = cs.rgb * cb.a + cb.rgb;\n\n\tgl_FragColor =  vec4(rgb, cs.a);\n}\n"]),blending:s.NoBlending},e))}var u=r.prototype,c=l.prototype=Object.create(u);c.constructor=l,c.setPostprocessing=function(e){u.setPostprocessing.call(this,e);var t=e.width,n=e.height,r=Math.ceil(t/2),i=Math.ceil(n/2);this._halfWidth=r,this._halfHeight=i,this.rt1&&this.rt1.setSize(r,i),this.rt2.setSize(r,i),this.rt3.setSize(r,i),this.sharedUniforms.u_halfTexelSize.value.set(1/r,1/i)},c.dispose=function(){this.rt1&&this.rt1.dispose(),this.rt2.dispose(),this.rt3.dispose()},c.needsRender=function(){return!0},c.render=function(e,t){var n,r,a,o=this._prevQuality!==this.quality,l=this._prevUseFloatTexture!==this.useFloatTexture,c=this.useCameraFov?(a=e.sharedUniforms.u_cameraFovRad.value,.5*e.camera.getFilmHeight()/Math.tan(.5*a)):this.focalLength,h=this.focusDistance,d=this.fNumber,p=c*c/(d*(h-c)*this.kFilmHeight*2),f=(n=e.height,r=4*this.quality+6,Math.min(.05,r/n));this.sharedUniforms.u_texelSize.value=e.sharedUniforms.u_texelSize.value,this.sharedUniforms.u_depthTexture.value=e.sharedUniforms.u_sceneDepthTexture.value,this.sharedUniforms.u_cameraNear.value=e.sharedUniforms.u_cameraNear.value,this.sharedUniforms.u_cameraFar.value=e.sharedUniforms.u_cameraFar.value,this.sharedUniforms.u_focusDistance.value=h,this.sharedUniforms.u_fNumber.value=d,this.sharedUniforms.u_lensCoeff.value=p,this.sharedUniforms.u_maxCoC.value=f,this.sharedUniforms.u_rcpMaxCoC.value=1/f,this.sharedUniforms.u_rcpAspect.value=e.height/e.width,l&&(this.rt1&&this.rt1.dispose(),this.rt1=i.createRenderTarget(this._halfWidth,this._halfHeight,!0,!1,this.useFloatTexture)),e.fromTexture.minFilter=e.fromTexture.magFilter=s.NearestFilter,l&&(this.cocMaterial.defines.USE_FLOAT=this.useFloatTexture,this.cocMaterial.needsUpdate=!0),this.cocMaterial.uniforms.u_hashNoise.value=(this.cocMaterial.uniforms.u_hashNoise.value+1.2415)%100,this.cocMaterial.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.cocMaterial,this.rt1),e.fromTexture.minFilter=e.fromTexture.magFilter=s.LinearFilter,this.simMaterial.defines.QUALITY=this.quality,this.simMaterial.uniforms.u_cocTexture.value=this.rt1.texture,o&&(this.simMaterial.needsUpdate=!0),l&&(this.simMaterial.defines.USE_FLOAT=this.useFloatTexture,this.simMaterial.needsUpdate=!0),e.renderMaterial(this.simMaterial,this.rt2),this.useAdditionalBlur&&(this.blurMaterial.uniforms.u_bokehTexture.value=this.rt2.texture,e.renderMaterial(this.blurMaterial,this.rt3)),this.material.uniforms.u_blurTexture.value=this.useAdditionalBlur?this.rt3.texture:this.rt2.texture,this._prevQuality=this.quality,this._prevUseFloatTexture=this.useFloatTexture,u.render.call(this,e,t,e.fromTexture)},t.exports=l},{"../../helpers/fboHelper":72,"../../utils/math":115,"../PostEffect":83,glslify:21,"mout/object/mixIn":40,three:59}],87:[function(e,t,n){"use strict";var r=e("../PostEffect"),i=e("../../helpers/fboHelper"),a=e("../../effects/blur/blur"),o=(e("../../utils/math"),e("mout/object/merge")),s=e("mout/object/mixIn"),l=(e("../../core/settings"),e("../../core/properties")),u=e("glslify"),c=e("three");function h(e){e=o({bgColor:new c.Color(0),vignetteFrom:.6,vignetteTo:1.6,vignetteAspect:new c.Vector2,vignetteColor:new c.Color(0),saturation:1,contrast:0,brightness:1,blurRatio:0,maskTexture:null,maskRatio:1,maskInRatio:1,maskInFrameMax:254,maskAspect:new c.Vector2,tintColor:new c.Color(0),tintOpacity:1,opacity:1,borderSize:new c.Vector2(24,24),borderNoiseScale:2,borderNoiseSpeed:.1,borderNoiseIntensity:.2},e),this.blurRenderTarget=i.createRenderTarget(1,1),d.constructor.call(this,o({uniforms:{u_vignetteFrom:{value:0},u_vignetteTo:{value:0},u_vignetteAspect:{value:e.vignetteAspect},u_vignetteColor:{value:e.vignetteColor},u_saturation:{value:0},u_contrast:{value:0},u_brightness:{value:0},u_tintColor:{value:e.tintColor},u_tintOpacity:{value:0},u_bgColor:{value:e.bgColor},u_opacity:{value:0},u_ditherSeed:{value:0}},fragmentShader:i.precisionPrefix+u(["#define GLSLIFY 1\nvarying vec2 v_uv;\nuniform sampler2D u_texture;\nuniform vec3 u_bgColor;\nuniform float u_opacity;\n\nuniform float u_vignetteFrom;\nuniform float u_vignetteTo;\nuniform vec2 u_vignetteAspect;\nuniform vec3 u_vignetteColor;\n\nuniform float u_saturation;\nuniform float u_contrast;\nuniform float u_brightness;\n\nuniform vec3 u_tintColor;\nuniform float u_tintOpacity;\nuniform float u_ditherSeed;\n\n#ifdef IS_MASK\nuniform sampler2D u_maskTexture;\nuniform float u_maskRatio;\nuniform float u_maskInRatio;\nuniform float u_maskInFrameRatio;\nuniform vec2 u_maskAspect;\n#endif\n\nfloat hash13(vec3 p3) {\n\tp3  = fract(p3 * .1031);\n    p3 += dot(p3, p3.yzx + 33.33);\n    return fract((p3.x + p3.y) * p3.z);\n}\n\nvec3 screen (vec3 cb, vec3 cs) {\n\treturn cb + cs - (cb * cs);\n}\n\nvec3 colorDodge (vec3 cb, vec3 cs) {\n\treturn mix(\n\t\tmin(vec3(1.0), cb / (1.0 - cs)),\n\t\tvec3(1.0),\n\t\tstep(vec3(1.0), cs)\n\t);\n}\nvoid main() {\n\n\tfloat opacity = 1.0;//\n\tvec2 uv = v_uv;\n\n\t#ifdef IS_MASK\n\t\tvec2 maskUv = (v_uv - 0.5) * u_maskAspect * 1.25 / mix(3.0, 1.0, u_maskRatio);\n\t\tfloat maskD = length(maskUv);\n\t\tfloat angle = atan(maskUv.y, maskUv.x);\n\t\tfloat oriDist = maskD;\n\n\t\tfloat distortedDist = maskD * 3.1415926 * 2.0 * u_maskRatio;\n\t\tfloat distortion = cos(distortedDist * distortedDist);\n\t\tmaskD *= distortion;\n\t\tmaskD = mix(maskD, oriDist, u_maskRatio);\n\t\tmaskUv = vec2(\n\t\t\tcos(angle),\n\t\t\tsin(angle)\n\t\t) * maskD;\n\n\t\tvec4 maskInfo = texture2D(u_maskTexture, maskUv + 0.5);\n\t\tfloat mask = smoothstep(maskInfo.r / u_maskInFrameRatio, maskInfo.r / u_maskInFrameRatio + 0.1, u_maskInRatio * 1.1);\n\t\topacity = mask * (1.0 - maskInfo.b);\n\t\topacity = 1.0 - (1.0 - opacity)  * smoothstep(0.0, 0.25 + opacity * 0.75, u_maskRatio);\n\t\tuv.xy += ((1.0 - mask) + 1.0 - u_maskInRatio * u_maskInRatio) * 0.025 * maskInfo.b;\n\t#endif\n\n\tvec3 color = texture2D(u_texture, uv).rgb;\n\n\tfloat d = length((uv - 0.5) * u_vignetteAspect) * 2.0;\n\tcolor = mix(color, u_vignetteColor, smoothstep(u_vignetteFrom, u_vignetteTo, d));\n\n\tfloat luma = dot(color, vec3(0.299, 0.587, 0.114));\n\n\tcolor = mix(vec3(luma), color, 1.0 + u_saturation);\n\tcolor = 0.5 + (1.0 + u_contrast) * (color - 0.5);\n\tcolor += u_brightness;\n\tcolor = clamp(color, vec3(0.0), vec3(1.0));\n\n\t// linear dodge add\n\tcolor = mix(color, screen(colorDodge(color, u_tintColor), u_tintColor), u_tintOpacity);\n\n\topacity *= u_opacity;\n\t\n\tgl_FragColor = vec4(mix(u_bgColor, color, opacity) + hash13(vec3(gl_FragCoord.xy, u_ditherSeed)) / 255.0, 1.0);\n}\n"]),blending:c.NoBlending},e)),this.noMaskMaterial=this.material,this.maskMaterial=new c.RawShaderMaterial({uniforms:s({u_maskTexture:{value:this.maskTexture},u_maskRatio:{value:1},u_maskInRatio:{value:0},u_maskInFrameRatio:{value:(this.maskInFrameMax-1)/255},u_maskAspect:{value:e.maskAspect}},this.material.uniforms),vertexShader:this.material.vertexShader,fragmentShader:this.material.fragmentShader}),this.maskMaterial.defines.IS_MASK=!0,this._createBorder()}t.exports=h;var d=r.prototype,p=h.prototype=Object.create(d);p.constructor=h,p._createBorder=function(){var e=this.borderGeometry=new c.InstancedBufferGeometry,t=new c.PlaneBufferGeometry(2,1,512,1);for(var n in t.translate(0,.5,0),t.attributes)e.setAttribute(n,t.attributes[n]);e.setIndex(t.getIndex()),e.setAttribute("instancePosition",new c.InstancedBufferAttribute(new Float32Array([0,-1,-1,0,0,1,1,0]),2)),e.setAttribute("instanceId",new c.InstancedBufferAttribute(new Float32Array([0,1,2,3]),1)),this.borderMaterial=new c.RawShaderMaterial({uniforms:{u_borderSize:{value:new c.Vector2},u_aspect:{value:new c.Vector2},u_noiseScale:{value:1},u_noiseIntensity:{value:1},u_time:{value:0},u_resolution:null},vertexShader:i.precisionPrefix+u(["#define GLSLIFY 1\nattribute vec2 position;\nattribute vec2 instancePosition;\nattribute float instanceId;\n\nuniform vec2 u_borderSize;\nuniform vec2 u_aspect;\nuniform float u_noiseScale;\nuniform float u_noiseIntensity;\nuniform float u_time;\n\nuniform vec2 u_resolution;\n\nvarying float v_wMax;\nvarying float v_w;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nvec2 rotate(vec2 v, float a) {\n\tfloat s = sin(a);\n\tfloat c = cos(a);\n\tmat2 m = mat2(c, -s, s, c);\n\treturn m * v;\n}\n\nvoid main () {\n\tvec2 pos = position;\n\tfloat isLeftRight= mod(floor(instanceId + 0.5), 2.0) > 0.5 ? 1.0 : 0.0;\n\tfloat borderSize = isLeftRight > 0.5 ? u_borderSize.x : u_borderSize.y;\n\tfloat noiseScale = isLeftRight > 0.5 ? u_noiseScale : u_noiseScale * u_aspect.x;\n\n\tfloat noise = snoise(vec3(pos.x * noiseScale * 2.0, instanceId * 10.0, u_time));\n\tfloat noiseOffset = u_noiseIntensity * snoise(vec3(pos.x * noiseScale + 100.0, instanceId * 10.0, u_time * 1.5 + noise));\n\n\tv_wMax = borderSize * (1.0 + noiseOffset);\n\tv_w = pos.y * v_wMax;\n\tpos.y  = v_w;\n\n\tfloat wScale = isLeftRight > 0.5 ? u_resolution.x : u_resolution.y;\n\tv_wMax *= wScale;\n\tv_w *= wScale;\n\n\tpos = rotate(pos, instanceId * 1.5707963267948966) + instancePosition;\n\n\tgl_Position = vec4(pos, 0.0, 1.0);\n}"]),fragmentShader:i.precisionPrefix+u(["#define GLSLIFY 1\nvarying float v_wMax;\nvarying float v_w;\n\nvoid main () {\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, smoothstep(v_wMax, v_wMax - 2.0, v_w));\n}"]),depthTest:!1,depthWrite:!1,transparent:!0})},p.needsRender=function(){return!0},p.render=function(e,t){var n=e.width,r=e.height;if(n===this.blurRenderTarget.width&&r===this.blurRenderTarget.height||this.blurRenderTarget.setSize(n,r),this.uniforms.u_vignetteFrom.value=this.vignetteFrom,this.uniforms.u_vignetteTo.value=this.vignetteTo,this.uniforms.u_vignetteAspect.value.set(n/r,1).multiplyScalar(r/Math.sqrt(n*n+r*r)),this.uniforms.u_saturation.value=this.saturation-1,this.uniforms.u_contrast.value=this.contrast,this.uniforms.u_brightness.value=this.brightness-1,this.uniforms.u_tintOpacity.value=this.tintOpacity,this.uniforms.u_opacity.value=this.opacity,this.uniforms.u_ditherSeed.value=1e3*Math.random(),this.maskRatio>0?(this.material=this.maskMaterial,this.material.uniforms.u_maskRatio.value=this.maskRatio,this.material.uniforms.u_maskInRatio.value=this.maskInRatio,this.material.uniforms.u_maskAspect.value.set(n/r,1)):this.material=this.noMaskMaterial,this.blurRatio>0){var o=this.blurRatio/e.camera.zoom*r/500;a.blur9(2*o,.5,e.fromRenderTarget,this.blurRenderTarget,e.fromRenderTarget),a.blur9(4*o,.5,e.fromRenderTarget,this.blurRenderTarget,e.fromRenderTarget),a.blur9(8*o,.25,e.fromRenderTarget,this.blurRenderTarget,e.fromRenderTarget)}this.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.material,t?null:e.toRenderTarget),e.swap();var s=i.getColorState();i.renderer.autoClear=!1,this.borderMaterial.uniforms.u_borderSize.value.set(this.borderSize.x/l.rawWidth*2,this.borderSize.y/l.rawHeight*2),this.borderMaterial.uniforms.u_aspect.value.set(n/r,1),this.borderMaterial.uniforms.u_noiseScale.value=this.borderNoiseScale*l.rawHeight/1e3,this.borderMaterial.uniforms.u_noiseIntensity.value=this.borderNoiseIntensity,this.borderMaterial.uniforms.u_time.value+=this.borderNoiseSpeed*l.dt,this.borderMaterial.uniforms.u_resolution=e.sharedUniforms.u_resolution,i.renderGeometry(this.borderGeometry,this.borderMaterial,t?null:e.toRenderTarget),i.setColorState(s),e.swap()}},{"../../core/properties":68,"../../core/settings":69,"../../effects/blur/blur":70,"../../helpers/fboHelper":72,"../../utils/math":115,"../PostEffect":83,glslify:21,"mout/object/merge":39,"mout/object/mixIn":40,three:59}],88:[function(e,t,n){"use strict";var r=e("../../helpers/fboHelper"),i=e("../PostEffect"),a=e("mout/object/merge"),o=e("three"),s=e("glslify");function l(e){e=a({},e),this.edgesRenderTarget=r.createRenderTarget(1,1),this.weightsRenderTarget=r.createRenderTarget(1,1,!0),this.uResolutionInv={value:new o.Vector2},u.constructor.call(this,a({uniforms:{u_weightsTexture:{value:this.weightsRenderTarget.texture},u_resolutionInv:this.uResolutionInv},vertexShader:r.precisionPrefix+s(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 2 ];\n\nvoid SMAANeighborhoodBlendingVS( vec2 texcoord ) {\n  v_offsets[ 0 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component\n  v_offsets[ 1 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n}\n\nvoid main() {\n\tv_uv = position.xy * 0.5 + 0.5;\n\n  SMAANeighborhoodBlendingVS( v_uv );\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = vec4( position, 1.0 );\n\n}\n"]),fragmentShader:r.precisionPrefix+s(["#define GLSLIFY 1\nuniform sampler2D u_weightsTexture;\nuniform sampler2D u_texture;\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 2 ];\n\nvec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {\n  // Fetch the blending weights for current pixel:\n  vec4 a;\n  a.xz = texture2D( blendTex, texcoord ).xz;\n  a.y = texture2D( blendTex, offset[ 1 ].zw ).g;\n  a.w = texture2D( blendTex, offset[ 1 ].xy ).a;\n\n  // Is there any blending weight with a value greater than 0.0?\n  if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {\n    return texture2D( colorTex, texcoord, 0.0 );\n  } else {\n    // Up to 4 lines can be crossing a pixel (one through each edge). We\n    // favor blending by choosing the line with the maximum weight for each\n    // direction:\n    vec2 offset;\n    offset.x = a.a > a.b ? a.a : -a.b; // left vs. right\n    offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs\n\n    // Then we go in the direction that has the maximum weight:\n    if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical\n      offset.y = 0.0;\n    } else {\n      offset.x = 0.0;\n    }\n\n    // Fetch the opposite color and lerp by hand:\n    vec4 C = texture2D( colorTex, texcoord, 0.0 );\n    texcoord += sign( offset ) * u_resolutionInv;\n    vec4 Cop = texture2D( colorTex, texcoord, 0.0 );\n    float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );\n\n    // WebGL port note: Added gamma correction\n    C.xyz = pow(abs(C.xyz), vec3(2.2));\n    Cop.xyz = pow(abs(Cop.xyz), vec3(2.2));\n    vec4 mixed = mix(C, Cop, s);\n    mixed.xyz = pow(abs(mixed.xyz), vec3(1.0 / 2.2));\n\n    return mixed;\n  }\n}\n\nvoid main() {\n\n  gl_FragColor = SMAANeighborhoodBlendingPS( v_uv, v_offsets, u_texture, u_weightsTexture );\n}\n"])},e)),this.edgesMaterial=new o.RawShaderMaterial({uniforms:{u_texture:{value:null},u_resolutionInv:this.uResolutionInv},vertexShader:r.precisionPrefix+s(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 3 ];\n\nvoid SMAAEdgeDetectionVS( vec2 texcoord ) {\n  v_offsets[ 0 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component\n  v_offsets[ 1 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component\n  v_offsets[ 2 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component\n}\n\nvoid main() {\n\n\tv_uv = position.xy * 0.5 + 0.5;\n\n  SMAAEdgeDetectionVS( v_uv );\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = vec4( position, 1.0 );\n\n}\n"]),fragmentShader:r.precisionPrefix+s(["#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 3 ];\n\nvec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {\n  vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );\n\n  // Calculate color deltas:\n  vec4 delta;\n  vec3 C = texture2D( colorTex, texcoord ).rgb;\n\n  vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;\n  vec3 t = abs( C - Cleft );\n  delta.x = max( max( t.r, t.g ), t.b );\n\n  vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;\n  t = abs( C - Ctop );\n  delta.y = max( max( t.r, t.g ), t.b );\n\n  // We do the usual threshold:\n  vec2 edges = step( threshold, delta.xy );\n\n  // Then discard if there is no edge:\n  if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )\n    discard;\n\n  // Calculate right and bottom deltas:\n  vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;\n  t = abs( C - Cright );\n  delta.z = max( max( t.r, t.g ), t.b );\n\n  vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;\n  t = abs( C - Cbottom );\n  delta.w = max( max( t.r, t.g ), t.b );\n\n  // Calculate the maximum delta in the direct neighborhood:\n  float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );\n\n  // Calculate left-left and top-top deltas:\n  vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;\n  t = abs( C - Cleftleft );\n  delta.z = max( max( t.r, t.g ), t.b );\n\n  vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;\n  t = abs( C - Ctoptop );\n  delta.w = max( max( t.r, t.g ), t.b );\n\n  // Calculate the final maximum delta:\n  maxDelta = max( max( maxDelta, delta.z ), delta.w );\n\n  // Local contrast adaptation in action:\n  edges.xy *= step( 0.5 * maxDelta, delta.xy );\n\n  return vec4( edges, 0.0, 0.0 );\n}\n\nvoid main() {\n\n  gl_FragColor = SMAAColorEdgeDetectionPS( v_uv, v_offsets, u_texture );\n\n}\n"]),defines:{SMAA_THRESHOLD:"0.1"},blending:o.NoBlending,depthTest:!1,depthWrite:!1}),this.weightsMaterial=new o.RawShaderMaterial({uniforms:{u_edgesTexture:{value:this.edgesRenderTarget.texture},u_areaTexture:h.u_areaTexture,u_searchTexture:h.u_searchTexture,u_resolutionInv:this.uResolutionInv},vertexShader:r.precisionPrefix+s(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[ 3 ];\nvarying vec2 v_pixcoord;\n\nvoid SMAABlendingWeightCalculationVS( vec2 texcoord ) {\n  v_pixcoord = texcoord / u_resolutionInv;\n\n  // We will use these offsets for the searches later on (see @PSEUDO_GATHER4):\n  v_offsets[ 0 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components\n  v_offsets[ 1 ] = texcoord.xyxy + u_resolutionInv.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components\n\n  // And these for the searches, they indicate the ends of the loops:\n  v_offsets[ 2 ] = vec4( v_offsets[ 0 ].xz, v_offsets[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * u_resolutionInv.xxyy * float( SMAA_MAX_SEARCH_STEPS );\n\n}\n\nvoid main() {\n\tv_uv = position.xy * 0.5 + 0.5;\n\n  SMAABlendingWeightCalculationVS( v_uv );\n\n  // gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = vec4( position, 1.0 );\n\n}\n"]),fragmentShader:r.precisionPrefix+s(["#define GLSLIFY 1\n#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * u_resolutionInv, 0.0 )\n\nuniform sampler2D u_edgesTexture;\nuniform sampler2D u_areaTexture;\nuniform sampler2D u_searchTexture;\nuniform vec2 u_resolutionInv;\n\nvarying vec2 v_uv;\nvarying vec4 v_offsets[3];\nvarying vec2 v_pixcoord;\n\nvec2 round( vec2 x ) {\n  return sign( x ) * floor( abs( x ) + 0.5 );\n}\n\nfloat SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {\n  // Not required if searchTex accesses are set to point:\n  // float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);\n  // e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +\n  //     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;\n  e.r = bias + e.r * scale;\n  return 255.0 * texture2D( searchTex, e, 0.0 ).r;\n}\n\nfloat SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  /**\n  * @PSEUDO_GATHER4\n  * This texcoord has been offset by (-0.25, -0.125) in the vertex shader to\n  * sample between edge, thus fetching four edges in a row.\n  * Sampling with different offsets in each direction allows to disambiguate\n  * which edges are active from the four fetched ones.\n  */\n  vec2 e = vec2( 0.0, 1.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord -= vec2( 2.0, 0.0 ) * u_resolutionInv;\n    if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n  }\n\n  // We correct the previous (-0.25, -0.125) offset we applied:\n  texcoord.x += 0.25 * u_resolutionInv.x;\n\n  // The searches are bias by 1, so adjust the coords accordingly:\n  texcoord.x += u_resolutionInv.x;\n\n  // Disambiguate the length added by the last step:\n  texcoord.x += 2.0 * u_resolutionInv.x; // Undo last step\n  texcoord.x -= u_resolutionInv.x * SMAASearchLength(searchTex, e, 0.0, 0.5);\n\n  return texcoord.x;\n}\n\nfloat SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  vec2 e = vec2( 0.0, 1.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord += vec2( 2.0, 0.0 ) * u_resolutionInv;\n    if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;\n  }\n\n  texcoord.x -= 0.25 * u_resolutionInv.x;\n  texcoord.x -= u_resolutionInv.x;\n  texcoord.x -= 2.0 * u_resolutionInv.x;\n  texcoord.x += u_resolutionInv.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );\n\n  return texcoord.x;\n}\n\nfloat SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  vec2 e = vec2( 1.0, 0.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord += vec2( 0.0, 2.0 ) * u_resolutionInv; // WebGL port note: Changed sign\n    if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n  }\n\n  texcoord.y -= 0.25 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y -= u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y -= 2.0 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y += u_resolutionInv.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign\n\n  return texcoord.y;\n}\n\nfloat SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {\n  vec2 e = vec2( 1.0, 0.0 );\n\n  for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for\n    e = texture2D( edgesTex, texcoord, 0.0 ).rg;\n    texcoord -= vec2( 0.0, 2.0 ) * u_resolutionInv; // WebGL port note: Changed sign\n    if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;\n  }\n\n  texcoord.y += 0.25 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y += u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y += 2.0 * u_resolutionInv.y; // WebGL port note: Changed sign\n  texcoord.y -= u_resolutionInv.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign\n\n  return texcoord.y;\n}\n\nvec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {\n  // Rounding prevents precision errors of bilinear filtering:\n  vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;\n\n  // We do a scale and bias for mapping to texel space:\n  texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );\n\n  // Move to proper place, according to the subpixel offset:\n  texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;\n\n  return texture2D( areaTex, texcoord, 0.0 ).rg;\n}\n\nvec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {\n  vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );\n\n  vec2 e = texture2D( edgesTex, texcoord ).rg;\n\n  if ( e.g > 0.0 ) { // Edge at north\n    vec2 d;\n\n    // Find the distance to the left:\n    vec2 coords;\n    coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );\n    coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * u_resolutionInv.y (@CROSSING_OFFSET)\n    d.x = coords.x;\n\n    // Now fetch the left crossing edges, two at a time using bilinear\n    // filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to\n    // discern what value each edge has:\n    float e1 = texture2D( edgesTex, coords, 0.0 ).r;\n\n    // Find the distance to the right:\n    coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );\n    d.y = coords.x;\n\n    // We want the distances to be in pixel units (doing this here allow to\n    // better interleave arithmetic and memory accesses):\n    d = d / u_resolutionInv.x - pixcoord.x;\n\n    // SMAAArea below needs a sqrt, as the areas texture is compressed\n    // quadratically:\n    vec2 sqrt_d = sqrt( abs( d ) );\n\n    // Fetch the right crossing edges:\n    coords.y -= 1.0 * u_resolutionInv.y; // WebGL port note: Added\n    float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;\n\n    // Ok, we know how this pattern looks like, now it is time for getting\n    // the actual area:\n    weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );\n  }\n\n  if ( e.r > 0.0 ) { // Edge at west\n    vec2 d;\n\n    // Find the distance to the top:\n    vec2 coords;\n\n    coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );\n    coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * u_resolutionInv.x;\n    d.x = coords.y;\n\n    // Fetch the top crossing edges:\n    float e1 = texture2D( edgesTex, coords, 0.0 ).g;\n\n    // Find the distance to the bottom:\n    coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );\n    d.y = coords.y;\n\n    // We want the distances to be in pixel units:\n    d = d / u_resolutionInv.y - pixcoord.y;\n\n    // SMAAArea below needs a sqrt, as the areas texture is compressed\n    // quadratically:\n    vec2 sqrt_d = sqrt( abs( d ) );\n\n    // Fetch the bottom crossing edges:\n    coords.y -= 1.0 * u_resolutionInv.y; // WebGL port note: Added\n    float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;\n\n    // Get the area for this direction:\n    weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );\n  }\n\n  return weights;\n}\n\nvoid main() {\n\n  gl_FragColor = SMAABlendingWeightCalculationPS( v_uv, v_pixcoord, v_offsets, u_edgesTexture, u_areaTexture, u_searchTexture, ivec4( 0.0 ) );\n\n}\n"]),defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},transparent:!0,blending:o.NoBlending,depthTest:!1,depthWrite:!1})}var u=i.prototype,c=l.prototype=Object.create(u);c.constructor=l,c.setPostprocessing=function(e){u.setPostprocessing.call(this,e);var t=e.width,n=e.height;this.edgesRenderTarget.setSize(t,n),this.weightsRenderTarget.setSize(t,n),this.uResolutionInv.value.set(1/t,1/n)},c.dispose=function(){this.edgesRenderTarget&&this.edgesRenderTarget.dispose(),this.weightsRenderTarget&&this.weightsRenderTarget.dispose()},c.needsRender=function(){return!h.u_areaTexture.value.needsUpdate},c.render=function(e,t){var n=r.getColorState();h.u_searchTexture.value||console.warn("You need to use Smaa.setImages() to set the smaa textures manually and assign to this class.");var i=r.renderer;i.autoClear=!0,i.setClearColor(0,0),this.edgesMaterial.uniforms.u_texture.value=e.fromTexture,e.renderMaterial(this.edgesMaterial,this.edgesRenderTarget,!0),e.renderMaterial(this.weightsMaterial,this.weightsRenderTarget,!0),r.setColorState(n),this.material.uniforms.u_texture.value=e.fromTexture,u.render.call(this,e,t)},(n=t.exports=l).setTextures=function(e,t){var n;(n=h.u_areaTexture.value=d(e)).format=o.RGBFormat,n.minFilter=o.LinearFilter,(n=h.u_searchTexture.value=d(t)).magFilter=o.NearestFilter,n.minFilter=o.NearestFilter},n.updateTextures=function(){h.u_areaTexture.value.needsUpdate=!0,h.u_searchTexture.value.needsUpdate=!0};var h={u_areaTexture:{value:null},u_searchTexture:{value:null}};function d(e){var t=new o.Texture(e);return t.generateMipmaps=!1,t.flipY=!1,t}},{"../../helpers/fboHelper":72,"../PostEffect":83,glslify:21,"mout/object/merge":39,three:59}],89:[function(e,t,n){"use strict";e("three"),t.exports=[e("./sceneData0"),e("./sceneData1"),e("./sceneData2"),e("./sceneData3"),e("./sceneData4"),e("./sceneData5")]},{"./sceneData0":90,"./sceneData1":91,"./sceneData2":92,"./sceneData3":93,"./sceneData4":94,"./sceneData5":95,three:59}],90:[function(e,t,n){"use strict";t.exports={properties:{bloomAmount:3.7170400000000003,bloomRadius:-.13,bloomThreshold:.5,bloomSmoothWidth:1.0015500000000002,haloWidth:.8,haloRGBShift:.03,haloStrength:.3,haloMaskInner:.8255,haloMaskOuter:1,vignetteFrom:.47665,vignetteTo:1.1714600000000002,vignetteColorHex:"#0b1f23",saturation:1,contrast:0,brightness:1,tintColorHex:"#05c5e0",tintOpacity:.30226000000000003,bokehFNumber:.36849000000000004,bokehFocusDistance:6.2,bokehFocalLength:.27813000000000004,bokehKFilmHeight:36,cameraDistance:3,cameraLookStrength:.032,cameraShakeStrength:.3},bgm:"forest",fishSplashSkipped:!0,dialogs:[{audio:"scene_0_a",text:"The story of a bird family crossing the river.",audioText:"The story of a bird family crossing the river.",char:"narrative",wait:0,hold:3},{audio:"scene_0_b",text:"Follow my lead!",audioText:"'Follow my lead!' Says mummy bird.",char:"mum",charExpression:0,wait:1,hold:2}],anchors:{scene_0_action_0:{position:[2.189745327751295,.2740236055131594,-3.9709062387901293],interaction:"clickToShow",interactionTarget:"rabbit",interactionAnimation:"bounce"}},camera:{position:[-2.762356237918326,1.3777616630604739,6.531078755004214],rotation:[-.11132160526100472,-.28327408879694277,-.031233479989794175,"XYZ"],cameraDistance:5},characters:{mum:{position:[-1.4556961861238171,.4983714787276823,-.1645034910428037],rotation:[2.4587583476582404,1.561557261548187,-2.4762973938630655,"XYZ"],action:"bounce",actionStrength:1,scale:.3},babyWalk:{position:[-1.9316698312012284,.4806000349046692,.5779247447917861],rotation:[.03878744702555993,-.09650917915493429,.04086837888902574,"XYZ"],action:"bounce",actionStrength:1,scale:.4},baby1Shadow:{position:[-1.9316698312012284,.4569439724721013,.5779247447917861],rotation:[.19762262640576914,-.09650917915493429,.04086837888902574,"XYZ"],scale:.25,opacity:.5,action:"still",actionStrength:1},baby2:{position:[-2.444718234596599,.4372090918539795,.7636312329707509],rotation:[-3.1415926535897927,1.416740119100939,3.1415926535897927,"XYZ"],action:"bounce",actionStrength:1,scale:.15},baby2Shadow:{position:[-2.444718234596599,.4422090918539795,.7636312329707509],rotation:[-3.009386035057485,1.4167401191009397,3.1415926535897927,"XYZ"],scale:.25,opacity:.5,action:"still",actionStrength:1},baby3:{position:[-2.1834116404591817,.4064673171397799,.7636312329707509],rotation:[-2.8214821872741167,.9280521632471485,2.9900167450431403,"XYZ"],action:"bounce",actionStrength:1,scale:.15},baby3Shadow:{position:[-2.1834116404591817,.4374568320278958,.7636312329707509],rotation:[-2.6529142681067737,.9280521632471488,2.9900167450431403,"XYZ"],scale:.25,opacity:.5,action:"still",actionStrength:1},afraid:{position:[-1.3702851221737073,1.099180993129319,-.1645034910428037],rotation:[0,0,0,"XYZ"],scale:.5,action:"bounce",actionStrength:1},bee:{position:[-.4419532803428043,.4679604954917822,2.546752330727357],rotation:[0,-.66382237986149,0,"XYZ"],scale:.25,action:"fly",actionStrength:1},bee2:{position:[-2.943368775003285,.7256174782882095,.8172865428876652],rotation:[-3.141592653589793,.34111180078325787,-3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1},rabbit:{position:[2.350037784780671,.05728891289491689,-3.519856000696667],rotation:[0,-.66382237986149,0,"XYZ"],scale:.2,hidden:!0,action:"still",actionStrength:1},bush:{position:[2.350037784780671,.0572889,-3.51985607],rotation:[0,-.66382237986149,0,"XYZ"],scale:.5,hidden:!0,action:"still",actionStrength:1,spriteLoopCount:1}}}},{}],91:[function(e,t,n){"use strict";t.exports={properties:{bloomAmount:3.7170400000000003,bloomRadius:-.13,bloomThreshold:.69239,bloomSmoothWidth:1.0015500000000002,haloWidth:.8,haloRGBShift:.03,haloStrength:.3,haloMaskInner:.8255,haloMaskOuter:1,vignetteFrom:.47665,vignetteTo:1.1714600000000002,vignetteColorHex:"#0b1f23",saturation:1,contrast:0,brightness:1,tintColorHex:"#27caff",tintOpacity:.23608,bokehFNumber:.041870000000000004,bokehFocusDistance:3.8393900000000003,bokehFocalLength:.27813000000000004,bokehKFilmHeight:36,cameraDistance:1,cameraLookStrength:.02,cameraShakeStrength:.36647},bgm:"river",dialogs:[{audio:"scene_1_a",text:"Look, there's something in the water",audioText:"'Look, there's something in the water', says mummy bird.",char:"mum",charExpression:0,wait:2,hold:3},{audio:"scene_1_b",text:"Can I see? Can I see?",audioText:"'Can I see? Can I see?', says baby bird.",char:"baby",charExpression:0,wait:1,hold:3},{audio:"scene_1_c",text:"Ahh... But it's cold!",audioText:"Ahh... But it's cold!",char:"baby",charExpression:0,wait:2,hold:3}],anchors:{},camera:{position:[3.4302520695045633,.7981686609387101,-3.5025600880082814],rotation:[-2.7853650915867503,.7920283805553776,2.882682802055517,"XYZ"],cameraDistance:5},characters:{mumNoLeg:{position:[.9560202316845308,-.23155001444752008,-1.1387619971043832],rotation:[.41836039189250007,1.188140810245514,-.41554422203598995,"XYZ"],action:"swim",actionStrength:1,scale:.3},baby1:{position:[.5001306286519451,-.18816000993816445,-.8392510334880796],rotation:[1.6508955943892272,1.136782258557686,-1.77014260212509,"XYZ"],action:"look",actionStrength:1,scale:.15},talk:{position:[.8310696717517619,.06649199825530742,-.9671897779422347],rotation:[-3.1272637683312503,.5954157954848289,-3.0900272655831134,"XYZ"],scale:.25,action:"bounce",actionStrength:1},baby2:{position:[.39176052643114767,-.1263171234917408,-1.1311387698564166],rotation:[.7552491308957803,1.2108977776792609,-.8193339490104395,"XYZ"],action:"bounce",actionStrength:1,scale:.15},baby2Shadow:{position:[.4672169695592878,-.11748140961577266,-1.1703103507935164],rotation:[1.558625628392399,1.3269610250782558,-1.6552955034993022,"XYZ"],scale:.125,opacity:.35,color:"#000",action:"still",actionStrength:1},baby3:{position:[.33989615370279525,-.14538827419939493,-.8567508189501117],rotation:[2.7574514668622885,1.0815713099349784,-2.824072411227712,"XYZ"],action:"bounce",actionStrength:1,scale:.15},dragonfly:{position:[.9214780202278963,.07820862363188427,-.1296637893168784],rotation:[-3.141592653589793,.34111180078325787,-3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1},bee2:{position:[-.01457732870895051,.2775268525413356,-1.644489885310395],rotation:[-3.141592653589793,1.0705018060413158,3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1}}}},{}],92:[function(e,t,n){"use strict";t.exports={properties:{bloomAmount:2.10888,bloomRadius:-.04369000000000001,bloomThreshold:.24137000000000003,bloomSmoothWidth:1.0015500000000002,haloWidth:.93376,haloRGBShift:.03,haloStrength:.3,haloMaskInner:.8255,haloMaskOuter:1,vignetteFrom:.47665,vignetteTo:1.1714600000000002,vignetteColorHex:"#0b1f23",saturation:1,contrast:0,brightness:1,tintColorHex:"#72b4c9",tintOpacity:.203,bokehFNumber:.02664,bokehFocusDistance:2.46533,bokehFocalLength:.18288000000000001,bokehKFilmHeight:36,cameraDistance:1.3886500000000002,cameraLookStrength:.025,cameraShakeStrength:.30144000000000004},bgm:"river",dialogs:[{audio:"scene_2_a",text:"I'm not sure how to do this, mummy",audioText:"'I'm not sure how to do this, mummy', cries little bird.",char:"baby",charExpression:0,wait:2,hold:3},{audio:"scene_2_b",text:"You can climb on the rock if you prefer",audioText:"'You can climb on the rock if you prefer', says mummy bird.",char:"mum",charExpression:0,wait:2,hold:3}],anchors:{},camera:{position:[1.8557825888476411,.2369632460871058,-3.127894586105574],rotation:[-2.983042389154217,.4456477540714796,3.0727810907653663,"XYZ"],cameraDistance:5},characters:{mumNoLeg:{position:[1.2427705826819115,-.24443693545795783,-.9159569642300072],rotation:[2.629920783785756,-1.3114327358944105,2.5047074627180996,"XYZ"],action:"swim",actionStrength:1,scale:.3},babyNoLeg1:{position:[1.0825950827588828,-.21309724770954053,-1.2228342274891635],rotation:[-3.0805267176932314,-.593432667574262,-3.029424434609042,"XYZ"],action:"swim",actionStrength:1,scale:.4},babyNoLeg2:{position:[.8966479674331429,-.21032280672165987,-.5025091370765624],rotation:[-2.786012182338791,1.4249515908873773,2.867471737086017,"XYZ"],action:"swim",actionStrength:1,scale:.4},baby1:{position:[.6088103726894968,-.15342158819894464,-.6661006128869613],rotation:[2.9227842963121713,.9094819778851888,-3.000660809013791,"XYZ"],action:"bounce",actionStrength:1,scale:.15},baby1Shadow:{position:[.6088103726894968,-.15141846552775878,-.6661006128869613],rotation:[2.7669366231399053,.8708235186648139,-2.800430309144854,"XYZ"],scale:.25,opacity:.5,color:"#000",action:"still",actionStrength:1},afraid:{position:[.4718567097280144,.02871089595945614,-.45680680054854655],rotation:[0,0,0,"XYZ"],scale:.25,action:"bounce",actionStrength:1},bee2:{position:[.34112113800734156,.0663715255177996,.48052558575446125],rotation:[-3.141592653589793,.34111180078325787,-3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1},fly:{position:[1.6439048300348496,-.0020573485176535317,-1.2359803562975733],rotation:[-3.141592653589793,.34111180078325787,-3.141592653589793,"XYZ"],scale:.1,action:"fly",actionStrength:1}}}},{}],93:[function(e,t,n){"use strict";t.exports={properties:{bloomAmount:3.7170400000000003,bloomRadius:-.13,bloomThreshold:.37946,bloomSmoothWidth:1.0015500000000002,haloWidth:.8,haloRGBShift:.03,haloStrength:.3,haloMaskInner:.8255,haloMaskOuter:1,vignetteFrom:.47665,vignetteTo:1.1714600000000002,vignetteColorHex:"#0b1f23",saturation:1,contrast:0,brightness:1,tintColorHex:"#69aeff",tintOpacity:.203,bokehFNumber:.19205000000000003,bokehFocusDistance:2.73652,bokehFocalLength:.28436,bokehKFilmHeight:54.00311000000001,cameraDistance:2.6892500000000004,cameraLookStrength:.027540000000000002,cameraShakeStrength:.21473},bgm:"river",dialogs:[{audio:"scene_3_a",text:"A small rock was easy, but now little bird is stuck..",audioText:"A small rock was easy, but now little bird is stuck..",char:"narrative",hold:3}],anchors:{scene_3_action_0:{position:[1.9044111842866007,.11651247049605318,-1.9701651137704235],interaction:"frogSleep"}},camera:{position:[.276263738227404,.5566829928215137,4.37337688582316],rotation:[-.139475006443249,-.4425259364701955,-.06004453306667441,"XYZ"],cameraDistance:5},characters:{mumNoLeg:{position:[2.1153117630631364,-.23709997713551306,.6993152981087393],rotation:[-2.93340311577333,-.637327478563905,-2.9764151975300632,"XYZ"],action:"swim",actionStrength:1,scale:.3},babyNoLeg1:{position:[2.0684305597962256,-.22673160981798807,-.045167277164363806],rotation:[-2.900926009828681,-.7455898737284387,3.067805887336594,"XYZ"],action:"swim",actionStrength:1,scale:.4},babyNoLeg2:{position:[1.6683112882906301,-.20434534101724255,.8942607553972224],rotation:[-.20638154680456544,.5461228664364168,-.13045718526437472,"XYZ"],action:"swim",actionStrength:1,scale:.4},babyTopRock:{position:[1.861560211324191,-.0935096816588647,.24408575832852492],rotation:[-1.146159316288871,1.001185204291383,1.1354738430931488,"XYZ"],action:"look",actionStrength:1,scale:.4},baby1Shadow:{position:[1.8345919048387622,-.10438814533494314,.2348273071663112],rotation:[-.17152935133995356,1.3318363976000136,.22633824965657745,"XYZ"],scale:.125,opacity:.4,color:"#000",action:"still",actionStrength:1},afraid:{position:[1.8301190593470156,.07076694568345576,-.024675690605865587],rotation:[.005212096830810093,.005695392045862039,-.02402389734811357,"XYZ"],scale:.1,action:"bounce",actionStrength:1},frog:{position:[2.0591019659703402,-.03131107681963553,-2.8039103710421447],rotation:[.2736095491147001,-.7140056102174454,.5082344827000366,"XYZ"],scale:.3,action:"still",actionStrength:1,spriteFrameOffset:0,spriteFrameCount:5,spriteBounce:!0},bee2:{position:[.6914019431330981,.003556219279030652,.6489124286556603],rotation:[-3.141592653589793,.4790507648161721,3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1},fly:{position:[1.7132874917215597,-.03761914496094024,-.23947258273928881],rotation:[-3.141592653589793,.15045102937518373,3.141592653589793,"XYZ"],scale:.1,action:"fly",actionStrength:1}}}},{}],94:[function(e,t,n){"use strict";t.exports={properties:{bloomAmount:2.67266,bloomRadius:.35447,bloomThreshold:.55708,bloomSmoothWidth:.9112100000000001,haloWidth:1.22692,haloRGBShift:.10465,haloStrength:0,haloMaskInner:.8051400000000001,haloMaskOuter:.9517300000000001,vignetteFrom:.7917500000000001,vignetteTo:1.1714600000000002,vignetteColorHex:"#000000",saturation:1,contrast:0,brightness:1,tintColorHex:"#6a81ff",tintOpacity:.19197000000000003,bokehFNumber:.18507,bokehFocusDistance:2.13752,bokehFocalLength:.35201000000000005,bokehKFilmHeight:38.97464,cameraDistance:1.8221800000000001,cameraLookStrength:.022660000000000003,cameraShakeStrength:.21473},bgm:"river",fishSplashSkipped:!0,dialogs:[{audio:"scene_4_a",text:"He must learn to overcome his fears.",audioText:"He must learn to overcome his fears.",char:"narrative",hold:3},{audio:"scene_4_b",text:"Okay, I can do it.",audioText:'"Okay", says baby bird. "I can do it."',char:"baby",charExpression:0,wait:2,hold:3},{audio:"scene_4_c",text:"He closes his eyes, and jumps!",audioText:"He closes his eyes, and jumps!",char:"narrative",hold:3}],anchors:{scene_4_jump_and_splash:{position:[1.813459426895757,.018989236341305324,.2827783148785261],interaction:"jumpAndSplash",interactionTarget:"babyJump",interactionSwap:"babyNoLeg2",interactionPosition:[1.945577983943744,-.32,.20747672098004388]}},camera:{position:[1.4890602975683422,-.0170574125401058,2.1115505030433197],rotation:[-.03644452824860722,-.3106549289975324,-.01114491998121202,"XYZ"],cameraDistance:5},characters:{mum:{position:[2.6189722556496036,.012728341062625048,-.11519073586176491],rotation:[1.7755267759301758,-1.352935710871537,1.796824347963032,"XYZ"],action:"still",actionStrength:1,scale:.3},mumShadow:{position:[2.616154849178298,-.06510142928262988,-.10841068594667108],rotation:[1.65709715425545,-1.0898415947799394,1.6811940712951141,"XYZ"],scale:.35,opacity:.35,action:"still",actionStrength:1},baby1:{position:[2.3493406297175166,-.0774188194396062,-.24803681003775385],rotation:[.23306033820785005,-.9089665734611222,.19658223806380096,"XYZ"],action:"still",actionStrength:.5,scale:.15},baby1Shadow:{position:[2.33753386158257,-.07374919671050201,-.24743482122793978],rotation:[.5706992755919161,-.7506107895346499,.4166353321541774,"XYZ"],scale:.1,opacity:.35,color:"#000",action:"still",actionStrength:1},babyNoLeg1:{position:[2.0258199534207466,-.22113835713187288,.686575908264845],rotation:[-.9170662056663741,1.4695970836624284,.9583611995364071,"XYZ"],action:"swim",actionStrength:.5,scale:.4},babyJump:{position:[1.8711716305319022,-.1106747575556889,.20747672098004388],rotation:[0,1.0302291040535871,0,"XYZ"],action:"still",actionStrength:1,scale:.4},babyNoLeg2:{position:[1.945577983943744,-.23455837596741597,.20747672098004388],rotation:[0,-.48765076212002534,0,"XYZ"],hidden:!0,action:"swim",actionStrength:.5,scale:.4},baby3Shadow:{position:[1.8221673678192778,-.10245180288924563,.20747672098004388],rotation:[.10422874372109929,1.0302291040535871,0,"XYZ"],scale:.1,opacity:.35,color:"#000",action:"still",actionStrength:1},talk:{position:[1.9194817594388494,-.02942221398486761,.2007721022161074],rotation:[-3.141592653589793,-.17278559157728945,-3.141592653589793,"XYZ"],scale:.05,action:"bounce",actionStrength:1},bee2:{position:[2.5901640528464256,.07751382812888641,-1.7862286460730368],rotation:[-3.141592653589793,-.093460096417906,-3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1},fly:{position:[1.1979014649158632,-.09758065171934846,-.23540542118613533],rotation:[-3.141592653589793,-.14486120020161236,-3.141592653589793,"XYZ"],scale:.1,action:"fly",actionStrength:1}}}},{}],95:[function(e,t,n){"use strict";t.exports={properties:{bloomAmount:3.7170400000000003,bloomRadius:-.13,bloomThreshold:.37946,bloomSmoothWidth:1.0015500000000002,haloWidth:.8,haloRGBShift:.03,haloStrength:.3,haloMaskInner:.8255,haloMaskOuter:1,vignetteFrom:.47665,vignetteTo:1.1714600000000002,vignetteColorHex:"#0b1f23",saturation:1,contrast:0,brightness:1,tintColorHex:"#2aa2e5",tintOpacity:.19197000000000003,bokehFNumber:.08177000000000001,bokehFocusDistance:5.162850000000001,bokehFocalLength:.31122000000000005,bokehKFilmHeight:19.26246,cameraDistance:3,cameraLookStrength:.036,cameraShakeStrength:.6482600000000001},bgm:"forest",fishSplashSkipped:!0,dialogs:[{audio:"scene_5_a",text:"They all arrived safely and learned new life skills.",audioText:"They all arrived safely and learned new life skills.",char:"narrative",hold:3}],anchors:{scene_5_wolf_action:{position:[.7617662365955971,.1890781586945408,-.14857587657502025],interaction:"clickToShow",interactionTarget:"wolf",interactionAnimation:"popin"}},camera:{position:[5.864008431836981,1.6526266270652008,3.040327045262618],rotation:[-.5129369222085902,.7735225823801453,.37489023757479606,"XYZ"],cameraDistance:5},characters:{mum:{position:[3.325950968141615,.16829988759616335,.1327582911520816],rotation:[-2.5402571521582287,1.0591367148183015,2.6499302320128244,"XYZ"],action:"bounce",actionStrength:1,scale:.3},mumShadow:{position:[3.325950968141615,.12052864248757827,.1327582911520816],rotation:[-3.0906641937817967,1.1369152553843338,3.0372085537201516,"XYZ"],scale:.45,action:"still",actionStrength:1},baby1:{position:[3.03933356300928,.014654136650800287,.8581783819028381],rotation:[-3.141592653589793,.9998432040621934,-3.141592653589793,"XYZ"],action:"bounce",actionStrength:1,scale:.1},baby1Shadow:{position:[3.03933356300928,.02913796321147802,.8581783819028381],rotation:[-3.141592653589793,.9998432040621934,-3.141592653589793,"XYZ"],scale:.25,action:"still",actionStrength:1},baby2:{position:[3.1296994404586154,.05000605248065598,.37816007364775883],rotation:[-3.141592653589793,1.1513964989803696,3.141592653589793,"XYZ"],action:"bounce",actionStrength:1,scale:.1},baby2Shadow:{position:[3.1296994404586154,.06500605248065598,.37816007364775883],rotation:[-2.8596306229918484,1.1439632790194358,2.9429804706349167,"XYZ"],scale:.25,action:"still",actionStrength:1},baby3:{position:[3.249568875617092,.08807105087444386,.7423776076509729],rotation:[-3.135654617235661,.0035658425058634254,-3.0734376195592046,"XYZ"],action:"bounce",actionStrength:1,scale:.1},baby3Shadow:{position:[3.249568875617092,.10307105087444386,.7423776076509729],rotation:[-3.135654617235661,.0035658425058634254,-3.0734376195592046,"XYZ"],scale:.25,action:"still",actionStrength:1},bee:{position:[.37918630774744955,.08476215172648816,.5251206629241612],rotation:[-3.1415926535897927,-1.264985668516611,-3.1415926535897927,"XYZ"],scale:.25,action:"fly",actionStrength:1},bee2:{position:[2.5901640528464256,.07751382812888641,-1.7862286460730368],rotation:[-3.141592653589793,-.093460096417906,-3.141592653589793,"XYZ"],scale:.25,action:"fly",actionStrength:1},fly:{position:[3.1874154619984716,.5037773272886455,1.2838595979234533],rotation:[-3.141592653589793,-.9846642229827689,-3.141592653589793,"XYZ"],scale:.1,action:"fly",actionStrength:1},wolf:{position:[.4200892469346674,-.04167819085469285,-.4218094572422224],rotation:[2.2908738614176896,-.6507059751933634,2.31480090332853,"XYZ"],scale:.35,hidden:!0,action:"still",actionStrength:1}}}},{}],96:[function(e,t,n){"use strict";var r=e("../core/settings"),i=e("../core/properties"),a=e("./sceneData"),o=e("gsap").default,s=e("min-signal"),l=e("../visuals/characters/characters"),u=e("../controls/cameraControls"),c=e("../audios/audios"),h=e("../visuals/fish/fish");e("mout/array/contains"),n.preInit=function(){},n.init=function(){for(var e=0,t=a.length;e<t;e++){var o=a[e];for(var s in o.anchors){var u=o.anchors[s];l.addAnchor(s,u),n.onAnchorCreated.dispatch(l.meshContainers[s].userData)}}if(r.LOOK_DEV_MODE&&window.dat){var c=new dat.GUI;c.add(i,"introRatio",0,1,1e-5).listen(),c.add(i,"skipCameraMovement").listen(),c.add(i,"bokehEnabled").listen(),c.add(i,"cameraDistance",0,10,1e-5).listen(),c.add(i,"cameraLookStrength",0,.05,1e-5).listen(),c.add(i,"cameraShakeStrength",0,1,1e-5).listen(),c.add(l.controlVisibilities,"main").name("main controls"),c.add(l.controlVisibilities,"expression").name("expression controls"),c.add(l.controlVisibilities,"extra").name("extra controls"),c.add(l.controlVisibilities,"anchor").name("anchor controls"),c.add(l.controlVisibilities,"shadow").name("shadow controls"),c.add({resetCameraPlacement:v},"resetCameraPlacement"),c.add({logSceneData:g},"logSceneData")}},n.start=function(){y(r.DEFAULT_SCENE)},n.update=function(e){a[f]},n.goTo=y,n.getDialogs=function(){return a[f].dialogs},n.getAllAudioIds=function(){for(var e=[],t=0;t<p;t++)for(var n=a[t].dialogs,r=0;r<n.length;r++)e.push(n[r].audio);return e},n.goToNext=function(){var e=f+1;e>=p?n.onFinished.dispatch():y(e)},n.isAnimating=!1,n.onSceneBeginStarted=new s,n.onSceneStarted=new s,n.onSceneEnded=new s,n.onFinished=new s,n.onAnchorCreated=new s,n.onAnchorReset=new s,n.onAnchorAddToScened=new s,n.onAnchorPlacementUpdated=new s;var d,p=n.MAX_SCENE_COUNT=a.length,f=-1,m=["bloomAmount","bloomRadius","bloomThreshold","bloomSmoothWidth","haloWidth","haloRGBShift","haloStrength","haloMaskInner","haloMaskOuter","vignetteFrom","vignetteTo","vignetteColorHex","saturation","contrast","brightness","tintColorHex","tintOpacity","bokehFNumber","bokehFocusDistance","bokehFocalLength","bokehKFilmHeight","cameraDistance","cameraLookStrength","cameraShakeStrength"];function v(){var e=a[f];u.basePosition.fromArray(e.camera.position),u.baseRotation.fromArray(e.camera.rotation),u.setOrbitPlacement(e.camera.position,e.camera.rotation)}function g(){var e=a[f];i.camera.position.toArray(e.camera.position),i.camera.rotation.toArray(e.camera.rotation);for(var t=e.properties={},n=0;n<m.length;n++){var r=m[n];t[r]=i[r]}for(var o in e.characters){var s=l.meshContainers[o],u=e.characters[o];s.position.toArray(u.position),s.rotation.toArray(u.rotation),u.scale.length?s.scale.toArray(u.scale):u.scale=s.scale.x}for(var c in e.anchors)l.meshContainers[c].position.toArray(e.anchors[c].position);var h=JSON.stringify(e,null,"\t");h=h.replace(/\"(.+)\":/g,(function(e,t){return t+":"})),navigator.clipboard.writeText("module.exports = "+h).then((function(){}),(function(e){console.error("".concat(e))}))}function y(e){n.isAnimating||e!==f&&(d=f,f=e,n.isAnimating=!0,n.onSceneEnded.dispatch(!0),n.sceneIndex=f,c.playFlip(),o.to(i,{duration:r.LOOK_DEV_MODE?0:.75,opacity:0,onComplete:function(){!function(){if(d>-1){var e=a[d];for(var t in e.characters){var r=l.meshContainers[t];if(r.userData.tweens){for(var i=0,o=r.userData.tweens.length;i<o;i++)r.userData.tweens[i].kill(),r.userData.tweens[i]=null;r.userData.tweens=null}r.visible=!1}for(var s in n.onAnchorReset.dispatch(),e.anchors){var u=l.meshContainers[s];u.visible=!1,u.userData.visible=!1}}}();var t=a[e];c.playSceneBase(t.bgm||"river"),t.properties=t.properties||{};for(var s=0;s<m.length;s++){var p=m[s];void 0!==t.properties[p]&&(i[p]=t.properties[p])}for(var f in u.basePosition.fromArray(t.camera.position),u.baseRotation.fromArray(t.camera.rotation),r.LOOK_DEV_MODE&&u.setOrbitPlacement(t.camera.position,t.camera.rotation),h.canSplash=!t.fishSplashSkipped,t.characters){var v=t.characters[f],g=l.meshContainers[f],y=l.meshes[f];v.action=v.action||"bounce",v.actionStrength=v.actionStrength||1,g.userData.data=v,g.userData.action=v.action,g.userData.actionStrength=v.actionStrength,g.userData.time=0,g.userData.spriteFrameOffset=v.spriteFrameOffset,g.userData.spriteFrameCount=v.spriteFrameCount,g.userData.spriteLoopCount=v.spriteLoopCount,g.userData.spriteBounce=v.spriteBounce,g.position.fromArray(v.position),g.rotation.fromArray(v.rotation),v.scale.length?g.scale.fromArray(v.scale):g.scale.set(1,1,1).multiplyScalar(v.scale),g.visible=!v.hidden,y&&(y.visible=!0)}for(var x in t.anchors){var _=t.anchors[x],b=l.meshContainers[x];b.position.fromArray(_.position),b.visible=!0,b.userData.visible=!0,n.onAnchorAddToScened.dispatch(b.userData)}i.cameraDollyZoomFovOffset=15,n.onSceneBeginStarted.dispatch(e),o.to(i,{duration:r.LOOK_DEV_MODE?0:.75,opacity:1,ease:"Cubic.easeOut",onComplete:function(){n.isAnimating=!1,n.onSceneStarted.dispatch(e)}})}}))}},{"../audios/audios":62,"../controls/cameraControls":66,"../core/properties":68,"../core/settings":69,"../visuals/characters/characters":117,"../visuals/fish/fish":119,"./sceneData":89,gsap:22,"min-signal":23,"mout/array/contains":24}],97:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Anchor=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),s=e("../../core/settings"),l=e("../../core/properties"),u=e("../../scenes/scenes"),c=function(){function e(){(0,i.default)(this,e),(0,o.default)(this,"testAnchorElems",{})}return(0,a.default)(e,[{key:"init",value:function(){var e=this;this._container=document.getElementById("story"),s.LOOK_DEV_MODE&&(u.onAnchorCreated.add((function(t){return e._onAnchorCreate(t)})),u.onAnchorAddToScened.add((function(t){return e._onAnchorCreateToScene(t)})),u.onAnchorPlacementUpdated.add((function(t){return e._onAnchorPlacementUpdate(t)})))}},{key:"_onAnchorCreate",value:function(e){var t=e.id,n=this.testAnchorElems[t]=document.createElement("div");n.style.position="absolute",n.style.left=n.style.top=0,n.style.display="none",n.style.pointerEvents="none",n.style.backgroundColor="rgba(0,255,0,0.3)",n.innerHTML=t,this._container.appendChild(n)}},{key:"_onAnchorCreateToScene",value:function(e){var t=e.id;this.testAnchorElems[t].style.display=e.visible?"inline-block":"none"}},{key:"_onAnchorPlacementUpdate",value:function(e){var t=e.id,n=this.testAnchorElems[t];n.style.transform="translate3d("+e.screenXY.x+"px,"+e.screenXY.y+"px,0)",n.style.opacity=l.opacity}}]),e}();n.Anchor=c},{"../../core/properties":68,"../../core/settings":69,"../../scenes/scenes":96,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/defineProperty":6,"@babel/runtime/helpers/interopRequireDefault":10}],98:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Blob=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("@georgedoescode/spline"),s=r(e("simplex-noise")),l=e("../../utils/math"),u=e("../../audios/audios"),c=function(){function e(t,n,r,a){var o=this;(0,i.default)(this,e),this.blob=t,this.path=this.blob.querySelector(".blob-path"),this.cb=a,this.radius=n,this.speed=r,this.noiseStep=.005,this.offset=10,this.init(),this.blob.addEventListener("mouseenter",(function(){return o.onMouseEnter()}),!1),this.blob.addEventListener("mouseleave",(function(){return o.onMouseLeave()}),!1),this.blob.onclick=function(e){return o.onClick(e,a)}}return(0,a.default)(e,[{key:"init",value:function(){this.simplex=new s.default,this.points=this.createPoints()}},{key:"show",value:function(){this.blob.style.opacity=1}},{key:"hide",value:function(){this.blob.style.opacity=0}},{key:"createPoints",value:function(){for(var e=[],t=2*Math.PI/6,n=1;n<=6;n++){var r=n*t,i=100+Math.cos(r)*this.radius,a=100+Math.sin(r)*this.radius;e.push({x:i,y:a,originX:i,originY:a,noiseOffsetX:100*Math.random(),noiseOffsetY:100*Math.random()})}return e}},{key:"noise",value:function(e,t){return this.simplex.noise2D(e,t)}},{key:"onMouseEnter",value:function(){u.playHover(),this.noiseStep=.01,this.speed=4}},{key:"onMouseLeave",value:function(){u.playHover(),this.noiseStep=.005,this.speed=2}},{key:"onClick",value:function(e){u.playTap(),this.cb(e)}},{key:"update",value:function(e){this.path.setAttribute("d",(0,o.spline)(this.points,1,!0));for(var t=0;t<this.points.length;t++){var n=this.points[t],r=this.noise(n.noiseOffsetX,n.noiseOffsetX),i=this.noise(n.noiseOffsetY,n.noiseOffsetY),a=(0,l.map)(r,-1,1,n.originX-this.offset,n.originX+this.offset),s=(0,l.map)(i,-1,1,n.originY-this.offset,n.originY+this.offset);n.x=a,n.y=s,n.noiseOffsetX+=this.noiseStep*this.speed,n.noiseOffsetY+=this.noiseStep*this.speed,this.blob.style.transform="translateX(".concat(-a/2,"%) translateY(").concat(-s/2,"%)")}}}]),e}();n.Blob=c},{"../../audios/audios":62,"../../utils/math":115,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,"@georgedoescode/spline":19,"simplex-noise":57}],99:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Cursor=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../../utils/math"),s=r(e("../../input/input")),l=function(){function e(){(0,i.default)(this,e),this.cursor=document.querySelector(".cursor"),this.active=!1,this.allowAnimation=!1,this.state={position:{},x:{previous:0,current:0},y:{previous:0,current:0},scale:{previous:1,current:1},opacity:{previous:1,current:.4},angle:{previous:0,current:0},squeeze:{previous:0,current:0}},this.getPosition()}return(0,a.default)(e,[{key:"show",value:function(){this.cursor.style.opacity=1,this.active=!0}},{key:"hide",value:function(){this.cursor.style.opacity=0,this.active=!1}},{key:"enter",value:function(){this.state.scale.current=4,this.state.opacity.current=.8}},{key:"leave",value:function(){this.state.scale.current=1,this.state.opacity.current=.4}},{key:"getPosition",value:function(){this.state.position=this.cursor.getBoundingClientRect()}},{key:"getSqueeze",value:function(e,t){var n=(0,o.distanceTo)(e,t);return 10*Math.min(n/1500,.1)}},{key:"update",value:function(){if(this.active){var e=this.state.position,t=e.width,n=e.height;for(var r in this.state.x.current=s.default.mousePixelXY.x-t/2,this.state.y.current=s.default.mousePixelXY.y-n/2,this.state)Math.abs(this.state[r].previous-this.state[r].current)>.001&&(this.allowAnimation=!0,this.state[r].previous=(0,o.lerp)(this.state[r].previous,this.state[r].current,.25));var i=Math.round(this.state.x.current-this.state.x.previous),a=Math.round(this.state.y.current-this.state.y.previous);this.state.squeeze.current=this.getSqueeze(i,a),this.state.angle.current=(0,o.getAngle)(i,a);var l="scale(".concat(1+this.state.squeeze.current,", ").concat(1-.25*this.state.squeeze.current,")"),u="rotate(".concat(this.state.angle.current,"deg)"),c="translateX(".concat(this.state.x.previous,"px) translateY(").concat(this.state.y.previous,"px) scale(").concat(this.state.scale.previous,")");this.allowAnimation&&(this.cursor.style.transform=c+u+l,this.cursor.style.opacity=this.state.opacity.previous)}}}]),e}();n.Cursor=l},{"../../input/input":76,"../../utils/math":115,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10}],100:[function(e,t,n){"use strict";var r=e("../../core/properties"),i=e("../../utils/math"),a=e("../../utils/ease"),o=e("min-signal"),s=e("../../audios/audios"),l=e("../../utils/dom");function u(e){this.container=e,this.opacity=0,this.isActive=!1,this.t=0,this.targetT=0,this.maxVisibleDialog=3,this.tmpl=this.container.querySelector(".dialog"),this.container.removeChild(this.tmpl),this.activeElemList=[],this.onChangeCompleted=new o}var c=u.prototype;c.add=function(e){var t=this,n=e.wait||0,r=e.hold||3,i=l.clone(this.tmpl),a=i.querySelector(".dialog-head"),o=i.querySelector(".dialog-text");o.innerHTML=n?'\n\t<div class="dialog-text--dots">\n\t\t<div class="dialog-text--dot"></div>\n\t\t<div class="dialog-text--dot"></div>\n\t\t<div class="dialog-text--dot"></div>\n\t</div>\n':e.text,i.classList.add("is-"+e.char),this.targetT+=1,i._t=this.targetT,i._side="mum"==e.char?1:-1,i._isNarrative="narrative"==e.char,i._ratio=0,i._headElem=a,i._textElem=o,i._waitTime=0,i._waitTimeTarget=n,i._text=e.text,i._audioId=e.audio,this.activeElemList.push(i),this.container.appendChild(i),setTimeout((function(){t.onChangeCompleted.dispatch()}),1e3*(n+r))},c.show=function(){this.isActive=!0},c.hide=function(){this.isActive=!1},c.reset=function(){for(var e=this.activeElemList.length;e--;){var t=this.activeElemList[e];this.container.removeChild(t)}this.activeElemList.length=0},c.update=function(e){if(this.container){this.opacity=i.clamp(this.opacity+2*(this.isActive?e:-e),0,1),this.container.style.display=this.opacity>0?1:0,this.container.style.opacity=this.opacity;var t=i.fit(r.width,320,560,50,90),n=t*this.maxVisibleDialog;this.t=Math.min(this.targetT,this.t+2*e);for(var o=this.activeElemList.length;o--;){var l=this.activeElemList[o];l._ratio=Math.min(1,l._ratio+e);var u=i.fit(this.t-l._t,this.maxVisibleDialog,this.maxVisibleDialog-1,0,1);if(0==(u*=i.fit(this.t-l._t,1,0,.9,.9)))this.container.removeChild(l),this.activeElemList.splice(o,1);else{var c=l._t-this.t,h=i.fit(c,0,.75,0,1,a.easeInSine);l.style.opacity=l._ratio*u,l._waitTime<=l._waitTimeTarget&&(l._waitTime+=e,l._waitTime>l._waitTimeTarget&&(l._textElem.innerHTML=l._text,s.play(l._audioId))),l._isNarrative?l._textElem.style.transform="translate3d(0,"+10*h+"px,0) translate3d(-50%,0,0)":l._textElem.style.transform="rotateZ("+-3*h*l._side+"deg) translate3d(0,"+10*h+"px,0)",l.style.transform="translate3d(0,"+(c*t+n)+"%,0)"}}}},t.exports=u},{"../../audios/audios":62,"../../core/properties":68,"../../utils/dom":113,"../../utils/ease":114,"../../utils/math":115,"min-signal":23}],101:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Interaction=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../../utils/math"),s=r(e("../../input/input")),l=e("min-signal"),u=e("../../scenes/scenes"),c=e("../../visuals/characters/characters"),h=e("../../audios/audios"),d=function(){function e(){(0,i.default)(this,e),this.btn=document.getElementById("story-interaction-btn"),this.circleBg=this.btn.querySelector(".circle-bg"),this.circleBorder=this.btn.querySelector(".circle-border"),this.anchorCount=0,this.allowAnimation=!1,this.isActive=!1,this.hasInteraction=!1,this.opacity=0,this.anchor={},this.state={hover:!1,triggerDistance:0,position:{},parallaxValue:1.1},this.magnetic={x:{previous:0,current:0},y:{previous:0,current:0}},this.onHoverIn=new l,this.onHoverOut=new l,this.btn.addEventListener("click",this.onClick.bind(this))}return(0,a.default)(e,[{key:"init",value:function(){var e=this;u.onAnchorReset.add((function(t){return e.onAnchorReset(t)})),u.onAnchorAddToScened.add((function(t){return e.onAnchorAddToScene(t)})),u.onAnchorPlacementUpdated.add((function(t){return e.setPosition(t)}))}},{key:"show",value:function(){this.btn.style.pointerEvents="initial",this.isActive=!0}},{key:"hide",value:function(){this.btn.style.pointerEvents="none",this.hasInteraction=!1,this.isActive=!1}},{key:"onClick",value:function(){if(this.hasInteraction&&this.isActive){switch(this.anchor.data.interaction){case"frogSleep":c.frogSleep();break;case"clickToShow":c.show(this.anchor.data.interactionTarget,this.anchor.data.interactionAnimation);break;case"jumpAndSplash":c.jumpAndSplash(this.anchor.data.interactionTarget,this.anchor.data.interactionPosition,this.anchor.data.interactionSwap)}this.onMouseLeave(),this.hide()}}},{key:"onAnchorAddToScene",value:function(e){this.anchor=e,this.hasInteraction=!0,this.anchorCount++}},{key:"onAnchorReset",value:function(){this.anchorCount=0}},{key:"setPosition",value:function(e){this.btn.style.transform="translate3d("+e.screenXY.x+"px,"+e.screenXY.y+"px,0)"}},{key:"getPosition",value:function(){this.state.position=this.circleBg.getBoundingClientRect(),this.state.triggerDistance=this.state.position.width/2*1.1}},{key:"calculatePosition",value:function(e,t,n,r){this.dist=(0,o.distance)(s.default.mousePixelXY.x+window.scrollX,s.default.mousePixelXY.y+window.scrollY,e+n/2,t+r/2)}},{key:"onMouseEnter",value:function(){this.isActive&&(h.playHover(),this.state.hover=!0,this.onHoverIn.dispatch())}},{key:"onMouseLeave",value:function(){this.isActive&&(this.state.hover=!1,this.onHoverOut.dispatch())}},{key:"update",value:function(e){if(this.opacity=(0,o.clamp)(this.opacity+(this.isActive&&this.hasInteraction?e:-e),0,1),this.btn.style.opacity=this.opacity,this.btn.style.display=this.opacity>0?"flex":"none",this.opacity>0){this.getPosition();var t=this.state.position,n=t.left,r=t.top,i=t.width,a=t.height;this.calculatePosition(n,r,i,a);var l=0,u=0;for(var c in this.dist<this.state.triggerDistance?(this.state.hover||this.onMouseEnter(),l=1.1*(s.default.mousePixelXY.x+window.scrollX-(n+i/2)),u=1.1*(s.default.mousePixelXY.y+window.scrollY-(r+a/2))):this.state.hover&&this.onMouseLeave(),this.magnetic.x.current=l,this.magnetic.y.current=u,this.magnetic)Math.abs(this.magnetic[c].previous-this.magnetic[c].current)>.001&&(this.allowAnimation=!0,this.magnetic[c].previous=(0,o.lerp)(this.magnetic[c].previous,this.magnetic[c].current,.25));this.allowAnimation&&(this.circleBg.style.transform="\n\t\t\t\t\ttranslate3d(".concat(this.magnetic.x.previous,"px, ").concat(this.magnetic.y.previous,"px, 0)\n\t\t\t\t"),this.circleBorder.style.transform="\n\t\t\t\t\ttranslate3d(".concat(this.magnetic.x.previous*this.state.parallaxValue,"px, ").concat(this.magnetic.y.previous*this.state.parallaxValue,"px, 0)\n\t\t\t\t"))}}}]),e}();n.Interaction=d},{"../../audios/audios":62,"../../input/input":76,"../../scenes/scenes":96,"../../utils/math":115,"../../visuals/characters/characters":117,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,"min-signal":23}],102:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.PrimaryButton=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("gsap"),s=e("../../libs/gsap/CustomEase").default,l=e("../../audios/audios"),u=function(){function e(t,n){var r=this;(0,i.default)(this,e),this._dom={button:t},this._btn=this._dom.button.querySelector(".btn--primary"),this._label=this._dom.button.querySelector(".btn--primary-label__masked"),this._waterDrops=this._dom.button.querySelectorAll(".water-drop"),this._heroDrop=this._dom.button.querySelector(".hero-drop"),this.tlFadeIn=o.gsap.timeline({paused:!0}),this.tlFadeOut=o.gsap.timeline({paused:!0}),this.tlWater=o.gsap.timeline({repeat:-1,yoyo:!0}),this.tlHeroDrop=o.gsap.timeline({paused:!0}),this.tlHover=o.gsap.timeline({paused:!0}),this._btn.addEventListener("mouseenter",(function(){return r.onMouseEnter()}),!1),this._btn.addEventListener("mouseleave",(function(){return r.onMouseLeave()}),!1),this._btn.addEventListener("touchstart",(function(){return r.onMouseEnter()}),!1),this._btn.addEventListener("touchend",(function(){return r.onMouseLeave()}),!1),this._btn.onclick=function(e){return r.onMouseClick(e,n)},this.init()}return(0,a.default)(e,[{key:"init",value:function(){this.initWaterAnimation(),this.initHeroDropAnimation(),this.initHoverAnimation()}},{key:"show",value:function(){var e=this;this.tlFadeIn.to(this._btn,{opacity:1,duration:.35,delay:1,onComplete:function(){e._btn.style.pointerEvents="auto"}}),this.tlFadeIn.play()}},{key:"hide",value:function(){this.tlFadeOut.to(this._btn,{opacity:0}).to(this._btn,{pointerEvents:"none"}),this.tlFadeOut.play()}},{key:"initWaterAnimation",value:function(){this.tlWater.fromTo(this._waterDrops,{y:0,x:0,duration:.5,ease:"Sine.easeIn",stagger:{each:.15}},{y:-2,x:-10,duration:.5,ease:"Sine.easeOut"}).to(this._waterDrops,{y:0,x:0,duration:.5,ease:"Sine.easeIn",stagger:{each:.15}})}},{key:"initHeroDropAnimation",value:function(){this.tlHeroDrop.fromTo(this._heroDrop,{y:100,scale:1},{y:20,scale:.5,ease:"Expo.easeInOut"}).to(this._heroDrop,{y:100,scale:1,duration:1,ease:"Bounce.easeOut"})}},{key:"initHoverAnimation",value:function(){this.tlHover.to(this._label,{ease:s.create("easeIn",".65,1.01,.97,1.00"),opacity:0,y:-10,duration:.1}).to(this._label,{opacity:1,startAt:{y:10,opacity:1},y:0,duration:.3,ease:s.create("easeLabel","0.16, 1.26, 0.58, 1.00")},.1)}},{key:"onMouseEnter",value:function(){l.playHover(),this.tlHover.play(),this.tlHeroDrop.restart()}},{key:"onMouseLeave",value:function(){l.playHover(),this.tlHover.reverse()}},{key:"onMouseClick",value:function(e,t){l.playTap(),t(e)}}]),e}();n.PrimaryButton=u},{"../../audios/audios":62,"../../libs/gsap/CustomEase":77,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],103:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.MomBird=n.BabyBirdStuck=n.BabyBird=void 0;var i=r(e("@babel/runtime/helpers/assertThisInitialized")),a=r(e("@babel/runtime/helpers/get")),o=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),l=r(e("@babel/runtime/helpers/getPrototypeOf")),u=r(e("@babel/runtime/helpers/classCallCheck")),c=r(e("@babel/runtime/helpers/createClass")),h=r(e("@babel/runtime/helpers/defineProperty")),d=r(e("../../../input/input"));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var f=e("gsap").default,m=e("../../../core/properties"),v=document.querySelector(".mom-bird"),g=function(){function e(){(0,u.default)(this,e),(0,h.default)(this,"_bird",v),(0,h.default)(this,"_birdLeftLeg",void 0),(0,h.default)(this,"_birdRightLeg",void 0),(0,h.default)(this,"_birdEye",void 0),(0,h.default)(this,"followTarget",null),(0,h.default)(this,"followOffset",0),(0,h.default)(this,"speed",14),(0,h.default)(this,"x",0),(0,h.default)(this,"vx",0),(0,h.default)(this,"dir",1),(0,h.default)(this,"side",1),(0,h.default)(this,"walkRatio",.5),(0,h.default)(this,"jumpRatio",0),(0,h.default)(this,"isStuck",!1),(0,h.default)(this,"tlFadeIn",f.timeline({paused:!0})),(0,h.default)(this,"tlBlinkEyes",f.timeline({paused:!0}))}return(0,c.default)(e,[{key:"init",value:function(e){Object.assign(this,e),this._birdLeftLeg=this._bird.querySelector(".left-leg"),this._birdRightLeg=this._bird.querySelector(".right-leg"),this._birdEye=this._bird.querySelector(".eye"),this.fixPathOrigin(this._birdLeftLeg),this.fixPathOrigin(this._birdRightLeg)}},{key:"show",value:function(){this.tlFadeIn.to(this._bird,{opacity:1,delay:1.5}),this.tlFadeIn.play()}},{key:"hide",value:function(){this.tlFadeIn.reverse()}},{key:"blinkEyes",value:function(){this.tlBlinkEyes.to(this._birdEye,{startAt:{scaleY:1},scaleY:.2,duration:.2}).to(this._birdEye,{scaleY:1,duration:.6}),this.tlBlinkEyes.play()}},{key:"fixPathOrigin",value:function(e){e.getAttribute("d").replace(/M([0-9\.]+)\s([0-9\.]+)/g,(function(t,n,r,i){e.style.transformOrigin=n+"px "+r+"px"}))}},{key:"update",value:function(e){var t=this.followTarget?this.followTarget.x+this.followOffset*this.followTarget.dir:d.default.mousePixelXY.x;this.isStuck&&(t=Math.max(0,Math.min(215,t-(m.rawWidth-215)/2))),this.vx*=.95,this.vx+=Math.min(140,Math.abs(t-this.x))*Math.sign(t-this.x)*e*this.speed,this.x+=this.vx*e;var n=Math.abs(this.vx)>1;this.dir=n?this.vx>0?-1:1:this.dir,n?this.walkRatio=(this.walkRatio+e*Math.abs(this.vx)*.02*this.speed)%1:this.walkRatio+=.1*(.5-this.walkRatio);var r=0;if(this.isStuck&&(this.x=Math.max(0,Math.min(215,this.x)),this.dir=this.x+(m.rawWidth-215)/2-this.followTarget.x>0?-1:1,Math.abs(this.x/215-.5)>.45?this.jumpRatio=(this.jumpRatio+.4*e)%1:this.jumpRatio+=.1*(.5-this.jumpRatio),r=-4*Math.pow(2*Math.max(Math.abs(3*this.jumpRatio-1.5)-1,0),2)),this._bird.style.transform="translate3d("+this.x+"px,"+r+"px,0) translate3d(-50%, 0, 0) scale3d("+this.dir*this.side+",1,1)",this._birdLeftLeg){var i=(1-Math.abs(2*Math.abs(2*this.walkRatio-1)-1))*(this.walkRatio<.5?-45:45);this._birdLeftLeg.style.transform="rotate("+i+"deg)",this._birdRightLeg.style.transform="rotate("+-i+"deg)"}}}]),e}(),y=function(e){(0,o.default)(n,e);var t=p(n);function n(){var e;(0,u.default)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return e=t.call.apply(t,[this].concat(a)),(0,h.default)((0,i.default)(e),"_bird",v),(0,h.default)((0,i.default)(e),"_momBirdFeather",void 0),(0,h.default)((0,i.default)(e),"tlFeather",f.timeline({paused:!0,repeat:-1})),e}return(0,c.default)(n,[{key:"init",value:function(e){Object.assign(this,e),(0,a.default)((0,l.default)(n.prototype),"init",this).call(this),this._momBirdFeather=document.querySelector(".mom-bird-feather")}},{key:"feather",value:function(){this.tlFeather.to(this._momBirdFeather,{startAt:{rotate:0},rotate:45,transformOrigin:"bottom center",ease:"Sine.easeInOut"}).to(this._momBirdFeather,{rotate:0}),this.tlFeather.play()}}]),n}(g);n.MomBird=y;var x=function(e){(0,o.default)(n,e);var t=p(n);function n(){return(0,u.default)(this,n),t.apply(this,arguments)}return(0,c.default)(n,[{key:"init",value:function(e){Object.assign(this,e),(0,a.default)((0,l.default)(n.prototype),"init",this).call(this)}}]),n}(g);n.BabyBird=x;var _=function(e){(0,o.default)(n,e);var t=p(n);function n(){return(0,u.default)(this,n),t.apply(this,arguments)}return(0,c.default)(n,[{key:"init",value:function(e){Object.assign(this,e),(0,a.default)((0,l.default)(n.prototype),"init",this).call(this)}}]),n}(g);n.BabyBirdStuck=_},{"../../../core/properties":68,"../../../input/input":76,"@babel/runtime/helpers/assertThisInitialized":3,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/defineProperty":6,"@babel/runtime/helpers/get":7,"@babel/runtime/helpers/getPrototypeOf":8,"@babel/runtime/helpers/inherits":9,"@babel/runtime/helpers/interopRequireDefault":10,"@babel/runtime/helpers/possibleConstructorReturn":13,gsap:22}],104:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Dust=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("gsap"),s=function(){function e(t){(0,i.default)(this,e),this.container=t,this.numDust=10,this.tlFadeIn=o.gsap.timeline({paused:!0}),this.init()}return(0,a.default)(e,[{key:"init",value:function(){for(var e=0;e<this.numDust;e++){var t=this.createParticle();this.animateParticles(t)}}},{key:"createParticle",value:function(){var e=document.createElement("div"),t="dust dust"+o.gsap.utils.random(1,4,1);return e.setAttribute("class",t),this.container.appendChild(e),e}},{key:"animateParticles",value:function(e){var t=this,n=window.innerWidth,r=window.innerHeight,i=o.Power1.easeIn(Math.random()),a=o.gsap.utils.interpolate(.05,.1,i),s=o.gsap.utils.interpolate(5,8,1-i),l=o.gsap.utils.interpolate(.5,1,i);o.gsap.set(e,{y:o.gsap.utils.random(0,r),x:-200,scale:a,opacity:l,rotation:0}),o.gsap.to(e,{y:o.gsap.utils.random(0,r),x:n+200,duration:s,delay:"random(0,10)",ease:"none",rotation:"random(0, 360)",onComplete:function(){t.animateParticles(e)},onCompleteParams:[e]})}},{key:"show",value:function(){this.tlFadeIn.to(this.container,{opacity:1,delay:1.5}),this.tlFadeIn.play()}},{key:"hide",value:function(){this.tlFadeIn.reverse()}}]),e}();n.Dust=s},{"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],105:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Grass=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("gsap"),s=e("../../../core/browser"),l=function(){function e(t){(0,i.default)(this,e),this.container=t,this.btnContainer=document.querySelectorAll(".btn-plants"),this.btnContainerPlants=document.querySelectorAll(".btn-plants--group"),this.aboutGrass=document.querySelectorAll(".about-plant"),this.numGrass=s.isMobile?5:10,this.tlFadeIn=o.gsap.timeline({paused:!0}),this.init()}return(0,a.default)(e,[{key:"init",value:function(){for(var e=this,t=0;t<this.numGrass;t++){var n=this.createGrass();this.removeRandomGrass(),this.animateGrass(n,"random(0, 60)")}this.btnContainerPlants.forEach((function(t){t.querySelectorAll(".grass").forEach((function(t){e.animateGrass(t,"random(0, 30)")}))})),this.aboutGrass.forEach((function(t){e.animateGrass(t,"random(0, 6)",!0)}))}},{key:"createGrass",value:function(){var e=document.createElement("div"),t="grass grass"+o.gsap.utils.random(1,6,1);return e.setAttribute("class",t),this.container.appendChild(e),e}},{key:"removeRandomGrass",value:function(){var e=Math.floor(1+Math.random()*this.numGrass),t=this.container.querySelector(".plants>div:nth-child("+e+")");t&&(t.classList.add("hidden"),t.style.opacity=0)}},{key:"animateGrass",value:function(e,t,n){window.innerWidth;var r=o.Expo.easeInOut(Math.random()),i=o.gsap.utils.interpolate(.8,2,1-r);o.gsap.set(e,{rotation:0}),s.isMobile&&n&&o.gsap.set(e,{scale:.34}),o.gsap.to(e,{duration:i,delay:"random(0,10)",ease:"Sine.easeInOut",rotation:t,repeat:-1,yoyo:!0})}},{key:"show",value:function(){this.tlFadeIn.to(this.container,{opacity:1,delay:1.5}).to(this.btnContainer,{opacity:1}),this.tlFadeIn.play()}},{key:"hide",value:function(){this.tlFadeIn.reverse()}}]),e}();n.Grass=l},{"../../../core/browser":67,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],106:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.STATUS=void 0,n.STATUS={PRELOAD:0,INTRO:1,STORY:2,ENDING:3,ABOUT:4}},{}],107:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.About=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=(e("../constants"),e("gsap")),s=e("../components/Blob"),l=(e("../../core/properties"),e("../../libs/gsap/CustomEase").default),u=e("../../audios/audios"),c=function(){function e(){var t=this;(0,i.default)(this,e),this._isActive=!1,this._about=document.getElementById("about"),this._aboutTitle=document.getElementById("about-title"),this._aboutContent=document.getElementById("about-content"),this._aboutInfo=document.getElementById("about-info"),this._aboutCloseBtn=document.getElementById("about-exit--close-btn"),this._aboutStar=document.getElementById("about-star"),this._aboutInfoGoBackBtn=document.querySelector(".about-info--explore-btn"),this._aboutExploreBtn=document.querySelector(".explore-btn"),this._aboutExploreBtnArrow=document.querySelector(".explore-btn--arrow"),this._aboutExploreBtnText=document.querySelector(".explore-btn--text"),this._blobWhat=document.querySelector(".blob-what"),this._blobWho=document.querySelector(".blob-who"),this.blobs=[new s.Blob(this._blobWhat,100,2,(function(){return t._showInfo(!0)})),new s.Blob(this._blobWho,70,1,(function(){return t._showInfo(!0)}))],this.tlFadeIn=o.gsap.timeline({paused:!0}),this.tlFadeOut=o.gsap.timeline({paused:!0}),this.tlHover=o.gsap.timeline({paused:!0}),this._aboutExploreBtn.addEventListener("mouseenter",(function(){return t._onMouseEnter()}),!1),this._aboutExploreBtn.addEventListener("mouseleave",(function(){return t._onMouseLeave()}),!1),this._aboutCloseBtn.onclick=function(){return t._onClickClose()},this._aboutInfoGoBackBtn.onclick=function(){return t._showInfo(!1)},this.init()}return(0,a.default)(e,[{key:"preInit",value:function(){}},{key:"init",value:function(){this.initFadeInAnimation(),this.initFadeOutAnimation(),this.initHoverAnimation()}},{key:"initFadeInAnimation",value:function(){this.tlFadeIn.set(this._aboutStar,{y:-14}).to(this._about,{opacity:1}).to(this._aboutStar,{y:0,duration:.3,ease:"Power3.EaseInOut"}).fromTo(this._aboutExploreBtn,{opacity:0,y:20},{opacity:1,y:0})}},{key:"initFadeOutAnimation",value:function(){this.tlFadeOut.to(this._aboutStar,{y:-14,duration:.3,ease:"Power3.EaseInOut"}).to(this._about,{opacity:0})}},{key:"initHoverAnimation",value:function(){this.tlHover.to(this._aboutExploreBtnArrow,{x:30,duration:1,ease:l.create("easeCubic","0.42, 0, 0, 0.99")},0).to(this._aboutExploreBtnText,{x:35,duration:.85,ease:l.create("easeCubic","0.42, 0, 0, 0.99")},.2)}},{key:"show",value:function(){this._isActive||(this._isActive=!0,this.tlFadeIn.restart())}},{key:"hide",value:function(){var e=this;this._isActive&&(this._isActive=!1,this.tlFadeOut.restart(),setTimeout((function(){e._showInfo(!1)}),1e3))}},{key:"_toggleContent",value:function(e){this._aboutTitle.style.opacity=e?1:0,this._aboutContent.style.opacity=e?1:0,this.blobs.forEach((function(t){e?t.show():t.hide()}))}},{key:"_toggleInfo",value:function(e){var t=this;this._aboutInfo.style.display=e?"flex":"none",setTimeout((function(){t._aboutInfo.style.opacity=e?1:0}),300)}},{key:"_showInfo",value:function(e){this._toggleContent(!e),this._toggleInfo(!!e)}},{key:"_onClickClose",value:function(){u.playTap(),this.hide()}},{key:"_onMouseEnter",value:function(){u.playHover(),this.tlHover.play()}},{key:"_onMouseLeave",value:function(){u.playHover(),this.tlHover.pause(),this.tlHover.reverse()}},{key:"update",value:function(e){var t=+this._about.style.opacity>0;this._about.style.display=t?"block":"none",t&&this.blobs.forEach((function(t){t.update(e)}))}}]),e}();n.About=c},{"../../audios/audios":62,"../../core/properties":68,"../../libs/gsap/CustomEase":77,"../components/Blob":98,"../constants":106,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],108:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Ending=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../components/intro/Bird"),s=e("../components/intro/Dust"),l=e("../components/intro/Grass"),u=e("../components/PrimaryButton.js"),c=e("../constants.js"),h=r(e("../ui")),d=e("../../core/settings"),p=e("../../core/properties"),f=e("gsap").default,m=e("../../scenes/scenes"),v=function(){function e(){var t=this;(0,i.default)(this,e),this._container=document.getElementById("ending"),this._title=document.querySelector("#ending-title h1"),this._btnDom=document.getElementById("ending-restart-btn"),this._windContainer=this._container.querySelector(".wind-particles"),this._grassContainer=this._container.querySelector(".plants"),this.babyBird1=this._container.querySelector(".baby-bird-stuck"),this.babyBird2=this._container.querySelector(".baby-bird2"),this.babyBird3=this._container.querySelector(".baby-bird3"),this.momBird=this._container.querySelector(".mom-bird"),this._star=document.getElementById("star"),this._startAgainBtn=new u.PrimaryButton(this._btnDom,(function(){return t._onClick()})),this._hasInitialized=!1,this._dust=new s.Dust(this._windContainer),this._grass=new l.Grass(this._grassContainer),this._momBird=new o.MomBird,this._babyBird1=new o.BabyBird,this._babyBird2=new o.BabyBird,this._babyBird3=new o.BabyBird,this.tlFadeIn=f.timeline({paused:!0}),this.tlFadeOut=f.timeline({paused:!0})}return(0,a.default)(e,[{key:"preInit",value:function(){var e=this;p.statusSignal.add((function(t){t===c.STATUS.ENDING&&e.show()})),this._star.onclick=function(t){return e._onClickStar(t)}}},{key:"init",value:function(){var e=this;this.initFadeInAnimation(),this.initFadeOutAnimation(),this._hasInitialized=!0,this._babyBird1.init({_bird:this.babyBird1,followTarget:this._momBird,followOffset:125,speed:1.7,side:-1}),this._momBird.init({_bird:this.momBird}),this._babyBird2.init({_bird:this.babyBird2,followTarget:this._momBird,followOffset:45,speed:7}),this._babyBird3.init({_bird:this.babyBird3,followTarget:this._momBird,followOffset:70,speed:5}),m.onFinished.add((function(){return e.show()}))}},{key:"initFadeInAnimation",value:function(){var e=this;this.tlFadeIn.to(p,{duration:2,introRatio:0}).to(this._container,{opacity:1,onComplete:function(){e._startAgainBtn.show(),e._grass.show(),e._dust.show(),e._momBird.show(),e._babyBird1.show(),e._babyBird2.show(),e._babyBird3.show()}}).to(this._title,{opacity:1,delay:1.5,ease:"Sine.easeInOut"})}},{key:"initFadeOutAnimation",value:function(){this.tlFadeOut.to(this._title,{opacity:0,ease:"Sine.easeInOut"}).to(this._container,{opacity:0}).to(p,{duration:3,introRatio:1,onComplete:function(){p.statusSignal.dispatch(c.STATUS.STORY)}})}},{key:"show",value:function(){document.documentElement.classList.add("is-ending"),this._btnDom.style.pointerEvents="initial",d.SKIP_ENDING?this._hide():(this._momBird.x=p.width,this._babyBird1.x=p.width,this._babyBird2.x=p.width,this._babyBird3.x=p.width,this._container.classList.add("is-active"),this.tlFadeIn.play())}},{key:"_hide",value:function(){document.documentElement.classList.remove("is-ending"),this._btnDom.style.pointerEvents="none",m.goTo(d.DEFAULT_SCENE),this._startAgainBtn.hide(),this._grass.hide(),this._dust.hide(),this._momBird.hide(),this._babyBird1.hide(),this._babyBird2.hide(),this._babyBird3.hide(),this.tlFadeOut.play()}},{key:"_onClick",value:function(){this._hide()}},{key:"_onClickStar",value:function(e){h.default.showAbout()}},{key:"update",value:function(e){if(this._hasInitialized){var t=+this._container.style.opacity>0;this._container.style.display=t?"block":"none",t&&(this._momBird.update(e),this._babyBird1.update(e),this._babyBird2.update(e),this._babyBird3.update(e))}}}]),e}();n.Ending=v},{"../../core/properties":68,"../../core/settings":69,"../../scenes/scenes":96,"../components/PrimaryButton.js":102,"../components/intro/Bird":103,"../components/intro/Dust":104,"../components/intro/Grass":105,"../constants.js":106,"../ui":112,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],109:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Intro=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../components/intro/Bird"),s=e("../components/intro/Dust"),l=e("../components/intro/Grass"),u=e("../components/PrimaryButton.js"),c=e("../constants.js"),h=e("gsap").default,d=e("../../core/settings"),p=e("../../core/properties"),f=function(){function e(){var t=this;(0,i.default)(this,e),this._container=document.getElementById("intro"),this._title=document.querySelector("#intro-title h1"),this._subTitle=document.querySelector("#intro-title h2"),this._enterBtnDom=document.getElementById("intro-enter-btn"),this._windContainer=this._container.querySelector(".wind-particles"),this._grassContainer=this._container.querySelector(".plants"),this.babyBird1Stuck=this._container.querySelector(".baby-bird-stuck"),this.babyBird2=this._container.querySelector(".baby-bird2"),this.babyBird3=this._container.querySelector(".baby-bird3"),this.momBird=this._container.querySelector(".mom-bird"),this._enterBtn=new u.PrimaryButton(this._enterBtnDom,(function(){return t._onClick()})),this._hasInitialized=!1,this._hasEntered=!1,this._dust=new s.Dust(this._windContainer),this._grass=new l.Grass(this._grassContainer),this._momBird=new o.MomBird,this._babyBird1Stuck=new o.BabyBirdStuck,this._babyBird2=new o.BabyBird,this._babyBird3=new o.BabyBird,this.tlFadeIn=h.timeline({paused:!0}),this.tlFadeOut=h.timeline({paused:!0})}return(0,a.default)(e,[{key:"preInit",value:function(){var e=this;p.statusSignal.add((function(t){t!==c.STATUS.INTRO||d.SKIP_ANIMATION?(t===c.STATUS.STORY&&!e._hasEntered||d.SKIP_ANIMATION)&&(e._hide(),e._delete()):e.show()}))}},{key:"init",value:function(){this.initFadeInAnimation(),this.initFadeOutAnimation(),this._hasInitialized=!0,this._momBird.init({_bird:this.momBird}),this._babyBird1Stuck.init({_bird:this.babyBird1Stuck,followTarget:this._momBird,isStuck:!0,speed:7}),this._babyBird2.init({_bird:this.babyBird2,followTarget:this._momBird,followOffset:45,speed:7}),this._babyBird3.init({_bird:this.babyBird3,followTarget:this._momBird,followOffset:70,speed:5})}},{key:"initFadeInAnimation",value:function(){var e=this;this.tlFadeIn.to(this._container,{opacity:1,onComplete:function(){e._enterBtn.show(),e._grass.show(),e._dust.show(),e._momBird.show(),e._babyBird1Stuck.show(),e._babyBird2.show(),e._babyBird3.show()}}).to(this._title,{opacity:1,delay:1.5,ease:"Sine.easeInOut"}).to(this._subTitle,{opacity:1,ease:"Sine.easeInOut"},2.3)}},{key:"initFadeOutAnimation",value:function(){this.tlFadeOut.to(this._title,{opacity:0}).to(this._subTitle,{opacity:0},.3).to(this._container,{opacity:0}).to(p,{duration:2,introRatio:1})}},{key:"show",value:function(){d.SKIP_ANIMATION?this._hide():(this._momBird.x=p.rawWidth,this._babyBird2.x=p.rawWidth,this._babyBird3.x=p.rawWidth,this.tlFadeIn.play())}},{key:"_hide",value:function(){this._hasEntered||(this._hasEntered=!0,this._enterBtn.hide(),this._grass.hide(),this._dust.hide(),this._momBird.hide(),this._babyBird1Stuck.hide(),this._babyBird2.hide(),this._babyBird3.hide(),d.SKIP_ANIMATION?(p.introRatio=1,p.statusSignal.dispatch(c.STATUS.STORY)):this.tlFadeOut.play())}},{key:"_onClick",value:function(){this._enterBtn._btn.style.pointerEvents="none",p.statusSignal.dispatch(c.STATUS.STORY)}},{key:"_delete",value:function(){var e=this;setTimeout((function(){e._container.remove()}),d.SKIP_ANIMATION?0:3e3)}},{key:"update",value:function(e){this._momBird.update(e),this._babyBird1Stuck.update(e),this._babyBird2.update(e),this._babyBird3.update(e)}}]),e}();n.Intro=f},{"../../core/properties":68,"../../core/settings":69,"../components/PrimaryButton.js":102,"../components/intro/Bird":103,"../components/intro/Dust":104,"../components/intro/Grass":105,"../constants.js":106,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],110:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Preloader=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../constants.js"),s=e("gsap"),l=e("../../libs/gsap/CustomEase").default,u=e("../../core/settings"),c=e("../../core/properties"),h=function(){function e(){(0,i.default)(this,e),this._preloader=document.getElementById("preloader"),this._preloaderSprite=document.getElementById("preloader-sprite"),this._preloaderPercentage=document.getElementById("preloader-percentage"),this._preloaderExplanation=document.getElementById("preloader-explanation"),this._preloaderBarInner=document.getElementById("preloader-bar-inner"),this._spriteFrame=0,this._percent=0,this._targetPercent=0,this._isLoadingCompleted=!1,this._isAnimationCompleted=!1,this._cb,this.tlFadeIn=s.gsap.timeline({paused:!0}),this.tlFadeOut=s.gsap.timeline({paused:!0}),this.init()}return(0,a.default)(e,[{key:"preInit",value:function(e){var t=this;this._cb=e,u.SKIP_ANIMATION||u.SKIP_PRELOADER?(this._preloader.style.display="none",this._isAnimationCompleted=!0,document.documentElement.classList.add("is-ready"),c.statusSignal.dispatch(o.STATUS.STORY)):this._show(),c.statusSignal.add((function(e){(e===o.STATUS.INTRO||u.SKIP_ANIMATION)&&t._hide()})),c.loader.start((function(e){t._targetPercent=e}))}},{key:"init",value:function(){this.initFadeInAnimation(),this.initFadeOutAnimation()}},{key:"initFadeInAnimation",value:function(){var e=this;this.tlFadeIn.fromTo(this._preloaderPercentage,{opacity:0,y:30},{opacity:1,y:0,duration:1.6},0).fromTo(this._preloaderExplanation,{opacity:0,y:30},{opacity:1,y:0,duration:1.2,ease:"Power2.easeInOut",onComplete:function(){e._isAnimationCompleted=!0}},.05)}},{key:"initFadeOutAnimation",value:function(){var e=this;this.tlFadeOut.to(this._preloaderSprite,{opacity:0}).to(this._preloaderBarInner,{scaleY:0,duration:.8,ease:l.create("easeIn",".65,1.01,.97,1.00")}).to(this._preloaderPercentage,{opacity:0,duration:.6},.2).to(this._preloaderExplanation,{opacity:0,duration:.6},.45).to(this._preloader,{opacity:0,duration:1,onComplete:function(){document.documentElement.classList.add("is-ready"),e._preloader.classList.remove("is-active"),e._delete()}})}},{key:"_show",value:function(){this._preloader.classList.add("is-active"),this.tlFadeIn.play()}},{key:"_hide",value:function(){this.tlFadeOut.play()}},{key:"_delete",value:function(){var e=this;setTimeout((function(){e._preloader.remove()}),u.SKIP_ANIMATION?0:3e3)}},{key:"update",value:function(e){if(this._spriteFrame+=3*e,this._spriteFrame=this._spriteFrame%6,this._preloaderSprite.style.backgroundPosition=-100*Math.floor(this._spriteFrame)+"px",this._percent<1){this._percent=Math.min(this._targetPercent,this._percent+(this._targetPercent>this._percent?1:0)*(u.SKIP_ANIMATION?1:e));var t=Math.round(100*this._percent);this._preloaderPercentage.innerText=t+"%",this._preloaderBarInner.style.transform="scale3d(1,"+this._percent+",1)"}else 1==this._percent&&!this._isLoadingCompleted&&this._isAnimationCompleted&&(this._isLoadingCompleted=!0,this._preloaderExplanation.innerText="Experience is loaded",this._cb(),c.statusSignal.dispatch(o.STATUS.INTRO))}}]),e}();n.Preloader=h},{"../../core/properties":68,"../../core/settings":69,"../../libs/gsap/CustomEase":77,"../constants.js":106,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],111:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.Story=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("../components/Cursor.js"),s=e("../components/Interaction.js"),l=e("../components/PrimaryButton.js"),u=e("../components/Anchor"),c=e("../constants.js"),h=e("gsap"),d=r(e("../ui")),p=e("../../core/settings"),f=e("../../core/properties"),m=e("../../core/browser"),v=e("../components/Dialogs"),g=e("../../scenes/scenes"),y=e("../../libs/gsap/CustomEase").default,x=e("../../audios/audios"),_=function(){function e(){var t=this;(0,i.default)(this,e),this._container=document.getElementById("story"),this._btnDom=document.getElementById("story-next-btn"),this._dialogContainer=document.getElementById("story-dialogs"),this._footerAbout=document.getElementById("story-about"),this._footerSound=document.getElementById("audio-btn"),this.nextBtn=new l.PrimaryButton(this._btnDom,(function(){return t._onNextBtnClick()})),this.dialogs=new v(this._dialogContainer),this.interaction=new s.Interaction,m.isMobile||(this.cursor=new o.Cursor),this.anchors=new u.Anchor,this._dialogIndex=-1,this._dialogList=[],this._hasInitialized=!1,this._isActive=!1}return(0,a.default)(e,[{key:"preInit",value:function(){var e=this;f.statusSignal.add((function(t){t===c.STATUS.STORY&&e.show()})),this.interaction.init(),this.interaction.hide(),this.anchors.init(),this._footerAbout.onclick=function(){return e._onClickAbout()},this._footerAbout.addEventListener("mouseenter",(function(){return e._onFooterAboutMouseEnter()})),this._footerAbout.addEventListener("mouseleave",(function(){return e._onFooterAboutMouseLeave()}))}},{key:"init",value:function(){var e=this;this._hasInitialized=!0,g.onSceneStarted.add((function(){return e._onSceneStarted()})),g.onSceneEnded.add((function(){return e._onSceneEnded()})),g.onFinished.add((function(){return e._hide()})),this.dialogs.onChangeCompleted.add((function(){return e._next()})),m.isMobile||(this.interaction.onHoverIn.add((function(){return e.cursor.enter()})),this.interaction.onHoverOut.add((function(){return e.cursor.leave()})))}},{key:"show",value:function(){var e=this;this._isActive=!0,this._container.style.display="block",this._container.style.opacity=1,setTimeout((function(){e._nextStep()}),g.sceneIndex==p.DEFAULT_SCENE?3500:2e3),m.isMobile||this.cursor.show(),this._hideFooter(!0),setTimeout((function(){e._footerAbout.style.display="block",e._hideFooter(!1)}),3e3)}},{key:"_hide",value:function(){var e=this;this._isActive=!1,this._container.style.opacity=0,m.isMobile||this.cursor.hide(),setTimeout((function(){e._container.style.display="none"}),3e3)}},{key:"_next",value:function(){this._nextStep()}},{key:"_onNextBtnClick",value:function(e){g.goToNext()}},{key:"_changeBorder",value:function(e,t){h.gsap.to(f,{borderSize:e,borderNoiseSpeed:t,duration:1,ease:y.create("easeIn","0.54,-0.01, 0, 0.65")})}},{key:"_hideFooter",value:function(e){h.gsap.to(this._footerAbout,{opacity:e?0:1,pointerEvents:e?"none":"visible",duration:.5,ease:y.create("easeIn","0.54,-0.01, 0, 0.65")}),h.gsap.to(this._footerSound,{opacity:e?0:1,duration:.5,ease:y.create("easeIn","0.54,-0.01, 0, 0.65")})}},{key:"_onSceneStarted",value:function(e){var t=this;this.dialogs.reset(),this._changeBorder(15,.2),this._hideFooter(!1),this._dialogIndex=-1,this._dialogList=g.getDialogs(),g.sceneIndex!==p.DEFAULT_SCENE&&this._hasInitialized&&setTimeout((function(){t._nextStep()}),g.sceneIndex==p.DEFAULT_SCENE?3500:2e3)}},{key:"_onSceneEnded",value:function(){this.interaction.hide(),this.nextBtn.hide(),this.dialogs.hide(),this._hideFooter(!0),this._changeBorder(50,.1)}},{key:"_nextStep",value:function(){this._dialogIndex++,this._dialogIndex<this._dialogList.length?(this.dialogs.add(this._dialogList[this._dialogIndex]),this.dialogs.show()):(this.interaction.anchorCount>0&&this.interaction.show(),this.nextBtn.show())}},{key:"_onClickAbout",value:function(){d.default.showAbout()}},{key:"_onFooterAboutMouseEnter",value:function(){x.playHover()}},{key:"_onFooterAboutMouseLeave",value:function(){x.playHover()}},{key:"resize",value:function(e,t){}},{key:"update",value:function(e){this._hasInitialized&&!d.default.about._isActive&&(this.dialogs.update(e),this.interaction.update(e),m.isMobile||this.cursor.update(e))}}]),e}();n.Story=_},{"../../audios/audios":62,"../../core/browser":67,"../../core/properties":68,"../../core/settings":69,"../../libs/gsap/CustomEase":77,"../../scenes/scenes":96,"../components/Anchor":97,"../components/Cursor.js":99,"../components/Dialogs":100,"../components/Interaction.js":101,"../components/PrimaryButton.js":102,"../constants.js":106,"../ui":112,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10,gsap:22}],112:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=e("./pages/Preloader"),s=e("./pages/Intro"),l=e("./pages/Story"),u=e("./pages/Ending"),c=e("./pages/About"),h=e("../libs/splitting"),d=(e("../core/settings"),e("../core/properties")),p=new(function(){function e(){(0,i.default)(this,e)}return(0,a.default)(e,[{key:"preInit",value:function(e){this.preloader=new o.Preloader,this.intro=new s.Intro,this.story=new l.Story,this.ending=new u.Ending,this.about=new c.About,this.preloader.preInit(e),this.intro.preInit(),this.story.preInit(),this.ending.preInit(),this.about.preInit(),(0,h.splitText)(),d.statusSignal.add((function(e){return d.status=e}))}},{key:"init",value:function(){this.intro.init(),this.story.init(),this.ending.init(),this.about.init()}},{key:"update",value:function(e){this.preloader.update(e),this.intro.update(e),this.story.update(e),this.ending.update(e),this.about.update(e)}},{key:"showAbout",value:function(){this.about.show()}},{key:"hideAbout",value:function(){this.about.hide()}},{key:"resize",value:function(e,t){this.story.resize(e,t)}}]),e}());n.default=p},{"../core/properties":68,"../core/settings":69,"../libs/splitting":79,"./pages/About":107,"./pages/Ending":108,"./pages/Intro":109,"./pages/Preloader":110,"./pages/Story":111,"@babel/runtime/helpers/classCallCheck":4,"@babel/runtime/helpers/createClass":5,"@babel/runtime/helpers/interopRequireDefault":10}],113:[function(e,t,n){"use strict";var r;function i(e){(r=r||document.createElement("div")).innerHTML=e;for(var t,n=r.childNodes,i=[],a=n.length;a--;)1===(t=n[a]).nodeType&&(i.unshift(t),r.removeChild(t));return r.innerHTML="",i}n.createElements=i,n.createElement=function(e){return i(e)[0]},n.removeSelf=function(e){return e.parentNode&&e.parentNode.removeChild(e),e},n.clone=function(e){return i(e.outerHTML)[0]},n.filterByClass=function(e,t,n){for(var r=[],i=0,a=e.length;i<a;i++)if(e[i].classList.contains(t)){if(n)return e[i];r.push(e[i])}return n?null:r}},{}],114:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.linear=n.easeOutSine=n.easeOutQuint=n.easeOutQuart=n.easeOutQuad=n.easeOutExpo=n.easeOutElastic=n.easeOutCubic=n.easeOutCirc=n.easeOutBounce=n.easeOutBack=n.easeInSine=n.easeInQuint=n.easeInQuart=n.easeInQuad=n.easeInOutSine=n.easeInOutQuint=n.easeInOutQuart=n.easeInOutQuad=n.easeInOutExpo=n.easeInOutElastic=n.easeInOutCubic=n.easeInOutCirc=n.easeInOutBounce=n.easeInOutBack=n.easeInExpo=n.easeInElastic=n.easeInCubic=n.easeInCirc=n.easeInBounce=n.easeInBack=void 0,n.linear=function(e){return e},n.easeInQuad=function(e){return e*e},n.easeOutQuad=function(e){return e*(2-e)},n.easeInOutQuad=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},n.easeInCubic=function(e){return e*e*e},n.easeOutCubic=function(e){return--e*e*e+1},n.easeInOutCubic=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},n.easeInQuart=function(e){return e*e*e*e},n.easeOutQuart=function(e){return 1- --e*e*e*e},n.easeInOutQuart=function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},n.easeInQuint=function(e){return e*e*e*e*e},n.easeOutQuint=function(e){return--e*e*e*e*e+1},n.easeInOutQuint=function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},n.easeInSine=function(e){return 1-Math.cos(e*Math.PI/2)},n.easeOutSine=function(e){return Math.sin(e*Math.PI/2)},n.easeInOutSine=function(e){return.5*(1-Math.cos(Math.PI*e))},n.easeInExpo=function(e){return 0===e?0:Math.pow(1024,e-1)},n.easeOutExpo=function(e){return 1===e?1:1-Math.pow(2,-10*e)},n.easeInOutExpo=function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},n.easeInCirc=function(e){return 1-Math.sqrt(1-e*e)},n.easeOutCirc=function(e){return Math.sqrt(1- --e*e)},n.easeInOutCirc=function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},n.easeInElastic=function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4))},n.easeOutElastic=function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/.4)+1)},n.easeInOutElastic=function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-.5*n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4):n*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4)*.5+1)},n.easeInBack=function(e){var t=1.70158;return e*e*((t+1)*e-t)},n.easeOutBack=function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1};var r=function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)};n.easeInOutBack=r;var i=function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375};n.easeOutBounce=i,n.easeInBounce=function(e){return 1-i(1-e)},n.easeInOutBounce=function(e){return e<.5?.5*r(2*e):.5*i(2*e-1)+.5}},{}],115:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.unMix=n.step=n.smoothstep=n.sign=n.saturate=n.powerTwoFloorBase=n.powerTwoFloor=n.powerTwoCeilingBase=n.powerTwoCeiling=n.normalize=n.mix=n.map=n.lerp=n.latLngDistance=n.latLngBearing=n.isPowerOfTwo=n.hash2=n.hash=n.getAngle=n.fract=n.fit=n.distanceTo3=n.distanceTo=n.distanceSqrTo3=n.distanceSqrTo=n.distance=n.cubicBezierFn=n.cubicBezier=n.closestAngleTo=n.clamp=n.cUnMix=n.cMix=n.cMap=n.RAD2DEG=n.PI2=n.PI=n.HALF_PI=n.DEG2RAD=void 0;var r=Math.PI;n.PI=r;var i=2*r;n.PI2=i;var a=.5*r;n.HALF_PI=a;var o=r/180;n.DEG2RAD=o;var s=180/r;n.RAD2DEG=s,n.step=function(e,t){return t<e?0:1};var l=function(e,t,n){return e<t?t:e>n?n:e};n.clamp=l,n.mix=function(e,t,n){return e+(t-e)*n},n.cMix=function(e,t,n){return e+(t-e)*l(n,0,1)},n.unMix=function(e,t,n){return(n-e)/(t-e)};var u=function(e,t,n){return l((n-e)/(t-e),0,1)};n.cUnMix=u,n.saturate=function(e){return l(e,0,1)};var c=function(e,t,n,r,i){return r+(i-r)*(e-t)/(n-t)};n.map=c,n.cMap=function(e,t,n,r,i){return r+(i-r)*l((e-t)/(n-t),0,1)},n.fit=function(e,t,n,r,i,a){return e=u(t,n,e),a&&(e=a(e)),r+e*(i-r)},n.normalize=function(e,t,n){return c(e,t,n,0,1)},n.smoothstep=function(e,t,n){return(n=u(e,t,n))*n*(3-2*n)};var h=function(e){return e-Math.floor(e)};n.fract=h,n.hash=function(e){return h(43758.5453123*Math.sin(e))},n.hash2=function(e,t){return h(43758.5453*Math.sin(12.9898*e+4.1414*t))},n.sign=function(e){return e?e<0?-1:1:0};var d=function(e){return(e&-e)===e};n.isPowerOfTwo=d;var p=function(e){return Math.ceil(Math.log(e)/Math.log(2))};n.powerTwoCeilingBase=p,n.powerTwoCeiling=function(e){return d(e)?e:1<<p(e)};var f=function(e){return Math.floor(Math.log(e)/Math.log(2))};n.powerTwoFloorBase=f,n.powerTwoFloor=function(e){return d(e)?e:1<<f(e)},n.latLngBearing=function(e,t,n,r){var i=Math.sin(r-t)*Math.cos(n),a=Math.cos(e)*Math.sin(n)-Math.sin(e)*Math.cos(n)*Math.cos(r-t);return Math.atan2(i,a)},n.distance=function(e,t,n,r){var i=e-n,a=t-r;return Math.hypot(i,a)},n.distanceTo=function(e,t){return Math.sqrt(e*e+t*t)},n.distanceSqrTo=function(e,t){return e*e+t*t},n.distanceTo3=function(e,t,n){return Math.sqrt(e*e+t*t+n*n)},n.distanceSqrTo3=function(e,t,n){return e*e+t*t+n*n},n.latLngDistance=function(e,t,n,r){var i=Math.sin((n-e)/2),a=Math.sin((r-t)/2),o=i*i+Math.cos(e)*Math.cos(n)*a*a;return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))},n.cubicBezier=function(e,t,n,r,i){var a=3*(t-e),o=3*(n-t)-a,s=i*i;return s*i*(r-e-a-o)+o*s+a*i+e},n.cubicBezierFn=function(e,t,n,r){var i=3*(t-e),a=3*(n-t)-i,o=r-e-i-a;return function(t){var n=t*t;return o*(n*t)+a*n+i*t+e}},n.closestAngleTo=function(e,t){var n=t-e;return e+((n=(n+=r)<0?i-Math.abs(n%i):n%i)-r)},n.lerp=function(e,t,n){return(1-n)*e+n*t},n.getAngle=function(e,t){return 180*Math.atan2(t,e)/Math.PI}},{}],116:[function(e,t,n){"use strict";var r=e("../../helpers/fboHelper"),i=e("three"),a=e("glslify");n.preInit=function(){var e=new i.InstancedBufferGeometry,t=new i.PlaneBufferGeometry(1,1);for(var g in t.rotateX(.5*-Math.PI),t.attributes)e.setAttribute(g,t.attributes[g]);e.setIndex(t.getIndex()),e.setAttribute("instancePosition",o=new i.InstancedBufferAttribute(s=new Float32Array(12),3)),e.setAttribute("instanceOrient",l=new i.InstancedBufferAttribute(u=new Float32Array(16),4)),e.setAttribute("instanceScale",c=new i.InstancedBufferAttribute(h=new Float32Array(12),3)),e.setAttribute("instanceOpacity",d=new i.InstancedBufferAttribute(p=new Float32Array(4),1)),e.setAttribute("instanceColor",f=new i.InstancedBufferAttribute(m=new Float32Array(12),3)),(v=n.mesh=new i.Mesh(e,new i.RawShaderMaterial({uniforms:{},depthWrite:!1,vertexShader:r.precisionPrefix+a(["#define GLSLIFY 1\nattribute vec3 instancePosition;\nattribute vec4 instanceOrient;\nattribute vec3 instanceScale;\nattribute float instanceOpacity;\nattribute vec3 instanceColor;\n\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvarying vec4 v_color4;\nvarying vec2 v_uv;\n\nvec3 qRotate (vec4 q, vec3 v) { \n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main () {\n\tvec3 pos = position;\n\tpos = qRotate(instanceOrient, pos * instanceScale) + instancePosition;\n\n\tvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_uv = uv;\n\tv_color4 = vec4(instanceColor, instanceOpacity);\n}"]),fragmentShader:r.precisionPrefix+a(["#define GLSLIFY 1\nvarying vec4 v_color4;\nvarying vec2 v_uv;\n\nvoid main () {\n\tgl_FragColor = v_color4;\n\tgl_FragColor.a *= max(0.0, 1.0 - length(v_uv - 0.5) * 2.0);\n}"]),transparent:!0}))).frustumCulled=!1,v.visible=!1,v.renderOrder=8e3},n.init=function(){},n.clear=function(){g=0},n.add=function(e){e.position.toArray(s,3*g),e.quaternion.toArray(u,4*g),e.scale.toArray(h,3*g),p[g]=e.userData.data.opacity||1,y.setStyle(e.userData.data.color||"#031d00").toArray(m,3*g),0==g&&(o.needsUpdate=!0,l.needsUpdate=!0,c.needsUpdate=!0,d.needsUpdate=!0,f.needsUpdate=!0),g++},n.resize=function(e,t){},n.update=function(e){v.geometry.instanceCount=g,v.visible=g>0};var o,s,l,u,c,h,d,p,f,m,v=n.mesh=null,g=0,y=new i.Color},{"../../helpers/fboHelper":72,glslify:21,three:59}],117:[function(e,t,n){"use strict";var r=e("../../core/settings"),i=e("../../core/properties"),a=e("../../helpers/fboHelper"),o=e("../terrain/terrain"),s=e("gsap").default,l=e("../sky/sky"),u=e("mout/object/mixIn"),c=e("../../controls/TransformControls"),h=e("../../controls/cameraControls"),d=e("../../utils/math"),p=e("../../audios/audios"),f=e("../../scenes/scenes"),m=e("./characterShadows"),v=e("../river/river"),g=e("three"),y=e("glslify");n.preInit=function(){for(var e in n.container=new g.Object3D,m.preInit(),n.container.add(m.mesh),_){var t=_[e],a=t.modelFilename,o=t.textureFilename,s=t.spriteFilename;o&&(M[e]=i.loader.add(r.TEXTURE_PATH+"characters/"+o,{weight:300,type:"texture"}).content),a&&i.loader.add(r.MODEL_PATH+"characters/"+a+".buf",{weight:300,onLoad:R.bind(this,e,t)}),s&&i.loader.add(r.TEXTURE_PATH+"characters/"+s+".json",{weight:10,type:"json",onLoad:L.bind(this,e,t)}),"shadow"==t.type&&C(e,t)}},n.init=function(){r.LOOK_DEV_MODE&&window.addEventListener("keyup",(function(e){if(16===e.keyCode)for(var t in T="translate"===T?"rotate":"translate",S)S[t].setMode(T)})),m.init()},n.getActiveCharacters=function(){var e=[];for(var t in w)w[t].visible&&e.push(w[t]);return e},n.addAnchor=function(e,t){var i=b[e]=new g.Object3D;i.visible=!1,i.userData.id=e,i.userData.config={type:"anchor"},i.userData.data=t,i.userData.visible=!1,i.userData.screenXY=new g.Vector2,n.container.add(i),r.LOOK_DEV_MODE&&P(e)},n.resize=function(e,t){m.resize(e,t)},n.show=function(e,t){var n=b[e];if(n.userData.time=0,n.visible=!0,t){var r=(n.userData.tweens=[])[0]=s.timeline();if("popin"==t)p.play("wolf"),A.position.copy(n.position),A.quaternion.copy(n.quaternion),A.scale.copy(n.scale),A.translateX(.2),r.fromTo(n.position,{x:A.position.x,y:A.position.y,z:A.position.z},{x:n.position.x,y:n.position.y,z:n.position.z,ease:"Cubic.easeOut",duration:1},0);else if("bounce"==t){p.play("spring");var i=b.bush;i.userData.time=0,i.visible=!0,r.fromTo(n.scale,{x:1.5*n.scale.x,y:.1*n.scale.y,z:1.5*n.scale.z},{x:n.scale.x,y:n.scale.y,z:n.scale.z,ease:"Bounce.easeOut",duration:1.5},0).fromTo(n.position,{y:n.position.y-.1},{y:n.position.y,ease:"Bounce.easeOut",duration:1},0)}}},n.jumpAndSplash=function(e,t,n){var r=b[e],i=b[n],a=(r.userData.tweens=[])[0]=s.timeline();a.to(r.scale,{x:1.2*r.scale.x,y:.9*r.scale.y,z:1.2*r.scale.z,duration:.2},0),a.to(r.scale,{x:.9*r.scale.x,y:1.2*r.scale.y,z:.9*r.scale.z,duration:.3},.2).to(r.position,{x:t[0],z:t[2],ease:"Sine.easeOut",duration:1},.2).to(r.position,{y:r.position.y+.03,duration:.5,ease:"Sine.easeOut"},.2).to(r.position,{y:t[1],duration:.5,ease:"Sine.easeIn",onComplete:function(){i.visible=!0,v.splash(t[0],t[2],.35),r.visible=!1}},.7).fromTo(i.position,{y:i.position.y-.05},{y:i.position.y,ease:"Bounce.easeOut",duration:2},"<")},n.frogSleep=function(){var e=b.frog;e.userData.time=0,e.userData.spriteFrameCount=14,p.play("frog"),((e.userData.tweens=[])[0]=s.timeline()).call((function(){e.userData.time=0,e.userData.spriteFrameOffset=14,e.userData.spriteFrameCount=5}),null,14/e.userData.config.fps)},n.update=function(e){for(var t in m.clear(),x.length=0,b){var r=b[t];if(S[t]&&r&&(S[t].visible=S[t].enabled=r.visible&&n.controlVisibilities[r.userData.config.type]),r.visible){var a=w[t],s=r.userData.actionStrength,l=r.scale.x,u=r.userData.config.needsWriteToTerrain;if("shadow"===r.userData.config.type)m.add(r);else if("anchor"===r.userData.config.type)E.copy(r.position).project(i.camera),r.userData.screenXY.set((.5*E.x+.5)*i.rawWidth,(.5-.5*E.y)*i.rawHeight),f.onAnchorPlacementUpdated.dispatch(r.userData);else if(r.userData.spriteData){var c=r.userData.time+=e,h=r.userData.spriteFrameCount||r.userData.frameCount,p=Math.floor(c*r.userData.config.fps%h);(r.userData.spriteLoopCount||0)>0&&Math.floor(c*r.userData.config.fps/h)>=r.userData.spriteLoopCount&&(r.visible=!1),r.userData.spriteBounce&&Math.floor(c*r.userData.config.fps/h)%2&&(p=h-p-1),p+=r.userData.spriteFrameOffset||0;var v=r.userData.spriteData.frames[p],g=r.userData.textureWidth,y=r.userData.textureHeight,_=v.frame.x/g,M=v.frame.y/y,T=v.frame.w/g,A=v.frame.h/y;a.material.uniforms.u_textureOffset.value.set(_,M),a.material.uniforms.u_textureScale.value.set(T,A),a.material.uniforms.u_geometryScale.value.set(v.spriteSourceSize.w,v.spriteSourceSize.h),a.material.uniforms.u_geometryOffset.value.set(v.spriteSourceSize.x,-v.spriteSourceSize.y);var C=1/v.sourceSize.h;if(a.position.set(.5*-v.sourceSize.w*C,.5*v.sourceSize.h*C,0),a.scale.set(C,C,1),"fly"===r.userData.action){var L=c/(.5+.5*s)*2;a.position.x+=Math.cos(.85*L+42.4)/C*.0015*s,a.position.y+=Math.sin(2*L+22.51235)/C*75e-5*s,a.position.y+=Math.max(0,Math.cos(6*L+Math.sin(3*L)))/C*6e-4*s,a.position.z+=Math.cos(.75*L+223.54)/C*.0015*s,a.rotation.x=.2*Math.cos(L+1.51232),a.rotation.z=.2*Math.cos(L+2.734)}}else{var R=r.userData.time+=e*(1+r.userData.random);switch(a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),a.material.uniforms.u_bounce.value=1-2*Math.abs(R%1-.5),r.userData.action){case"bounce":a.position.y+=Math.max(0,Math.cos(6*R+Math.sin(4*R)))/l*.005;break;case"swim":a.rotation.x+=.025*Math.cos(R+1.51232)*s,a.rotation.y+=.1*Math.cos(R)*s,a.rotation.z+=.025*Math.cos(R+2.734)*s,a.position.x+=Math.cos(.85*R+42.4)/l*.01*s,a.position.y+=Math.cos(1*R+22.51235)/l*.0075*s,a.position.z+=Math.cos(.75*R+223.54)/l*.01*s;break;case"look":a.rotation.y+=d.fit(Math.cos(1.5*R),-.25,.25,-.1,.1)*s,a.position.y+=Math.max(0,Math.cos(6*R+Math.sin(4*R)))/l*.005*s}}u&&x.push(a)}}if(x.length){n.container.updateMatrixWorld(!0);for(var P=0;P<x.length;P++)o.addCharacterMesh(x[P])}m.update(e)},n.controlVisibilities={main:!0,expression:!0,extra:!0,anchor:!0,shadow:!0},n.container=null;var x=[],_={mum:{type:"main",modelFilename:"bird",textureFilename:"bird.png",needsWriteToTerrain:!0},mumNoLeg:{type:"main",modelFilename:"bird",textureFilename:"bird.png",drawCount:12608,drawCountChangedOffsetY:-.7,needsWriteToTerrain:!0,doubleSided:!0},baby1:{type:"main",modelFilename:"baby_bird",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},baby2:{type:"main",modelFilename:"baby_bird",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},baby3:{type:"main",modelFilename:"baby_bird",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},babyJump:{type:"main",modelFilename:"baby_jump",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},babyNoLeg1:{type:"main",modelFilename:"baby_no_leg",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},babyNoLeg2:{type:"main",modelFilename:"baby_no_leg",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},babyTopRock:{type:"main",modelFilename:"baby_top_rock",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},babyWalk:{type:"main",modelFilename:"baby_walk",textureFilename:"baby_bird.jpg",needsWriteToTerrain:!0},afraid:{type:"expression",spriteFilename:"afraid",textureFilename:"afraid.png",fps:30,hasAlpha:!1},talk:{type:"expression",spriteFilename:"talk",textureFilename:"talk.png",fps:30,hasAlpha:!1},talk2:{type:"expression",spriteFilename:"talk",textureFilename:"talk.png",fps:30,hasAlpha:!1},bee:{type:"extra",spriteFilename:"bee",textureFilename:"bee.png",fps:30,hasAlpha:!0},bee2:{type:"extra",spriteFilename:"bee",textureFilename:"bee.png",fps:30,hasAlpha:!0},dragonfly:{type:"extra",spriteFilename:"dragonfly",textureFilename:"dragonfly.png",fps:30,hasAlpha:!0},fly:{type:"extra",spriteFilename:"fly",textureFilename:"fly.png",fps:30,hasAlpha:!0},rabbit:{type:"extra",spriteFilename:"rabbit",textureFilename:"rabbit.png",fps:10,hasAlpha:!0},tail:{type:"extra",spriteFilename:"tail",textureFilename:"tail.png",fps:30,hasAlpha:!0},wolf:{type:"extra",spriteFilename:"wolf",textureFilename:"wolf.png",fps:10,hasAlpha:!0},frog:{type:"extra",spriteFilename:"frog",textureFilename:"frog.png",fps:8,hasAlpha:!0},bush:{type:"extra",spriteFilename:"bush",textureFilename:"bush.png",fps:15,hasAlpha:!0},mumShadow:{type:"shadow"},baby1Shadow:{type:"shadow"},baby2Shadow:{type:"shadow"},baby3Shadow:{type:"shadow"}},b=n.meshContainers={},w=n.meshes={},M={},S={},T="translate",E=new g.Vector3,A=new g.Object3D;function C(e,t){var i=b[e]=new g.Object3D;i.visible=!1,i.userData.id=e,i.userData.config=t,i.userData.visible=!1,n.container.add(i),r.LOOK_DEV_MODE&&P(e)}function L(e,t,i){var o=b[e]=new g.Object3D;M[e].flipY=!1;var s=w[e]=new g.Mesh(new g.PlaneGeometry(1,1).translate(.5,-.5,0),new g.RawShaderMaterial({uniforms:u({u_texture:{value:M[e]},u_textureOffset:{value:new g.Vector2},u_textureScale:{value:new g.Vector2},u_geometryScale:{value:new g.Vector2},u_geometryOffset:{value:new g.Vector2},u_hasAlpha:{value:+t.hasAlpha}},l.sharedUniforms),vertexShader:a.precisionPrefix+y(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nuniform vec2 u_textureOffset;\nuniform vec2 u_textureScale;\nuniform vec2 u_geometryScale;\nuniform vec2 u_geometryOffset;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_uv;\n\nvoid main () {\n\tvec3 pos = position;\n\tpos.xy *= u_geometryScale;\n\tpos.xy += u_geometryOffset;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n\n\tv_viewNormal = normalMatrix * normal;\n\tv_worldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n\tv_uv = vec2(uv.x, 1.0 - uv.y) * u_textureScale + u_textureOffset;\n}"]),fragmentShader:a.precisionPrefix+y(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec3 cameraPosition;\nuniform float u_hasAlpha;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_uv;\n\n#include <fog>\n\nvoid main () {\n\tgl_FragColor = texture2D(u_texture, v_uv);\n\tgl_FragColor = u_hasAlpha > 0.5 ? gl_FragColor : vec4(0.0, 0.0, 0.0, gl_FragColor.r);\n\tif (gl_FragColor.a < 0.1) discard;\n}"]),side:g.DoubleSide,transparent:!0}));o.add(s),o.visible=!1,o.userData.spriteData=i,o.userData.frameCount=i.frames.length,o.userData.config=t,o.userData.action="",o.userData.textureWidth=i.meta.size.w,o.userData.textureHeight=i.meta.size.h,o.userData.random=Math.random(),o.userData.time=100*Math.random(),s.frustumCulled=!1,n.container.add(o),r.LOOK_DEV_MODE&&P(e)}function R(e,t,i){if(t.drawCount){var s=new g.BufferGeometry;for(var c in i.translate(0,.5,0),i.attributes)s.setAttribute(c,i.attributes[c]);s.setIndex(i.getIndex()),(i=s).setDrawRange(0,3*t.drawCount),t.drawCountChangedOffsetY&&i.translate(0,t.drawCountChangedOffsetY,0)}i.boundingSphere||i.computeBoundingSphere(),t.needsWriteToTerrain&&(i.boundingBox||i.computeBoundingBox());var h=b[e]=new g.Object3D,d=w[e]=new g.Mesh(i,new g.RawShaderMaterial({uniforms:u({u_texture:{value:M[e]},u_terrainInfoTexture:o.sharedUniforms.u_terrainInfoTexture,u_terrainBoundingMin:o.sharedUniforms.u_terrainBoundingMin,u_terrainBoundingMax:o.sharedUniforms.u_terrainBoundingMax,u_bounce:{value:0}},l.sharedUniforms),vertexShader:a.precisionPrefix+y(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform float u_bounce;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_localPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_worldNormal;\nvarying vec2 v_uv;\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\nvoid main () {\n\tv_localPosition = position;\n\n\tv_localPosition.y *=  mix(0.985, 1.0, u_bounce);\n\tv_localPosition.xz *= mix(1.015, 1.0, u_bounce);\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(v_localPosition, 1.0);\n\n\tv_viewNormal = normalMatrix * normal;\n\tv_worldNormal = inverseTransformDirection(v_viewNormal, viewMatrix);\n\tv_worldPosition = (modelMatrix * vec4(v_localPosition, 1.0)).xyz;\n\tv_uv = uv;\n}"]),fragmentShader:a.precisionPrefix+y(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec3 cameraPosition;\n\nuniform sampler2D u_terrainInfoTexture;\nuniform vec3 u_terrainBoundingMin;\nuniform vec3 u_terrainBoundingMax;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_localPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_worldNormal;\nvarying vec2 v_uv;\n\n#include <fog>\n\nvoid main () {\n\tvec3 normalizedWorldPositionToTerrain = (v_worldPosition - u_terrainBoundingMin) / (u_terrainBoundingMax - u_terrainBoundingMin);\n\tvec2 terrainUv = normalizedWorldPositionToTerrain.xz;\n\tvec4 terrainInfo = texture2D(u_terrainInfoTexture, terrainUv);\n\n\tgl_FragColor = texture2D(u_texture, v_uv);\n\t#ifdef USE_ALPHA\n\t\tif (gl_FragColor.a < 0.03) discard;\n\t#endif\n\n\tfloat floorDiffuse = smoothstep(1.0, -1.0, v_worldNormal.y) * smoothstep(1.0, 0.0, v_localPosition.y * v_localPosition.y);\n\tgl_FragColor.rgb = mix(gl_FragColor.rgb, mix(vec3(0.1843137254901961,0.26666666666666666,0.20784313725490197), vec3(0.6235294117647059,0.7686274509803922,0.9333333333333333), terrainInfo.a), floorDiffuse * (1.0 - terrainInfo.a * 0.5));\n\n\tgl_FragColor.rgb = applyFog(clamp(gl_FragColor.rgb, vec3(0.0), vec3(1.0)), v_worldPosition);\n\n}"]),side:t.doubleSided?g.DoubleSide:g.FrontSide}));t.textureFilename.indexOf(".png")>-1&&(d.material.defines.USE_ALPHA=!0,d.material.blending=g.CustomBlending,d.material.blendSrc=g.SrcAlphaFactor,d.material.blendDst=g.OneMinusSrcAlphaFactor,d.material.blendSrcAlpha=g.OneFactor,d.material.blendDstAlpha=g.OneMinusSrcAlphaFactor),h.add(d),h.visible=!1,h.userData.config=t,h.userData.action="",h.userData.random=Math.random(),h.userData.time=100*Math.random(),n.container.add(h),r.LOOK_DEV_MODE&&P(e)}function P(e){var t=S[e]=new c(i.camera,r.canvas);t.attach(b[e]),n.container.add(t),t.addEventListener("dragging-changed",D)}function D(e){h.orbitControls.enabled=!e.value}},{"../../audios/audios":62,"../../controls/TransformControls":65,"../../controls/cameraControls":66,"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../../scenes/scenes":96,"../../utils/math":115,"../river/river":123,"../sky/sky":125,"../terrain/terrain":126,"./characterShadows":116,glslify:21,gsap:22,"mout/object/mixIn":40,three:59}],118:[function(e,t,n){"use strict";var r,i,a=e("../../core/settings"),o=e("../../core/properties"),s=(e("../../utils/math"),e("three")),l=e("glslify");n.preInit=function(){n.container=new s.Object3D,i=o.loader.add(a.TEXTURE_PATH+"dust-texture.jpg",{type:"texture",weight:10}).content},n.init=function(){for(var e=new s.PlaneBufferGeometry(1,1,1,1),t=new Float32Array(c),a=new Float32Array(6144),o=new Float32Array(c),h=0,d=0;h<c;h++){var p=.5+10*Math.sqrt(Math.random()),f=h/c*Math.PI*2;t[h]=Math.random(),a[d+0]=Math.cos(f)*p,a[d+1]=Math.tan(2*(Math.random()-.5))*p*.5,a[d+2]=Math.sin(f)*p,o[h]=Math.floor(Math.random()*(u.x-1)),o[h]>1&&o[h]++,d+=3}var m=new s.InstancedBufferGeometry;for(var v in e.attributes)m.setAttribute(v,e.attributes[v]);m.setIndex(e.getIndex()),m.setAttribute("a_id",new s.InstancedBufferAttribute(t,1)),m.setAttribute("a_position",new s.InstancedBufferAttribute(a,3)),m.setAttribute("a_spriteId",new s.InstancedBufferAttribute(o,1));var g=new s.ShaderMaterial({uniforms:{u_spriteSize:{value:u},u_dustTexture:{value:i},u_time:{value:0},u_opacity:{value:0}},vertexShader:l(["#define GLSLIFY 1\nattribute float a_id;\nattribute vec3 a_position;\nattribute float a_spriteId;\n\nuniform vec2 u_spriteSize;\nuniform float u_time;\nuniform float u_opacity;\n\nvarying vec2 v_uv1;\nvarying vec2 v_uv2;\nvarying float v_mix;\nvarying float v_blur;\nvarying float v_rotation;\nvarying float v_opacity;\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v + dot(v, vec4(F4)) );\n    vec4 x0 = v -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\nfloat n11(float p) {\n  return fract(97531.2468 * sin(24680.135 * p));\n}\n\nvec2 rotate2d(vec2 uv, float a) {\n  float sinTheta = sin(a);\n  float cosTheta = cos(a);\n  uv = mat2(cosTheta, -sinTheta, sinTheta, cosTheta) * uv;\n  return uv;\n}\n\nvoid main() {\n  vec3 pos = a_position;\n  vec3 noiseDirection = vec3(\n    0.5 * cos(0.1 * u_time),\n    sin(0.05 * u_time),\n    0.25\n  );\n  pos += 0.65 * noiseDirection * simplexNoiseDerivatives(vec4(0.08 * pos, 0.05 * u_time)).xyz * vec3(1.0, 0.3, 1.0);\n  pos += 0.4 * noiseDirection * simplexNoiseDerivatives(vec4(0.12 * pos + 10.0, 0.03 * u_time)).xyz * vec3(1.0, 0.3, 1.0);\n\n  // pos.y = abs(pos.y);\n\n  pos.y = abs(pos.y - -0.203611) + -0.203611;\n\n  vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n  vec2 spriteSizeMinus1 = u_spriteSize - 1.0;\n  float blurLevel = spriteSizeMinus1.y * smoothstep(0.0, 8.0, abs(-mvPosition.z - 5.0));\n  v_blur = blurLevel;\n\n  vec4 offsets = vec4(\n    vec2(a_spriteId, spriteSizeMinus1.y - floor(blurLevel)),\n    vec2(a_spriteId, spriteSizeMinus1.y - ceil(blurLevel))\n  );\n  v_uv1 = (uv + offsets.xy) / u_spriteSize;\n  v_uv2 = (uv + offsets.zw) / u_spriteSize;\n\n  v_mix = fract(blurLevel);\n  \n  float rand = n11(a_id);\n  float scale = 0.015 * (1.0 + blurLevel);\n  vec3 positionRotated = position.xyz;\n  v_rotation = (rand - 0.5) * u_time * 3.0 + 21.0 * a_id;\n  positionRotated.xy = rotate2d(positionRotated.xy, v_rotation);\n  mvPosition.xyz += scale * positionRotated;\n\n  v_opacity = smoothstep(0.1, 0.2, -mvPosition.z) * smoothstep(20.0, 10.0, -mvPosition.z) * u_opacity;\n\n  gl_Position = projectionMatrix * mvPosition;\n}"]),fragmentShader:l(["#define GLSLIFY 1\nuniform sampler2D u_dustTexture;\nuniform vec2 u_spriteSize;\nuniform float u_time;\n\nvarying vec3 v_position;\nvarying vec2 v_uv1;\nvarying vec2 v_uv2;\nvarying float v_mix;\nvarying float v_blur;\nvarying float v_rotation;\nvarying float v_opacity;\n\nfloat n21(vec2 p) {\n  return fract(sin(p.x * 1234.56 + p.y * 7531.246) * 6901.749);\n}\n\nvec2 rotate2d(vec2 uv, float a) {\n  return mat2(cos(a), -sin(a), sin(a), cos(a)) * uv;\n}\n\nvoid main() {\n  vec4 dust1 = texture2D(u_dustTexture, v_uv1);\n  vec4 dust2 = texture2D(u_dustTexture, v_uv2);\n  vec4 dust = mix(dust1, dust2, v_mix);\n  vec3 normal = vec3(dust.rg * 2.0 - 1.0, 0.0);\n  // float blur = v_blur / (u_spriteSize.y - 1.0);\n\n  normal.xy = rotate2d(normal.xy, 3.1415926-v_rotation);\n  normal.z = sqrt(1.0 - normal.x * normal.x - normal.y * normal.y);\n  normal = normalize(normal);\n  \n  vec3 lightPosition = vec3(0.0, 1.0, 1.0);\n  float light = max(0.0, dot(normal, normalize(lightPosition)));\n\n  // ALPHA - BOKEH\n  float alpha = dust.b / (1.0 + v_blur * 1.0);\n\n  gl_FragColor = vec4(1.0, 1.0, 1.0, alpha * light * v_opacity);\n}"]),depthWrite:!1,transparent:!0,blending:s.CustomBlending,blendEquation:s.AddEquation,blendSrc:s.SrcAlphaFactor,blendDst:s.OneFactor,blendEquationAlpha:s.AddEquation,blendSrcAlpha:s.ZeroFactor,blendDstAlpha:s.OneFactor});(r=new s.Mesh(m,g)).frustumCulled=!1,n.container.add(r)},n.resize=function(e,t){},n.update=function(e){r.material.uniforms.u_time.value+=e,r.material.uniforms.u_opacity.value=.35},n.container=null;var u=new s.Vector2(8,8),c=2048},{"../../core/properties":68,"../../core/settings":69,"../../utils/math":115,glslify:21,three:59}],119:[function(e,t,n){"use strict";var r,i,a=e("../../core/settings"),o=e("../../core/properties"),s=e("../../helpers/fboHelper"),l=(e("../terrain/terrain"),e("../../utils/math")),u=e("../../utils/ease"),c=e("../sky/sky"),h=e("../river/river"),d=e("mout/object/mixIn"),p=e("three"),f=e("glslify");n.preInit=function(){n.container=new p.Object3D,m=new p.Object3D,o.loader.add(a.MODEL_PATH+"fish.buf",{weight:61,noCache:!0,onLoad:E}),o.loader.add(a.MODEL_PATH+"fish_spline.buf",{weight:2,noCache:!0,onLoad:T}),i=o.loader.add(a.TEXTURE_PATH+"fish.png",{weight:295,type:"texture"}).content},n.init=function(){},n.resize=function(e,t){},n.update=function(e){if(o.hasInitialized){w+=e;for(var t=0,r=0,i=0;t<5;t++){var a=w+t/5*_/6,s=6*a%_;A(m.position,s-1),A(S,s+1),m.lookAt(S),A(m.position,s),A(S,s=6*(a-e)%_),y.array[t]+=3*m.position.distanceTo(S)+.2*e;var c=0;0==t&&n.canSplash?(c=.2*w%3,x.array[t]=1-2*Math.abs(Math.min(1,c)-.5),c=l.smoothstep(0,.1,c)*Math.pow(1-u.easeOutQuint(l.smoothstep(0,1,c)),2)):x.array[t]=c,m.position.y=.1*c-.3,m.position.toArray(v.array,r),m.quaternion.toArray(g.array,i),m.position.y>-.25&&n.canSplash&&(m.translateZ(.25),h.splash(m.position.x,m.position.z)),r+=3,i+=4}v.needsUpdate=!0,g.needsUpdate=!0,y.needsUpdate=!0,x.needsUpdate=!0}},n.canSplash=!1,n.container=null;var m,v,g,y,x,_=0,b=[],w=0,M=new p.Vector3,S=new p.Vector3;function T(e){b=e.attributes.position.array,_=b.length/3}function E(e){var t=new p.InstancedBufferGeometry;for(var a in e.attributes)t.setAttribute(a,e.attributes[a]);t.setIndex(e.getIndex()),t.setAttribute("instancePosition",v=new p.InstancedBufferAttribute(new Float32Array(15),3)),t.setAttribute("instanceOrient",g=new p.InstancedBufferAttribute(new Float32Array(20),4)),t.setAttribute("instanceScale",new p.InstancedBufferAttribute(new Float32Array(5),1)),t.setAttribute("instanceHueShift",new p.InstancedBufferAttribute(new Float32Array(5),1)),t.setAttribute("instanceTime",y=new p.InstancedBufferAttribute(new Float32Array(5),1)),t.setAttribute("instanceYRatio",x=new p.InstancedBufferAttribute(new Float32Array(5),1));for(var o=[.75,.6,.4,.4,.4],l=[-.35,0,.075,.075,.075],u=t.attributes.instanceScale.array,h=t.attributes.instanceHueShift.array,m=0;m<5;m++)u[m]=o[m%o.length],h[m]=l[m%l.length];(r=new p.Mesh(t,new p.RawShaderMaterial({uniforms:d({u_texture:{value:i}},c.sharedUniforms),vertexShader:s.precisionPrefix+f(["#define GLSLIFY 1\nattribute vec3 instancePosition;\nattribute vec4 instanceOrient;\nattribute float instanceScale;\nattribute float instanceTime;\nattribute float instanceYRatio;\nattribute float instanceHueShift;\n\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute float occlusion;\nattribute float finRatio;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_uv;\nvarying float v_ao;\nvarying float v_instanceHueShift;\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v_0) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v_0 + dot(v_0, vec4(F4)) );\n    vec4 x0 = v_0 -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\nvec3 qRotate (vec4 q, vec3 v) { \n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\nvec4 getRotation(vec3 axis, float halfAngle) { \n\treturn vec4(axis.xyz * sin(halfAngle), cos(halfAngle));\n}\n\nvoid main () {\n\tvec3 pos = position;\n\tvec3 nor = normal;\n\tvec3 noise = simplexNoiseDerivatives(vec4(pos * 10.0, instanceTime * 0.5)).xyz * 0.0075 * finRatio;\n\tnoise.y *= 0.0;\n\n\tpos += noise;\n\tnor = normalize(nor + noise * 100.0);\n\n\tvec4 q = getRotation(vec3(0.0, 1.0, 0.0), cos(instanceTime * 3.0 + position.z * 6.0 + sin(instanceTime * 1.5) * 0.8 ) * (0.1 + finRatio * 0.15));\n\n\tpos = qRotate(q, pos * instanceScale);\n\tnor = qRotate(q, nor);\n\n\tfloat lengthRatio = (position.z - -0.157056) / 0.32007;\n\tfloat yRatio = instanceYRatio;\n\tq = getRotation(vec3(1.0, 0.0, 0.0), -instanceYRatio * 0.25 * lengthRatio * lengthRatio);\n\tpos = qRotate(q, pos);\n\tnor = qRotate(q, nor);\n\n\tpos = qRotate(instanceOrient, pos) + instancePosition;\n\tnor = qRotate(instanceOrient, nor);\n\n\tvec4 worldPosition = modelMatrix * vec4(pos, 1.0);\n\tvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_worldPosition = worldPosition.xyz;\n\tv_viewPosition = mvPosition.xyz;\n\tv_viewNormal = normalMatrix * nor;\n\n\tv_uv = uv;\n\tv_instanceHueShift = instanceHueShift;\n\tv_ao = occlusion;\n}"]),fragmentShader:s.precisionPrefix+f(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_uv;\nvarying float v_ao;\nvarying float v_instanceHueShift;\n\n#include <fog>\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\nvec3 rgb2hsv(vec3 c) {\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c) {\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main () {\n\tvec4 texel = texture2D(u_texture, v_uv);\n\ttexel.rgb = rgb2hsv(texel.rgb);\n\n\ttexel.r += v_instanceHueShift;\n\n\ttexel.rgb = hsv2rgb(texel.rgb);\n\n\tvec3 color = texel.rgb * v_ao;\n\n\tvec3 worldNormal = inverseTransformDirection(normalize(v_viewNormal), viewMatrix);\n\tvec3 specRay = reflect(normalize(v_worldPosition - cameraPosition), normalize(worldNormal));\n\n\tvec3 diff = sampleSky(worldNormal);\n\tvec3 spec = sampleSky(specRay);\n\t\n\tcolor = color * (1.0 + diff * 0.3) * v_ao + (spec + spec.b) * v_ao * color * color * color * 4.0 * mix(0.6, 0.1, color.b);\n\tcolor *= mix(0.85, 1.0, step(-0.203611, v_worldPosition.y)) * (1.0 - pow(clamp((v_worldPosition.y + 0.203611) / -0.6, 0.0, 1.0), 0.5));\n\n\tgl_FragColor = vec4(color, 1.0);\n}"]),side:p.DoubleSide}))).frustumCulled=!1,n.container.add(r)}function A(e,t){var n=~~(t+=_)%_,r=(n+1)%_,i=t%1;e.fromArray(b,3*n).lerp(M.fromArray(b,3*r),i)}},{"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../../utils/ease":114,"../../utils/math":115,"../river/river":123,"../sky/sky":125,"../terrain/terrain":126,glslify:21,"mout/object/mixIn":40,three:59}],120:[function(e,t,n){"use strict";var r,i,a,o=e("../../core/settings"),s=e("../../core/properties"),l=e("../../helpers/fboHelper"),u=e("../terrain/terrain"),c=e("../sky/sky"),h=e("mout/object/mixIn"),d=e("three"),p=e("glslify");function f(e){var t=new d.PlaneBufferGeometry(.3,.512).translate(0,.256,0);for(var o in a=new d.InstancedBufferGeometry,t.attributes)a.setAttribute(o,t.attributes[o]);a.setIndex(t.getIndex()),a.setAttribute("instancePosition",new d.InstancedBufferAttribute(e.attributes.position.array,3)),a.setAttribute("instanceSize",new d.InstancedBufferAttribute(e.attributes.pscale.array,1)),a.setAttribute("flowerId",new d.InstancedBufferAttribute(e.attributes.flowerId.array,1)),(r=new d.Mesh(a,new d.RawShaderMaterial({uniforms:h({u_time:s.sharedUniforms.u_time,u_texture:{value:i},u_terrainGrassTexture:u.sharedUniforms.u_terrainGrassTexture,u_terrainDrawTexture:u.sharedUniforms.u_terrainDrawTexture},c.sharedUniforms),vertexShader:l.precisionPrefix+p(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute float flowerId;\n\nattribute vec3 instancePosition;\nattribute float instanceSize;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\nuniform float u_time;\n\nuniform sampler2D u_terrainGrassTexture;\nuniform sampler2D u_terrainDrawTexture;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying float v_yRatio;\nvarying vec3 v_color;\nvarying vec2 v_uv;\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v_0) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v_0 + dot(v_0, vec4(F4)) );\n    vec4 x0 = v_0 -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\nvec3 qRotate (vec4 q, vec3 v) { \n  return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main () {\n\tfloat yRatio = uv.y;\n\tvec3 pos = position;\n\n\tpos = pos * instanceSize;\n\tpos += simplexNoiseDerivatives(vec4(instancePosition * 0.25, u_time * 0.3)).xyz * vec3(1.0, 0.3, 1.0) * 0.02 * yRatio * yRatio;\n\n\tvec2 terrainUv = instancePosition.xz / 10.0 + 0.5;\n\tvec3 drawInfo = texture2D(u_terrainDrawTexture, terrainUv).rgb;\n\tdrawInfo.xy = (drawInfo.xy * 2.0 - 1.0) * drawInfo.z ;\n\n\tv_color = yRatio > 0.01 ? vec3(1.0 + drawInfo.z * 0.3) : texture2D(u_terrainGrassTexture, terrainUv).rgb * 0.8;\n\n\tpos.xz  += drawInfo.xy * 0.02 * yRatio * yRatio;\n\tpos.y -= yRatio * yRatio * 0.01;\n\n\tvec4 mvPosition = modelViewMatrix * vec4(instancePosition, 1.0);\n\tmvPosition.xyz += pos;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_viewNormal = normalMatrix * normal;\n\n\tv_worldPosition = (modelMatrix * vec4(instancePosition, 1.0)).xyz;\n\tv_yRatio = position.y;\n\tv_uv = uv;\n\tv_uv.x = (v_uv.x + flowerId) / 5.0;\n}"]),fragmentShader:l.precisionPrefix+p(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec3 cameraPosition;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying float v_yRatio;\nvarying vec3 v_color;\nvarying vec2 v_uv;\n\n#include <fog>\n\nvoid main () {\n\n\tgl_FragColor = texture2D(u_texture, v_uv);\n\tgl_FragColor.rgb = applyFog(gl_FragColor.rgb * v_color, v_worldPosition);\n\tif (gl_FragColor.a < 0.004) discard;\n}"]),side:d.DoubleSide,transparent:!0}))).renderOrder=0,r.frustumCulled=!1,n.container.add(r)}n.preInit=function(){n.container=new d.Object3D,i=s.loader.add(o.TEXTURE_PATH+"flowers.png",{weight:40,type:"texture"}).content,s.loader.add(o.MODEL_PATH+"flower_placement.buf",{weight:7,noCache:!0,onLoad:f})},n.init=function(){},n.resize=function(e,t){},n.update=function(e){},n.container=null},{"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../sky/sky":125,"../terrain/terrain":126,glslify:21,"mout/object/mixIn":40,three:59}],121:[function(e,t,n){"use strict";var r,i,a,o=e("../../core/settings"),s=e("../../core/properties"),l=e("../../helpers/fboHelper"),u=e("../terrain/terrain"),c=e("../sky/sky"),h=e("mout/object/mixIn"),d=e("three"),p=e("glslify");function f(e,t){if("placement"==e)a=t;else if("hero"==e||"float"==e||"water"==e){var r=new d.Mesh(t,new d.RawShaderMaterial({uniforms:h({u_time:s.sharedUniforms.u_time,u_terrainGrassTexture:u.sharedUniforms.u_terrainGrassTexture,u_terrainDrawTexture:u.sharedUniforms.u_terrainDrawTexture,u_movementStrength:{value:"hero"===e?1:.25}},c.sharedUniforms),vertexShader:l.precisionPrefix+p(["#define GLSLIFY 1\nattribute float yRatio;\nattribute vec3 position;\nattribute vec3 normal;\n\n#ifdef USE_AO\n\tattribute float occlusion;\n#endif\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\nuniform float u_time;\nuniform float u_movementStrength;\n\nuniform sampler2D u_terrainGrassTexture;\nuniform sampler2D u_terrainDrawTexture;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_color;\nvarying float v_yRatio;\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v_0) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v_0 + dot(v_0, vec4(F4)) );\n    vec4 x0 = v_0 -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\nvec3 qRotate (vec4 q, vec3 v) { \n  return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main () {\n\tvec2 terrainUv = position.xz / 10.0 + 0.5;\n\tvec3 drawInfo = texture2D(u_terrainDrawTexture, terrainUv).rgb;\n\tdrawInfo.xy = (drawInfo.xy * 2.0 - 1.0) * drawInfo.z;\n\n\tvec3 pos = position;\n\tpos += simplexNoiseDerivatives(vec4(position * 0.25, u_time * 0.3)).xyz * vec3(0.02, 0.0, 0.02) * yRatio * yRatio * u_movementStrength;\n\n\tpos.xz  += drawInfo.xy * 0.01 * yRatio * yRatio;\n\tpos.y -= yRatio * yRatio * 0.005;\n\n\tvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_color = texture2D(u_terrainGrassTexture, terrainUv).rgb * (0.8 + yRatio * 0.2 + drawInfo.z * yRatio);\n\n\t#ifdef USE_AO\n\t\tv_color = v_color * (0.25 + occlusion * 1.75);\n\t#endif\n\n\tv_viewNormal = normalMatrix * normal;\n\n\tv_worldPosition = (modelMatrix * vec4(pos, 1.0)).xyz;\n\tv_yRatio = yRatio;\n}"]),fragmentShader:l.precisionPrefix+p(["#define GLSLIFY 1\nuniform vec3 cameraPosition;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_color;\n\n#include <fog>\n\nvoid main () {\n\tgl_FragColor = vec4(v_color * (1.0 + dot(vec3(0.5733),  normalize(v_viewNormal)) * 0.05), 1.0);\n\tgl_FragColor.rgb = applyFog(clamp(gl_FragColor.rgb, vec3(0.0), vec3(1.0)), v_worldPosition);\n}"])}));switch(n.container.add(r),e){case"hero":r.material.side=d.DoubleSide;break;case"float":case"water":r.material.defines.USE_AO=!0}}else{for(var o in i=new d.InstancedBufferGeometry,t.attributes)i.setAttribute(o,t.attributes[o]);i.setIndex(t.getIndex())}}n.preInit=function(){n.container=new d.Object3D,s.loader.add(o.MODEL_PATH+"grass.buf",{weight:1,noCache:!0,onLoad:f.bind(this,"")}),s.loader.add(o.MODEL_PATH+"grass_placement.buf",{weight:449,noCache:!0,onLoad:f.bind(this,"placement")}),s.loader.add(o.MODEL_PATH+"hero_grass.buf",{weight:92,noCache:!0,onLoad:f.bind(this,"hero")}),s.loader.add(o.MODEL_PATH+"float_plants.buf",{weight:165,noCache:!0,onLoad:f.bind(this,"float")}),s.loader.add(o.MODEL_PATH+"water_plants.buf",{weight:263,noCache:!0,onLoad:f.bind(this,"water")})},n.init=function(){i.setAttribute("instancePosition",new d.InstancedBufferAttribute(a.attributes.position.array,3)),i.setAttribute("instanceQrient",new d.InstancedBufferAttribute(a.attributes.orient.array,4)),i.setAttribute("instanceSize",new d.InstancedBufferAttribute(a.attributes.pscale.array,1)),(r=new d.Mesh(i,new d.RawShaderMaterial({uniforms:h({u_time:s.sharedUniforms.u_time,u_terrainGrassTexture:u.sharedUniforms.u_terrainGrassTexture,u_terrainDrawTexture:u.sharedUniforms.u_terrainDrawTexture},c.sharedUniforms),vertexShader:l.precisionPrefix+p(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nattribute vec3 instancePosition;\nattribute vec4 instanceQrient;\nattribute float instanceSize;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\nuniform float u_time;\n\nuniform sampler2D u_terrainGrassTexture;\nuniform sampler2D u_terrainDrawTexture;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_color;\nvarying float v_yRatio;\nvarying vec3 v_offset;\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v_0) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v_0 + dot(v_0, vec4(F4)) );\n    vec4 x0 = v_0 -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\nvec3 qRotate (vec4 q, vec3 v) { \n  return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main () {\n\tvec2 terrainUv = instancePosition.xz / 10.0 + 0.5;\n\tvec3 drawInfo = texture2D(u_terrainDrawTexture, terrainUv).rgb;\n\tdrawInfo.xy = (drawInfo.xy * 2.0 - 1.0) * drawInfo.z;\n\n\tfloat yRatio = position.y;\n\tvec3 pos = position;\n\n\tpos = qRotate(instanceQrient, pos) * instanceSize;\n\t\n\tv_offset = simplexNoiseDerivatives(vec4(instancePosition * 0.25, u_time * 0.3 + cos(u_time) * 0.1)).xyz * vec3(1.0, 0.3, 1.0);\n\t\n\tpos += v_offset * 0.02 * yRatio * yRatio;\n\tpos.xz  += drawInfo.xy * 0.06 * yRatio * yRatio;\n\tpos.y -= yRatio * yRatio * 0.03;\n\n\tpos += instancePosition;\n\n\tvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_color = texture2D(u_terrainGrassTexture, terrainUv).rgb * (0.8 + yRatio * 0.2 + drawInfo.z * yRatio * 0.5);\n\n\tv_viewNormal = normalMatrix * qRotate(instanceQrient, normal);\n\n\tv_worldPosition = (modelMatrix * vec4(pos, 1.0)).xyz;\n\tv_yRatio = position.y;\n}"]),fragmentShader:l.precisionPrefix+p(["#define GLSLIFY 1\nuniform vec3 cameraPosition;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_color;\nvarying float v_yRatio;\nvarying vec3 v_offset;\n\n#include <fog>\n\nvoid main () {\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tfloat diff = dot(vec3(0.5733),  viewNormal);\n\t// gl_FragColor = vec4(v_color * (1.0 + dot(vec3(0.5733),  normalize(v_viewNormal)) * 0.05), 1.0);\n\tgl_FragColor = vec4(v_color * (1.0 + dot(vec3(0.5733),  viewNormal) * 0.05), 1.0);\n\n\tgl_FragColor.rgb += max(0.0, v_offset.y + 0.25) * v_yRatio * smoothstep(-0.25, 1.0, diff) * 0.175 * vec3(0.7372549019607844,1.,0.023529411764705882);\n\n\tgl_FragColor.rgb = applyFog(clamp(gl_FragColor.rgb, vec3(0.0), vec3(1.0)), v_worldPosition);\n}"]),side:d.DoubleSide}))).renderOrder=0,r.frustumCulled=!1,n.container.add(r)},n.resize=function(e,t){},n.update=function(e){},n.container=null},{"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../sky/sky":125,"../terrain/terrain":126,glslify:21,"mout/object/mixIn":40,three:59}],122:[function(e,t,n){"use strict";var r=e("../../core/settings"),i=e("../../core/properties"),a=e("../../helpers/fboHelper"),o=(e("../terrain/terrain"),e("../sky/sky")),s=e("mout/object/mixIn"),l=e("three"),u=e("glslify");n.preInit=function(){n.container=new l.Object3D;for(var e=0;e<4;e++)i.loader.add(r.MODEL_PATH+"leaf_"+e+".buf",{weight:2,noCache:!0,onLoad:v.bind(this,e)});i.loader.add(r.MODEL_PATH+"leaf_splines.buf",{weight:10,noCache:!0,onLoad:m})},n.init=function(){},n.resize=function(e,t){},n.update=function(e){if(i.hasInitialized){d+=e;for(var t=0;t<4;t++){var n=c[t],r=8*(d+(t/4*f+t*f)/8)%768,a=~~(r/f)%6,o=Math.floor(r)%f,s=Math.ceil(r)%f;s=s<o?o:s;var l=r%1;n.position.fromArray(h,3*(o+a*f)).lerp(p.fromArray(h,3*(s+a*f)),l),n.rotation.y+=2*e}}},n.container=null;var c=[],h=[],d=0,p=new l.Vector3,f=128;function m(e){h=e.attributes.position.array}function v(e,t){var r=c[e]=new l.Mesh(t,new l.RawShaderMaterial({uniforms:s({},o.sharedUniforms),vertexShader:a.precisionPrefix+u(["#define GLSLIFY 1\nattribute float shade;\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_color;\n\nvoid main () {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\n\tv_color = mix(vec3(0.4980392156862745,0.4666666666666667,0.09411764705882353), vec3(0.22745098039215686,0.2549019607843137,0.027450980392156862), shade);\n\n\tv_viewNormal = normalMatrix * normal;\n\tv_worldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n}"]),fragmentShader:a.precisionPrefix+u(["#define GLSLIFY 1\nuniform vec3 cameraPosition;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_color;\n\n#include <fog>\n\nvoid main () {\n\tgl_FragColor = vec4(v_color * (1.0 + dot(vec3(0.5733),  normalize(v_viewNormal)) * 0.05), 1.0);\n\tgl_FragColor.rgb = applyFog(clamp(gl_FragColor.rgb, vec3(0.0), vec3(1.0)), v_worldPosition);\n}"])}));r.rotation.y=e/4*Math.PI*2,r.scale.set(1,1,1).multiplyScalar(3),r.renderOrder=1001,n.container.add(r)}},{"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../sky/sky":125,"../terrain/terrain":126,glslify:21,"mout/object/mixIn":40,three:59}],123:[function(e,t,n){"use strict";var r,i,a,o,s=e("../../core/settings"),l=e("../../core/properties"),u=e("../../helpers/fboHelper"),c=e("../terrain/terrain"),h=e("../sky/sky"),d=e("../../audios/audios"),p=e("mout/object/mixIn"),f=e("three"),m=e("glslify");n.preInit=function(){n.container=new f.Object3D,g=u.createRenderTarget(1,1),v=l.loader.add(s.TEXTURE_PATH+"voronoi.png",{weight:200,wrap:f.RepeatWrapping,type:"texture"}).content,l.loader.add(s.MODEL_PATH+"splashes.buf",{weight:976,noCache:!0,onLoad:M})},n.init=function(){(r=new f.Mesh(new f.PlaneBufferGeometry(1,1),new f.RawShaderMaterial({uniforms:p({u_streamOffset:{value:0},u_noiseScale:{value:.5},u_noiseOffsetY:{value:.05},u_shimmerTime:{value:0},u_shimmerDensity:{value:0},u_shimmerRotate:{value:0},u_shimmerScale:{value:new f.Vector2(1,1)},u_shimmerColor:{value:n.shimmerColor},u_voronoiTexture:{value:v},u_time:{value:0},u_splashPosition:{value:_},u_splashSize:{value:1},u_splashRestRatio:{value:0},u_terrainInfoTexture:c.sharedUniforms.u_terrainInfoTexture,u_terrainBoundingMin:c.sharedUniforms.u_terrainBoundingMin,u_terrainBoundingMax:c.sharedUniforms.u_terrainBoundingMax,u_resolution:l.sharedUniforms.u_resolution,u_layerTexture:{value:g.texture}},h.sharedUniforms),vertexShader:u.precisionPrefix+m(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nuniform float u_streamOffset;\nuniform float u_shimmerRotate;\nuniform vec2 u_shimmerScale;\nuniform float u_shimmerTime;\n\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_worldPosition;\nvarying vec3 v_worldNormal;\nvarying vec2 v_uv;\n\n#ifdef IS_SPLASH\nattribute float occlusion;\nuniform float u_splashRestRatio;\nvarying float v_ao;\n#endif\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\nvoid main () {\n\tvec3 pos = position;\n\t#ifdef IS_SPLASH\n\t\tpos.y = mix(pos.y, 0.0, u_splashRestRatio);\n\t#endif\n\t\n\tvec4 worldPosition = modelMatrix * vec4(pos, 1.0);\n\tvec4 mvPosition = viewMatrix * worldPosition;\n\n\tv_worldPosition = worldPosition.xyz;\n\n\tv_uv = worldPosition.xz;\n\tfloat s = sin(u_shimmerRotate);\n\tfloat c = cos(u_shimmerRotate);\n\tv_uv = mat2(c, -s, s, c) * v_uv;\n\tv_uv = v_uv * u_shimmerScale;\n\tv_uv.x += u_streamOffset + u_shimmerTime;\n\n\tv_viewPosition = mvPosition.xyz;\n\n\t#ifdef IS_SPLASH\n\tv_viewNormal = normalMatrix * normalize(mix(normal, vec3(0.0, 1.0, 0.0), u_splashRestRatio));\n\t#else\n\tv_viewNormal = normalMatrix * normal;\n\t#endif\n\tv_worldNormal = inverseTransformDirection(v_viewNormal, viewMatrix);\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#ifdef IS_SPLASH\n\tv_ao = occlusion;\n\t#endif\n}"]),fragmentShader:u.precisionPrefix+m(["#define GLSLIFY 1\nuniform sampler2D u_voronoiTexture;\n\nuniform float u_shimmerTime;\nuniform float u_shimmerDensity;\nuniform vec3 cameraPosition;\nuniform vec3 u_shimmerColor;\n\nuniform sampler2D u_terrainInfoTexture;\nuniform vec3 u_terrainBoundingMin;\nuniform vec3 u_terrainBoundingMax;\nuniform mat4 viewMatrix;\n\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_worldPosition;\nvarying vec3 v_worldNormal;\nvarying vec2 v_uv;\n\n// uniform sampler2D u_reflectionTexture;\n// varying vec4 v_reflectionTextureUv;\n\n// #pragma glslify: voronoi3d = require('glsl-voronoi-noise/3d')\n\nuniform sampler2D u_layerTexture;\nuniform vec2 u_resolution;\n\nuniform vec3 u_splashPosition;\nuniform float u_splashSize;\n\n#ifdef IS_SPLASH\nuniform float u_splashRestRatio;\nvarying float v_ao;\n#endif\n\nfloat plaIntersect( in vec3 ro, in vec3 rd, in vec4 p ) {\n    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\n#include <fog>\n\nvoid main () {\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tvec3 worldNormal = normalize(v_worldNormal);\n\tvec3 toCameraDir = normalize(v_worldPosition - cameraPosition);\n\tvec3 surfaceReflect = reflect(toCameraDir, worldNormal);\n\tvec3 normalizedWorldPositionToTerrain = (v_worldPosition - u_terrainBoundingMin) / (u_terrainBoundingMax - u_terrainBoundingMin);\n\tvec2 terrainUv = normalizedWorldPositionToTerrain.xz;\n\tvec4 terrainInfo = texture2D(u_terrainInfoTexture, terrainUv);\n\n\tvec3 noise = texture2D(u_voronoiTexture, v_uv * 0.1).rgb;\n\tnoise += noise.yzx * 0.4;\n\n\tfloat shimmer = smoothstep(0.0, -0.2, noise.x - u_shimmerDensity);\n\n\tfloat edgeRatio = terrainInfo.b;\n\n\tvec3 foamNoise = texture2D(u_voronoiTexture, v_worldPosition.xz * 0.8 + edgeRatio * edgeRatio * 0.6 + u_shimmerTime).rgb;\n\tfoamNoise +=  foamNoise.yzx -0.2;\n\n\tfloat edgeShimmer = max(step(0.9, edgeRatio), step(0.3 + foamNoise.y * 0.2, edgeRatio * foamNoise.x)) * edgeRatio;\n\n\tshimmer = max(edgeShimmer, shimmer);\n\n\tfloat visibility = smoothstep(5.0, 4.5, abs(v_worldPosition.z));\n\n\tvec3 color = u_shimmerColor;\n\n\tfloat opacity = mix(0.2, 1.0, shimmer) * smoothstep(1.0, 0.8, terrainInfo.b - foamNoise.x * 0.1);\n\t\n\t#ifdef IS_SPLASH\n\t\tfloat splashRadiusRatio = smoothstep(u_splashSize * 0.45, u_splashSize * 0.25, length(v_worldPosition - u_splashPosition));\n\t\tnoise.xy += viewNormal.xy * splashRadiusRatio * v_ao * 5.0 * (1.0 - u_splashRestRatio);\n\t#endif\n\t\n\tvec2 screenUv = gl_FragCoord.xy / u_resolution + noise.xy * 0.03 * foamNoise.y * visibility  * vec2(u_resolution.y / u_resolution.x, 1.0) * smoothstep(1.0, 0.0, terrainInfo.b);\n\n\tvec3 layerColor = texture2D(u_layerTexture, screenUv).rgb * mix(u_shimmerColor, vec3(1.0), min(1.0, edgeRatio + 1.0 - visibility));\n\n\t// vec2 reflectionUv = v_reflectionTextureUv.xy / v_reflectionTextureUv.w + noise.xy * 0.03 * foamNoise.y  * vec2(u_resolution.y / u_resolution.x, 1.0) * smoothstep(1.0, 0.0, terrainInfo.b);\n\t// vec3 reflection = texture2D(u_reflectionTexture, reflectionUv).rgb;\n\t// reflection *= inverseTransformDirection(surfaceReflect, viewMatrix).z;\n\n\t#ifdef IS_SPLASH\n\t\tvec3 splashLayerColor = layerColor * v_ao;\n\t\tfloat splashHeightRatio = smoothstep(0.0, 0.5, v_worldPosition.y + 0.203611);\n\t\t// opacity *= mix(1.0, 0.2, splashHeightRatio);\n\t\tsplashLayerColor *= mix(mix(u_shimmerColor, vec3(1.0), edgeRatio), vec3(1.0), splashRadiusRatio);\n\t\tvec3 splashColor = mix(splashLayerColor, color, opacity);\n\t\tsplashColor += smoothstep(0.5, 0.3, abs(viewNormal.z)) * splashRadiusRatio * v_ao * (1.0 - abs(viewNormal.y));\n\t\t\n\t\tgl_FragColor = vec4(splashColor, 1.0 - max(0.0, splashHeightRatio * smoothstep(0.3, 0.5, abs(viewNormal.z)) *2.0));\n\n\t\tcolor = mix(layerColor * mix(u_shimmerColor, vec3(1.0), edgeRatio), color, opacity);\n\t\tgl_FragColor = mix(gl_FragColor, vec4(color, 1.0), u_splashRestRatio);\n\t#else\n\t\tif (length(v_worldPosition - u_splashPosition) < u_splashSize * 0.45) {\n\t\t\tdiscard;\n\t\t}\n\t\tcolor = mix(layerColor * mix(u_shimmerColor, vec3(1.0), edgeRatio), color, opacity);\n\t\tgl_FragColor = vec4(color, 1.0);\n\t#endif\n\n\tgl_FragColor.rgb = applyFog(clamp(gl_FragColor.rgb, vec3(0.0), vec3(1.0)), v_worldPosition);\n\tgl_FragColor.rgb = mix(layerColor,gl_FragColor.rgb, visibility);\n\n}"])}))).scale.set(3.09973,10,1),r.rotation.x=-.5*Math.PI,r.position.set(1.29566,-.203611,0),r.onBeforeRender=S,r.renderOrder=1e3,n.container.add(r),(a=new f.Mesh(o,new f.RawShaderMaterial({uniforms:r.material.uniforms,vertexShader:r.material.vertexShader,fragmentShader:r.material.fragmentShader,blending:f.CustomBlending,blendSrc:f.SrcAlphaFactor,blendDst:f.OneMinusSrcAlphaFactor,blendSrcAlpha:f.SrcAlphaFactor,blendDstAlpha:f.DstAlphaFactor}))).material.defines.IS_SPLASH=!0,a.renderOrder=1002,d.audioItems.splash0.setPositionObjectParent(a),d.audioItems.splash1.setPositionObjectParent(a),n.container.add(a),(i=new f.Mesh(new f.PlaneBufferGeometry(1,1),new f.RawShaderMaterial({uniforms:p({u_time:r.material.uniforms.u_time,u_shimmerColor:r.material.uniforms.u_shimmerColor,u_voronoiTexture:r.material.uniforms.u_voronoiTexture},h.sharedUniforms),vertexShader:u.precisionPrefix+m(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_worldPosition;\nvarying vec3 v_worldNormal;\nvarying vec2 v_uv;\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\nvoid main () {\n\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\t\n\tvec4 mvPosition = viewMatrix * worldPosition;\n\n\tv_viewPosition = mvPosition.xyz;\n\tv_viewNormal = normalMatrix * normal;\n\tv_worldPosition = worldPosition.xyz;\n\tv_worldNormal = inverseTransformDirection(v_viewNormal, viewMatrix);\n\tv_uv = uv;\n\n\tgl_Position = projectionMatrix * mvPosition;\n}"]),fragmentShader:u.precisionPrefix+m(["#define GLSLIFY 1\nuniform sampler2D u_voronoiTexture;\n\nuniform vec3 cameraPosition;\nuniform vec3 u_shimmerColor;\n\nuniform float u_time;\n\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec3 v_worldPosition;\nvarying vec3 v_worldNormal;\nvarying vec2 v_uv;\n\n// #pragma glslify: voronoi3d = require('glsl-voronoi-noise/3d')\n\nuniform sampler2D u_layerTexture;\nuniform vec2 u_resolution;\n\nfloat plaIntersect( in vec3 ro, in vec3 rd, in vec4 p ) {\n    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);\n}\n\nvoid main () {\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tvec3 worldNormal = normalize(v_worldNormal);\n\tvec3 toCameraDir = normalize(v_worldPosition - cameraPosition);\n\tvec3 surfaceReflect = reflect(toCameraDir, worldNormal);\n\n\tvec3 noise = texture2D(u_voronoiTexture, v_uv * vec2(1.5,  0.1)+ vec2(0.0, u_time * 0.2)).rgb;\n\tnoise += texture2D(u_voronoiTexture, v_uv * vec2(1.0,  0.1) + vec2(0.5, u_time * 0.25)).gbr;\n\tnoise.x = (0.95 - noise.x) * 1.5 * smoothstep(0.5, 0.0, length(v_uv - 0.5));\n\t// vec3 noise = voronoi3d(vec3(v_uv * vec2(15.0, 1.0) + vec2(0.0, u_time * 2.0), u_time));\n\t// noise += voronoi3d(vec3(v_uv * vec2(10.0, 1.0) + vec2(1000.0, u_time * 2.0), u_time));\n\t// noise.x = (1.35 - noise.x) * 1.25 * smoothstep(0.5, 0.0, length(v_uv - 0.5));\n\n\tvec3 color = u_shimmerColor * max(1.0, noise.x);\n\tfloat opacity = clamp(noise.x, 0.0, 1.0);\n\n\tgl_FragColor = vec4(color, opacity);\n}"]),blending:f.CustomBlending,blendSrc:f.SrcAlphaFactor,blendDst:f.OneMinusSrcAlphaFactor,blendSrcAlpha:f.SrcAlphaFactor,blendDstAlpha:f.DstAlphaFactor,transparent:!0}))).geometry.rotateX(.5*-Math.PI),i.scale.set(1.2,1,.4),i.position.set(1.35,-.2,-1.8),n.container.add(i)},n.resize=function(e,t){},n.update=function(e){if(r){r.material.uniforms.u_time.value+=e,r.material.uniforms.u_streamOffset.value-=n.streamSpeed*e,r.material.uniforms.u_shimmerTime.value+=n.shimmerSpeed*e,r.material.uniforms.u_shimmerDensity.value=n.shimmerDensity,r.material.uniforms.u_shimmerRotate.value=n.shimmerRotate,r.material.uniforms.u_shimmerScale.value.set(1/(n.shimmerScale*n.shimmerStretch),1/n.shimmerScale),b+=e;var t=Math.floor(24*b),i=w[Math.min(w.length-1,t)],o=w[Math.min(w.length-1,t+1)];i!==o?(a.geometry.setDrawRange(3*i,3*(o-i)),a.visible=!0,x=0,n.canSplash=!1):x<1?(a.geometry.setDrawRange(3*w[w.length-2],3*(w[w.length-1]-w[w.length-2])),x=Math.min(x+.5*e,1),a.visible=!0,n.canSplash=!1):(y=0,a.visible||(a.rotation.y=Math.random()*Math.PI*2),a.visible=!1,n.canSplash=!0);var s=y*(1+.5*x);r.material.uniforms.u_splashSize.value=s,r.material.uniforms.u_splashRestRatio.value=x,a.position.copy(_),a.scale.set(1,1,1).multiplyScalar(Math.max(1e-5,s))}},n.splash=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.35;n.canSplash&&(d.playSplash(),_.set(e,-.203611,t),y=r,b=0,x=0)},n.canSplash=!0,n.container=null,n.shimmerSpeed=.2,n.shimmerRotate=.5*Math.PI,n.shimmerScale=.1,n.shimmerStretch=10,n.shimmerDensity=.15,n.shimmerColor=new f.Color(9013641),n.streamSpeed=1;var v,g,y=1,x=1,_=new f.Vector3,b=1e5,w=[0,2023,6994,11549,13908,15626,19885,26119,33487,40780,46428,50527,53491,55916,58222,60661,62974,65646,67815,69912,71489,72759,73847,74733,75495];function M(e){o=e}function S(e,t,n){if(l.camera===n){if("recursion"in n.userData){if(n.userData.recursion===recursion)return;n.userData.recursion++}u.clearMultisampleRenderTargetState(),g.setSize(l.width,l.height);var r=e.getRenderTarget();e.setRenderTarget(g),u.copyMaterial.uniforms.u_texture.value=r.texture,u.tri.material=u.copyMaterial,e.render(u.scene,u.camera),e.setRenderTarget(r)}}},{"../../audios/audios":62,"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../sky/sky":125,"../terrain/terrain":126,glslify:21,"mout/object/mixIn":40,three:59}],124:[function(e,t,n){"use strict";var r,i=e("../../core/browser"),a=e("../../core/settings"),o=e("../../core/properties"),s=e("../../helpers/fboHelper"),l=e("../sky/sky"),u=e("mout/object/mixIn"),c=e("three"),h=e("glslify");function d(e){r=new c.Mesh(e,new c.RawShaderMaterial({uniforms:u({u_texture:n.sharedUniforms.u_texture,u_aoTexture:n.sharedUniforms.u_aoTexture},l.sharedUniforms),vertexShader:s.precisionPrefix+h(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelMatrix;\nuniform mat3 normalMatrix;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_uv;\nvarying vec2 v_uv2;\n\nvoid main () {\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_worldPosition = worldPosition.xyz;\n\tv_viewPosition = mvPosition.xyz;\n\tv_viewNormal = normalMatrix * normal;\n\n\tv_uv = uv;\n\tv_uv2 = uv2;\n}"]),fragmentShader:s.precisionPrefix+h(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_aoTexture;\nuniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_uv;\nvarying vec2 v_uv2;\n\n#include <fog>\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\nvoid main () {\n\tvec3 color = texture2D(u_texture, v_uv).rgb;\n\tfloat ao = texture2D(u_aoTexture, v_uv2).r;\n\tao *= ao;\n\n\tvec3 worldNormal = inverseTransformDirection(normalize(v_viewNormal), viewMatrix);\n\tvec3 specRay = reflect(normalize(v_worldPosition - cameraPosition), normalize(worldNormal));\n\n\tvec3 diff = sampleSky(worldNormal);\n\tvec3 spec = sampleSky(specRay);\n\t\n\tcolor = color * (1.0 + diff * 0.3) * ao * 0.8 + (spec + spec.b) * ao * color * color * color * 3.0 * mix(0.6, 0.1, color.b);\n\tcolor *= mix(0.85, 1.0, step(-0.203611, v_worldPosition.y)) * (1.0 - pow(clamp((v_worldPosition.y + 0.203611) / -0.6, 0.0, 1.0), 0.5));\n\n\tgl_FragColor = vec4(color, 1.0);\n}"]),blending:c.NoBlending})),n.container.add(r)}n.preInit=function(){n.container=new c.Object3D,n.sharedUniforms.u_texture.value=o.loader.add(a.TEXTURE_PATH+"rocks"+(i.isMobile?"_mobile":"")+".jpg",{weight:460,type:"texture"}).content,n.sharedUniforms.u_aoTexture.value=o.loader.add(a.TEXTURE_PATH+"rocks_ao"+(i.isMobile?"_mobile":"")+".jpg",{weight:493,type:"texture"}).content,o.loader.add(a.MODEL_PATH+"rocks.buf",{weight:726,noCache:!0,onLoad:d})},n.init=function(){},n.resize=function(e,t){},n.update=function(e){},n.container=null,n.sharedUniforms={u_texture:{value:null},u_aoTexture:{value:null}}},{"../../core/browser":67,"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../sky/sky":125,glslify:21,"mout/object/mixIn":40,three:59}],125:[function(e,t,n){"use strict";var r=e("../../core/browser"),i=e("../../core/settings"),a=e("../../core/properties"),o=e("../../helpers/shaderHelper"),s=e("mout/object/mixIn"),l=e("three"),u=e("glslify");n.preInit=function(){o.addChunk("fog",u(["#define GLSLIFY 1\nuniform sampler2D u_envTexture;\n\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n\nvec2 equirectUv( in vec3 dir ) {\n\t// dir is assumed to be unit length\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = -asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tv = mix(v, v * v, 0.25);\n\n    u *= 2.0;\n    v = (v - 0.5) * 2.0 + 0.54;\n\treturn vec2( u, v );\n}\n\nfloat sdRoundedBox( in vec2 p, in vec2 b, in float r ){\n    vec2 q = abs(p)-b+r;\n    return min(max(q.x,q.y),0.0) + length(max(q,0.0)) - r;\n}\n\nvec3 applyFog(vec3 color, vec3 worldPosition) {\n\tvec3 toCamera = worldPosition - cameraPosition;\n\tvec3 nToCamera = normalize(toCamera);\n\n\tvec3 fogColor = texture2D(u_envTexture, equirectUv(nToCamera)).rgb;\n\tfloat d = sdRoundedBox(worldPosition.xz, vec2(2.5, 2.5), 1.0);\n\tfloat fog = clamp(d - 1.5, 0.0, 1.0);\n\tcolor = mix(color, fogColor, vec3(fog));\n\treturn color;\n}\n\nvec3 sampleSky (vec3 dir) {\n\treturn texture2D(u_envTexture, equirectUv(dir)).rgb;\n}"])),n.container=new l.Object3D,n.sharedUniforms.u_envTexture.value=a.loader.add(i.TEXTURE_PATH+"sky"+(r.isMobile?"_mobile":"")+".jpg",{type:"texture",wrap:l.MirroredRepeatWrapping,flipY:!1}).content,h=a.loader.add(i.TEXTURE_PATH+"noise.png",{type:"texture",wrap:l.RepeatWrapping,minFilter:l.LinearFilter}).content},n.init=function(){c=new l.Mesh(new l.SphereBufferGeometry(15,32,24),new l.ShaderMaterial({uniforms:s({u_time:a.sharedUniforms.u_time,u_noiseTexture:{value:h}},d),vertexShader:u(["#define GLSLIFY 1\nuniform float u_time;\nvarying vec3 v_worldPosition;\nvarying vec3 v_originalWorldPosition;\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nfloat mod289(float x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat permute(float x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat taylorInvSqrt(float r) {\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec4 grad4(float j, vec4 ip) {\n    const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n    vec4 p,s;\n\n    p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n    p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n    s = vec4(lessThan(p, vec4(0.0)));\n    p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www;\n\n    return p;\n}\n\n#define F4 0.309016994374947451\n\nvec4 simplexNoiseDerivatives (vec4 v) {\n    const vec4  C = vec4( 0.138196601125011,0.276393202250021,0.414589803375032,-0.447213595499958);\n\n    vec4 i  = floor(v + dot(v, vec4(F4)) );\n    vec4 x0 = v -   i + dot(i, C.xxxx);\n\n    vec4 i0;\n    vec3 isX = step( x0.yzw, x0.xxx );\n    vec3 isYZ = step( x0.zww, x0.yyz );\n    i0.x = isX.x + isX.y + isX.z;\n    i0.yzw = 1.0 - isX;\n    i0.y += isYZ.x + isYZ.y;\n    i0.zw += 1.0 - isYZ.xy;\n    i0.z += isYZ.z;\n    i0.w += 1.0 - isYZ.z;\n\n    vec4 i3 = clamp( i0, 0.0, 1.0 );\n    vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n    vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n\n    vec4 x1 = x0 - i1 + C.xxxx;\n    vec4 x2 = x0 - i2 + C.yyyy;\n    vec4 x3 = x0 - i3 + C.zzzz;\n    vec4 x4 = x0 + C.wwww;\n\n    i = mod289(i);\n    float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n    vec4 j1 = permute( permute( permute( permute (\n             i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n           + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n           + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n           + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n\n    vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n\n    vec4 p0 = grad4(j0,   ip);\n    vec4 p1 = grad4(j1.x, ip);\n    vec4 p2 = grad4(j1.y, ip);\n    vec4 p3 = grad4(j1.z, ip);\n    vec4 p4 = grad4(j1.w, ip);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n    p4 *= taylorInvSqrt(dot(p4,p4));\n\n    vec3 values0 = vec3(dot(p0, x0), dot(p1, x1), dot(p2, x2)); //value of contributions from each corner at point\n    vec2 values1 = vec2(dot(p3, x3), dot(p4, x4));\n\n    vec3 m0 = max(0.5 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0); //(0.5 - x^2) where x is the distance\n    vec2 m1 = max(0.5 - vec2(dot(x3,x3), dot(x4,x4)), 0.0);\n\n    vec3 temp0 = -6.0 * m0 * m0 * values0;\n    vec2 temp1 = -6.0 * m1 * m1 * values1;\n\n    vec3 mmm0 = m0 * m0 * m0;\n    vec2 mmm1 = m1 * m1 * m1;\n\n    float dx = temp0[0] * x0.x + temp0[1] * x1.x + temp0[2] * x2.x + temp1[0] * x3.x + temp1[1] * x4.x + mmm0[0] * p0.x + mmm0[1] * p1.x + mmm0[2] * p2.x + mmm1[0] * p3.x + mmm1[1] * p4.x;\n    float dy = temp0[0] * x0.y + temp0[1] * x1.y + temp0[2] * x2.y + temp1[0] * x3.y + temp1[1] * x4.y + mmm0[0] * p0.y + mmm0[1] * p1.y + mmm0[2] * p2.y + mmm1[0] * p3.y + mmm1[1] * p4.y;\n    float dz = temp0[0] * x0.z + temp0[1] * x1.z + temp0[2] * x2.z + temp1[0] * x3.z + temp1[1] * x4.z + mmm0[0] * p0.z + mmm0[1] * p1.z + mmm0[2] * p2.z + mmm1[0] * p3.z + mmm1[1] * p4.z;\n    float dw = temp0[0] * x0.w + temp0[1] * x1.w + temp0[2] * x2.w + temp1[0] * x3.w + temp1[1] * x4.w + mmm0[0] * p0.w + mmm0[1] * p1.w + mmm0[2] * p2.w + mmm1[0] * p3.w + mmm1[1] * p4.w;\n\n    return vec4(dx, dy, dz, dw) * 49.0;\n}\n\nvoid main () {\n\tvec3 pos = position + simplexNoiseDerivatives(vec4(position * 5.0, u_time * 0.05)).xyz * 0.04;\n\tv_worldPosition = (modelMatrix * vec4(pos, 1.0)).xyz;\n\tv_originalWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}"]),fragmentShader:u(["#define GLSLIFY 1\nuniform sampler2D u_noiseTexture;\nuniform float u_time;\nvarying vec3 v_worldPosition;\nvarying vec3 v_originalWorldPosition;\n\n#include <fog>\n\nvoid main () {\n    vec3 worldDir = normalize(v_worldPosition - cameraPosition);\n    vec2 uv = equirectUv(worldDir);\n\n    worldDir = normalize(v_originalWorldPosition * 2.0 - v_worldPosition - cameraPosition);\n    vec2 uv2 = equirectUv(worldDir);\n\n    vec3 displacement = texture2D(u_noiseTexture, uv * vec2(30.0 , 15.0)).xyz;\n    vec3 displacement2 = texture2D(u_noiseTexture, uv2 * vec2(40 , 20.0)).xyz;\n\n    displacement.x = abs(fract(u_time * 0.1 + displacement.x) - 0.5) * 3.5;\n\n    gl_FragColor = mix(\n        texture2D(u_envTexture, uv + (displacement.yz - 0.5) * vec2(0.005, 0.0025)),\n        texture2D(u_envTexture, uv2 + (displacement2.yz - 0.5) * vec2(0.005, 0.0025)),\n        displacement.xxxx\n    );\n}"]),side:l.BackSide})),n.container.add(c)},n.resize=function(e,t){},n.update=function(e){c.position.copy(a.camera.position)},n.container=null,n.sunDirection=null,n.sunViewDirection=null,n.TEXTURE_WIDTH=256,n.TEXTURE_HEIGHT=128;var c,h,d=n.sharedUniforms={u_envTexture:{value:null}}},{"../../core/browser":67,"../../core/properties":68,"../../core/settings":69,"../../helpers/shaderHelper":73,glslify:21,"mout/object/mixIn":40,three:59}],126:[function(e,t,n){"use strict";var r=e("../../core/browser"),i=e("../../core/settings"),a=e("../../core/properties"),o=e("../../helpers/fboHelper"),s=e("../../audios/audios"),l=e("../../input/input"),u=e("../sky/sky"),c=e("mout/object/mixIn"),h=e("three"),d=e("glslify");n.preInit=function(){n.container=new h.Object3D,E=new h.Object3D,n.container.add(E),T=new h.Raycaster,f=o.createRenderTarget(512,512,!0),m=f.clone(),n.sharedUniforms.u_terrainInfoTexture.value=m.texture,v=a.loader.add(i.TEXTURE_PATH+"terrain_info_1.png",{weight:65,type:"texture"}).content,g=a.loader.add(i.TEXTURE_PATH+"terrain_info_2.png",{weight:10,type:"texture"}).content,n.sharedUniforms.u_terrainGrassTexture.value=a.loader.add(i.TEXTURE_PATH+"grass.jpg",{weight:113,type:"texture",flipY:!1}).content,n.sharedUniforms.u_terrainRocksTexture.value=a.loader.add(i.TEXTURE_PATH+"rocks_ground_01"+(r.isMobile?"_mobile":"")+".jpg",{weight:656,type:"texture",wrap:h.RepeatWrapping}).content,n.sharedUniforms.u_terrainAOTexture.value=a.loader.add(i.TEXTURE_PATH+"terrain_ao"+(r.isMobile?"_mobile":"")+".jpg",{weight:454,type:"texture",flipY:!1}).content,a.loader.add(i.MODEL_PATH+"terrain.buf",{weight:250,noCache:!0,onLoad:O}),M=o.createRenderTarget(256,256),S=o.createRenderTarget(256,256)},n.init=function(){var e;e=new h.RawShaderMaterial({uniforms:{u_info1Texture:{value:v},u_info2Texture:{value:g}},vertexShader:o.vertexShader,fragmentShader:o.precisionPrefix+d(["#define GLSLIFY 1\nuniform sampler2D u_info1Texture;\nuniform sampler2D u_info2Texture;\n\nvarying vec2 v_uv;\n\nvoid main () {\n\tvec2 uv = v_uv;\n\tuv.y = 1.0 - v_uv.y;\n\tgl_FragColor = vec4(texture2D(u_info1Texture, uv).rgb, texture2D(u_info2Texture, uv).r);\n}"])}),o.render(e,f),s.audioItems.bush0.setPositionObjectParent(E),s.audioItems.bush1.setPositionObjectParent(E);var t=new h.InstancedBufferGeometry,n=new h.PlaneBufferGeometry(1,1);for(var r in n.rotateX(.5*Math.PI),n.attributes)t.setAttribute(r,n.attributes[r]);t.setIndex(n.getIndex()),t.setAttribute("instancePosition",x=new h.InstancedBufferAttribute(new Float32Array(15),3)),t.setAttribute("instanceOrient",_=new h.InstancedBufferAttribute(new Float32Array(20),4)),t.setAttribute("instanceScale",b=new h.InstancedBufferAttribute(new Float32Array(15),3)),(y=new h.Mesh(t,new h.RawShaderMaterial({vertexShader:o.precisionPrefix+d(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nattribute vec3 instancePosition;\nattribute vec4 instanceOrient;\nattribute vec3 instanceScale;\n\nvarying vec2 v_uv;\n\nvec3 qRotate (vec4 q, vec3 v) { \n\treturn v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main () {\n\tvec3 pos = position;\n\tpos = qRotate(instanceOrient, pos * instanceScale * 3.0) + instancePosition;\n\n\tgl_Position = vec4(pos.xz / 5.0, 0.0, 1.0);\n\tgl_PointSize = 100.0;\n\tv_uv = uv;\n}"]),fragmentShader:o.precisionPrefix+d(["#define GLSLIFY 1\nvarying vec2 v_uv;\n\nvoid main () {\n\tfloat d = max(0.0, 1.0 - length(v_uv - 0.5) * 2.0);\n\tgl_FragColor = vec4(0.0, 0.0, d, 0.0);\n}"]),blending:h.CustomBlending,blendEquation:h.AddEquation,blendSrc:h.OneFactor,blendDst:h.OneFactor,blendEquationAlpha:h.AddEquation,blendSrcAlpha:h.OneFactor,blendDstAlpha:h.OneFactor,transparent:!0,depthTest:!1,depthWrite:!1}))).frustumCulled=!1,w=new h.RawShaderMaterial({uniforms:{u_texture:{value:null},u_mouseXZ:{value:new h.Vector2},u_mouseRadius:{value:.5},u_mouseStrength:{value:1},u_drag:{value:.975}},vertexShader:o.vertexShader,fragmentShader:o.precisionPrefix+d(["#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec2 u_mouseXZ;\nuniform float u_mouseRadius;\nuniform float u_mouseStrength;\nuniform float u_drag;\n\nvarying vec2 v_uv;\n\nvoid main () {\n\tvec4 texel = texture2D(u_texture, v_uv);\n\n\tvec2 pos = v_uv * 10.0 - 5.0;\n\tvec3 delta3 = vec3(pos, 0.0) - vec3(u_mouseXZ, 0.001);\n\tvec2 nor = normalize(delta3).xy;\n\tfloat dist = length(delta3);\n\tfloat weight = smoothstep(u_mouseRadius, 0.0, dist) * u_mouseStrength;\n\n\ttexel.b = texel.b * u_drag + weight;\n\n\ttexel.rg += (0.5 - texel.rg) * (1.0 - u_drag);\n\ttexel.rg = mix(texel.rg, nor * 0.5 + 0.5, weight);\n\n\tgl_FragColor = texel;\n}"])}),o.clearColor(.5,.5,0,1,S)},n.resize=function(e,t){},n.update=function(e){if(A=0,p){var t=!1;T.setFromCamera(l.mouseXY,a.camera);var r=T.intersectObject(p);if(r.length>0){var i=r[0].point;if(i.y<D.constant?(T.setFromCamera(l.mouseXY,a.camera),T.ray.intersectPlane(D,i)):t=!0,w.uniforms.u_mouseXZ.value.set(i.x,i.z),w.uniforms.u_mouseStrength.value=Math.min(1,l.mousePixelXY.distanceTo(l.prevMousePixelXY)/5),n.sharedUniforms.u_terrainDrawPos.value.copy(i),t){if(I+.5<a.time){I=a.time;var u=E.position.distanceTo(i),c=s.playBush();c&&(c.volume=4*Math.pow(Math.min(1,u/e/10),.3)*a.introRatio*(1-a.final.blurRatio))}E.position.copy(i)}}else w.uniforms.u_mouseStrength.value=0;var h=M;M=S,S=h,w.uniforms.u_texture.value=M.texture,o.render(w,S),n.sharedUniforms.u_terrainDrawTexture.value=S.texture}},n.addCharacterMesh=function(e){e.geometry.boundingBox.getCenter(L),e.geometry.boundingBox.getSize(P),L.y=0,P.y=1,R.identity(),C.compose(L,R,P).premultiply(e.matrixWorld),C.decompose(L,R,P),L.toArray(x.array,3*A),R.toArray(_.array,4*A),P.toArray(b.array,3*A),A++},n.updateInfoTexture=function(){if(p&&(o.copy(f.texture,m),A>0)){var e=o.getColorState();o.renderer.autoClear=!1,y.geometry.instanceCount=A,x.needsUpdate=!0,_.needsUpdate=!0,b.needsUpdate=!0,o.renderMesh(y,m),o.setColorState(e)}},n.container=null,n.sharedUniforms={u_terrainInfoTexture:{value:null},u_terrainGrassTexture:{value:null},u_terrainRocksTexture:{value:null},u_terrainAOTexture:{value:null},u_terrainDrawTexture:{value:null},u_terrainDrawPos:{value:new h.Vector3},u_terrainBoundingMin:{value:null},u_terrainBoundingMax:{value:null}};var p,f,m,v,g,y,x,_,b,w,M,S,T,E,A=0,C=new h.Matrix4,L=new h.Vector3,R=new h.Quaternion,P=new h.Vector3,D=new h.Plane(new h.Vector3(0,-1,0),-.203611),I=0;function O(e){e.computeBoundingBox(),n.sharedUniforms.u_terrainBoundingMin.value=e.boundingBox.min,n.sharedUniforms.u_terrainBoundingMax.value=e.boundingBox.max,(p=new h.Mesh(e,new h.ShaderMaterial({uniforms:c({u_terrainInfoTexture:n.sharedUniforms.u_terrainInfoTexture,u_terrainGrassTexture:n.sharedUniforms.u_terrainGrassTexture,u_terrainRocksTexture:n.sharedUniforms.u_terrainRocksTexture,u_terrainAOTexture:n.sharedUniforms.u_terrainAOTexture},u.sharedUniforms),vertexShader:d(["#define GLSLIFY 1\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_terrainUv;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\n\nvoid main () {\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tgl_Position = projectionMatrix * mvPosition;\n\n\tv_terrainUv = worldPosition.xz / 10.0 + 0.5;\n\n\tv_worldPosition = worldPosition.xyz;\n\tv_viewPosition = mvPosition.xyz;\n\tv_viewNormal = normalMatrix * normal;\n}"]),fragmentShader:d(["#define GLSLIFY 1\nuniform sampler2D u_terrainInfoTexture;\nuniform sampler2D u_terrainGrassTexture;\nuniform sampler2D u_terrainRocksTexture;\nuniform sampler2D u_terrainAOTexture;\n\nvarying vec3 v_worldPosition;\nvarying vec3 v_viewPosition;\nvarying vec3 v_viewNormal;\nvarying vec2 v_terrainUv;\n\nvec2 dHdxy_fwd(float Hll, vec2 uv) {\n\tvec2 dSTdx = dFdx( uv );\n\tvec2 dSTdy = dFdy( uv );\n\tfloat dBx = texture2D( u_terrainRocksTexture, uv + dSTdx ).b - Hll;\n\tfloat dBy = texture2D( u_terrainRocksTexture, uv + dSTdy ).b - Hll;\n\treturn vec2( dBx, dBy ) * 0.35;\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See vec4(0.6,0.6,0.5333333333333333,0.5333333333333333)\n\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\tvec3 vN = surf_norm;\t\t// normalized\n\tvec3 R1 = cross( vSigmaY, vN );\n\tvec3 R2 = cross( vN, vSigmaX );\n\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n\n#include <fog>\n\nvoid main () {\n\tvec4 info = texture2D(u_terrainInfoTexture, v_terrainUv);\n\n\tvec3 grassColor = texture2D(u_terrainGrassTexture, v_terrainUv).rgb;\n\n\tvec2 rockUv =  v_terrainUv * 8.0;\n\tvec3 rockColor = texture2D(u_terrainRocksTexture, rockUv).rgb;\n\n\trockColor *= mix(0.85, 1.0, step(-0.203611, v_worldPosition.y)) * (1.0 - pow(clamp((v_worldPosition.y + 0.203611) / -0.7, 0.0, 1.0), 0.75));\n\n\tvec3 viewNormal = normalize(v_viewNormal);\n\tviewNormal = perturbNormalArb(v_viewPosition, viewNormal, dHdxy_fwd(rockColor.b, rockUv), 1.0);\n\n\tvec3 specRay = reflect(normalize(v_viewPosition), viewNormal);\n\tfloat l = smoothstep(-1.0, 1.0, dot(specRay, vec3(0.57735))) * info.a;\n\n\tvec2 aoTexel = texture2D(u_terrainAOTexture, v_terrainUv).rg;\n\tfloat ao = mix(1.0, aoTexel.r, mix(0.25, 1.0, info.a)) * aoTexel.y;\n\t\n\tvec3 color = mix(grassColor, rockColor, info.a);\n\n\tcolor = color * ao * (1.0 + l);\n\tgl_FragColor = vec4(applyFog(clamp(color, vec3(0.0), vec3(1.0)), v_worldPosition), 1.0);\n}"])}))).material.extensions.derivatives=!0,p.renderOrder=-1e3,n.container.add(p)}},{"../../audios/audios":62,"../../core/browser":67,"../../core/properties":68,"../../core/settings":69,"../../helpers/fboHelper":72,"../../input/input":76,"../sky/sky":125,glslify:21,"mout/object/mixIn":40,three:59}],127:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault")(e("../ui/ui")),i=e("three"),a=e("../core/properties"),o=(e("../helpers/fboHelper"),e("./sky/sky")),s=e("./terrain/terrain"),l=e("./grass/grass"),u=e("./flowers/flowers"),c=e("./rocks/rocks"),h=e("./river/river"),d=e("./leaves/leaves"),p=e("./fish/fish"),f=e("./dusts/dusts"),m=e("./characters/characters");n.preInit=function(){n.container=new i.Object3D,o.preInit(),n.container.add(o.container),h.preInit(),n.container.add(h.container),s.preInit(),n.container.add(s.container),l.preInit(),n.container.add(l.container),u.preInit(),n.container.add(u.container),c.preInit(),n.container.add(c.container),m.preInit(),n.container.add(m.container),d.preInit(),n.container.add(d.container),p.preInit(),n.container.add(p.container),f.preInit(),n.container.add(f.container)},n.init=function(){o.init(),h.init(),s.init(),l.init(),u.init(),c.init(),m.init(),d.init(),p.init(),f.init()},n.resize=function(e,t){o.resize(e,t),h.resize(e,t),s.resize(e,t),l.resize(e,t),u.resize(e,t),c.resize(e,t),m.resize(e,t),d.resize(e,t),p.resize(e,t)},n.update=function(e){!r.default.about._isActive&&a.introRatio>0&&(o.update(e),h.update(e),s.update(e),l.update(e),u.update(e),c.update(e),m.update(e),d.update(e),f.update(e),p.update(e),s.updateInfoTexture(e))},n.container=null},{"../core/properties":68,"../helpers/fboHelper":72,"../ui/ui":112,"./characters/characters":117,"./dusts/dusts":118,"./fish/fish":119,"./flowers/flowers":120,"./grass/grass":121,"./leaves/leaves":122,"./river/river":123,"./rocks/rocks":124,"./sky/sky":125,"./terrain/terrain":126,"@babel/runtime/helpers/interopRequireDefault":10,three:59}]},{},[75]);